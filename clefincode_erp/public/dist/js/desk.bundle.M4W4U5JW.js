(()=>{var up=Object.create;var Br=Object.defineProperty,dp=Object.defineProperties,fp=Object.getOwnPropertyDescriptor,pp=Object.getOwnPropertyDescriptors,hp=Object.getOwnPropertyNames,ys=Object.getOwnPropertySymbols,_p=Object.getPrototypeOf,ks=Object.prototype.hasOwnProperty,mp=Object.prototype.propertyIsEnumerable;var ws=(i,t,e)=>t in i?Br(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,lt=(i,t)=>{for(var e in t||(t={}))ks.call(t,e)&&ws(i,e,t[e]);if(ys)for(var e of ys(t))mp.call(t,e)&&ws(i,e,t[e]);return i},Ht=(i,t)=>dp(i,pp(t));var tr=(i=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(i,{get:(t,e)=>(typeof require!="undefined"?require:t)[e]}):i)(function(i){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+i+'" is not supported')});var ye=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),gp=(i,t)=>{for(var e in t)Br(i,e,{get:t[e],enumerable:!0})},vp=(i,t,e,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of hp(t))!ks.call(i,n)&&n!==e&&Br(i,n,{get:()=>t[n],enumerable:!(r=fp(t,n))||r.enumerable});return i};var Ut=(i,t,e)=>(e=i!=null?up(_p(i)):{},vp(t||!i||!i.__esModule?Br(e,"default",{value:i,enumerable:!0}):e,i));var ro=ye((M3,io)=>{"use strict";var eo=Array.isArray,to=Object.keys,Vp=Object.prototype.hasOwnProperty;io.exports=function i(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var r=eo(t),n=eo(e),a,s,o;if(r&&n){if(s=t.length,s!=e.length)return!1;for(a=s;a--!==0;)if(!i(t[a],e[a]))return!1;return!0}if(r!=n)return!1;var l=t instanceof Date,u=e instanceof Date;if(l!=u)return!1;if(l&&u)return t.getTime()==e.getTime();var c=t instanceof RegExp,h=e instanceof RegExp;if(c!=h)return!1;if(c&&h)return t.toString()==e.toString();var p=to(t);if(s=p.length,s!==to(e).length)return!1;for(a=s;a--!==0;)if(!Vp.call(e,p[a]))return!1;for(a=s;a--!==0;)if(o=p[a],!i(t[o],e[o]))return!1;return!0}return t!==t&&e!==e}});var ao=ye((P3,no)=>{function Yp(){this.__data__=[],this.size=0}no.exports=Yp});var aa=ye((D3,so)=>{function Gp(i,t){return i===t||i!==i&&t!==t}so.exports=Gp});var ur=ye((j3,oo)=>{var Xp=aa();function Kp(i,t){for(var e=i.length;e--;)if(Xp(i[e][0],t))return e;return-1}oo.exports=Kp});var co=ye((z3,lo)=>{var Jp=ur(),Zp=Array.prototype,Qp=Zp.splice;function eh(i){var t=this.__data__,e=Jp(t,i);if(e<0)return!1;var r=t.length-1;return e==r?t.pop():Qp.call(t,e,1),--this.size,!0}lo.exports=eh});var fo=ye((F3,uo)=>{var th=ur();function ih(i){var t=this.__data__,e=th(t,i);return e<0?void 0:t[e][1]}uo.exports=ih});var ho=ye((H3,po)=>{var rh=ur();function nh(i){return rh(this.__data__,i)>-1}po.exports=nh});var mo=ye((q3,_o)=>{var ah=ur();function sh(i,t){var e=this.__data__,r=ah(e,i);return r<0?(++this.size,e.push([i,t])):e[r][1]=t,this}_o.exports=sh});var dr=ye((U3,go)=>{var oh=ao(),lh=co(),ch=fo(),uh=ho(),dh=mo();function Mi(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var r=i[t];this.set(r[0],r[1])}}Mi.prototype.clear=oh;Mi.prototype.delete=lh;Mi.prototype.get=ch;Mi.prototype.has=uh;Mi.prototype.set=dh;go.exports=Mi});var bo=ye((W3,vo)=>{var fh=dr();function ph(){this.__data__=new fh,this.size=0}vo.exports=ph});var wo=ye((V3,yo)=>{function hh(i){var t=this.__data__,e=t.delete(i);return this.size=t.size,e}yo.exports=hh});var xo=ye((Y3,ko)=>{function _h(i){return this.__data__.get(i)}ko.exports=_h});var So=ye((G3,Co)=>{function mh(i){return this.__data__.has(i)}Co.exports=mh});var sa=ye((X3,To)=>{var gh=typeof global=="object"&&global&&global.Object===Object&&global;To.exports=gh});var li=ye((K3,Eo)=>{var vh=sa(),bh=typeof self=="object"&&self&&self.Object===Object&&self,yh=vh||bh||Function("return this")();Eo.exports=yh});var Vr=ye((J3,Ao)=>{var wh=li(),kh=wh.Symbol;Ao.exports=kh});var Lo=ye((Z3,Ro)=>{var $o=Vr(),Oo=Object.prototype,xh=Oo.hasOwnProperty,Ch=Oo.toString,fr=$o?$o.toStringTag:void 0;function Sh(i){var t=xh.call(i,fr),e=i[fr];try{i[fr]=void 0;var r=!0}catch(a){}var n=Ch.call(i);return r&&(t?i[fr]=e:delete i[fr]),n}Ro.exports=Sh});var Io=ye((Q3,Bo)=>{var Th=Object.prototype,Eh=Th.toString;function Ah(i){return Eh.call(i)}Bo.exports=Ah});var pr=ye((e2,Po)=>{var Mo=Vr(),$h=Lo(),Oh=Io(),Rh="[object Null]",Lh="[object Undefined]",No=Mo?Mo.toStringTag:void 0;function Bh(i){return i==null?i===void 0?Lh:Rh:No&&No in Object(i)?$h(i):Oh(i)}Po.exports=Bh});var Ni=ye((t2,Do)=>{function Ih(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}Do.exports=Ih});var oa=ye((i2,jo)=>{var Mh=pr(),Nh=Ni(),Ph="[object AsyncFunction]",Dh="[object Function]",jh="[object GeneratorFunction]",zh="[object Proxy]";function Fh(i){if(!Nh(i))return!1;var t=Mh(i);return t==Dh||t==jh||t==Ph||t==zh}jo.exports=Fh});var Fo=ye((r2,zo)=>{var Hh=li(),qh=Hh["__core-js_shared__"];zo.exports=qh});var Uo=ye((n2,qo)=>{var la=Fo(),Ho=function(){var i=/[^.]+$/.exec(la&&la.keys&&la.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function Uh(i){return!!Ho&&Ho in i}qo.exports=Uh});var ca=ye((a2,Wo)=>{var Wh=Function.prototype,Vh=Wh.toString;function Yh(i){if(i!=null){try{return Vh.call(i)}catch(t){}try{return i+""}catch(t){}}return""}Wo.exports=Yh});var Yo=ye((s2,Vo)=>{var Gh=oa(),Xh=Uo(),Kh=Ni(),Jh=ca(),Zh=/[\\^$.*+?()[\]{}|]/g,Qh=/^\[object .+?Constructor\]$/,e_=Function.prototype,t_=Object.prototype,i_=e_.toString,r_=t_.hasOwnProperty,n_=RegExp("^"+i_.call(r_).replace(Zh,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function a_(i){if(!Kh(i)||Xh(i))return!1;var t=Gh(i)?n_:Qh;return t.test(Jh(i))}Vo.exports=a_});var Xo=ye((o2,Go)=>{function s_(i,t){return i==null?void 0:i[t]}Go.exports=s_});var yi=ye((l2,Ko)=>{var o_=Yo(),l_=Xo();function c_(i,t){var e=l_(i,t);return o_(e)?e:void 0}Ko.exports=c_});var Yr=ye((c2,Jo)=>{var u_=yi(),d_=li(),f_=u_(d_,"Map");Jo.exports=f_});var hr=ye((u2,Zo)=>{var p_=yi(),h_=p_(Object,"create");Zo.exports=h_});var tl=ye((d2,el)=>{var Qo=hr();function m_(){this.__data__=Qo?Qo(null):{},this.size=0}el.exports=m_});var rl=ye((f2,il)=>{function g_(i){var t=this.has(i)&&delete this.__data__[i];return this.size-=t?1:0,t}il.exports=g_});var al=ye((p2,nl)=>{var v_=hr(),b_="__lodash_hash_undefined__",y_=Object.prototype,w_=y_.hasOwnProperty;function k_(i){var t=this.__data__;if(v_){var e=t[i];return e===b_?void 0:e}return w_.call(t,i)?t[i]:void 0}nl.exports=k_});var ol=ye((h2,sl)=>{var x_=hr(),C_=Object.prototype,S_=C_.hasOwnProperty;function T_(i){var t=this.__data__;return x_?t[i]!==void 0:S_.call(t,i)}sl.exports=T_});var cl=ye((_2,ll)=>{var E_=hr(),A_="__lodash_hash_undefined__";function $_(i,t){var e=this.__data__;return this.size+=this.has(i)?0:1,e[i]=E_&&t===void 0?A_:t,this}ll.exports=$_});var dl=ye((m2,ul)=>{var O_=tl(),R_=rl(),L_=al(),B_=ol(),I_=cl();function Pi(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var r=i[t];this.set(r[0],r[1])}}Pi.prototype.clear=O_;Pi.prototype.delete=R_;Pi.prototype.get=L_;Pi.prototype.has=B_;Pi.prototype.set=I_;ul.exports=Pi});var hl=ye((g2,pl)=>{var fl=dl(),M_=dr(),N_=Yr();function P_(){this.size=0,this.__data__={hash:new fl,map:new(N_||M_),string:new fl}}pl.exports=P_});var ml=ye((v2,_l)=>{function D_(i){var t=typeof i;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?i!=="__proto__":i===null}_l.exports=D_});var _r=ye((b2,gl)=>{var j_=ml();function z_(i,t){var e=i.__data__;return j_(t)?e[typeof t=="string"?"string":"hash"]:e.map}gl.exports=z_});var bl=ye((y2,vl)=>{var F_=_r();function H_(i){var t=F_(this,i).delete(i);return this.size-=t?1:0,t}vl.exports=H_});var wl=ye((w2,yl)=>{var q_=_r();function U_(i){return q_(this,i).get(i)}yl.exports=U_});var xl=ye((k2,kl)=>{var W_=_r();function V_(i){return W_(this,i).has(i)}kl.exports=V_});var Sl=ye((x2,Cl)=>{var Y_=_r();function G_(i,t){var e=Y_(this,i),r=e.size;return e.set(i,t),this.size+=e.size==r?0:1,this}Cl.exports=G_});var El=ye((C2,Tl)=>{var X_=hl(),K_=bl(),J_=wl(),Z_=xl(),Q_=Sl();function Di(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var r=i[t];this.set(r[0],r[1])}}Di.prototype.clear=X_;Di.prototype.delete=K_;Di.prototype.get=J_;Di.prototype.has=Z_;Di.prototype.set=Q_;Tl.exports=Di});var $l=ye((S2,Al)=>{var em=dr(),tm=Yr(),im=El(),rm=200;function nm(i,t){var e=this.__data__;if(e instanceof em){var r=e.__data__;if(!tm||r.length<rm-1)return r.push([i,t]),this.size=++e.size,this;e=this.__data__=new im(r)}return e.set(i,t),this.size=e.size,this}Al.exports=nm});var Rl=ye((T2,Ol)=>{var am=dr(),sm=bo(),om=wo(),lm=xo(),cm=So(),um=$l();function ji(i){var t=this.__data__=new am(i);this.size=t.size}ji.prototype.clear=sm;ji.prototype.delete=om;ji.prototype.get=lm;ji.prototype.has=cm;ji.prototype.set=um;Ol.exports=ji});var Bl=ye((E2,Ll)=>{function dm(i,t){for(var e=-1,r=i==null?0:i.length;++e<r&&t(i[e],e,i)!==!1;);return i}Ll.exports=dm});var Ml=ye((A2,Il)=>{var fm=yi(),pm=function(){try{var i=fm(Object,"defineProperty");return i({},"",{}),i}catch(t){}}();Il.exports=pm});var ua=ye(($2,Pl)=>{var Nl=Ml();function hm(i,t,e){t=="__proto__"&&Nl?Nl(i,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):i[t]=e}Pl.exports=hm});var da=ye((O2,Dl)=>{var _m=ua(),mm=aa(),gm=Object.prototype,vm=gm.hasOwnProperty;function bm(i,t,e){var r=i[t];(!(vm.call(i,t)&&mm(r,e))||e===void 0&&!(t in i))&&_m(i,t,e)}Dl.exports=bm});var mr=ye((R2,jl)=>{var ym=da(),wm=ua();function km(i,t,e,r){var n=!e;e||(e={});for(var a=-1,s=t.length;++a<s;){var o=t[a],l=r?r(e[o],i[o],o,e,i):void 0;l===void 0&&(l=i[o]),n?wm(e,o,l):ym(e,o,l)}return e}jl.exports=km});var Fl=ye((L2,zl)=>{function xm(i,t){for(var e=-1,r=Array(i);++e<i;)r[e]=t(e);return r}zl.exports=xm});var zi=ye((B2,Hl)=>{function Cm(i){return i!=null&&typeof i=="object"}Hl.exports=Cm});var Ul=ye((I2,ql)=>{var Sm=pr(),Tm=zi(),Em="[object Arguments]";function Am(i){return Tm(i)&&Sm(i)==Em}ql.exports=Am});var Gl=ye((M2,Yl)=>{var Wl=Ul(),$m=zi(),Vl=Object.prototype,Om=Vl.hasOwnProperty,Rm=Vl.propertyIsEnumerable,Lm=Wl(function(){return arguments}())?Wl:function(i){return $m(i)&&Om.call(i,"callee")&&!Rm.call(i,"callee")};Yl.exports=Lm});var Gr=ye((N2,Xl)=>{var Bm=Array.isArray;Xl.exports=Bm});var Jl=ye((P2,Kl)=>{function Im(){return!1}Kl.exports=Im});var fa=ye((gr,Fi)=>{var Mm=li(),Nm=Jl(),ec=typeof gr=="object"&&gr&&!gr.nodeType&&gr,Zl=ec&&typeof Fi=="object"&&Fi&&!Fi.nodeType&&Fi,Pm=Zl&&Zl.exports===ec,Ql=Pm?Mm.Buffer:void 0,Dm=Ql?Ql.isBuffer:void 0,jm=Dm||Nm;Fi.exports=jm});var ic=ye((D2,tc)=>{var zm=9007199254740991,Fm=/^(?:0|[1-9]\d*)$/;function Hm(i,t){var e=typeof i;return t=t==null?zm:t,!!t&&(e=="number"||e!="symbol"&&Fm.test(i))&&i>-1&&i%1==0&&i<t}tc.exports=Hm});var pa=ye((j2,rc)=>{var qm=9007199254740991;function Um(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=qm}rc.exports=Um});var ac=ye((z2,nc)=>{var Wm=pr(),Vm=pa(),Ym=zi(),Gm="[object Arguments]",Xm="[object Array]",Km="[object Boolean]",Jm="[object Date]",Zm="[object Error]",Qm="[object Function]",eg="[object Map]",tg="[object Number]",ig="[object Object]",rg="[object RegExp]",ng="[object Set]",ag="[object String]",sg="[object WeakMap]",og="[object ArrayBuffer]",lg="[object DataView]",cg="[object Float32Array]",ug="[object Float64Array]",dg="[object Int8Array]",fg="[object Int16Array]",pg="[object Int32Array]",hg="[object Uint8Array]",_g="[object Uint8ClampedArray]",mg="[object Uint16Array]",gg="[object Uint32Array]",gt={};gt[cg]=gt[ug]=gt[dg]=gt[fg]=gt[pg]=gt[hg]=gt[_g]=gt[mg]=gt[gg]=!0;gt[Gm]=gt[Xm]=gt[og]=gt[Km]=gt[lg]=gt[Jm]=gt[Zm]=gt[Qm]=gt[eg]=gt[tg]=gt[ig]=gt[rg]=gt[ng]=gt[ag]=gt[sg]=!1;function vg(i){return Ym(i)&&Vm(i.length)&&!!gt[Wm(i)]}nc.exports=vg});var Xr=ye((F2,sc)=>{function bg(i){return function(t){return i(t)}}sc.exports=bg});var Kr=ye((vr,Hi)=>{var yg=sa(),oc=typeof vr=="object"&&vr&&!vr.nodeType&&vr,br=oc&&typeof Hi=="object"&&Hi&&!Hi.nodeType&&Hi,wg=br&&br.exports===oc,ha=wg&&yg.process,kg=function(){try{var i=br&&br.require&&br.require("util").types;return i||ha&&ha.binding&&ha.binding("util")}catch(t){}}();Hi.exports=kg});var dc=ye((H2,uc)=>{var xg=ac(),Cg=Xr(),lc=Kr(),cc=lc&&lc.isTypedArray,Sg=cc?Cg(cc):xg;uc.exports=Sg});var _a=ye((q2,fc)=>{var Tg=Fl(),Eg=Gl(),Ag=Gr(),$g=fa(),Og=ic(),Rg=dc(),Lg=Object.prototype,Bg=Lg.hasOwnProperty;function Ig(i,t){var e=Ag(i),r=!e&&Eg(i),n=!e&&!r&&$g(i),a=!e&&!r&&!n&&Rg(i),s=e||r||n||a,o=s?Tg(i.length,String):[],l=o.length;for(var u in i)(t||Bg.call(i,u))&&!(s&&(u=="length"||n&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Og(u,l)))&&o.push(u);return o}fc.exports=Ig});var Jr=ye((U2,pc)=>{var Mg=Object.prototype;function Ng(i){var t=i&&i.constructor,e=typeof t=="function"&&t.prototype||Mg;return i===e}pc.exports=Ng});var ma=ye((W2,hc)=>{function Pg(i,t){return function(e){return i(t(e))}}hc.exports=Pg});var mc=ye((V2,_c)=>{var Dg=ma(),jg=Dg(Object.keys,Object);_c.exports=jg});var vc=ye((Y2,gc)=>{var zg=Jr(),Fg=mc(),Hg=Object.prototype,qg=Hg.hasOwnProperty;function Ug(i){if(!zg(i))return Fg(i);var t=[];for(var e in Object(i))qg.call(i,e)&&e!="constructor"&&t.push(e);return t}gc.exports=Ug});var ga=ye((G2,bc)=>{var Wg=oa(),Vg=pa();function Yg(i){return i!=null&&Vg(i.length)&&!Wg(i)}bc.exports=Yg});var Zr=ye((X2,yc)=>{var Gg=_a(),Xg=vc(),Kg=ga();function Jg(i){return Kg(i)?Gg(i):Xg(i)}yc.exports=Jg});var kc=ye((K2,wc)=>{var Zg=mr(),Qg=Zr();function ev(i,t){return i&&Zg(t,Qg(t),i)}wc.exports=ev});var Cc=ye((J2,xc)=>{function tv(i){var t=[];if(i!=null)for(var e in Object(i))t.push(e);return t}xc.exports=tv});var Tc=ye((Z2,Sc)=>{var iv=Ni(),rv=Jr(),nv=Cc(),av=Object.prototype,sv=av.hasOwnProperty;function ov(i){if(!iv(i))return nv(i);var t=rv(i),e=[];for(var r in i)r=="constructor"&&(t||!sv.call(i,r))||e.push(r);return e}Sc.exports=ov});var Qr=ye((Q2,Ec)=>{var lv=_a(),cv=Tc(),uv=ga();function dv(i){return uv(i)?lv(i,!0):cv(i)}Ec.exports=dv});var $c=ye((eT,Ac)=>{var fv=mr(),pv=Qr();function hv(i,t){return i&&fv(t,pv(t),i)}Ac.exports=hv});var Ic=ye((yr,qi)=>{var _v=li(),Bc=typeof yr=="object"&&yr&&!yr.nodeType&&yr,Oc=Bc&&typeof qi=="object"&&qi&&!qi.nodeType&&qi,mv=Oc&&Oc.exports===Bc,Rc=mv?_v.Buffer:void 0,Lc=Rc?Rc.allocUnsafe:void 0;function gv(i,t){if(t)return i.slice();var e=i.length,r=Lc?Lc(e):new i.constructor(e);return i.copy(r),r}qi.exports=gv});var Nc=ye((tT,Mc)=>{function vv(i,t){var e=-1,r=i.length;for(t||(t=Array(r));++e<r;)t[e]=i[e];return t}Mc.exports=vv});var Dc=ye((iT,Pc)=>{function bv(i,t){for(var e=-1,r=i==null?0:i.length,n=0,a=[];++e<r;){var s=i[e];t(s,e,i)&&(a[n++]=s)}return a}Pc.exports=bv});var va=ye((rT,jc)=>{function yv(){return[]}jc.exports=yv});var en=ye((nT,Fc)=>{var wv=Dc(),kv=va(),xv=Object.prototype,Cv=xv.propertyIsEnumerable,zc=Object.getOwnPropertySymbols,Sv=zc?function(i){return i==null?[]:(i=Object(i),wv(zc(i),function(t){return Cv.call(i,t)}))}:kv;Fc.exports=Sv});var qc=ye((aT,Hc)=>{var Tv=mr(),Ev=en();function Av(i,t){return Tv(i,Ev(i),t)}Hc.exports=Av});var ba=ye((sT,Uc)=>{function $v(i,t){for(var e=-1,r=t.length,n=i.length;++e<r;)i[n+e]=t[e];return i}Uc.exports=$v});var ya=ye((oT,Wc)=>{var Ov=ma(),Rv=Ov(Object.getPrototypeOf,Object);Wc.exports=Rv});var wa=ye((lT,Vc)=>{var Lv=ba(),Bv=ya(),Iv=en(),Mv=va(),Nv=Object.getOwnPropertySymbols,Pv=Nv?function(i){for(var t=[];i;)Lv(t,Iv(i)),i=Bv(i);return t}:Mv;Vc.exports=Pv});var Gc=ye((cT,Yc)=>{var Dv=mr(),jv=wa();function zv(i,t){return Dv(i,jv(i),t)}Yc.exports=zv});var ka=ye((uT,Xc)=>{var Fv=ba(),Hv=Gr();function qv(i,t,e){var r=t(i);return Hv(i)?r:Fv(r,e(i))}Xc.exports=qv});var Jc=ye((dT,Kc)=>{var Uv=ka(),Wv=en(),Vv=Zr();function Yv(i){return Uv(i,Vv,Wv)}Kc.exports=Yv});var Qc=ye((fT,Zc)=>{var Gv=ka(),Xv=wa(),Kv=Qr();function Jv(i){return Gv(i,Kv,Xv)}Zc.exports=Jv});var tu=ye((pT,eu)=>{var Zv=yi(),Qv=li(),eb=Zv(Qv,"DataView");eu.exports=eb});var ru=ye((hT,iu)=>{var tb=yi(),ib=li(),rb=tb(ib,"Promise");iu.exports=rb});var au=ye((_T,nu)=>{var nb=yi(),ab=li(),sb=nb(ab,"Set");nu.exports=sb});var ou=ye((mT,su)=>{var ob=yi(),lb=li(),cb=ob(lb,"WeakMap");su.exports=cb});var tn=ye((gT,hu)=>{var xa=tu(),Ca=Yr(),Sa=ru(),Ta=au(),Ea=ou(),pu=pr(),Ui=ca(),lu="[object Map]",ub="[object Object]",cu="[object Promise]",uu="[object Set]",du="[object WeakMap]",fu="[object DataView]",db=Ui(xa),fb=Ui(Ca),pb=Ui(Sa),hb=Ui(Ta),_b=Ui(Ea),$i=pu;(xa&&$i(new xa(new ArrayBuffer(1)))!=fu||Ca&&$i(new Ca)!=lu||Sa&&$i(Sa.resolve())!=cu||Ta&&$i(new Ta)!=uu||Ea&&$i(new Ea)!=du)&&($i=function(i){var t=pu(i),e=t==ub?i.constructor:void 0,r=e?Ui(e):"";if(r)switch(r){case db:return fu;case fb:return lu;case pb:return cu;case hb:return uu;case _b:return du}return t});hu.exports=$i});var mu=ye((vT,_u)=>{var mb=Object.prototype,gb=mb.hasOwnProperty;function vb(i){var t=i.length,e=new i.constructor(t);return t&&typeof i[0]=="string"&&gb.call(i,"index")&&(e.index=i.index,e.input=i.input),e}_u.exports=vb});var vu=ye((bT,gu)=>{var bb=li(),yb=bb.Uint8Array;gu.exports=yb});var rn=ye((yT,yu)=>{var bu=vu();function wb(i){var t=new i.constructor(i.byteLength);return new bu(t).set(new bu(i)),t}yu.exports=wb});var ku=ye((wT,wu)=>{var kb=rn();function xb(i,t){var e=t?kb(i.buffer):i.buffer;return new i.constructor(e,i.byteOffset,i.byteLength)}wu.exports=xb});var Cu=ye((kT,xu)=>{var Cb=/\w*$/;function Sb(i){var t=new i.constructor(i.source,Cb.exec(i));return t.lastIndex=i.lastIndex,t}xu.exports=Sb});var $u=ye((xT,Au)=>{var Su=Vr(),Tu=Su?Su.prototype:void 0,Eu=Tu?Tu.valueOf:void 0;function Tb(i){return Eu?Object(Eu.call(i)):{}}Au.exports=Tb});var Ru=ye((CT,Ou)=>{var Eb=rn();function Ab(i,t){var e=t?Eb(i.buffer):i.buffer;return new i.constructor(e,i.byteOffset,i.length)}Ou.exports=Ab});var Bu=ye((ST,Lu)=>{var $b=rn(),Ob=ku(),Rb=Cu(),Lb=$u(),Bb=Ru(),Ib="[object Boolean]",Mb="[object Date]",Nb="[object Map]",Pb="[object Number]",Db="[object RegExp]",jb="[object Set]",zb="[object String]",Fb="[object Symbol]",Hb="[object ArrayBuffer]",qb="[object DataView]",Ub="[object Float32Array]",Wb="[object Float64Array]",Vb="[object Int8Array]",Yb="[object Int16Array]",Gb="[object Int32Array]",Xb="[object Uint8Array]",Kb="[object Uint8ClampedArray]",Jb="[object Uint16Array]",Zb="[object Uint32Array]";function Qb(i,t,e){var r=i.constructor;switch(t){case Hb:return $b(i);case Ib:case Mb:return new r(+i);case qb:return Ob(i,e);case Ub:case Wb:case Vb:case Yb:case Gb:case Xb:case Kb:case Jb:case Zb:return Bb(i,e);case Nb:return new r;case Pb:case zb:return new r(i);case Db:return Rb(i);case jb:return new r;case Fb:return Lb(i)}}Lu.exports=Qb});var Nu=ye((TT,Mu)=>{var ey=Ni(),Iu=Object.create,ty=function(){function i(){}return function(t){if(!ey(t))return{};if(Iu)return Iu(t);i.prototype=t;var e=new i;return i.prototype=void 0,e}}();Mu.exports=ty});var Du=ye((ET,Pu)=>{var iy=Nu(),ry=ya(),ny=Jr();function ay(i){return typeof i.constructor=="function"&&!ny(i)?iy(ry(i)):{}}Pu.exports=ay});var zu=ye((AT,ju)=>{var sy=tn(),oy=zi(),ly="[object Map]";function cy(i){return oy(i)&&sy(i)==ly}ju.exports=cy});var Uu=ye(($T,qu)=>{var uy=zu(),dy=Xr(),Fu=Kr(),Hu=Fu&&Fu.isMap,fy=Hu?dy(Hu):uy;qu.exports=fy});var Vu=ye((OT,Wu)=>{var py=tn(),hy=zi(),_y="[object Set]";function my(i){return hy(i)&&py(i)==_y}Wu.exports=my});var Ku=ye((RT,Xu)=>{var gy=Vu(),vy=Xr(),Yu=Kr(),Gu=Yu&&Yu.isSet,by=Gu?vy(Gu):gy;Xu.exports=by});var td=ye((LT,ed)=>{var yy=Rl(),wy=Bl(),ky=da(),xy=kc(),Cy=$c(),Sy=Ic(),Ty=Nc(),Ey=qc(),Ay=Gc(),$y=Jc(),Oy=Qc(),Ry=tn(),Ly=mu(),By=Bu(),Iy=Du(),My=Gr(),Ny=fa(),Py=Uu(),Dy=Ni(),jy=Ku(),zy=Zr(),Fy=Qr(),Hy=1,qy=2,Uy=4,Ju="[object Arguments]",Wy="[object Array]",Vy="[object Boolean]",Yy="[object Date]",Gy="[object Error]",Zu="[object Function]",Xy="[object GeneratorFunction]",Ky="[object Map]",Jy="[object Number]",Qu="[object Object]",Zy="[object RegExp]",Qy="[object Set]",ew="[object String]",tw="[object Symbol]",iw="[object WeakMap]",rw="[object ArrayBuffer]",nw="[object DataView]",aw="[object Float32Array]",sw="[object Float64Array]",ow="[object Int8Array]",lw="[object Int16Array]",cw="[object Int32Array]",uw="[object Uint8Array]",dw="[object Uint8ClampedArray]",fw="[object Uint16Array]",pw="[object Uint32Array]",_t={};_t[Ju]=_t[Wy]=_t[rw]=_t[nw]=_t[Vy]=_t[Yy]=_t[aw]=_t[sw]=_t[ow]=_t[lw]=_t[cw]=_t[Ky]=_t[Jy]=_t[Qu]=_t[Zy]=_t[Qy]=_t[ew]=_t[tw]=_t[uw]=_t[dw]=_t[fw]=_t[pw]=!0;_t[Gy]=_t[Zu]=_t[iw]=!1;function nn(i,t,e,r,n,a){var s,o=t&Hy,l=t&qy,u=t&Uy;if(e&&(s=n?e(i,r,n,a):e(i)),s!==void 0)return s;if(!Dy(i))return i;var c=My(i);if(c){if(s=Ly(i),!o)return Ty(i,s)}else{var h=Ry(i),p=h==Zu||h==Xy;if(Ny(i))return Sy(i,o);if(h==Qu||h==Ju||p&&!n){if(s=l||p?{}:Iy(i),!o)return l?Ay(i,Cy(s,i)):Ey(i,xy(s,i))}else{if(!_t[h])return n?i:{};s=By(i,h,o)}}a||(a=new yy);var g=a.get(i);if(g)return g;a.set(i,s),jy(i)?i.forEach(function(k){s.add(nn(k,t,e,k,i,a))}):Py(i)&&i.forEach(function(k,C){s.set(C,nn(k,t,e,C,i,a))});var b=u?l?Oy:$y:l?Fy:zy,v=c?void 0:b(i);return wy(v||i,function(k,C){v&&(C=k,k=i[C]),ky(s,C,nn(k,t,e,C,i,a))}),s}ed.exports=nn});var rd=ye((BT,id)=>{var hw=td(),_w=1,mw=4;function gw(i,t){return t=typeof t=="function"?t:void 0,hw(i,_w|mw,t)}id.exports=gw});var sd=ye((exports,module)=>{frappe.provide("frappe.model");$.extend(frappe.model,{no_value_type:["Section Break","Column Break","Tab Break","HTML","Table","Table MultiSelect","Button","Image","Fold","Heading"],layout_fields:["Section Break","Column Break","Tab Break","Fold"],std_fields_list:["name","owner","creation","modified","modified_by","_user_tags","_comments","_assign","_liked_by","docstatus","idx"],child_table_field_list:["parent","parenttype","parentfield"],core_doctypes_list:["DocType","DocField","DocPerm","User","Role","Has Role","Page","Module Def","Print Format","Report","Customize Form","Customize Form Field","Property Setter","Custom Field","Client Script"],std_fields:[{fieldname:"name",fieldtype:"Link",label:__("ID")},{fieldname:"owner",fieldtype:"Link",label:__("Created By"),options:"User"},{fieldname:"idx",fieldtype:"Int",label:__("Index")},{fieldname:"creation",fieldtype:"Date",label:__("Created On")},{fieldname:"modified",fieldtype:"Date",label:__("Last Updated On")},{fieldname:"modified_by",fieldtype:"Data",label:__("Last Updated By")},{fieldname:"_user_tags",fieldtype:"Data",label:__("Tags")},{fieldname:"_liked_by",fieldtype:"Data",label:__("Liked By")},{fieldname:"_comments",fieldtype:"Text",label:__("Comments")},{fieldname:"_assign",fieldtype:"Text",label:__("Assigned To")},{fieldname:"docstatus",fieldtype:"Int",label:__("Document Status")}],numeric_fieldtypes:["Int","Float","Currency","Percent","Duration"],std_fields_table:[{fieldname:"parent",fieldtype:"Data",label:__("Parent")}],table_fields:["Table","Table MultiSelect"],new_names:{},events:{},user_settings:{},init:function(){frappe.realtime.on("doc_update",function(i){var t=locals[i.doctype]&&locals[i.doctype][i.name];t&&(frappe.get_route()[0]==="Form"&&cur_frm.doc.doctype===t.doctype&&cur_frm.doc.name===t.name?!frappe.ui.form.is_saving&&i.modified!=cur_frm.doc.modified&&(t.__needs_refresh=!0,cur_frm.show_conflict_message()):t.__unsaved?t.__needs_refresh=!0:frappe.model.remove_from_locals(t.doctype,t.name))})},is_value_type:function(i){return typeof i=="object"&&(i=i.fieldtype),frappe.model.no_value_type.indexOf(i)===-1},is_non_std_field:function(i){return![...frappe.model.std_fields_list,...frappe.model.child_table_field_list].includes(i)},get_std_field:function(i,t=!1){var e=$.map([].concat(frappe.model.std_fields).concat(frappe.model.std_fields_table),function(r){if(r.fieldname==i)return r});if(!e.length){if(t)return{fieldname:i};frappe.msgprint(__("Unknown Column: {0}",[i]))}return e[0]},get_from_localstorage:function(i){if(localStorage["_doctype:"+i])return JSON.parse(localStorage["_doctype:"+i])},set_in_localstorage:function(i,t){try{localStorage["_doctype:"+i]=JSON.stringify(t)}catch(e){console.warn("localStorage quota exceeded, clearing doctype cache"),frappe.model.clear_local_storage(),localStorage["_doctype:"+i]=JSON.stringify(t)}},clear_local_storage:function(){for(var i in localStorage)i.startsWith("_doctype:")&&localStorage.removeItem(i)},with_doctype:function(i,t,e){if(locals.DocType[i])return t&&t(),Promise.resolve();{let r=null,n=null,a=frappe.model.get_from_localstorage(i);return a&&(n=a.filter(s=>s.name===i)[0],n&&(r=n.modified)),frappe.call({method:"frappe.desk.form.load.getdoctype",type:"GET",args:{doctype:i,with_parent:1,cached_timestamp:r},async:e,callback:function(s){if(s.exc)throw frappe.msgprint(__("Unable to load: {0}",[__(i)])),"No doctype";s.message=="use_cache"?frappe.model.sync(n):frappe.model.set_in_localstorage(i,s.docs),frappe.model.init_doctype(i),s.user_settings&&(frappe.model.user_settings[i]=JSON.parse(s.user_settings),frappe.model.user_settings[i].updated_on=moment().toString()),t&&t(s)}})}},init_doctype:function(doctype){var meta=locals.DocType[doctype];meta.__list_js&&eval(meta.__list_js),meta.__custom_list_js&&eval(meta.__custom_list_js),meta.__calendar_js&&eval(meta.__calendar_js),meta.__map_js&&eval(meta.__map_js),meta.__tree_js&&eval(meta.__tree_js),meta.__templates&&$.extend(frappe.templates,meta.__templates)},with_doc:function(i,t,e){return new Promise(r=>{if(t||(t=i),locals[i]&&locals[i][t]&&frappe.model.get_docinfo(i,t))e&&e(t),r(frappe.get_doc(i,t));else return frappe.call({method:"frappe.desk.form.load.getdoc",type:"GET",args:{doctype:i,name:t},callback:function(n){e&&e(t,n),r(frappe.get_doc(i,t))}})})},get_docinfo:function(i,t){return frappe.model.docinfo[i]&&frappe.model.docinfo[i][t]||null},set_docinfo:function(i,t,e,r){frappe.model.docinfo[i]&&frappe.model.docinfo[i][t]&&(frappe.model.docinfo[i][t][e]=r)},get_shared:function(i,t){return frappe.model.get_docinfo(i,t).shared},get_server_module_name:function(i){var t=frappe.model.scrub(i),e=frappe.model.scrub(locals.DocType[i].module),r=frappe.boot.module_app[e];return r+"."+e+".doctype."+t+"."+t},scrub:function(i){return i.replace(/ /g,"_").toLowerCase()},unscrub:function(i){return __(i||"").replace(/-|_/g," ").replace(/\w*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})},can_create:function(i){return frappe.boot.user.can_create.indexOf(i)!==-1},can_select:function(i){if(frappe.boot.user)return frappe.boot.user.can_select.indexOf(i)!==-1},can_read:function(i){if(frappe.boot.user)return frappe.boot.user.can_read.indexOf(i)!==-1},can_write:function(i){return frappe.boot.user.can_write.indexOf(i)!==-1},can_get_report:function(i){return frappe.boot.user.can_get_report.indexOf(i)!==-1},can_delete:function(i){return i?frappe.boot.user.can_delete.indexOf(i)!==-1:!1},can_cancel:function(i){return i?frappe.boot.user.can_cancel.indexOf(i)!==-1:!1},has_workflow:function(i){return frappe.get_list("Workflow",{document_type:i,is_active:1}).length},is_submittable:function(i){return i?locals.DocType[i]&&locals.DocType[i].is_submittable:!1},is_table:function(i){return i?locals.DocType[i]&&locals.DocType[i].istable:!1},is_single:function(i){return i?frappe.boot.single_types.indexOf(i)!=-1:!1},is_tree:function(i){return i?locals.DocType[i]&&locals.DocType[i].is_tree:!1},is_fresh(i){return i&&i.__last_sync_on&&new Date-i.__last_sync_on<5e3},can_import:function(i,t,e=null){return e&&!e.allow_import?!1:frappe.user_roles.includes("System Manager")?!0:t?t.perm[0].import===1:frappe.boot.user.can_import.indexOf(i)!==-1},can_export:function(i,t){return frappe.user_roles.includes("System Manager")?!0:t?t.perm[0].export===1:frappe.boot.user.can_export.indexOf(i)!==-1},can_print:function(i,t){return t?t.perm[0].print===1:frappe.boot.user.can_print.indexOf(i)!==-1},can_email:function(i,t){return t?t.perm[0].email===1:frappe.boot.user.can_email.indexOf(i)!==-1},can_share:function(i,t){return t?t.perm[0].share===1:frappe.boot.user.can_share.indexOf(i)!==-1},can_set_user_permissions:function(i,t){return frappe.user_roles.includes("System Manager")?!0:t?t.perm[0].set_user_permissions===1:frappe.boot.user.can_set_user_permissions.indexOf(i)!==-1},has_value:function(i,t,e){var r=locals[i]&&locals[i][t]&&locals[i][t][e],n=frappe.meta.get_docfield(i,e,t);if(frappe.model.table_fields.includes(n.fieldtype)){var a=!1;$.each(locals[n.options]||{},function(s,o){if(o.parent==t&&o.parenttype==i&&o.parentfield==n.fieldname)return a=!0,!1})}else var a=!is_null(r);return!!a},get_list:function(i,t){var e=locals[i]||locals[":"+i]||{};return $.isEmptyObject(e)?[]:frappe.utils.filter_dict(e,t)},get_value:function(i,t,e,r){if(r)frappe.call({method:"frappe.client.get_value",args:{doctype:i,fieldname:e,filters:t},callback:function(a){a.exc||r(a.message)}});else{if(["number","string"].includes(typeof t)&&locals[i]&&locals[i][t])return locals[i][t][e];var n=frappe.get_list(i,t);return n.length&&n[0]?n[0][e]:null}},set_value:function(i,t,e,r,n,a=!1){var s;$.isPlainObject(i)?(s=i,e=t,r=e):s=locals[i]&&locals[i][t];let o=e,l=[];return $.isPlainObject(o)||(o={},o[e]=r),$.each(o,(u,c)=>{s&&s[u]!==c?(s.__unedited&&!(!s[u]&&!c)&&(s.__unedited=!1),s[u]=c,l.push(()=>frappe.model.trigger(u,c,s,a))):in_list(["Link","Dynamic Link"],n)&&s&&l.push(()=>frappe.model.trigger(u,c,s,a))}),frappe.run_serially(l)},on:function(i,t,e){frappe.provide("frappe.model.events."+i),frappe.model.events[i][t]||(frappe.model.events[i][t]=[]),frappe.model.events[i][t].push(e)},trigger:function(i,t,e,r=!1){let n=[];function a(s){if(!!s)for(let o of s)!o||n.push(()=>{let l=o(i,t,e,r);return l&&l.then?l:frappe.after_server_call()})}return frappe.model.events[e.doctype]&&(a(frappe.model.events[e.doctype][i]),a(frappe.model.events[e.doctype]["*"])),frappe.run_serially(n)},get_doc:function(i,t){if(t||(t=i),$.isPlainObject(t)){var e=frappe.get_list(i,t);return e&&e.length?e[0]:null}return locals[i]?locals[i][t]:null},get_children:function(i,t,e,r){if($.isPlainObject(i))var n=i,r=e,e=t;else var n=frappe.get_doc(i,t);var a=n[e]||[];return r?frappe.utils.filter_dict(a,r):a},clear_table:function(i,t){for(var e=0,r=(i[t]||[]).length;e<r;e++){var n=i[t][e];delete locals[n.doctype][n.name]}i[t]=[]},remove_from_locals:function(i,t){this.clear_doc(i,t),frappe.views.formview[i]&&delete frappe.views.formview[i].frm.opendocs[t]},clear_doc:function(i,t){var e=locals[i]&&locals[i][t];if(!!e){var r=null;if(e.parenttype)var r=e.parent,n=e.parenttype,a=e.parentfield;if(delete locals[i][t],r){var s=locals[n][r],o=[],l=1;$.each(s[a],function(u,c){c.name!=t&&(o.push(c),c.idx=l,l++),s[a]=o})}}},get_no_copy_list:function(i){for(var t=["name","amended_from","amendment_date","cancel_reason"],e=frappe.get_doc("DocType",i).fields||[],r=0,n=e.length;r<n;r++){var a=e[r];cint(a.no_copy)&&t.push(a.fieldname)}return t},delete_doc:function(i,t,e){let r=t,n=frappe.get_meta(i).title_field;if(frappe.get_meta(i).autoname=="hash"&&n){let a=frappe.model.get_value(i,t,n);a&&(r=`${a} (${t})`)}frappe.confirm(__("Permanently delete {0}?",[r.bold()]),function(){return frappe.call({method:"frappe.client.delete",args:{doctype:i,name:t},freeze:!0,freeze_message:__("Deleting {0}...",[r]),callback:function(a,s){a.exc||(frappe.utils.play_sound("delete"),frappe.model.clear_doc(i,t),e&&e(a,s))}})})},rename_doc:function(i,t,e){let r=__("Merge with existing"),n=__("This cannot be undone"),a=r+" <b>("+n+")</b>";var s=new frappe.ui.Dialog({title:__("Rename {0}",[__(t)]),fields:[{label:__("New Name"),fieldname:"new_name",fieldtype:"Data",reqd:1,default:t},{label:a,fieldtype:"Check",fieldname:"merge"}]});s.set_primary_action(__("Rename"),function(){s.hide();var o=s.get_values();if(!!o)return frappe.call({method:"frappe.rename_doc",freeze:!0,freeze_message:"Updating related fields...",args:{doctype:i,old:t,new:o.new_name,merge:o.merge},btn:s.get_primary_btn(),callback:function(l,u){l.exc||($(document).trigger("rename",[i,t,l.message||o.new_name]),locals[i]&&locals[i][t]&&delete locals[i][t],s.hide(),e&&e(l.message))}})}),s.show()},round_floats_in:function(i,t){t||(t=frappe.meta.get_fieldnames(i.doctype,i.parent,{fieldtype:["in",["Currency","Float"]]}));for(var e=0,r=t.length;e<r;e++){var n=t[e];i[n]=flt(i[n],precision(n,i))}},validate_missing:function(i,t){i[t]||frappe.throw(__("Please specify")+": "+__(frappe.meta.get_label(i.doctype,t,i.parent||i.name)))},get_all_docs:function(i){var t=[i];for(var e in i)if($.isArray(i[e]))for(var r=i[e],n=0,a=r.length;n<a;n++)t.push(r[n]);return t},get_full_column_name:function(i,t){return i.includes("`tab")?i:"`tab"+t+"`.`"+i+"`"},is_numeric_field:function(i){if(!!i)return typeof i=="object"&&(i=i.fieldtype),frappe.model.numeric_fieldtypes.includes(i)},set_default_views_for_doctype(i,t){frappe.model.with_doctype(i,()=>{let e=frappe.get_meta(i),r=["List","Report","Dashboard","Kanban"];if(e.is_calendar_and_gantt&&frappe.views.calendar[i]){let n=["Calendar","Gantt"];r.push(...n)}e.is_tree&&r.push("Tree"),t.doc.image_field&&r.push("Image"),i==="Communication"&&frappe.boot.email_accounts.length&&r.push("Inbox"),(t.doc.fields.find(n=>n.fieldname==="latitude")&&t.doc.fields.find(n=>n.fieldname==="longitude")||t.doc.fields.find(n=>n.fieldname==="location"&&n.fieldtype=="Geolocation"))&&r.push("Map"),t.set_df_property("default_view","options",r)})}});frappe.get_doc=frappe.model.get_doc;frappe.get_children=frappe.model.get_children;frappe.get_list=frappe.model.get_list;var getchildren=function(i,t,e){var r=[];return $.each(locals[i]||{},function(n,a){a.parent===t&&a.parentfield===e&&r.push(a)}),r}});var ld=ye((UT,od)=>{(function(){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,r){return e<<r|e>>>32-r},rotr:function(e,r){return e<<32-r|e>>>r},endian:function(e){if(e.constructor==Number)return t.rotl(e,8)&16711935|t.rotl(e,24)&4278255360;for(var r=0;r<e.length;r++)e[r]=t.endian(e[r]);return e},randomBytes:function(e){for(var r=[];e>0;e--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(e){for(var r=[],n=0,a=0;n<e.length;n++,a+=8)r[a>>>5]|=e[n]<<24-a%32;return r},wordsToBytes:function(e){for(var r=[],n=0;n<e.length*32;n+=8)r.push(e[n>>>5]>>>24-n%32&255);return r},bytesToHex:function(e){for(var r=[],n=0;n<e.length;n++)r.push((e[n]>>>4).toString(16)),r.push((e[n]&15).toString(16));return r.join("")},hexToBytes:function(e){for(var r=[],n=0;n<e.length;n+=2)r.push(parseInt(e.substr(n,2),16));return r},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var a=e[n]<<16|e[n+1]<<8|e[n+2],s=0;s<4;s++)n*8+s*6<=e.length*8?r.push(i.charAt(a>>>6*(3-s)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],n=0,a=0;n<e.length;a=++n%4)a!=0&&r.push((i.indexOf(e.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<a*2|i.indexOf(e.charAt(n))>>>6-a*2);return r}};od.exports=t})()});var $a=ye((WT,cd)=>{var Aa={utf8:{stringToBytes:function(i){return Aa.bin.stringToBytes(unescape(encodeURIComponent(i)))},bytesToString:function(i){return decodeURIComponent(escape(Aa.bin.bytesToString(i)))}},bin:{stringToBytes:function(i){for(var t=[],e=0;e<i.length;e++)t.push(i.charCodeAt(e)&255);return t},bytesToString:function(i){for(var t=[],e=0;e<i.length;e++)t.push(String.fromCharCode(i[e]));return t.join("")}}};cd.exports=Aa});var fd=ye((VT,dd)=>{dd.exports=function(i){return i!=null&&(ud(i)||Cw(i)||!!i._isBuffer)};function ud(i){return!!i.constructor&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function Cw(i){return typeof i.readFloatLE=="function"&&typeof i.slice=="function"&&ud(i.slice(0,0))}});var hd=ye((YT,pd)=>{(function(){var i=ld(),t=$a().utf8,e=fd(),r=$a().bin,n=function(a,s){a.constructor==String?s&&s.encoding==="binary"?a=r.stringToBytes(a):a=t.stringToBytes(a):e(a)?a=Array.prototype.slice.call(a,0):!Array.isArray(a)&&a.constructor!==Uint8Array&&(a=a.toString());for(var o=i.bytesToWords(a),l=a.length*8,u=1732584193,c=-271733879,h=-1732584194,p=271733878,g=0;g<o.length;g++)o[g]=(o[g]<<8|o[g]>>>24)&16711935|(o[g]<<24|o[g]>>>8)&4278255360;o[l>>>5]|=128<<l%32,o[(l+64>>>9<<4)+14]=l;for(var b=n._ff,v=n._gg,k=n._hh,C=n._ii,g=0;g<o.length;g+=16){var O=u,d=c,_=h,m=p;u=b(u,c,h,p,o[g+0],7,-680876936),p=b(p,u,c,h,o[g+1],12,-389564586),h=b(h,p,u,c,o[g+2],17,606105819),c=b(c,h,p,u,o[g+3],22,-1044525330),u=b(u,c,h,p,o[g+4],7,-176418897),p=b(p,u,c,h,o[g+5],12,1200080426),h=b(h,p,u,c,o[g+6],17,-1473231341),c=b(c,h,p,u,o[g+7],22,-45705983),u=b(u,c,h,p,o[g+8],7,1770035416),p=b(p,u,c,h,o[g+9],12,-1958414417),h=b(h,p,u,c,o[g+10],17,-42063),c=b(c,h,p,u,o[g+11],22,-1990404162),u=b(u,c,h,p,o[g+12],7,1804603682),p=b(p,u,c,h,o[g+13],12,-40341101),h=b(h,p,u,c,o[g+14],17,-1502002290),c=b(c,h,p,u,o[g+15],22,1236535329),u=v(u,c,h,p,o[g+1],5,-165796510),p=v(p,u,c,h,o[g+6],9,-1069501632),h=v(h,p,u,c,o[g+11],14,643717713),c=v(c,h,p,u,o[g+0],20,-373897302),u=v(u,c,h,p,o[g+5],5,-701558691),p=v(p,u,c,h,o[g+10],9,38016083),h=v(h,p,u,c,o[g+15],14,-660478335),c=v(c,h,p,u,o[g+4],20,-405537848),u=v(u,c,h,p,o[g+9],5,568446438),p=v(p,u,c,h,o[g+14],9,-1019803690),h=v(h,p,u,c,o[g+3],14,-187363961),c=v(c,h,p,u,o[g+8],20,1163531501),u=v(u,c,h,p,o[g+13],5,-1444681467),p=v(p,u,c,h,o[g+2],9,-51403784),h=v(h,p,u,c,o[g+7],14,1735328473),c=v(c,h,p,u,o[g+12],20,-1926607734),u=k(u,c,h,p,o[g+5],4,-378558),p=k(p,u,c,h,o[g+8],11,-2022574463),h=k(h,p,u,c,o[g+11],16,1839030562),c=k(c,h,p,u,o[g+14],23,-35309556),u=k(u,c,h,p,o[g+1],4,-1530992060),p=k(p,u,c,h,o[g+4],11,1272893353),h=k(h,p,u,c,o[g+7],16,-155497632),c=k(c,h,p,u,o[g+10],23,-1094730640),u=k(u,c,h,p,o[g+13],4,681279174),p=k(p,u,c,h,o[g+0],11,-358537222),h=k(h,p,u,c,o[g+3],16,-722521979),c=k(c,h,p,u,o[g+6],23,76029189),u=k(u,c,h,p,o[g+9],4,-640364487),p=k(p,u,c,h,o[g+12],11,-421815835),h=k(h,p,u,c,o[g+15],16,530742520),c=k(c,h,p,u,o[g+2],23,-995338651),u=C(u,c,h,p,o[g+0],6,-198630844),p=C(p,u,c,h,o[g+7],10,1126891415),h=C(h,p,u,c,o[g+14],15,-1416354905),c=C(c,h,p,u,o[g+5],21,-57434055),u=C(u,c,h,p,o[g+12],6,1700485571),p=C(p,u,c,h,o[g+3],10,-1894986606),h=C(h,p,u,c,o[g+10],15,-1051523),c=C(c,h,p,u,o[g+1],21,-2054922799),u=C(u,c,h,p,o[g+8],6,1873313359),p=C(p,u,c,h,o[g+15],10,-30611744),h=C(h,p,u,c,o[g+6],15,-1560198380),c=C(c,h,p,u,o[g+13],21,1309151649),u=C(u,c,h,p,o[g+4],6,-145523070),p=C(p,u,c,h,o[g+11],10,-1120210379),h=C(h,p,u,c,o[g+2],15,718787259),c=C(c,h,p,u,o[g+9],21,-343485551),u=u+O>>>0,c=c+d>>>0,h=h+_>>>0,p=p+m>>>0}return i.endian([u,c,h,p])};n._ff=function(a,s,o,l,u,c,h){var p=a+(s&o|~s&l)+(u>>>0)+h;return(p<<c|p>>>32-c)+s},n._gg=function(a,s,o,l,u,c,h){var p=a+(s&l|o&~l)+(u>>>0)+h;return(p<<c|p>>>32-c)+s},n._hh=function(a,s,o,l,u,c,h){var p=a+(s^o^l)+(u>>>0)+h;return(p<<c|p>>>32-c)+s},n._ii=function(a,s,o,l,u,c,h){var p=a+(o^(s|~l))+(u>>>0)+h;return(p<<c|p>>>32-c)+s},n._blocksize=16,n._digestsize=16,pd.exports=function(a,s){if(a==null)throw new Error("Illegal argument "+a);var o=i.wordsToBytes(n(a,s));return s&&s.asBytes?o:s&&s.asString?r.bytesToString(o):i.bytesToHex(o)}})()});var md=ye((_d,an)=>{(function(){function i(d){"use strict";var _={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:`Remove only spaces, ' and " from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids`,type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,describe:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,describe:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,describe:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,describe:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,describe:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",describe:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,describe:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,describe:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,describe:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,describe:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,describe:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},ellipsis:{defaultValue:!0,describe:"Replaces three dots with the ellipsis unicode character",type:"boolean"},completeHTMLDocument:{defaultValue:!1,describe:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,describe:"Enable support for document metadata (defined at the top of the document between `\xAB\xAB\xAB` and `\xBB\xBB\xBB` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,describe:"Split adjacent blockquote blocks",type:"boolean"}};if(d===!1)return JSON.parse(JSON.stringify(_));var m={};for(var y in _)_.hasOwnProperty(y)&&(m[y]=_[y].defaultValue);return m}function t(){"use strict";var d=i(!0),_={};for(var m in d)d.hasOwnProperty(m)&&(_[m]=!0);return _}var e={},r={},n={},a=i(!0),s="vanilla",o={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:i(!0),allOn:t()};e.helper={},e.extensions={},e.setOption=function(d,_){"use strict";return a[d]=_,this},e.getOption=function(d){"use strict";return a[d]},e.getOptions=function(){"use strict";return a},e.resetOptions=function(){"use strict";a=i(!0)},e.setFlavor=function(d){"use strict";if(!o.hasOwnProperty(d))throw Error(d+" flavor was not found");e.resetOptions();var _=o[d];s=d;for(var m in _)_.hasOwnProperty(m)&&(a[m]=_[m])},e.getFlavor=function(){"use strict";return s},e.getFlavorOptions=function(d){"use strict";if(o.hasOwnProperty(d))return o[d]},e.getDefaultOptions=function(d){"use strict";return i(d)},e.subParser=function(d,_){"use strict";if(e.helper.isString(d))if(typeof _!="undefined")r[d]=_;else{if(r.hasOwnProperty(d))return r[d];throw Error("SubParser named "+d+" not registered!")}},e.extension=function(d,_){"use strict";if(!e.helper.isString(d))throw Error("Extension 'name' must be a string");if(d=e.helper.stdExtName(d),e.helper.isUndefined(_)){if(!n.hasOwnProperty(d))throw Error("Extension named "+d+" is not registered!");return n[d]}else{typeof _=="function"&&(_=_()),e.helper.isArray(_)||(_=[_]);var m=l(_,d);if(m.valid)n[d]=_;else throw Error(m.error)}},e.getAllExtensions=function(){"use strict";return n},e.removeExtension=function(d){"use strict";delete n[d]},e.resetExtensions=function(){"use strict";n={}};function l(d,_){"use strict";var m=_?"Error in "+_+" extension->":"Error in unnamed extension",y={valid:!0,error:""};e.helper.isArray(d)||(d=[d]);for(var x=0;x<d.length;++x){var S=m+" sub-extension "+x+": ",w=d[x];if(typeof w!="object")return y.valid=!1,y.error=S+"must be an object, but "+typeof w+" given",y;if(!e.helper.isString(w.type))return y.valid=!1,y.error=S+'property "type" must be a string, but '+typeof w.type+" given",y;var E=w.type=w.type.toLowerCase();if(E==="language"&&(E=w.type="lang"),E==="html"&&(E=w.type="output"),E!=="lang"&&E!=="output"&&E!=="listener")return y.valid=!1,y.error=S+"type "+E+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',y;if(E==="listener"){if(e.helper.isUndefined(w.listeners))return y.valid=!1,y.error=S+'. Extensions of type "listener" must have a property called "listeners"',y}else if(e.helper.isUndefined(w.filter)&&e.helper.isUndefined(w.regex))return y.valid=!1,y.error=S+E+' extensions must define either a "regex" property or a "filter" method',y;if(w.listeners){if(typeof w.listeners!="object")return y.valid=!1,y.error=S+'"listeners" property must be an object but '+typeof w.listeners+" given",y;for(var L in w.listeners)if(w.listeners.hasOwnProperty(L)&&typeof w.listeners[L]!="function")return y.valid=!1,y.error=S+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+L+" must be a function but "+typeof w.listeners[L]+" given",y}if(w.filter){if(typeof w.filter!="function")return y.valid=!1,y.error=S+'"filter" must be a function, but '+typeof w.filter+" given",y}else if(w.regex){if(e.helper.isString(w.regex)&&(w.regex=new RegExp(w.regex,"g")),!(w.regex instanceof RegExp))return y.valid=!1,y.error=S+'"regex" property must either be a string or a RegExp object, but '+typeof w.regex+" given",y;if(e.helper.isUndefined(w.replace))return y.valid=!1,y.error=S+'"regex" extensions must implement a replace string or function',y}}return y}e.validateExtension=function(d){"use strict";var _=l(d,null);return _.valid?!0:(console.warn(_.error),!1)},e.hasOwnProperty("helper")||(e.helper={}),e.helper.isString=function(d){"use strict";return typeof d=="string"||d instanceof String},e.helper.isFunction=function(d){"use strict";var _={};return d&&_.toString.call(d)==="[object Function]"},e.helper.isArray=function(d){"use strict";return Array.isArray(d)},e.helper.isUndefined=function(d){"use strict";return typeof d=="undefined"},e.helper.forEach=function(d,_){"use strict";if(e.helper.isUndefined(d))throw new Error("obj param is required");if(e.helper.isUndefined(_))throw new Error("callback param is required");if(!e.helper.isFunction(_))throw new Error("callback param must be a function/closure");if(typeof d.forEach=="function")d.forEach(_);else if(e.helper.isArray(d))for(var m=0;m<d.length;m++)_(d[m],m,d);else if(typeof d=="object")for(var y in d)d.hasOwnProperty(y)&&_(d[y],y,d);else throw new Error("obj does not seem to be an array or an iterable object")},e.helper.stdExtName=function(d){"use strict";return d.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()};function u(d,_){"use strict";var m=_.charCodeAt(0);return"\xA8E"+m+"E"}e.helper.escapeCharactersCallback=u,e.helper.escapeCharacters=function(d,_,m){"use strict";var y="(["+_.replace(/([\[\]\\])/g,"\\$1")+"])";m&&(y="\\\\"+y);var x=new RegExp(y,"g");return d=d.replace(x,u),d},e.helper.unescapeHTMLEntities=function(d){"use strict";return d.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var c=function(d,_,m,y){"use strict";var x=y||"",S=x.indexOf("g")>-1,w=new RegExp(_+"|"+m,"g"+x.replace(/g/g,"")),E=new RegExp(_,x.replace(/g/g,"")),L=[],I,A,B,T,M;do for(I=0;B=w.exec(d);)if(E.test(B[0]))I++||(A=w.lastIndex,T=A-B[0].length);else if(I&&!--I){M=B.index+B[0].length;var j={left:{start:T,end:A},match:{start:A,end:B.index},right:{start:B.index,end:M},wholeMatch:{start:T,end:M}};if(L.push(j),!S)return L}while(I&&(w.lastIndex=A));return L};e.helper.matchRecursiveRegExp=function(d,_,m,y){"use strict";for(var x=c(d,_,m,y),S=[],w=0;w<x.length;++w)S.push([d.slice(x[w].wholeMatch.start,x[w].wholeMatch.end),d.slice(x[w].match.start,x[w].match.end),d.slice(x[w].left.start,x[w].left.end),d.slice(x[w].right.start,x[w].right.end)]);return S},e.helper.replaceRecursiveRegExp=function(d,_,m,y,x){"use strict";if(!e.helper.isFunction(_)){var S=_;_=function(){return S}}var w=c(d,m,y,x),E=d,L=w.length;if(L>0){var I=[];w[0].wholeMatch.start!==0&&I.push(d.slice(0,w[0].wholeMatch.start));for(var A=0;A<L;++A)I.push(_(d.slice(w[A].wholeMatch.start,w[A].wholeMatch.end),d.slice(w[A].match.start,w[A].match.end),d.slice(w[A].left.start,w[A].left.end),d.slice(w[A].right.start,w[A].right.end))),A<L-1&&I.push(d.slice(w[A].wholeMatch.end,w[A+1].wholeMatch.start));w[L-1].wholeMatch.end<d.length&&I.push(d.slice(w[L-1].wholeMatch.end)),E=I.join("")}return E},e.helper.regexIndexOf=function(d,_,m){"use strict";if(!e.helper.isString(d))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(!(_ instanceof RegExp))throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var y=d.substring(m||0).search(_);return y>=0?y+(m||0):y},e.helper.splitAtIndex=function(d,_){"use strict";if(!e.helper.isString(d))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[d.substring(0,_),d.substring(_)]},e.helper.encodeEmailAddress=function(d){"use strict";var _=[function(m){return"&#"+m.charCodeAt(0)+";"},function(m){return"&#x"+m.charCodeAt(0).toString(16)+";"},function(m){return m}];return d=d.replace(/./g,function(m){if(m==="@")m=_[Math.floor(Math.random()*2)](m);else{var y=Math.random();m=y>.9?_[2](m):y>.45?_[1](m):_[0](m)}return m}),d},e.helper.padEnd=function(_,m,y){"use strict";return m=m>>0,y=String(y||" "),_.length>m?String(_):(m=m-_.length,m>y.length&&(y+=y.repeat(m/y.length)),String(_)+y.slice(0,m))},typeof console=="undefined"&&(console={warn:function(d){"use strict";alert(d)},log:function(d){"use strict";alert(d)},error:function(d){"use strict";throw d}}),e.helper.regexes={asteriskDashAndColon:/([*_:~])/g},e.helper.emojis={"+1":"\u{1F44D}","-1":"\u{1F44E}","100":"\u{1F4AF}","1234":"\u{1F522}","1st_place_medal":"\u{1F947}","2nd_place_medal":"\u{1F948}","3rd_place_medal":"\u{1F949}","8ball":"\u{1F3B1}",a:"\u{1F170}\uFE0F",ab:"\u{1F18E}",abc:"\u{1F524}",abcd:"\u{1F521}",accept:"\u{1F251}",aerial_tramway:"\u{1F6A1}",airplane:"\u2708\uFE0F",alarm_clock:"\u23F0",alembic:"\u2697\uFE0F",alien:"\u{1F47D}",ambulance:"\u{1F691}",amphora:"\u{1F3FA}",anchor:"\u2693\uFE0F",angel:"\u{1F47C}",anger:"\u{1F4A2}",angry:"\u{1F620}",anguished:"\u{1F627}",ant:"\u{1F41C}",apple:"\u{1F34E}",aquarius:"\u2652\uFE0F",aries:"\u2648\uFE0F",arrow_backward:"\u25C0\uFE0F",arrow_double_down:"\u23EC",arrow_double_up:"\u23EB",arrow_down:"\u2B07\uFE0F",arrow_down_small:"\u{1F53D}",arrow_forward:"\u25B6\uFE0F",arrow_heading_down:"\u2935\uFE0F",arrow_heading_up:"\u2934\uFE0F",arrow_left:"\u2B05\uFE0F",arrow_lower_left:"\u2199\uFE0F",arrow_lower_right:"\u2198\uFE0F",arrow_right:"\u27A1\uFE0F",arrow_right_hook:"\u21AA\uFE0F",arrow_up:"\u2B06\uFE0F",arrow_up_down:"\u2195\uFE0F",arrow_up_small:"\u{1F53C}",arrow_upper_left:"\u2196\uFE0F",arrow_upper_right:"\u2197\uFE0F",arrows_clockwise:"\u{1F503}",arrows_counterclockwise:"\u{1F504}",art:"\u{1F3A8}",articulated_lorry:"\u{1F69B}",artificial_satellite:"\u{1F6F0}",astonished:"\u{1F632}",athletic_shoe:"\u{1F45F}",atm:"\u{1F3E7}",atom_symbol:"\u269B\uFE0F",avocado:"\u{1F951}",b:"\u{1F171}\uFE0F",baby:"\u{1F476}",baby_bottle:"\u{1F37C}",baby_chick:"\u{1F424}",baby_symbol:"\u{1F6BC}",back:"\u{1F519}",bacon:"\u{1F953}",badminton:"\u{1F3F8}",baggage_claim:"\u{1F6C4}",baguette_bread:"\u{1F956}",balance_scale:"\u2696\uFE0F",balloon:"\u{1F388}",ballot_box:"\u{1F5F3}",ballot_box_with_check:"\u2611\uFE0F",bamboo:"\u{1F38D}",banana:"\u{1F34C}",bangbang:"\u203C\uFE0F",bank:"\u{1F3E6}",bar_chart:"\u{1F4CA}",barber:"\u{1F488}",baseball:"\u26BE\uFE0F",basketball:"\u{1F3C0}",basketball_man:"\u26F9\uFE0F",basketball_woman:"\u26F9\uFE0F&zwj;\u2640\uFE0F",bat:"\u{1F987}",bath:"\u{1F6C0}",bathtub:"\u{1F6C1}",battery:"\u{1F50B}",beach_umbrella:"\u{1F3D6}",bear:"\u{1F43B}",bed:"\u{1F6CF}",bee:"\u{1F41D}",beer:"\u{1F37A}",beers:"\u{1F37B}",beetle:"\u{1F41E}",beginner:"\u{1F530}",bell:"\u{1F514}",bellhop_bell:"\u{1F6CE}",bento:"\u{1F371}",biking_man:"\u{1F6B4}",bike:"\u{1F6B2}",biking_woman:"\u{1F6B4}&zwj;\u2640\uFE0F",bikini:"\u{1F459}",biohazard:"\u2623\uFE0F",bird:"\u{1F426}",birthday:"\u{1F382}",black_circle:"\u26AB\uFE0F",black_flag:"\u{1F3F4}",black_heart:"\u{1F5A4}",black_joker:"\u{1F0CF}",black_large_square:"\u2B1B\uFE0F",black_medium_small_square:"\u25FE\uFE0F",black_medium_square:"\u25FC\uFE0F",black_nib:"\u2712\uFE0F",black_small_square:"\u25AA\uFE0F",black_square_button:"\u{1F532}",blonde_man:"\u{1F471}",blonde_woman:"\u{1F471}&zwj;\u2640\uFE0F",blossom:"\u{1F33C}",blowfish:"\u{1F421}",blue_book:"\u{1F4D8}",blue_car:"\u{1F699}",blue_heart:"\u{1F499}",blush:"\u{1F60A}",boar:"\u{1F417}",boat:"\u26F5\uFE0F",bomb:"\u{1F4A3}",book:"\u{1F4D6}",bookmark:"\u{1F516}",bookmark_tabs:"\u{1F4D1}",books:"\u{1F4DA}",boom:"\u{1F4A5}",boot:"\u{1F462}",bouquet:"\u{1F490}",bowing_man:"\u{1F647}",bow_and_arrow:"\u{1F3F9}",bowing_woman:"\u{1F647}&zwj;\u2640\uFE0F",bowling:"\u{1F3B3}",boxing_glove:"\u{1F94A}",boy:"\u{1F466}",bread:"\u{1F35E}",bride_with_veil:"\u{1F470}",bridge_at_night:"\u{1F309}",briefcase:"\u{1F4BC}",broken_heart:"\u{1F494}",bug:"\u{1F41B}",building_construction:"\u{1F3D7}",bulb:"\u{1F4A1}",bullettrain_front:"\u{1F685}",bullettrain_side:"\u{1F684}",burrito:"\u{1F32F}",bus:"\u{1F68C}",business_suit_levitating:"\u{1F574}",busstop:"\u{1F68F}",bust_in_silhouette:"\u{1F464}",busts_in_silhouette:"\u{1F465}",butterfly:"\u{1F98B}",cactus:"\u{1F335}",cake:"\u{1F370}",calendar:"\u{1F4C6}",call_me_hand:"\u{1F919}",calling:"\u{1F4F2}",camel:"\u{1F42B}",camera:"\u{1F4F7}",camera_flash:"\u{1F4F8}",camping:"\u{1F3D5}",cancer:"\u264B\uFE0F",candle:"\u{1F56F}",candy:"\u{1F36C}",canoe:"\u{1F6F6}",capital_abcd:"\u{1F520}",capricorn:"\u2651\uFE0F",car:"\u{1F697}",card_file_box:"\u{1F5C3}",card_index:"\u{1F4C7}",card_index_dividers:"\u{1F5C2}",carousel_horse:"\u{1F3A0}",carrot:"\u{1F955}",cat:"\u{1F431}",cat2:"\u{1F408}",cd:"\u{1F4BF}",chains:"\u26D3",champagne:"\u{1F37E}",chart:"\u{1F4B9}",chart_with_downwards_trend:"\u{1F4C9}",chart_with_upwards_trend:"\u{1F4C8}",checkered_flag:"\u{1F3C1}",cheese:"\u{1F9C0}",cherries:"\u{1F352}",cherry_blossom:"\u{1F338}",chestnut:"\u{1F330}",chicken:"\u{1F414}",children_crossing:"\u{1F6B8}",chipmunk:"\u{1F43F}",chocolate_bar:"\u{1F36B}",christmas_tree:"\u{1F384}",church:"\u26EA\uFE0F",cinema:"\u{1F3A6}",circus_tent:"\u{1F3AA}",city_sunrise:"\u{1F307}",city_sunset:"\u{1F306}",cityscape:"\u{1F3D9}",cl:"\u{1F191}",clamp:"\u{1F5DC}",clap:"\u{1F44F}",clapper:"\u{1F3AC}",classical_building:"\u{1F3DB}",clinking_glasses:"\u{1F942}",clipboard:"\u{1F4CB}",clock1:"\u{1F550}",clock10:"\u{1F559}",clock1030:"\u{1F565}",clock11:"\u{1F55A}",clock1130:"\u{1F566}",clock12:"\u{1F55B}",clock1230:"\u{1F567}",clock130:"\u{1F55C}",clock2:"\u{1F551}",clock230:"\u{1F55D}",clock3:"\u{1F552}",clock330:"\u{1F55E}",clock4:"\u{1F553}",clock430:"\u{1F55F}",clock5:"\u{1F554}",clock530:"\u{1F560}",clock6:"\u{1F555}",clock630:"\u{1F561}",clock7:"\u{1F556}",clock730:"\u{1F562}",clock8:"\u{1F557}",clock830:"\u{1F563}",clock9:"\u{1F558}",clock930:"\u{1F564}",closed_book:"\u{1F4D5}",closed_lock_with_key:"\u{1F510}",closed_umbrella:"\u{1F302}",cloud:"\u2601\uFE0F",cloud_with_lightning:"\u{1F329}",cloud_with_lightning_and_rain:"\u26C8",cloud_with_rain:"\u{1F327}",cloud_with_snow:"\u{1F328}",clown_face:"\u{1F921}",clubs:"\u2663\uFE0F",cocktail:"\u{1F378}",coffee:"\u2615\uFE0F",coffin:"\u26B0\uFE0F",cold_sweat:"\u{1F630}",comet:"\u2604\uFE0F",computer:"\u{1F4BB}",computer_mouse:"\u{1F5B1}",confetti_ball:"\u{1F38A}",confounded:"\u{1F616}",confused:"\u{1F615}",congratulations:"\u3297\uFE0F",construction:"\u{1F6A7}",construction_worker_man:"\u{1F477}",construction_worker_woman:"\u{1F477}&zwj;\u2640\uFE0F",control_knobs:"\u{1F39B}",convenience_store:"\u{1F3EA}",cookie:"\u{1F36A}",cool:"\u{1F192}",policeman:"\u{1F46E}",copyright:"\xA9\uFE0F",corn:"\u{1F33D}",couch_and_lamp:"\u{1F6CB}",couple:"\u{1F46B}",couple_with_heart_woman_man:"\u{1F491}",couple_with_heart_man_man:"\u{1F468}&zwj;\u2764\uFE0F&zwj;\u{1F468}",couple_with_heart_woman_woman:"\u{1F469}&zwj;\u2764\uFE0F&zwj;\u{1F469}",couplekiss_man_man:"\u{1F468}&zwj;\u2764\uFE0F&zwj;\u{1F48B}&zwj;\u{1F468}",couplekiss_man_woman:"\u{1F48F}",couplekiss_woman_woman:"\u{1F469}&zwj;\u2764\uFE0F&zwj;\u{1F48B}&zwj;\u{1F469}",cow:"\u{1F42E}",cow2:"\u{1F404}",cowboy_hat_face:"\u{1F920}",crab:"\u{1F980}",crayon:"\u{1F58D}",credit_card:"\u{1F4B3}",crescent_moon:"\u{1F319}",cricket:"\u{1F3CF}",crocodile:"\u{1F40A}",croissant:"\u{1F950}",crossed_fingers:"\u{1F91E}",crossed_flags:"\u{1F38C}",crossed_swords:"\u2694\uFE0F",crown:"\u{1F451}",cry:"\u{1F622}",crying_cat_face:"\u{1F63F}",crystal_ball:"\u{1F52E}",cucumber:"\u{1F952}",cupid:"\u{1F498}",curly_loop:"\u27B0",currency_exchange:"\u{1F4B1}",curry:"\u{1F35B}",custard:"\u{1F36E}",customs:"\u{1F6C3}",cyclone:"\u{1F300}",dagger:"\u{1F5E1}",dancer:"\u{1F483}",dancing_women:"\u{1F46F}",dancing_men:"\u{1F46F}&zwj;\u2642\uFE0F",dango:"\u{1F361}",dark_sunglasses:"\u{1F576}",dart:"\u{1F3AF}",dash:"\u{1F4A8}",date:"\u{1F4C5}",deciduous_tree:"\u{1F333}",deer:"\u{1F98C}",department_store:"\u{1F3EC}",derelict_house:"\u{1F3DA}",desert:"\u{1F3DC}",desert_island:"\u{1F3DD}",desktop_computer:"\u{1F5A5}",male_detective:"\u{1F575}\uFE0F",diamond_shape_with_a_dot_inside:"\u{1F4A0}",diamonds:"\u2666\uFE0F",disappointed:"\u{1F61E}",disappointed_relieved:"\u{1F625}",dizzy:"\u{1F4AB}",dizzy_face:"\u{1F635}",do_not_litter:"\u{1F6AF}",dog:"\u{1F436}",dog2:"\u{1F415}",dollar:"\u{1F4B5}",dolls:"\u{1F38E}",dolphin:"\u{1F42C}",door:"\u{1F6AA}",doughnut:"\u{1F369}",dove:"\u{1F54A}",dragon:"\u{1F409}",dragon_face:"\u{1F432}",dress:"\u{1F457}",dromedary_camel:"\u{1F42A}",drooling_face:"\u{1F924}",droplet:"\u{1F4A7}",drum:"\u{1F941}",duck:"\u{1F986}",dvd:"\u{1F4C0}","e-mail":"\u{1F4E7}",eagle:"\u{1F985}",ear:"\u{1F442}",ear_of_rice:"\u{1F33E}",earth_africa:"\u{1F30D}",earth_americas:"\u{1F30E}",earth_asia:"\u{1F30F}",egg:"\u{1F95A}",eggplant:"\u{1F346}",eight_pointed_black_star:"\u2734\uFE0F",eight_spoked_asterisk:"\u2733\uFE0F",electric_plug:"\u{1F50C}",elephant:"\u{1F418}",email:"\u2709\uFE0F",end:"\u{1F51A}",envelope_with_arrow:"\u{1F4E9}",euro:"\u{1F4B6}",european_castle:"\u{1F3F0}",european_post_office:"\u{1F3E4}",evergreen_tree:"\u{1F332}",exclamation:"\u2757\uFE0F",expressionless:"\u{1F611}",eye:"\u{1F441}",eye_speech_bubble:"\u{1F441}&zwj;\u{1F5E8}",eyeglasses:"\u{1F453}",eyes:"\u{1F440}",face_with_head_bandage:"\u{1F915}",face_with_thermometer:"\u{1F912}",fist_oncoming:"\u{1F44A}",factory:"\u{1F3ED}",fallen_leaf:"\u{1F342}",family_man_woman_boy:"\u{1F46A}",family_man_boy:"\u{1F468}&zwj;\u{1F466}",family_man_boy_boy:"\u{1F468}&zwj;\u{1F466}&zwj;\u{1F466}",family_man_girl:"\u{1F468}&zwj;\u{1F467}",family_man_girl_boy:"\u{1F468}&zwj;\u{1F467}&zwj;\u{1F466}",family_man_girl_girl:"\u{1F468}&zwj;\u{1F467}&zwj;\u{1F467}",family_man_man_boy:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F466}",family_man_man_boy_boy:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F466}&zwj;\u{1F466}",family_man_man_girl:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F467}",family_man_man_girl_boy:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F467}&zwj;\u{1F466}",family_man_man_girl_girl:"\u{1F468}&zwj;\u{1F468}&zwj;\u{1F467}&zwj;\u{1F467}",family_man_woman_boy_boy:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F466}&zwj;\u{1F466}",family_man_woman_girl:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F467}",family_man_woman_girl_boy:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F466}",family_man_woman_girl_girl:"\u{1F468}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F467}",family_woman_boy:"\u{1F469}&zwj;\u{1F466}",family_woman_boy_boy:"\u{1F469}&zwj;\u{1F466}&zwj;\u{1F466}",family_woman_girl:"\u{1F469}&zwj;\u{1F467}",family_woman_girl_boy:"\u{1F469}&zwj;\u{1F467}&zwj;\u{1F466}",family_woman_girl_girl:"\u{1F469}&zwj;\u{1F467}&zwj;\u{1F467}",family_woman_woman_boy:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F466}",family_woman_woman_boy_boy:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F466}&zwj;\u{1F466}",family_woman_woman_girl:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F467}",family_woman_woman_girl_boy:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F466}",family_woman_woman_girl_girl:"\u{1F469}&zwj;\u{1F469}&zwj;\u{1F467}&zwj;\u{1F467}",fast_forward:"\u23E9",fax:"\u{1F4E0}",fearful:"\u{1F628}",feet:"\u{1F43E}",female_detective:"\u{1F575}\uFE0F&zwj;\u2640\uFE0F",ferris_wheel:"\u{1F3A1}",ferry:"\u26F4",field_hockey:"\u{1F3D1}",file_cabinet:"\u{1F5C4}",file_folder:"\u{1F4C1}",film_projector:"\u{1F4FD}",film_strip:"\u{1F39E}",fire:"\u{1F525}",fire_engine:"\u{1F692}",fireworks:"\u{1F386}",first_quarter_moon:"\u{1F313}",first_quarter_moon_with_face:"\u{1F31B}",fish:"\u{1F41F}",fish_cake:"\u{1F365}",fishing_pole_and_fish:"\u{1F3A3}",fist_raised:"\u270A",fist_left:"\u{1F91B}",fist_right:"\u{1F91C}",flags:"\u{1F38F}",flashlight:"\u{1F526}",fleur_de_lis:"\u269C\uFE0F",flight_arrival:"\u{1F6EC}",flight_departure:"\u{1F6EB}",floppy_disk:"\u{1F4BE}",flower_playing_cards:"\u{1F3B4}",flushed:"\u{1F633}",fog:"\u{1F32B}",foggy:"\u{1F301}",football:"\u{1F3C8}",footprints:"\u{1F463}",fork_and_knife:"\u{1F374}",fountain:"\u26F2\uFE0F",fountain_pen:"\u{1F58B}",four_leaf_clover:"\u{1F340}",fox_face:"\u{1F98A}",framed_picture:"\u{1F5BC}",free:"\u{1F193}",fried_egg:"\u{1F373}",fried_shrimp:"\u{1F364}",fries:"\u{1F35F}",frog:"\u{1F438}",frowning:"\u{1F626}",frowning_face:"\u2639\uFE0F",frowning_man:"\u{1F64D}&zwj;\u2642\uFE0F",frowning_woman:"\u{1F64D}",middle_finger:"\u{1F595}",fuelpump:"\u26FD\uFE0F",full_moon:"\u{1F315}",full_moon_with_face:"\u{1F31D}",funeral_urn:"\u26B1\uFE0F",game_die:"\u{1F3B2}",gear:"\u2699\uFE0F",gem:"\u{1F48E}",gemini:"\u264A\uFE0F",ghost:"\u{1F47B}",gift:"\u{1F381}",gift_heart:"\u{1F49D}",girl:"\u{1F467}",globe_with_meridians:"\u{1F310}",goal_net:"\u{1F945}",goat:"\u{1F410}",golf:"\u26F3\uFE0F",golfing_man:"\u{1F3CC}\uFE0F",golfing_woman:"\u{1F3CC}\uFE0F&zwj;\u2640\uFE0F",gorilla:"\u{1F98D}",grapes:"\u{1F347}",green_apple:"\u{1F34F}",green_book:"\u{1F4D7}",green_heart:"\u{1F49A}",green_salad:"\u{1F957}",grey_exclamation:"\u2755",grey_question:"\u2754",grimacing:"\u{1F62C}",grin:"\u{1F601}",grinning:"\u{1F600}",guardsman:"\u{1F482}",guardswoman:"\u{1F482}&zwj;\u2640\uFE0F",guitar:"\u{1F3B8}",gun:"\u{1F52B}",haircut_woman:"\u{1F487}",haircut_man:"\u{1F487}&zwj;\u2642\uFE0F",hamburger:"\u{1F354}",hammer:"\u{1F528}",hammer_and_pick:"\u2692",hammer_and_wrench:"\u{1F6E0}",hamster:"\u{1F439}",hand:"\u270B",handbag:"\u{1F45C}",handshake:"\u{1F91D}",hankey:"\u{1F4A9}",hatched_chick:"\u{1F425}",hatching_chick:"\u{1F423}",headphones:"\u{1F3A7}",hear_no_evil:"\u{1F649}",heart:"\u2764\uFE0F",heart_decoration:"\u{1F49F}",heart_eyes:"\u{1F60D}",heart_eyes_cat:"\u{1F63B}",heartbeat:"\u{1F493}",heartpulse:"\u{1F497}",hearts:"\u2665\uFE0F",heavy_check_mark:"\u2714\uFE0F",heavy_division_sign:"\u2797",heavy_dollar_sign:"\u{1F4B2}",heavy_heart_exclamation:"\u2763\uFE0F",heavy_minus_sign:"\u2796",heavy_multiplication_x:"\u2716\uFE0F",heavy_plus_sign:"\u2795",helicopter:"\u{1F681}",herb:"\u{1F33F}",hibiscus:"\u{1F33A}",high_brightness:"\u{1F506}",high_heel:"\u{1F460}",hocho:"\u{1F52A}",hole:"\u{1F573}",honey_pot:"\u{1F36F}",horse:"\u{1F434}",horse_racing:"\u{1F3C7}",hospital:"\u{1F3E5}",hot_pepper:"\u{1F336}",hotdog:"\u{1F32D}",hotel:"\u{1F3E8}",hotsprings:"\u2668\uFE0F",hourglass:"\u231B\uFE0F",hourglass_flowing_sand:"\u23F3",house:"\u{1F3E0}",house_with_garden:"\u{1F3E1}",houses:"\u{1F3D8}",hugs:"\u{1F917}",hushed:"\u{1F62F}",ice_cream:"\u{1F368}",ice_hockey:"\u{1F3D2}",ice_skate:"\u26F8",icecream:"\u{1F366}",id:"\u{1F194}",ideograph_advantage:"\u{1F250}",imp:"\u{1F47F}",inbox_tray:"\u{1F4E5}",incoming_envelope:"\u{1F4E8}",tipping_hand_woman:"\u{1F481}",information_source:"\u2139\uFE0F",innocent:"\u{1F607}",interrobang:"\u2049\uFE0F",iphone:"\u{1F4F1}",izakaya_lantern:"\u{1F3EE}",jack_o_lantern:"\u{1F383}",japan:"\u{1F5FE}",japanese_castle:"\u{1F3EF}",japanese_goblin:"\u{1F47A}",japanese_ogre:"\u{1F479}",jeans:"\u{1F456}",joy:"\u{1F602}",joy_cat:"\u{1F639}",joystick:"\u{1F579}",kaaba:"\u{1F54B}",key:"\u{1F511}",keyboard:"\u2328\uFE0F",keycap_ten:"\u{1F51F}",kick_scooter:"\u{1F6F4}",kimono:"\u{1F458}",kiss:"\u{1F48B}",kissing:"\u{1F617}",kissing_cat:"\u{1F63D}",kissing_closed_eyes:"\u{1F61A}",kissing_heart:"\u{1F618}",kissing_smiling_eyes:"\u{1F619}",kiwi_fruit:"\u{1F95D}",koala:"\u{1F428}",koko:"\u{1F201}",label:"\u{1F3F7}",large_blue_circle:"\u{1F535}",large_blue_diamond:"\u{1F537}",large_orange_diamond:"\u{1F536}",last_quarter_moon:"\u{1F317}",last_quarter_moon_with_face:"\u{1F31C}",latin_cross:"\u271D\uFE0F",laughing:"\u{1F606}",leaves:"\u{1F343}",ledger:"\u{1F4D2}",left_luggage:"\u{1F6C5}",left_right_arrow:"\u2194\uFE0F",leftwards_arrow_with_hook:"\u21A9\uFE0F",lemon:"\u{1F34B}",leo:"\u264C\uFE0F",leopard:"\u{1F406}",level_slider:"\u{1F39A}",libra:"\u264E\uFE0F",light_rail:"\u{1F688}",link:"\u{1F517}",lion:"\u{1F981}",lips:"\u{1F444}",lipstick:"\u{1F484}",lizard:"\u{1F98E}",lock:"\u{1F512}",lock_with_ink_pen:"\u{1F50F}",lollipop:"\u{1F36D}",loop:"\u27BF",loud_sound:"\u{1F50A}",loudspeaker:"\u{1F4E2}",love_hotel:"\u{1F3E9}",love_letter:"\u{1F48C}",low_brightness:"\u{1F505}",lying_face:"\u{1F925}",m:"\u24C2\uFE0F",mag:"\u{1F50D}",mag_right:"\u{1F50E}",mahjong:"\u{1F004}\uFE0F",mailbox:"\u{1F4EB}",mailbox_closed:"\u{1F4EA}",mailbox_with_mail:"\u{1F4EC}",mailbox_with_no_mail:"\u{1F4ED}",man:"\u{1F468}",man_artist:"\u{1F468}&zwj;\u{1F3A8}",man_astronaut:"\u{1F468}&zwj;\u{1F680}",man_cartwheeling:"\u{1F938}&zwj;\u2642\uFE0F",man_cook:"\u{1F468}&zwj;\u{1F373}",man_dancing:"\u{1F57A}",man_facepalming:"\u{1F926}&zwj;\u2642\uFE0F",man_factory_worker:"\u{1F468}&zwj;\u{1F3ED}",man_farmer:"\u{1F468}&zwj;\u{1F33E}",man_firefighter:"\u{1F468}&zwj;\u{1F692}",man_health_worker:"\u{1F468}&zwj;\u2695\uFE0F",man_in_tuxedo:"\u{1F935}",man_judge:"\u{1F468}&zwj;\u2696\uFE0F",man_juggling:"\u{1F939}&zwj;\u2642\uFE0F",man_mechanic:"\u{1F468}&zwj;\u{1F527}",man_office_worker:"\u{1F468}&zwj;\u{1F4BC}",man_pilot:"\u{1F468}&zwj;\u2708\uFE0F",man_playing_handball:"\u{1F93E}&zwj;\u2642\uFE0F",man_playing_water_polo:"\u{1F93D}&zwj;\u2642\uFE0F",man_scientist:"\u{1F468}&zwj;\u{1F52C}",man_shrugging:"\u{1F937}&zwj;\u2642\uFE0F",man_singer:"\u{1F468}&zwj;\u{1F3A4}",man_student:"\u{1F468}&zwj;\u{1F393}",man_teacher:"\u{1F468}&zwj;\u{1F3EB}",man_technologist:"\u{1F468}&zwj;\u{1F4BB}",man_with_gua_pi_mao:"\u{1F472}",man_with_turban:"\u{1F473}",tangerine:"\u{1F34A}",mans_shoe:"\u{1F45E}",mantelpiece_clock:"\u{1F570}",maple_leaf:"\u{1F341}",martial_arts_uniform:"\u{1F94B}",mask:"\u{1F637}",massage_woman:"\u{1F486}",massage_man:"\u{1F486}&zwj;\u2642\uFE0F",meat_on_bone:"\u{1F356}",medal_military:"\u{1F396}",medal_sports:"\u{1F3C5}",mega:"\u{1F4E3}",melon:"\u{1F348}",memo:"\u{1F4DD}",men_wrestling:"\u{1F93C}&zwj;\u2642\uFE0F",menorah:"\u{1F54E}",mens:"\u{1F6B9}",metal:"\u{1F918}",metro:"\u{1F687}",microphone:"\u{1F3A4}",microscope:"\u{1F52C}",milk_glass:"\u{1F95B}",milky_way:"\u{1F30C}",minibus:"\u{1F690}",minidisc:"\u{1F4BD}",mobile_phone_off:"\u{1F4F4}",money_mouth_face:"\u{1F911}",money_with_wings:"\u{1F4B8}",moneybag:"\u{1F4B0}",monkey:"\u{1F412}",monkey_face:"\u{1F435}",monorail:"\u{1F69D}",moon:"\u{1F314}",mortar_board:"\u{1F393}",mosque:"\u{1F54C}",motor_boat:"\u{1F6E5}",motor_scooter:"\u{1F6F5}",motorcycle:"\u{1F3CD}",motorway:"\u{1F6E3}",mount_fuji:"\u{1F5FB}",mountain:"\u26F0",mountain_biking_man:"\u{1F6B5}",mountain_biking_woman:"\u{1F6B5}&zwj;\u2640\uFE0F",mountain_cableway:"\u{1F6A0}",mountain_railway:"\u{1F69E}",mountain_snow:"\u{1F3D4}",mouse:"\u{1F42D}",mouse2:"\u{1F401}",movie_camera:"\u{1F3A5}",moyai:"\u{1F5FF}",mrs_claus:"\u{1F936}",muscle:"\u{1F4AA}",mushroom:"\u{1F344}",musical_keyboard:"\u{1F3B9}",musical_note:"\u{1F3B5}",musical_score:"\u{1F3BC}",mute:"\u{1F507}",nail_care:"\u{1F485}",name_badge:"\u{1F4DB}",national_park:"\u{1F3DE}",nauseated_face:"\u{1F922}",necktie:"\u{1F454}",negative_squared_cross_mark:"\u274E",nerd_face:"\u{1F913}",neutral_face:"\u{1F610}",new:"\u{1F195}",new_moon:"\u{1F311}",new_moon_with_face:"\u{1F31A}",newspaper:"\u{1F4F0}",newspaper_roll:"\u{1F5DE}",next_track_button:"\u23ED",ng:"\u{1F196}",no_good_man:"\u{1F645}&zwj;\u2642\uFE0F",no_good_woman:"\u{1F645}",night_with_stars:"\u{1F303}",no_bell:"\u{1F515}",no_bicycles:"\u{1F6B3}",no_entry:"\u26D4\uFE0F",no_entry_sign:"\u{1F6AB}",no_mobile_phones:"\u{1F4F5}",no_mouth:"\u{1F636}",no_pedestrians:"\u{1F6B7}",no_smoking:"\u{1F6AD}","non-potable_water":"\u{1F6B1}",nose:"\u{1F443}",notebook:"\u{1F4D3}",notebook_with_decorative_cover:"\u{1F4D4}",notes:"\u{1F3B6}",nut_and_bolt:"\u{1F529}",o:"\u2B55\uFE0F",o2:"\u{1F17E}\uFE0F",ocean:"\u{1F30A}",octopus:"\u{1F419}",oden:"\u{1F362}",office:"\u{1F3E2}",oil_drum:"\u{1F6E2}",ok:"\u{1F197}",ok_hand:"\u{1F44C}",ok_man:"\u{1F646}&zwj;\u2642\uFE0F",ok_woman:"\u{1F646}",old_key:"\u{1F5DD}",older_man:"\u{1F474}",older_woman:"\u{1F475}",om:"\u{1F549}",on:"\u{1F51B}",oncoming_automobile:"\u{1F698}",oncoming_bus:"\u{1F68D}",oncoming_police_car:"\u{1F694}",oncoming_taxi:"\u{1F696}",open_file_folder:"\u{1F4C2}",open_hands:"\u{1F450}",open_mouth:"\u{1F62E}",open_umbrella:"\u2602\uFE0F",ophiuchus:"\u26CE",orange_book:"\u{1F4D9}",orthodox_cross:"\u2626\uFE0F",outbox_tray:"\u{1F4E4}",owl:"\u{1F989}",ox:"\u{1F402}",package:"\u{1F4E6}",page_facing_up:"\u{1F4C4}",page_with_curl:"\u{1F4C3}",pager:"\u{1F4DF}",paintbrush:"\u{1F58C}",palm_tree:"\u{1F334}",pancakes:"\u{1F95E}",panda_face:"\u{1F43C}",paperclip:"\u{1F4CE}",paperclips:"\u{1F587}",parasol_on_ground:"\u26F1",parking:"\u{1F17F}\uFE0F",part_alternation_mark:"\u303D\uFE0F",partly_sunny:"\u26C5\uFE0F",passenger_ship:"\u{1F6F3}",passport_control:"\u{1F6C2}",pause_button:"\u23F8",peace_symbol:"\u262E\uFE0F",peach:"\u{1F351}",peanuts:"\u{1F95C}",pear:"\u{1F350}",pen:"\u{1F58A}",pencil2:"\u270F\uFE0F",penguin:"\u{1F427}",pensive:"\u{1F614}",performing_arts:"\u{1F3AD}",persevere:"\u{1F623}",person_fencing:"\u{1F93A}",pouting_woman:"\u{1F64E}",phone:"\u260E\uFE0F",pick:"\u26CF",pig:"\u{1F437}",pig2:"\u{1F416}",pig_nose:"\u{1F43D}",pill:"\u{1F48A}",pineapple:"\u{1F34D}",ping_pong:"\u{1F3D3}",pisces:"\u2653\uFE0F",pizza:"\u{1F355}",place_of_worship:"\u{1F6D0}",plate_with_cutlery:"\u{1F37D}",play_or_pause_button:"\u23EF",point_down:"\u{1F447}",point_left:"\u{1F448}",point_right:"\u{1F449}",point_up:"\u261D\uFE0F",point_up_2:"\u{1F446}",police_car:"\u{1F693}",policewoman:"\u{1F46E}&zwj;\u2640\uFE0F",poodle:"\u{1F429}",popcorn:"\u{1F37F}",post_office:"\u{1F3E3}",postal_horn:"\u{1F4EF}",postbox:"\u{1F4EE}",potable_water:"\u{1F6B0}",potato:"\u{1F954}",pouch:"\u{1F45D}",poultry_leg:"\u{1F357}",pound:"\u{1F4B7}",rage:"\u{1F621}",pouting_cat:"\u{1F63E}",pouting_man:"\u{1F64E}&zwj;\u2642\uFE0F",pray:"\u{1F64F}",prayer_beads:"\u{1F4FF}",pregnant_woman:"\u{1F930}",previous_track_button:"\u23EE",prince:"\u{1F934}",princess:"\u{1F478}",printer:"\u{1F5A8}",purple_heart:"\u{1F49C}",purse:"\u{1F45B}",pushpin:"\u{1F4CC}",put_litter_in_its_place:"\u{1F6AE}",question:"\u2753",rabbit:"\u{1F430}",rabbit2:"\u{1F407}",racehorse:"\u{1F40E}",racing_car:"\u{1F3CE}",radio:"\u{1F4FB}",radio_button:"\u{1F518}",radioactive:"\u2622\uFE0F",railway_car:"\u{1F683}",railway_track:"\u{1F6E4}",rainbow:"\u{1F308}",rainbow_flag:"\u{1F3F3}\uFE0F&zwj;\u{1F308}",raised_back_of_hand:"\u{1F91A}",raised_hand_with_fingers_splayed:"\u{1F590}",raised_hands:"\u{1F64C}",raising_hand_woman:"\u{1F64B}",raising_hand_man:"\u{1F64B}&zwj;\u2642\uFE0F",ram:"\u{1F40F}",ramen:"\u{1F35C}",rat:"\u{1F400}",record_button:"\u23FA",recycle:"\u267B\uFE0F",red_circle:"\u{1F534}",registered:"\xAE\uFE0F",relaxed:"\u263A\uFE0F",relieved:"\u{1F60C}",reminder_ribbon:"\u{1F397}",repeat:"\u{1F501}",repeat_one:"\u{1F502}",rescue_worker_helmet:"\u26D1",restroom:"\u{1F6BB}",revolving_hearts:"\u{1F49E}",rewind:"\u23EA",rhinoceros:"\u{1F98F}",ribbon:"\u{1F380}",rice:"\u{1F35A}",rice_ball:"\u{1F359}",rice_cracker:"\u{1F358}",rice_scene:"\u{1F391}",right_anger_bubble:"\u{1F5EF}",ring:"\u{1F48D}",robot:"\u{1F916}",rocket:"\u{1F680}",rofl:"\u{1F923}",roll_eyes:"\u{1F644}",roller_coaster:"\u{1F3A2}",rooster:"\u{1F413}",rose:"\u{1F339}",rosette:"\u{1F3F5}",rotating_light:"\u{1F6A8}",round_pushpin:"\u{1F4CD}",rowing_man:"\u{1F6A3}",rowing_woman:"\u{1F6A3}&zwj;\u2640\uFE0F",rugby_football:"\u{1F3C9}",running_man:"\u{1F3C3}",running_shirt_with_sash:"\u{1F3BD}",running_woman:"\u{1F3C3}&zwj;\u2640\uFE0F",sa:"\u{1F202}\uFE0F",sagittarius:"\u2650\uFE0F",sake:"\u{1F376}",sandal:"\u{1F461}",santa:"\u{1F385}",satellite:"\u{1F4E1}",saxophone:"\u{1F3B7}",school:"\u{1F3EB}",school_satchel:"\u{1F392}",scissors:"\u2702\uFE0F",scorpion:"\u{1F982}",scorpius:"\u264F\uFE0F",scream:"\u{1F631}",scream_cat:"\u{1F640}",scroll:"\u{1F4DC}",seat:"\u{1F4BA}",secret:"\u3299\uFE0F",see_no_evil:"\u{1F648}",seedling:"\u{1F331}",selfie:"\u{1F933}",shallow_pan_of_food:"\u{1F958}",shamrock:"\u2618\uFE0F",shark:"\u{1F988}",shaved_ice:"\u{1F367}",sheep:"\u{1F411}",shell:"\u{1F41A}",shield:"\u{1F6E1}",shinto_shrine:"\u26E9",ship:"\u{1F6A2}",shirt:"\u{1F455}",shopping:"\u{1F6CD}",shopping_cart:"\u{1F6D2}",shower:"\u{1F6BF}",shrimp:"\u{1F990}",signal_strength:"\u{1F4F6}",six_pointed_star:"\u{1F52F}",ski:"\u{1F3BF}",skier:"\u26F7",skull:"\u{1F480}",skull_and_crossbones:"\u2620\uFE0F",sleeping:"\u{1F634}",sleeping_bed:"\u{1F6CC}",sleepy:"\u{1F62A}",slightly_frowning_face:"\u{1F641}",slightly_smiling_face:"\u{1F642}",slot_machine:"\u{1F3B0}",small_airplane:"\u{1F6E9}",small_blue_diamond:"\u{1F539}",small_orange_diamond:"\u{1F538}",small_red_triangle:"\u{1F53A}",small_red_triangle_down:"\u{1F53B}",smile:"\u{1F604}",smile_cat:"\u{1F638}",smiley:"\u{1F603}",smiley_cat:"\u{1F63A}",smiling_imp:"\u{1F608}",smirk:"\u{1F60F}",smirk_cat:"\u{1F63C}",smoking:"\u{1F6AC}",snail:"\u{1F40C}",snake:"\u{1F40D}",sneezing_face:"\u{1F927}",snowboarder:"\u{1F3C2}",snowflake:"\u2744\uFE0F",snowman:"\u26C4\uFE0F",snowman_with_snow:"\u2603\uFE0F",sob:"\u{1F62D}",soccer:"\u26BD\uFE0F",soon:"\u{1F51C}",sos:"\u{1F198}",sound:"\u{1F509}",space_invader:"\u{1F47E}",spades:"\u2660\uFE0F",spaghetti:"\u{1F35D}",sparkle:"\u2747\uFE0F",sparkler:"\u{1F387}",sparkles:"\u2728",sparkling_heart:"\u{1F496}",speak_no_evil:"\u{1F64A}",speaker:"\u{1F508}",speaking_head:"\u{1F5E3}",speech_balloon:"\u{1F4AC}",speedboat:"\u{1F6A4}",spider:"\u{1F577}",spider_web:"\u{1F578}",spiral_calendar:"\u{1F5D3}",spiral_notepad:"\u{1F5D2}",spoon:"\u{1F944}",squid:"\u{1F991}",stadium:"\u{1F3DF}",star:"\u2B50\uFE0F",star2:"\u{1F31F}",star_and_crescent:"\u262A\uFE0F",star_of_david:"\u2721\uFE0F",stars:"\u{1F320}",station:"\u{1F689}",statue_of_liberty:"\u{1F5FD}",steam_locomotive:"\u{1F682}",stew:"\u{1F372}",stop_button:"\u23F9",stop_sign:"\u{1F6D1}",stopwatch:"\u23F1",straight_ruler:"\u{1F4CF}",strawberry:"\u{1F353}",stuck_out_tongue:"\u{1F61B}",stuck_out_tongue_closed_eyes:"\u{1F61D}",stuck_out_tongue_winking_eye:"\u{1F61C}",studio_microphone:"\u{1F399}",stuffed_flatbread:"\u{1F959}",sun_behind_large_cloud:"\u{1F325}",sun_behind_rain_cloud:"\u{1F326}",sun_behind_small_cloud:"\u{1F324}",sun_with_face:"\u{1F31E}",sunflower:"\u{1F33B}",sunglasses:"\u{1F60E}",sunny:"\u2600\uFE0F",sunrise:"\u{1F305}",sunrise_over_mountains:"\u{1F304}",surfing_man:"\u{1F3C4}",surfing_woman:"\u{1F3C4}&zwj;\u2640\uFE0F",sushi:"\u{1F363}",suspension_railway:"\u{1F69F}",sweat:"\u{1F613}",sweat_drops:"\u{1F4A6}",sweat_smile:"\u{1F605}",sweet_potato:"\u{1F360}",swimming_man:"\u{1F3CA}",swimming_woman:"\u{1F3CA}&zwj;\u2640\uFE0F",symbols:"\u{1F523}",synagogue:"\u{1F54D}",syringe:"\u{1F489}",taco:"\u{1F32E}",tada:"\u{1F389}",tanabata_tree:"\u{1F38B}",taurus:"\u2649\uFE0F",taxi:"\u{1F695}",tea:"\u{1F375}",telephone_receiver:"\u{1F4DE}",telescope:"\u{1F52D}",tennis:"\u{1F3BE}",tent:"\u26FA\uFE0F",thermometer:"\u{1F321}",thinking:"\u{1F914}",thought_balloon:"\u{1F4AD}",ticket:"\u{1F3AB}",tickets:"\u{1F39F}",tiger:"\u{1F42F}",tiger2:"\u{1F405}",timer_clock:"\u23F2",tipping_hand_man:"\u{1F481}&zwj;\u2642\uFE0F",tired_face:"\u{1F62B}",tm:"\u2122\uFE0F",toilet:"\u{1F6BD}",tokyo_tower:"\u{1F5FC}",tomato:"\u{1F345}",tongue:"\u{1F445}",top:"\u{1F51D}",tophat:"\u{1F3A9}",tornado:"\u{1F32A}",trackball:"\u{1F5B2}",tractor:"\u{1F69C}",traffic_light:"\u{1F6A5}",train:"\u{1F68B}",train2:"\u{1F686}",tram:"\u{1F68A}",triangular_flag_on_post:"\u{1F6A9}",triangular_ruler:"\u{1F4D0}",trident:"\u{1F531}",triumph:"\u{1F624}",trolleybus:"\u{1F68E}",trophy:"\u{1F3C6}",tropical_drink:"\u{1F379}",tropical_fish:"\u{1F420}",truck:"\u{1F69A}",trumpet:"\u{1F3BA}",tulip:"\u{1F337}",tumbler_glass:"\u{1F943}",turkey:"\u{1F983}",turtle:"\u{1F422}",tv:"\u{1F4FA}",twisted_rightwards_arrows:"\u{1F500}",two_hearts:"\u{1F495}",two_men_holding_hands:"\u{1F46C}",two_women_holding_hands:"\u{1F46D}",u5272:"\u{1F239}",u5408:"\u{1F234}",u55b6:"\u{1F23A}",u6307:"\u{1F22F}\uFE0F",u6708:"\u{1F237}\uFE0F",u6709:"\u{1F236}",u6e80:"\u{1F235}",u7121:"\u{1F21A}\uFE0F",u7533:"\u{1F238}",u7981:"\u{1F232}",u7a7a:"\u{1F233}",umbrella:"\u2614\uFE0F",unamused:"\u{1F612}",underage:"\u{1F51E}",unicorn:"\u{1F984}",unlock:"\u{1F513}",up:"\u{1F199}",upside_down_face:"\u{1F643}",v:"\u270C\uFE0F",vertical_traffic_light:"\u{1F6A6}",vhs:"\u{1F4FC}",vibration_mode:"\u{1F4F3}",video_camera:"\u{1F4F9}",video_game:"\u{1F3AE}",violin:"\u{1F3BB}",virgo:"\u264D\uFE0F",volcano:"\u{1F30B}",volleyball:"\u{1F3D0}",vs:"\u{1F19A}",vulcan_salute:"\u{1F596}",walking_man:"\u{1F6B6}",walking_woman:"\u{1F6B6}&zwj;\u2640\uFE0F",waning_crescent_moon:"\u{1F318}",waning_gibbous_moon:"\u{1F316}",warning:"\u26A0\uFE0F",wastebasket:"\u{1F5D1}",watch:"\u231A\uFE0F",water_buffalo:"\u{1F403}",watermelon:"\u{1F349}",wave:"\u{1F44B}",wavy_dash:"\u3030\uFE0F",waxing_crescent_moon:"\u{1F312}",wc:"\u{1F6BE}",weary:"\u{1F629}",wedding:"\u{1F492}",weight_lifting_man:"\u{1F3CB}\uFE0F",weight_lifting_woman:"\u{1F3CB}\uFE0F&zwj;\u2640\uFE0F",whale:"\u{1F433}",whale2:"\u{1F40B}",wheel_of_dharma:"\u2638\uFE0F",wheelchair:"\u267F\uFE0F",white_check_mark:"\u2705",white_circle:"\u26AA\uFE0F",white_flag:"\u{1F3F3}\uFE0F",white_flower:"\u{1F4AE}",white_large_square:"\u2B1C\uFE0F",white_medium_small_square:"\u25FD\uFE0F",white_medium_square:"\u25FB\uFE0F",white_small_square:"\u25AB\uFE0F",white_square_button:"\u{1F533}",wilted_flower:"\u{1F940}",wind_chime:"\u{1F390}",wind_face:"\u{1F32C}",wine_glass:"\u{1F377}",wink:"\u{1F609}",wolf:"\u{1F43A}",woman:"\u{1F469}",woman_artist:"\u{1F469}&zwj;\u{1F3A8}",woman_astronaut:"\u{1F469}&zwj;\u{1F680}",woman_cartwheeling:"\u{1F938}&zwj;\u2640\uFE0F",woman_cook:"\u{1F469}&zwj;\u{1F373}",woman_facepalming:"\u{1F926}&zwj;\u2640\uFE0F",woman_factory_worker:"\u{1F469}&zwj;\u{1F3ED}",woman_farmer:"\u{1F469}&zwj;\u{1F33E}",woman_firefighter:"\u{1F469}&zwj;\u{1F692}",woman_health_worker:"\u{1F469}&zwj;\u2695\uFE0F",woman_judge:"\u{1F469}&zwj;\u2696\uFE0F",woman_juggling:"\u{1F939}&zwj;\u2640\uFE0F",woman_mechanic:"\u{1F469}&zwj;\u{1F527}",woman_office_worker:"\u{1F469}&zwj;\u{1F4BC}",woman_pilot:"\u{1F469}&zwj;\u2708\uFE0F",woman_playing_handball:"\u{1F93E}&zwj;\u2640\uFE0F",woman_playing_water_polo:"\u{1F93D}&zwj;\u2640\uFE0F",woman_scientist:"\u{1F469}&zwj;\u{1F52C}",woman_shrugging:"\u{1F937}&zwj;\u2640\uFE0F",woman_singer:"\u{1F469}&zwj;\u{1F3A4}",woman_student:"\u{1F469}&zwj;\u{1F393}",woman_teacher:"\u{1F469}&zwj;\u{1F3EB}",woman_technologist:"\u{1F469}&zwj;\u{1F4BB}",woman_with_turban:"\u{1F473}&zwj;\u2640\uFE0F",womans_clothes:"\u{1F45A}",womans_hat:"\u{1F452}",women_wrestling:"\u{1F93C}&zwj;\u2640\uFE0F",womens:"\u{1F6BA}",world_map:"\u{1F5FA}",worried:"\u{1F61F}",wrench:"\u{1F527}",writing_hand:"\u270D\uFE0F",x:"\u274C",yellow_heart:"\u{1F49B}",yen:"\u{1F4B4}",yin_yang:"\u262F\uFE0F",yum:"\u{1F60B}",zap:"\u26A1\uFE0F",zipper_mouth_face:"\u{1F910}",zzz:"\u{1F4A4}",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:`<span style="font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;">S</span>`},e.Converter=function(d){"use strict";var _={},m=[],y=[],x={},S=s,w={parsed:{},raw:"",format:""};E();function E(){d=d||{};for(var T in a)a.hasOwnProperty(T)&&(_[T]=a[T]);if(typeof d=="object")for(var M in d)d.hasOwnProperty(M)&&(_[M]=d[M]);else throw Error("Converter expects the passed parameter to be an object, but "+typeof d+" was passed instead.");_.extensions&&e.helper.forEach(_.extensions,L)}function L(T,M){if(M=M||null,e.helper.isString(T))if(T=e.helper.stdExtName(T),M=T,e.extensions[T]){console.warn("DEPRECATION WARNING: "+T+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),I(e.extensions[T],T);return}else if(!e.helper.isUndefined(n[T]))T=n[T];else throw Error('Extension "'+T+'" could not be loaded. It was either not found or is not a valid extension.');typeof T=="function"&&(T=T()),e.helper.isArray(T)||(T=[T]);var j=l(T,M);if(!j.valid)throw Error(j.error);for(var J=0;J<T.length;++J){switch(T[J].type){case"lang":m.push(T[J]);break;case"output":y.push(T[J]);break}if(T[J].hasOwnProperty("listeners"))for(var U in T[J].listeners)T[J].listeners.hasOwnProperty(U)&&A(U,T[J].listeners[U])}}function I(T,M){typeof T=="function"&&(T=T(new e.Converter)),e.helper.isArray(T)||(T=[T]);var j=l(T,M);if(!j.valid)throw Error(j.error);for(var J=0;J<T.length;++J)switch(T[J].type){case"lang":m.push(T[J]);break;case"output":y.push(T[J]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function A(T,M){if(!e.helper.isString(T))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof T+" given");if(typeof M!="function")throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof M+" given");x.hasOwnProperty(T)||(x[T]=[]),x[T].push(M)}function B(T){var M=T.match(/^\s*/)[0].length,j=new RegExp("^\\s{0,"+M+"}","gm");return T.replace(j,"")}this._dispatch=function(M,j,J,U){if(x.hasOwnProperty(M))for(var H=0;H<x[M].length;++H){var te=x[M][H](M,j,this,J,U);te&&typeof te!="undefined"&&(j=te)}return j},this.listen=function(T,M){return A(T,M),this},this.makeHtml=function(T){if(!T)return T;var M={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:m,outputModifiers:y,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return T=T.replace(//g,"\xA8T"),T=T.replace(/\$/g,"\xA8D"),T=T.replace(/\r\n/g,`
`),T=T.replace(/\r/g,`
`),T=T.replace(/\u00A0/g,"&nbsp;"),_.smartIndentationFix&&(T=B(T)),T=`

`+T+`

`,T=e.subParser("detab")(T,_,M),T=T.replace(/^[ \t]+$/mg,""),e.helper.forEach(m,function(j){T=e.subParser("runExtension")(j,T,_,M)}),T=e.subParser("metadata")(T,_,M),T=e.subParser("hashPreCodeTags")(T,_,M),T=e.subParser("githubCodeBlocks")(T,_,M),T=e.subParser("hashHTMLBlocks")(T,_,M),T=e.subParser("hashCodeTags")(T,_,M),T=e.subParser("stripLinkDefinitions")(T,_,M),T=e.subParser("blockGamut")(T,_,M),T=e.subParser("unhashHTMLSpans")(T,_,M),T=e.subParser("unescapeSpecialChars")(T,_,M),T=T.replace(/D/g,"$$"),T=T.replace(/T/g,"\xA8"),T=e.subParser("completeHTMLDocument")(T,_,M),e.helper.forEach(y,function(j){T=e.subParser("runExtension")(j,T,_,M)}),w=M.metadata,T},this.makeMarkdown=this.makeMd=function(T,M){if(T=T.replace(/\r\n/g,`
`),T=T.replace(/\r/g,`
`),T=T.replace(/>[ \t]+</,">\xA8NBSP;<"),!M)if(window&&window.document)M=window.document;else throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");var j=M.createElement("div");j.innerHTML=T;var J={preList:W(j)};se(j);for(var U=j.childNodes,H="",te=0;te<U.length;te++)H+=e.subParser("makeMarkdown.node")(U[te],J);function se(Y){for(var ie=0;ie<Y.childNodes.length;++ie){var re=Y.childNodes[ie];re.nodeType===3?!/\S/.test(re.nodeValue)&&!/^[ ]+$/.test(re.nodeValue)?(Y.removeChild(re),--ie):(re.nodeValue=re.nodeValue.split(`
`).join(" "),re.nodeValue=re.nodeValue.replace(/(\s)+/g,"$1")):re.nodeType===1&&se(re)}}function W(Y){for(var ie=Y.querySelectorAll("pre"),re=[],Q=0;Q<ie.length;++Q)if(ie[Q].childElementCount===1&&ie[Q].firstChild.tagName.toLowerCase()==="code"){var ee=ie[Q].firstChild.innerHTML.trim(),pe=ie[Q].firstChild.getAttribute("data-language")||"";if(pe==="")for(var be=ie[Q].firstChild.className.split(" "),we=0;we<be.length;++we){var Le=be[we].match(/^language-(.+)$/);if(Le!==null){pe=Le[1];break}}ee=e.helper.unescapeHTMLEntities(ee),re.push(ee),ie[Q].outerHTML='<precode language="'+pe+'" precodenum="'+Q.toString()+'"></precode>'}else re.push(ie[Q].innerHTML),ie[Q].innerHTML="",ie[Q].setAttribute("prenum",Q.toString());return re}return H},this.setOption=function(T,M){_[T]=M},this.getOption=function(T){return _[T]},this.getOptions=function(){return _},this.addExtension=function(T,M){M=M||null,L(T,M)},this.useExtension=function(T){L(T)},this.setFlavor=function(T){if(!o.hasOwnProperty(T))throw Error(T+" flavor was not found");var M=o[T];S=T;for(var j in M)M.hasOwnProperty(j)&&(_[j]=M[j])},this.getFlavor=function(){return S},this.removeExtension=function(T){e.helper.isArray(T)||(T=[T]);for(var M=0;M<T.length;++M){for(var j=T[M],J=0;J<m.length;++J)m[J]===j&&m.splice(J,1);for(var U=0;U<y.length;++U)y[U]===j&&y.splice(U,1)}},this.getAllExtensions=function(){return{language:m,output:y}},this.getMetadata=function(T){return T?w.raw:w.parsed},this.getMetadataFormat=function(){return w.format},this._setMetadataPair=function(T,M){w.parsed[T]=M},this._setMetadataFormat=function(T){w.format=T},this._setMetadataRaw=function(T){w.raw=T}},e.subParser("anchors",function(d,_,m){"use strict";d=m.converter._dispatch("anchors.before",d,_,m);var y=function(x,S,w,E,L,I,A){if(e.helper.isUndefined(A)&&(A=""),w=w.toLowerCase(),x.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)E="";else if(!E)if(w||(w=S.toLowerCase().replace(/ ?\n/g," ")),E="#"+w,!e.helper.isUndefined(m.gUrls[w]))E=m.gUrls[w],e.helper.isUndefined(m.gTitles[w])||(A=m.gTitles[w]);else return x;E=E.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var B='<a href="'+E+'"';return A!==""&&A!==null&&(A=A.replace(/"/g,"&quot;"),A=A.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),B+=' title="'+A+'"'),_.openLinksInNewWindow&&!/^#/.test(E)&&(B+=' rel="noopener noreferrer" target="\xA8E95Eblank"'),B+=">"+S+"</a>",B};return d=d.replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,y),d=d.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,y),d=d.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,y),d=d.replace(/\[([^\[\]]+)]()()()()()/g,y),_.ghMentions&&(d=d.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gmi,function(x,S,w,E,L){if(w==="\\")return S+E;if(!e.helper.isString(_.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var I=_.ghMentionsLink.replace(/\{u}/g,L),A="";return _.openLinksInNewWindow&&(A=' rel="noopener noreferrer" target="\xA8E95Eblank"'),S+'<a href="'+I+'"'+A+">"+E+"</a>"})),d=m.converter._dispatch("anchors.after",d,_,m),d});var h=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,p=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,g=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,b=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi,v=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,k=function(d){"use strict";return function(_,m,y,x,S,w,E){y=y.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var L=y,I="",A="",B=m||"",T=E||"";return/^www\./i.test(y)&&(y=y.replace(/^www\./i,"http://www.")),d.excludeTrailingPunctuationFromURLs&&w&&(I=w),d.openLinksInNewWindow&&(A=' rel="noopener noreferrer" target="\xA8E95Eblank"'),B+'<a href="'+y+'"'+A+">"+L+"</a>"+I+T}},C=function(d,_){"use strict";return function(m,y,x){var S="mailto:";return y=y||"",x=e.subParser("unescapeSpecialChars")(x,d,_),d.encodeEmails?(S=e.helper.encodeEmailAddress(S+x),x=e.helper.encodeEmailAddress(x)):S=S+x,y+'<a href="'+S+'">'+x+"</a>"}};e.subParser("autoLinks",function(d,_,m){"use strict";return d=m.converter._dispatch("autoLinks.before",d,_,m),d=d.replace(g,k(_)),d=d.replace(v,C(_,m)),d=m.converter._dispatch("autoLinks.after",d,_,m),d}),e.subParser("simplifiedAutoLinks",function(d,_,m){"use strict";return _.simplifiedAutoLink&&(d=m.converter._dispatch("simplifiedAutoLinks.before",d,_,m),_.excludeTrailingPunctuationFromURLs?d=d.replace(p,k(_)):d=d.replace(h,k(_)),d=d.replace(b,C(_,m)),d=m.converter._dispatch("simplifiedAutoLinks.after",d,_,m)),d}),e.subParser("blockGamut",function(d,_,m){"use strict";return d=m.converter._dispatch("blockGamut.before",d,_,m),d=e.subParser("blockQuotes")(d,_,m),d=e.subParser("headers")(d,_,m),d=e.subParser("horizontalRule")(d,_,m),d=e.subParser("lists")(d,_,m),d=e.subParser("codeBlocks")(d,_,m),d=e.subParser("tables")(d,_,m),d=e.subParser("hashHTMLBlocks")(d,_,m),d=e.subParser("paragraphs")(d,_,m),d=m.converter._dispatch("blockGamut.after",d,_,m),d}),e.subParser("blockQuotes",function(d,_,m){"use strict";d=m.converter._dispatch("blockQuotes.before",d,_,m),d=d+`

`;var y=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return _.splitAdjacentBlockquotes&&(y=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),d=d.replace(y,function(x){return x=x.replace(/^[ \t]*>[ \t]?/gm,""),x=x.replace(/0/g,""),x=x.replace(/^[ \t]+$/gm,""),x=e.subParser("githubCodeBlocks")(x,_,m),x=e.subParser("blockGamut")(x,_,m),x=x.replace(/(^|\n)/g,"$1  "),x=x.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(S,w){var E=w;return E=E.replace(/^  /mg,"\xA80"),E=E.replace(/0/g,""),E}),e.subParser("hashBlock")(`<blockquote>
`+x+`
</blockquote>`,_,m)}),d=m.converter._dispatch("blockQuotes.after",d,_,m),d}),e.subParser("codeBlocks",function(d,_,m){"use strict";d=m.converter._dispatch("codeBlocks.before",d,_,m),d+="\xA80";var y=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=0))/g;return d=d.replace(y,function(x,S,w){var E=S,L=w,I=`
`;return E=e.subParser("outdent")(E,_,m),E=e.subParser("encodeCode")(E,_,m),E=e.subParser("detab")(E,_,m),E=E.replace(/^\n+/g,""),E=E.replace(/\n+$/g,""),_.omitExtraWLInCodeBlocks&&(I=""),E="<pre><code>"+E+I+"</code></pre>",e.subParser("hashBlock")(E,_,m)+L}),d=d.replace(/0/,""),d=m.converter._dispatch("codeBlocks.after",d,_,m),d}),e.subParser("codeSpans",function(d,_,m){"use strict";return d=m.converter._dispatch("codeSpans.before",d,_,m),typeof d=="undefined"&&(d=""),d=d.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(y,x,S,w){var E=w;return E=E.replace(/^([ \t]*)/g,""),E=E.replace(/[ \t]*$/g,""),E=e.subParser("encodeCode")(E,_,m),E=x+"<code>"+E+"</code>",E=e.subParser("hashHTMLSpans")(E,_,m),E}),d=m.converter._dispatch("codeSpans.after",d,_,m),d}),e.subParser("completeHTMLDocument",function(d,_,m){"use strict";if(!_.completeHTMLDocument)return d;d=m.converter._dispatch("completeHTMLDocument.before",d,_,m);var y="html",x=`<!DOCTYPE HTML>
`,S="",w=`<meta charset="utf-8">
`,E="",L="";typeof m.metadata.parsed.doctype!="undefined"&&(x="<!DOCTYPE "+m.metadata.parsed.doctype+`>
`,y=m.metadata.parsed.doctype.toString().toLowerCase(),(y==="html"||y==="html5")&&(w='<meta charset="utf-8">'));for(var I in m.metadata.parsed)if(m.metadata.parsed.hasOwnProperty(I))switch(I.toLowerCase()){case"doctype":break;case"title":S="<title>"+m.metadata.parsed.title+`</title>
`;break;case"charset":y==="html"||y==="html5"?w='<meta charset="'+m.metadata.parsed.charset+`">
`:w='<meta name="charset" content="'+m.metadata.parsed.charset+`">
`;break;case"language":case"lang":E=' lang="'+m.metadata.parsed[I]+'"',L+='<meta name="'+I+'" content="'+m.metadata.parsed[I]+`">
`;break;default:L+='<meta name="'+I+'" content="'+m.metadata.parsed[I]+`">
`}return d=x+"<html"+E+`>
<head>
`+S+w+L+`</head>
<body>
`+d.trim()+`
</body>
</html>`,d=m.converter._dispatch("completeHTMLDocument.after",d,_,m),d}),e.subParser("detab",function(d,_,m){"use strict";return d=m.converter._dispatch("detab.before",d,_,m),d=d.replace(/\t(?=\t)/g,"    "),d=d.replace(/\t/g,"\xA8A\xA8B"),d=d.replace(/B(.+?)A/g,function(y,x){for(var S=x,w=4-S.length%4,E=0;E<w;E++)S+=" ";return S}),d=d.replace(/A/g,"    "),d=d.replace(/B/g,""),d=m.converter._dispatch("detab.after",d,_,m),d}),e.subParser("ellipsis",function(d,_,m){"use strict";return _.ellipsis&&(d=m.converter._dispatch("ellipsis.before",d,_,m),d=d.replace(/\.\.\./g,"\u2026"),d=m.converter._dispatch("ellipsis.after",d,_,m)),d}),e.subParser("emoji",function(d,_,m){"use strict";if(!_.emoji)return d;d=m.converter._dispatch("emoji.before",d,_,m);var y=/:([\S]+?):/g;return d=d.replace(y,function(x,S){return e.helper.emojis.hasOwnProperty(S)?e.helper.emojis[S]:x}),d=m.converter._dispatch("emoji.after",d,_,m),d}),e.subParser("encodeAmpsAndAngles",function(d,_,m){"use strict";return d=m.converter._dispatch("encodeAmpsAndAngles.before",d,_,m),d=d.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),d=d.replace(/<(?![a-z\/?$!])/gi,"&lt;"),d=d.replace(/</g,"&lt;"),d=d.replace(/>/g,"&gt;"),d=m.converter._dispatch("encodeAmpsAndAngles.after",d,_,m),d}),e.subParser("encodeBackslashEscapes",function(d,_,m){"use strict";return d=m.converter._dispatch("encodeBackslashEscapes.before",d,_,m),d=d.replace(/\\(\\)/g,e.helper.escapeCharactersCallback),d=d.replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,e.helper.escapeCharactersCallback),d=m.converter._dispatch("encodeBackslashEscapes.after",d,_,m),d}),e.subParser("encodeCode",function(d,_,m){"use strict";return d=m.converter._dispatch("encodeCode.before",d,_,m),d=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,e.helper.escapeCharactersCallback),d=m.converter._dispatch("encodeCode.after",d,_,m),d}),e.subParser("escapeSpecialCharsWithinTagAttributes",function(d,_,m){"use strict";d=m.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",d,_,m);var y=/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,x=/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;return d=d.replace(y,function(S){return S.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,e.helper.escapeCharactersCallback)}),d=d.replace(x,function(S){return S.replace(/([\\`*_~=|])/g,e.helper.escapeCharactersCallback)}),d=m.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",d,_,m),d}),e.subParser("githubCodeBlocks",function(d,_,m){"use strict";return _.ghCodeBlocks?(d=m.converter._dispatch("githubCodeBlocks.before",d,_,m),d+="\xA80",d=d.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(y,x,S,w){var E=_.omitExtraWLInCodeBlocks?"":`
`;return w=e.subParser("encodeCode")(w,_,m),w=e.subParser("detab")(w,_,m),w=w.replace(/^\n+/g,""),w=w.replace(/\n+$/g,""),w="<pre><code"+(S?' class="'+S+" language-"+S+'"':"")+">"+w+E+"</code></pre>",w=e.subParser("hashBlock")(w,_,m),`

\xA8G`+(m.ghCodeBlocks.push({text:y,codeblock:w})-1)+`G

`}),d=d.replace(/0/,""),m.converter._dispatch("githubCodeBlocks.after",d,_,m)):d}),e.subParser("hashBlock",function(d,_,m){"use strict";return d=m.converter._dispatch("hashBlock.before",d,_,m),d=d.replace(/(^\n+|\n+$)/g,""),d=`

\xA8K`+(m.gHtmlBlocks.push(d)-1)+`K

`,d=m.converter._dispatch("hashBlock.after",d,_,m),d}),e.subParser("hashCodeTags",function(d,_,m){"use strict";d=m.converter._dispatch("hashCodeTags.before",d,_,m);var y=function(x,S,w,E){var L=w+e.subParser("encodeCode")(S,_,m)+E;return"\xA8C"+(m.gHtmlSpans.push(L)-1)+"C"};return d=e.helper.replaceRecursiveRegExp(d,y,"<code\\b[^>]*>","</code>","gim"),d=m.converter._dispatch("hashCodeTags.after",d,_,m),d}),e.subParser("hashElement",function(d,_,m){"use strict";return function(y,x){var S=x;return S=S.replace(/\n\n/g,`
`),S=S.replace(/^\n/,""),S=S.replace(/\n+$/g,""),S=`

\xA8K`+(m.gHtmlBlocks.push(S)-1)+`K

`,S}}),e.subParser("hashHTMLBlocks",function(d,_,m){"use strict";d=m.converter._dispatch("hashHTMLBlocks.before",d,_,m);var y=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],x=function(T,M,j,J){var U=T;return j.search(/\bmarkdown\b/)!==-1&&(U=j+m.converter.makeHtml(M)+J),`

\xA8K`+(m.gHtmlBlocks.push(U)-1)+`K

`};_.backslashEscapesHTMLTags&&(d=d.replace(/\\<(\/?[^>]+?)>/g,function(T,M){return"&lt;"+M+"&gt;"}));for(var S=0;S<y.length;++S)for(var w,E=new RegExp("^ {0,3}(<"+y[S]+"\\b[^>]*>)","im"),L="<"+y[S]+"\\b[^>]*>",I="</"+y[S]+">";(w=e.helper.regexIndexOf(d,E))!==-1;){var A=e.helper.splitAtIndex(d,w),B=e.helper.replaceRecursiveRegExp(A[1],x,L,I,"im");if(B===A[1])break;d=A[0].concat(B)}return d=d.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,e.subParser("hashElement")(d,_,m)),d=e.helper.replaceRecursiveRegExp(d,function(T){return`

\xA8K`+(m.gHtmlBlocks.push(T)-1)+`K

`},"^ {0,3}<!--","-->","gm"),d=d.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,e.subParser("hashElement")(d,_,m)),d=m.converter._dispatch("hashHTMLBlocks.after",d,_,m),d}),e.subParser("hashHTMLSpans",function(d,_,m){"use strict";d=m.converter._dispatch("hashHTMLSpans.before",d,_,m);function y(x){return"\xA8C"+(m.gHtmlSpans.push(x)-1)+"C"}return d=d.replace(/<[^>]+?\/>/gi,function(x){return y(x)}),d=d.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(x){return y(x)}),d=d.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(x){return y(x)}),d=d.replace(/<[^>]+?>/gi,function(x){return y(x)}),d=m.converter._dispatch("hashHTMLSpans.after",d,_,m),d}),e.subParser("unhashHTMLSpans",function(d,_,m){"use strict";d=m.converter._dispatch("unhashHTMLSpans.before",d,_,m);for(var y=0;y<m.gHtmlSpans.length;++y){for(var x=m.gHtmlSpans[y],S=0;/C(\d+)C/.test(x);){var w=RegExp.$1;if(x=x.replace("\xA8C"+w+"C",m.gHtmlSpans[w]),S===10){console.error("maximum nesting of 10 spans reached!!!");break}++S}d=d.replace("\xA8C"+y+"C",x)}return d=m.converter._dispatch("unhashHTMLSpans.after",d,_,m),d}),e.subParser("hashPreCodeTags",function(d,_,m){"use strict";d=m.converter._dispatch("hashPreCodeTags.before",d,_,m);var y=function(x,S,w,E){var L=w+e.subParser("encodeCode")(S,_,m)+E;return`

\xA8G`+(m.ghCodeBlocks.push({text:x,codeblock:L})-1)+`G

`};return d=e.helper.replaceRecursiveRegExp(d,y,"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),d=m.converter._dispatch("hashPreCodeTags.after",d,_,m),d}),e.subParser("headers",function(d,_,m){"use strict";d=m.converter._dispatch("headers.before",d,_,m);var y=isNaN(parseInt(_.headerLevelStart))?1:parseInt(_.headerLevelStart),x=_.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,S=_.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;d=d.replace(x,function(L,I){var A=e.subParser("spanGamut")(I,_,m),B=_.noHeaderId?"":' id="'+E(I)+'"',T=y,M="<h"+T+B+">"+A+"</h"+T+">";return e.subParser("hashBlock")(M,_,m)}),d=d.replace(S,function(L,I){var A=e.subParser("spanGamut")(I,_,m),B=_.noHeaderId?"":' id="'+E(I)+'"',T=y+1,M="<h"+T+B+">"+A+"</h"+T+">";return e.subParser("hashBlock")(M,_,m)});var w=_.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;d=d.replace(w,function(L,I,A){var B=A;_.customizedHeaderId&&(B=A.replace(/\s?\{([^{]+?)}\s*$/,""));var T=e.subParser("spanGamut")(B,_,m),M=_.noHeaderId?"":' id="'+E(A)+'"',j=y-1+I.length,J="<h"+j+M+">"+T+"</h"+j+">";return e.subParser("hashBlock")(J,_,m)});function E(L){var I,A;if(_.customizedHeaderId){var B=L.match(/\{([^{]+?)}\s*$/);B&&B[1]&&(L=B[1])}return I=L,e.helper.isString(_.prefixHeaderId)?A=_.prefixHeaderId:_.prefixHeaderId===!0?A="section-":A="",_.rawPrefixHeaderId||(I=A+I),_.ghCompatibleHeaderId?I=I.replace(/ /g,"-").replace(/&amp;/g,"").replace(/T/g,"").replace(/D/g,"").replace(/[&+$,\/:;=?@"#{}|^~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():_.rawHeaderId?I=I.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/T/g,"\xA8").replace(/D/g,"$").replace(/["']/g,"-").toLowerCase():I=I.replace(/[^\w]/g,"").toLowerCase(),_.rawPrefixHeaderId&&(I=A+I),m.hashLinkCounts[I]?I=I+"-"+m.hashLinkCounts[I]++:m.hashLinkCounts[I]=1,I}return d=m.converter._dispatch("headers.after",d,_,m),d}),e.subParser("horizontalRule",function(d,_,m){"use strict";d=m.converter._dispatch("horizontalRule.before",d,_,m);var y=e.subParser("hashBlock")("<hr />",_,m);return d=d.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,y),d=d.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,y),d=d.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,y),d=m.converter._dispatch("horizontalRule.after",d,_,m),d}),e.subParser("images",function(d,_,m){"use strict";d=m.converter._dispatch("images.before",d,_,m);var y=/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,x=/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,S=/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,w=/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,E=/!\[([^\[\]]+)]()()()()()/g;function L(A,B,T,M,j,J,U,H){return M=M.replace(/\s/g,""),I(A,B,T,M,j,J,U,H)}function I(A,B,T,M,j,J,U,H){var te=m.gUrls,se=m.gTitles,W=m.gDimensions;if(T=T.toLowerCase(),H||(H=""),A.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)M="";else if(M===""||M===null)if((T===""||T===null)&&(T=B.toLowerCase().replace(/ ?\n/g," ")),M="#"+T,!e.helper.isUndefined(te[T]))M=te[T],e.helper.isUndefined(se[T])||(H=se[T]),e.helper.isUndefined(W[T])||(j=W[T].width,J=W[T].height);else return A;B=B.replace(/"/g,"&quot;").replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),M=M.replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback);var Y='<img src="'+M+'" alt="'+B+'"';return H&&e.helper.isString(H)&&(H=H.replace(/"/g,"&quot;").replace(e.helper.regexes.asteriskDashAndColon,e.helper.escapeCharactersCallback),Y+=' title="'+H+'"'),j&&J&&(j=j==="*"?"auto":j,J=J==="*"?"auto":J,Y+=' width="'+j+'"',Y+=' height="'+J+'"'),Y+=" />",Y}return d=d.replace(w,I),d=d.replace(S,L),d=d.replace(x,I),d=d.replace(y,I),d=d.replace(E,I),d=m.converter._dispatch("images.after",d,_,m),d}),e.subParser("italicsAndBold",function(d,_,m){"use strict";d=m.converter._dispatch("italicsAndBold.before",d,_,m);function y(x,S,w){return S+x+w}return _.literalMidWordUnderscores?(d=d.replace(/\b___(\S[\s\S]*?)___\b/g,function(x,S){return y(S,"<strong><em>","</em></strong>")}),d=d.replace(/\b__(\S[\s\S]*?)__\b/g,function(x,S){return y(S,"<strong>","</strong>")}),d=d.replace(/\b_(\S[\s\S]*?)_\b/g,function(x,S){return y(S,"<em>","</em>")})):(d=d.replace(/___(\S[\s\S]*?)___/g,function(x,S){return/\S$/.test(S)?y(S,"<strong><em>","</em></strong>"):x}),d=d.replace(/__(\S[\s\S]*?)__/g,function(x,S){return/\S$/.test(S)?y(S,"<strong>","</strong>"):x}),d=d.replace(/_([^\s_][\s\S]*?)_/g,function(x,S){return/\S$/.test(S)?y(S,"<em>","</em>"):x})),_.literalMidWordAsterisks?(d=d.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(x,S,w){return y(w,S+"<strong><em>","</em></strong>")}),d=d.replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(x,S,w){return y(w,S+"<strong>","</strong>")}),d=d.replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(x,S,w){return y(w,S+"<em>","</em>")})):(d=d.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(x,S){return/\S$/.test(S)?y(S,"<strong><em>","</em></strong>"):x}),d=d.replace(/\*\*(\S[\s\S]*?)\*\*/g,function(x,S){return/\S$/.test(S)?y(S,"<strong>","</strong>"):x}),d=d.replace(/\*([^\s*][\s\S]*?)\*/g,function(x,S){return/\S$/.test(S)?y(S,"<em>","</em>"):x})),d=m.converter._dispatch("italicsAndBold.after",d,_,m),d}),e.subParser("lists",function(d,_,m){"use strict";function y(w,E){m.gListLevel++,w=w.replace(/\n{2,}$/,`
`),w+="\xA80";var L=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,I=/\n[ \t]*\n(?!0)/.test(w);return _.disableForced4SpacesIndentedSublists&&(L=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(0|\2([*+-]|\d+[.])[ \t]+))/gm),w=w.replace(L,function(A,B,T,M,j,J,U){U=U&&U.trim()!=="";var H=e.subParser("outdent")(j,_,m),te="";return J&&_.tasklists&&(te=' class="task-list-item" style="list-style-type: none;"',H=H.replace(/^[ \t]*\[(x|X| )?]/m,function(){var se='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return U&&(se+=" checked"),se+=">",se})),H=H.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(se){return"\xA8A"+se}),B||H.search(/\n{2,}/)>-1?(H=e.subParser("githubCodeBlocks")(H,_,m),H=e.subParser("blockGamut")(H,_,m)):(H=e.subParser("lists")(H,_,m),H=H.replace(/\n$/,""),H=e.subParser("hashHTMLBlocks")(H,_,m),H=H.replace(/\n\n+/g,`

`),I?H=e.subParser("paragraphs")(H,_,m):H=e.subParser("spanGamut")(H,_,m)),H=H.replace("\xA8A",""),H="<li"+te+">"+H+`</li>
`,H}),w=w.replace(/0/g,""),m.gListLevel--,E&&(w=w.replace(/\s+$/,"")),w}function x(w,E){if(E==="ol"){var L=w.match(/^ *(\d+)\./);if(L&&L[1]!=="1")return' start="'+L[1]+'"'}return""}function S(w,E,L){var I=_.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,A=_.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,B=E==="ul"?I:A,T="";if(w.search(B)!==-1)(function j(J){var U=J.search(B),H=x(w,E);U!==-1?(T+=`

<`+E+H+`>
`+y(J.slice(0,U),!!L)+"</"+E+`>
`,E=E==="ul"?"ol":"ul",B=E==="ul"?I:A,j(J.slice(U))):T+=`

<`+E+H+`>
`+y(J,!!L)+"</"+E+`>
`})(w);else{var M=x(w,E);T=`

<`+E+M+`>
`+y(w,!!L)+"</"+E+`>
`}return T}return d=m.converter._dispatch("lists.before",d,_,m),d+="\xA80",m.gListLevel?d=d.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(w,E,L){var I=L.search(/[*+-]/g)>-1?"ul":"ol";return S(E,I,!0)}):d=d.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(w,E,L,I){var A=I.search(/[*+-]/g)>-1?"ul":"ol";return S(L,A,!1)}),d=d.replace(/0/,""),d=m.converter._dispatch("lists.after",d,_,m),d}),e.subParser("metadata",function(d,_,m){"use strict";if(!_.metadata)return d;d=m.converter._dispatch("metadata.before",d,_,m);function y(x){m.metadata.raw=x,x=x.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),x=x.replace(/\n {4}/g," "),x.replace(/^([\S ]+): +([\s\S]+?)$/gm,function(S,w,E){return m.metadata.parsed[w]=E,""})}return d=d.replace(/^\s*+(\S*?)\n([\s\S]+?)\n+\n/,function(x,S,w){return y(w),"\xA8M"}),d=d.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(x,S,w){return S&&(m.metadata.format=S),y(w),"\xA8M"}),d=d.replace(/M/g,""),d=m.converter._dispatch("metadata.after",d,_,m),d}),e.subParser("outdent",function(d,_,m){"use strict";return d=m.converter._dispatch("outdent.before",d,_,m),d=d.replace(/^(\t|[ ]{1,4})/gm,"\xA80"),d=d.replace(/0/g,""),d=m.converter._dispatch("outdent.after",d,_,m),d}),e.subParser("paragraphs",function(d,_,m){"use strict";d=m.converter._dispatch("paragraphs.before",d,_,m),d=d.replace(/^\n+/g,""),d=d.replace(/\n+$/g,"");for(var y=d.split(/\n{2,}/g),x=[],S=y.length,w=0;w<S;w++){var E=y[w];E.search(/(K|G)(\d+)\1/g)>=0?x.push(E):E.search(/\S/)>=0&&(E=e.subParser("spanGamut")(E,_,m),E=E.replace(/^([ \t]*)/g,"<p>"),E+="</p>",x.push(E))}for(S=x.length,w=0;w<S;w++){for(var L="",I=x[w],A=!1;/(K|G)(\d+)\1/.test(I);){var B=RegExp.$1,T=RegExp.$2;B==="K"?L=m.gHtmlBlocks[T]:A?L=e.subParser("encodeCode")(m.ghCodeBlocks[T].text,_,m):L=m.ghCodeBlocks[T].codeblock,L=L.replace(/\$/g,"$$$$"),I=I.replace(/(\n\n)?(K|G)\d+\2(\n\n)?/,L),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(I)&&(A=!0)}x[w]=I}return d=x.join(`
`),d=d.replace(/^\n+/g,""),d=d.replace(/\n+$/g,""),m.converter._dispatch("paragraphs.after",d,_,m)}),e.subParser("runExtension",function(d,_,m,y){"use strict";if(d.filter)_=d.filter(_,y.converter,m);else if(d.regex){var x=d.regex;x instanceof RegExp||(x=new RegExp(x,"g")),_=_.replace(x,d.replace)}return _}),e.subParser("spanGamut",function(d,_,m){"use strict";return d=m.converter._dispatch("spanGamut.before",d,_,m),d=e.subParser("codeSpans")(d,_,m),d=e.subParser("escapeSpecialCharsWithinTagAttributes")(d,_,m),d=e.subParser("encodeBackslashEscapes")(d,_,m),d=e.subParser("images")(d,_,m),d=e.subParser("anchors")(d,_,m),d=e.subParser("autoLinks")(d,_,m),d=e.subParser("simplifiedAutoLinks")(d,_,m),d=e.subParser("emoji")(d,_,m),d=e.subParser("underline")(d,_,m),d=e.subParser("italicsAndBold")(d,_,m),d=e.subParser("strikethrough")(d,_,m),d=e.subParser("ellipsis")(d,_,m),d=e.subParser("hashHTMLSpans")(d,_,m),d=e.subParser("encodeAmpsAndAngles")(d,_,m),_.simpleLineBreaks?/\n\nK/.test(d)||(d=d.replace(/\n+/g,`<br />
`)):d=d.replace(/  +\n/g,`<br />
`),d=m.converter._dispatch("spanGamut.after",d,_,m),d}),e.subParser("strikethrough",function(d,_,m){"use strict";function y(x){return _.simplifiedAutoLink&&(x=e.subParser("simplifiedAutoLinks")(x,_,m)),"<del>"+x+"</del>"}return _.strikethrough&&(d=m.converter._dispatch("strikethrough.before",d,_,m),d=d.replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(x,S){return y(S)}),d=m.converter._dispatch("strikethrough.after",d,_,m)),d}),e.subParser("stripLinkDefinitions",function(d,_,m){"use strict";var y=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=0))/gm,x=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=0)|(?=\n\[))/gm;d+="\xA80";var S=function(w,E,L,I,A,B,T){return E=E.toLowerCase(),d.toLowerCase().split(E).length-1<2?w:(L.match(/^data:.+?\/.+?;base64,/)?m.gUrls[E]=L.replace(/\s/g,""):m.gUrls[E]=e.subParser("encodeAmpsAndAngles")(L,_,m),B?B+T:(T&&(m.gTitles[E]=T.replace(/"|'/g,"&quot;")),_.parseImgDimensions&&I&&A&&(m.gDimensions[E]={width:I,height:A}),""))};return d=d.replace(x,S),d=d.replace(y,S),d=d.replace(/0/,""),d}),e.subParser("tables",function(d,_,m){"use strict";if(!_.tables)return d;var y=/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|0)/gm,x=/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|0)/gm;function S(A){return/^:[ \t]*--*$/.test(A)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(A)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(A)?' style="text-align:center;"':""}function w(A,B){var T="";return A=A.trim(),(_.tablesHeaderId||_.tableHeaderId)&&(T=' id="'+A.replace(/ /g,"_").toLowerCase()+'"'),A=e.subParser("spanGamut")(A,_,m),"<th"+T+B+">"+A+`</th>
`}function E(A,B){var T=e.subParser("spanGamut")(A,_,m);return"<td"+B+">"+T+`</td>
`}function L(A,B){for(var T=`<table>
<thead>
<tr>
`,M=A.length,j=0;j<M;++j)T+=A[j];for(T+=`</tr>
</thead>
<tbody>
`,j=0;j<B.length;++j){T+=`<tr>
`;for(var J=0;J<M;++J)T+=B[j][J];T+=`</tr>
`}return T+=`</tbody>
</table>
`,T}function I(A){var B,T=A.split(`
`);for(B=0;B<T.length;++B)/^ {0,3}\|/.test(T[B])&&(T[B]=T[B].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(T[B])&&(T[B]=T[B].replace(/\|[ \t]*$/,"")),T[B]=e.subParser("codeSpans")(T[B],_,m);var M=T[0].split("|").map(function(Y){return Y.trim()}),j=T[1].split("|").map(function(Y){return Y.trim()}),J=[],U=[],H=[],te=[];for(T.shift(),T.shift(),B=0;B<T.length;++B)T[B].trim()!==""&&J.push(T[B].split("|").map(function(Y){return Y.trim()}));if(M.length<j.length)return A;for(B=0;B<j.length;++B)H.push(S(j[B]));for(B=0;B<M.length;++B)e.helper.isUndefined(H[B])&&(H[B]=""),U.push(w(M[B],H[B]));for(B=0;B<J.length;++B){for(var se=[],W=0;W<U.length;++W)e.helper.isUndefined(J[B][W]),se.push(E(J[B][W],H[W]));te.push(se)}return L(U,te)}return d=m.converter._dispatch("tables.before",d,_,m),d=d.replace(/\\(\|)/g,e.helper.escapeCharactersCallback),d=d.replace(y,I),d=d.replace(x,I),d=m.converter._dispatch("tables.after",d,_,m),d}),e.subParser("underline",function(d,_,m){"use strict";return _.underline&&(d=m.converter._dispatch("underline.before",d,_,m),_.literalMidWordUnderscores?(d=d.replace(/\b___(\S[\s\S]*?)___\b/g,function(y,x){return"<u>"+x+"</u>"}),d=d.replace(/\b__(\S[\s\S]*?)__\b/g,function(y,x){return"<u>"+x+"</u>"})):(d=d.replace(/___(\S[\s\S]*?)___/g,function(y,x){return/\S$/.test(x)?"<u>"+x+"</u>":y}),d=d.replace(/__(\S[\s\S]*?)__/g,function(y,x){return/\S$/.test(x)?"<u>"+x+"</u>":y})),d=d.replace(/(_)/g,e.helper.escapeCharactersCallback),d=m.converter._dispatch("underline.after",d,_,m)),d}),e.subParser("unescapeSpecialChars",function(d,_,m){"use strict";return d=m.converter._dispatch("unescapeSpecialChars.before",d,_,m),d=d.replace(/E(\d+)E/g,function(y,x){var S=parseInt(x);return String.fromCharCode(S)}),d=m.converter._dispatch("unescapeSpecialChars.after",d,_,m),d}),e.subParser("makeMarkdown.blockquote",function(d,_){"use strict";var m="";if(d.hasChildNodes())for(var y=d.childNodes,x=y.length,S=0;S<x;++S){var w=e.subParser("makeMarkdown.node")(y[S],_);w!==""&&(m+=w)}return m=m.trim(),m="> "+m.split(`
`).join(`
> `),m}),e.subParser("makeMarkdown.codeBlock",function(d,_){"use strict";var m=d.getAttribute("language"),y=d.getAttribute("precodenum");return"```"+m+`
`+_.preList[y]+"\n```"}),e.subParser("makeMarkdown.codeSpan",function(d){"use strict";return"`"+d.innerHTML+"`"}),e.subParser("makeMarkdown.emphasis",function(d,_){"use strict";var m="";if(d.hasChildNodes()){m+="*";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="*"}return m}),e.subParser("makeMarkdown.header",function(d,_,m){"use strict";var y=new Array(m+1).join("#"),x="";if(d.hasChildNodes()){x=y+" ";for(var S=d.childNodes,w=S.length,E=0;E<w;++E)x+=e.subParser("makeMarkdown.node")(S[E],_)}return x}),e.subParser("makeMarkdown.hr",function(){"use strict";return"---"}),e.subParser("makeMarkdown.image",function(d){"use strict";var _="";return d.hasAttribute("src")&&(_+="!["+d.getAttribute("alt")+"](",_+="<"+d.getAttribute("src")+">",d.hasAttribute("width")&&d.hasAttribute("height")&&(_+=" ="+d.getAttribute("width")+"x"+d.getAttribute("height")),d.hasAttribute("title")&&(_+=' "'+d.getAttribute("title")+'"'),_+=")"),_}),e.subParser("makeMarkdown.links",function(d,_){"use strict";var m="";if(d.hasChildNodes()&&d.hasAttribute("href")){var y=d.childNodes,x=y.length;m="[";for(var S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="](",m+="<"+d.getAttribute("href")+">",d.hasAttribute("title")&&(m+=' "'+d.getAttribute("title")+'"'),m+=")"}return m}),e.subParser("makeMarkdown.list",function(d,_,m){"use strict";var y="";if(!d.hasChildNodes())return"";for(var x=d.childNodes,S=x.length,w=d.getAttribute("start")||1,E=0;E<S;++E)if(!(typeof x[E].tagName=="undefined"||x[E].tagName.toLowerCase()!=="li")){var L="";m==="ol"?L=w.toString()+". ":L="- ",y+=L+e.subParser("makeMarkdown.listItem")(x[E],_),++w}return y+=`
<!-- -->
`,y.trim()}),e.subParser("makeMarkdown.listItem",function(d,_){"use strict";for(var m="",y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);return/\n$/.test(m)?m=m.split(`
`).join(`
    `).replace(/^ {4}$/gm,"").replace(/\n\n+/g,`

`):m+=`
`,m}),e.subParser("makeMarkdown.node",function(d,_,m){"use strict";m=m||!1;var y="";if(d.nodeType===3)return e.subParser("makeMarkdown.txt")(d,_);if(d.nodeType===8)return"<!--"+d.data+`-->

`;if(d.nodeType!==1)return"";var x=d.tagName.toLowerCase();switch(x){case"h1":m||(y=e.subParser("makeMarkdown.header")(d,_,1)+`

`);break;case"h2":m||(y=e.subParser("makeMarkdown.header")(d,_,2)+`

`);break;case"h3":m||(y=e.subParser("makeMarkdown.header")(d,_,3)+`

`);break;case"h4":m||(y=e.subParser("makeMarkdown.header")(d,_,4)+`

`);break;case"h5":m||(y=e.subParser("makeMarkdown.header")(d,_,5)+`

`);break;case"h6":m||(y=e.subParser("makeMarkdown.header")(d,_,6)+`

`);break;case"p":m||(y=e.subParser("makeMarkdown.paragraph")(d,_)+`

`);break;case"blockquote":m||(y=e.subParser("makeMarkdown.blockquote")(d,_)+`

`);break;case"hr":m||(y=e.subParser("makeMarkdown.hr")(d,_)+`

`);break;case"ol":m||(y=e.subParser("makeMarkdown.list")(d,_,"ol")+`

`);break;case"ul":m||(y=e.subParser("makeMarkdown.list")(d,_,"ul")+`

`);break;case"precode":m||(y=e.subParser("makeMarkdown.codeBlock")(d,_)+`

`);break;case"pre":m||(y=e.subParser("makeMarkdown.pre")(d,_)+`

`);break;case"table":m||(y=e.subParser("makeMarkdown.table")(d,_)+`

`);break;case"code":y=e.subParser("makeMarkdown.codeSpan")(d,_);break;case"em":case"i":y=e.subParser("makeMarkdown.emphasis")(d,_);break;case"strong":case"b":y=e.subParser("makeMarkdown.strong")(d,_);break;case"del":y=e.subParser("makeMarkdown.strikethrough")(d,_);break;case"a":y=e.subParser("makeMarkdown.links")(d,_);break;case"img":y=e.subParser("makeMarkdown.image")(d,_);break;default:y=d.outerHTML+`

`}return y}),e.subParser("makeMarkdown.paragraph",function(d,_){"use strict";var m="";if(d.hasChildNodes())for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);return m=m.trim(),m}),e.subParser("makeMarkdown.pre",function(d,_){"use strict";var m=d.getAttribute("prenum");return"<pre>"+_.preList[m]+"</pre>"}),e.subParser("makeMarkdown.strikethrough",function(d,_){"use strict";var m="";if(d.hasChildNodes()){m+="~~";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="~~"}return m}),e.subParser("makeMarkdown.strong",function(d,_){"use strict";var m="";if(d.hasChildNodes()){m+="**";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_);m+="**"}return m}),e.subParser("makeMarkdown.table",function(d,_){"use strict";var m="",y=[[],[]],x=d.querySelectorAll("thead>tr>th"),S=d.querySelectorAll("tbody>tr"),w,E;for(w=0;w<x.length;++w){var L=e.subParser("makeMarkdown.tableCell")(x[w],_),I="---";if(x[w].hasAttribute("style")){var A=x[w].getAttribute("style").toLowerCase().replace(/\s/g,"");switch(A){case"text-align:left;":I=":---";break;case"text-align:right;":I="---:";break;case"text-align:center;":I=":---:";break}}y[0][w]=L.trim(),y[1][w]=I}for(w=0;w<S.length;++w){var B=y.push([])-1,T=S[w].getElementsByTagName("td");for(E=0;E<x.length;++E){var M=" ";typeof T[E]!="undefined"&&(M=e.subParser("makeMarkdown.tableCell")(T[E],_)),y[B].push(M)}}var j=3;for(w=0;w<y.length;++w)for(E=0;E<y[w].length;++E){var J=y[w][E].length;J>j&&(j=J)}for(w=0;w<y.length;++w){for(E=0;E<y[w].length;++E)w===1?y[w][E].slice(-1)===":"?y[w][E]=e.helper.padEnd(y[w][E].slice(-1),j-1,"-")+":":y[w][E]=e.helper.padEnd(y[w][E],j,"-"):y[w][E]=e.helper.padEnd(y[w][E],j);m+="| "+y[w].join(" | ")+` |
`}return m.trim()}),e.subParser("makeMarkdown.tableCell",function(d,_){"use strict";var m="";if(!d.hasChildNodes())return"";for(var y=d.childNodes,x=y.length,S=0;S<x;++S)m+=e.subParser("makeMarkdown.node")(y[S],_,!0);return m.trim()}),e.subParser("makeMarkdown.txt",function(d){"use strict";var _=d.nodeValue;return _=_.replace(/ +/g," "),_=_.replace(/NBSP;/g," "),_=e.helper.unescapeHTMLEntities(_),_=_.replace(/([*_~|`])/g,"\\$1"),_=_.replace(/^(\s*)>/g,"\\$1>"),_=_.replace(/^#/gm,"\\#"),_=_.replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3"),_=_.replace(/^( {0,3}\d+)\./gm,"$1\\."),_=_.replace(/^( {0,3})([+-])/gm,"$1\\$2"),_=_.replace(/]([\s]*)\(/g,"\\]$1\\("),_=_.replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:"),_});var O=this;typeof define=="function"&&define.amd?define(function(){"use strict";return e}):typeof an!="undefined"&&an.exports?an.exports=e:O.showdown=e}).call(_d)});var Ld=ye((Da,ja)=>{(function(i,t){typeof Da=="object"&&typeof ja!="undefined"?ja.exports=t():typeof define=="function"&&define.amd?define(t):(i=typeof globalThis!="undefined"?globalThis:i||self,i.Cropper=t())})(Da,function(){"use strict";function i(D,R){var P=Object.keys(D);if(Object.getOwnPropertySymbols){var N=Object.getOwnPropertySymbols(D);R&&(N=N.filter(function(X){return Object.getOwnPropertyDescriptor(D,X).enumerable})),P.push.apply(P,N)}return P}function t(D){for(var R=1;R<arguments.length;R++){var P=arguments[R]!=null?arguments[R]:{};R%2?i(Object(P),!0).forEach(function(N){s(D,N,P[N])}):Object.getOwnPropertyDescriptors?Object.defineProperties(D,Object.getOwnPropertyDescriptors(P)):i(Object(P)).forEach(function(N){Object.defineProperty(D,N,Object.getOwnPropertyDescriptor(P,N))})}return D}function e(D){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(R){return typeof R}:e=function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},e(D)}function r(D,R){if(!(D instanceof R))throw new TypeError("Cannot call a class as a function")}function n(D,R){for(var P=0;P<R.length;P++){var N=R[P];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(D,N.key,N)}}function a(D,R,P){return R&&n(D.prototype,R),P&&n(D,P),D}function s(D,R,P){return R in D?Object.defineProperty(D,R,{value:P,enumerable:!0,configurable:!0,writable:!0}):D[R]=P,D}function o(D){return l(D)||u(D)||c(D)||p()}function l(D){if(Array.isArray(D))return h(D)}function u(D){if(typeof Symbol!="undefined"&&D[Symbol.iterator]!=null||D["@@iterator"]!=null)return Array.from(D)}function c(D,R){if(!!D){if(typeof D=="string")return h(D,R);var P=Object.prototype.toString.call(D).slice(8,-1);if(P==="Object"&&D.constructor&&(P=D.constructor.name),P==="Map"||P==="Set")return Array.from(D);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return h(D,R)}}function h(D,R){(R==null||R>D.length)&&(R=D.length);for(var P=0,N=new Array(R);P<R;P++)N[P]=D[P];return N}function p(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=typeof window!="undefined"&&typeof window.document!="undefined",b=g?window:{},v=g&&b.document.documentElement?"ontouchstart"in b.document.documentElement:!1,k=g?"PointerEvent"in b:!1,C="cropper",O="all",d="crop",_="move",m="zoom",y="e",x="w",S="s",w="n",E="ne",L="nw",I="se",A="sw",B="".concat(C,"-crop"),T="".concat(C,"-disabled"),M="".concat(C,"-hidden"),j="".concat(C,"-hide"),J="".concat(C,"-invisible"),U="".concat(C,"-modal"),H="".concat(C,"-move"),te="".concat(C,"Action"),se="".concat(C,"Preview"),W="crop",Y="move",ie="none",re="crop",Q="cropend",ee="cropmove",pe="cropstart",be="dblclick",we=v?"touchstart":"mousedown",Le=v?"touchmove":"mousemove",fe=v?"touchend touchcancel":"mouseup",xe=k?"pointerdown":we,Ne=k?"pointermove":Le,Be=k?"pointerup pointercancel":fe,Pe="ready",Ze="resize",tt="wheel",Xe="zoom",Ke="image/jpeg",nt=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,at=/^data:/,ce=/^data:image\/jpeg;base64,/,ve=/^img|canvas$/i,Ie=200,He=100,st={viewMode:0,dragMode:W,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Ie,minContainerHeight:He,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},vt='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',bt=Number.isNaN||b.isNaN;function Me(D){return typeof D=="number"&&!bt(D)}var yt=function(R){return R>0&&R<1/0};function Vt(D){return typeof D=="undefined"}function Ft(D){return e(D)==="object"&&D!==null}var Ye=Object.prototype.hasOwnProperty;function Ge(D){if(!Ft(D))return!1;try{var R=D.constructor,P=R.prototype;return R&&P&&Ye.call(P,"isPrototypeOf")}catch(N){return!1}}function Qe(D){return typeof D=="function"}var qe=Array.prototype.slice;function ei(D){return Array.from?Array.from(D):qe.call(D)}function dt(D,R){return D&&Qe(R)&&(Array.isArray(D)||Me(D.length)?ei(D).forEach(function(P,N){R.call(D,P,N,D)}):Ft(D)&&Object.keys(D).forEach(function(P){R.call(D,D[P],P,D)})),D}var De=Object.assign||function(R){for(var P=arguments.length,N=new Array(P>1?P-1:0),X=1;X<P;X++)N[X-1]=arguments[X];return Ft(R)&&N.length>0&&N.forEach(function(q){Ft(q)&&Object.keys(q).forEach(function(K){R[K]=q[K]})}),R},ti=/\.\d*(?:0|9){12}\d*$/;function et(D){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return ti.test(D)?Math.round(D*R)/R:D}var ii=/^width|height|left|top|marginLeft|marginTop$/;function It(D,R){var P=D.style;dt(R,function(N,X){ii.test(X)&&Me(N)&&(N="".concat(N,"px")),P[X]=N})}function di(D,R){return D.classList?D.classList.contains(R):D.className.indexOf(R)>-1}function pt(D,R){if(!!R){if(Me(D.length)){dt(D,function(N){pt(N,R)});return}if(D.classList){D.classList.add(R);return}var P=D.className.trim();P?P.indexOf(R)<0&&(D.className="".concat(P," ").concat(R)):D.className=R}}function Lt(D,R){if(!!R){if(Me(D.length)){dt(D,function(P){Lt(P,R)});return}if(D.classList){D.classList.remove(R);return}D.className.indexOf(R)>=0&&(D.className=D.className.replace(R,""))}}function Xt(D,R,P){if(!!R){if(Me(D.length)){dt(D,function(N){Xt(N,R,P)});return}P?pt(D,R):Lt(D,R)}}var xi=/([a-z\d])([A-Z])/g;function Nt(D){return D.replace(xi,"$1-$2").toLowerCase()}function ri(D,R){return Ft(D[R])?D[R]:D.dataset?D.dataset[R]:D.getAttribute("data-".concat(Nt(R)))}function Pt(D,R,P){Ft(P)?D[R]=P:D.dataset?D.dataset[R]=P:D.setAttribute("data-".concat(Nt(R)),P)}function hi(D,R){if(Ft(D[R]))try{delete D[R]}catch(P){D[R]=void 0}else if(D.dataset)try{delete D.dataset[R]}catch(P){D.dataset[R]=void 0}else D.removeAttribute("data-".concat(Nt(R)))}var Kt=/\s\s*/,ni=function(){var D=!1;if(g){var R=!1,P=function(){},N=Object.defineProperty({},"once",{get:function(){return D=!0,R},set:function(q){R=q}});b.addEventListener("test",P,N),b.removeEventListener("test",P,N)}return D}();function Tt(D,R,P){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},X=P;R.trim().split(Kt).forEach(function(q){if(!ni){var K=D.listeners;K&&K[q]&&K[q][P]&&(X=K[q][P],delete K[q][P],Object.keys(K[q]).length===0&&delete K[q],Object.keys(K).length===0&&delete D.listeners)}D.removeEventListener(q,X,N)})}function Et(D,R,P){var N=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},X=P;R.trim().split(Kt).forEach(function(q){if(N.once&&!ni){var K=D.listeners,oe=K===void 0?{}:K;X=function(){delete oe[q][P],D.removeEventListener(q,X,N);for(var me=arguments.length,he=new Array(me),_e=0;_e<me;_e++)he[_e]=arguments[_e];P.apply(D,he)},oe[q]||(oe[q]={}),oe[q][P]&&D.removeEventListener(q,oe[q][P],N),oe[q][P]=X,D.listeners=oe}D.addEventListener(q,X,N)})}function wt(D,R,P){var N;return Qe(Event)&&Qe(CustomEvent)?N=new CustomEvent(R,{detail:P,bubbles:!0,cancelable:!0}):(N=document.createEvent("CustomEvent"),N.initCustomEvent(R,!0,!0,P)),D.dispatchEvent(N)}function Ee(D){var R=D.getBoundingClientRect();return{left:R.left+(window.pageXOffset-document.documentElement.clientLeft),top:R.top+(window.pageYOffset-document.documentElement.clientTop)}}var Te=b.location,ze=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function z(D){var R=D.match(ze);return R!==null&&(R[1]!==Te.protocol||R[2]!==Te.hostname||R[3]!==Te.port)}function G(D){var R="timestamp=".concat(new Date().getTime());return D+(D.indexOf("?")===-1?"?":"&")+R}function Z(D){var R=D.rotate,P=D.scaleX,N=D.scaleY,X=D.translateX,q=D.translateY,K=[];Me(X)&&X!==0&&K.push("translateX(".concat(X,"px)")),Me(q)&&q!==0&&K.push("translateY(".concat(q,"px)")),Me(R)&&R!==0&&K.push("rotate(".concat(R,"deg)")),Me(P)&&P!==1&&K.push("scaleX(".concat(P,")")),Me(N)&&N!==1&&K.push("scaleY(".concat(N,")"));var oe=K.length?K.join(" "):"none";return{WebkitTransform:oe,msTransform:oe,transform:oe}}function de(D){var R=t({},D),P=0;return dt(D,function(N,X){delete R[X],dt(R,function(q){var K=Math.abs(N.startX-q.startX),oe=Math.abs(N.startY-q.startY),ge=Math.abs(N.endX-q.endX),me=Math.abs(N.endY-q.endY),he=Math.sqrt(K*K+oe*oe),_e=Math.sqrt(ge*ge+me*me),ke=(_e-he)/he;Math.abs(ke)>Math.abs(P)&&(P=ke)})}),P}function le(D,R){var P=D.pageX,N=D.pageY,X={endX:P,endY:N};return R?X:t({startX:P,startY:N},X)}function Ce(D){var R=0,P=0,N=0;return dt(D,function(X){var q=X.startX,K=X.startY;R+=q,P+=K,N+=1}),R/=N,P/=N,{pageX:R,pageY:P}}function Se(D){var R=D.aspectRatio,P=D.height,N=D.width,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",q=yt(N),K=yt(P);if(q&&K){var oe=P*R;X==="contain"&&oe>N||X==="cover"&&oe<N?P=N/R:N=P*R}else q?P=N/R:K&&(N=P*R);return{width:N,height:P}}function Re(D){var R=D.width,P=D.height,N=D.degree;if(N=Math.abs(N)%180,N===90)return{width:P,height:R};var X=N%90*Math.PI/180,q=Math.sin(X),K=Math.cos(X),oe=R*K+P*q,ge=R*q+P*K;return N>90?{width:ge,height:oe}:{width:oe,height:ge}}function Ae(D,R,P,N){var X=R.aspectRatio,q=R.naturalWidth,K=R.naturalHeight,oe=R.rotate,ge=oe===void 0?0:oe,me=R.scaleX,he=me===void 0?1:me,_e=R.scaleY,ke=_e===void 0?1:_e,je=P.aspectRatio,Ve=P.naturalWidth,ft=P.naturalHeight,ot=N.fillColor,kt=ot===void 0?"transparent":ot,Ot=N.imageSmoothingEnabled,Ct=Ot===void 0?!0:Ot,ai=N.imageSmoothingQuality,Dt=ai===void 0?"low":ai,Oe=N.maxWidth,ct=Oe===void 0?1/0:Oe,Rt=N.maxHeight,Jt=Rt===void 0?1/0:Rt,_i=N.minWidth,Ci=_i===void 0?0:_i,Si=N.minHeight,bi=Si===void 0?0:Si,fi=document.createElement("canvas"),qt=fi.getContext("2d"),Ti=Se({aspectRatio:je,width:ct,height:Jt}),Lr=Se({aspectRatio:je,width:Ci,height:bi},"cover"),Vn=Math.min(Ti.width,Math.max(Lr.width,Ve)),Yn=Math.min(Ti.height,Math.max(Lr.height,ft)),ms=Se({aspectRatio:X,width:ct,height:Jt}),gs=Se({aspectRatio:X,width:Ci,height:bi},"cover"),vs=Math.min(ms.width,Math.max(gs.width,q)),bs=Math.min(ms.height,Math.max(gs.height,K)),lp=[-vs/2,-bs/2,vs,bs];return fi.width=et(Vn),fi.height=et(Yn),qt.fillStyle=kt,qt.fillRect(0,0,Vn,Yn),qt.save(),qt.translate(Vn/2,Yn/2),qt.rotate(ge*Math.PI/180),qt.scale(he,ke),qt.imageSmoothingEnabled=Ct,qt.imageSmoothingQuality=Dt,qt.drawImage.apply(qt,[D].concat(o(lp.map(function(cp){return Math.floor(et(cp))})))),qt.restore(),fi}var $e=String.fromCharCode;function We(D,R,P){var N="";P+=R;for(var X=R;X<P;X+=1)N+=$e(D.getUint8(X));return N}var Fe=/^data:.*,/;function it(D){var R=D.replace(Fe,""),P=atob(R),N=new ArrayBuffer(P.length),X=new Uint8Array(N);return dt(X,function(q,K){X[K]=P.charCodeAt(K)}),N}function mt(D,R){for(var P=[],N=8192,X=new Uint8Array(D);X.length>0;)P.push($e.apply(null,ei(X.subarray(0,N)))),X=X.subarray(N);return"data:".concat(R,";base64,").concat(btoa(P.join("")))}function Je(D){var R=new DataView(D),P;try{var N,X,q;if(R.getUint8(0)===255&&R.getUint8(1)===216)for(var K=R.byteLength,oe=2;oe+1<K;){if(R.getUint8(oe)===255&&R.getUint8(oe+1)===225){X=oe;break}oe+=1}if(X){var ge=X+4,me=X+10;if(We(R,ge,4)==="Exif"){var he=R.getUint16(me);if(N=he===18761,(N||he===19789)&&R.getUint16(me+2,N)===42){var _e=R.getUint32(me+4,N);_e>=8&&(q=me+_e)}}}if(q){var ke=R.getUint16(q,N),je,Ve;for(Ve=0;Ve<ke;Ve+=1)if(je=q+Ve*12+2,R.getUint16(je,N)===274){je+=8,P=R.getUint16(je,N),R.setUint16(je,1,N);break}}}catch(ft){P=1}return P}function Ue(D){var R=0,P=1,N=1;switch(D){case 2:P=-1;break;case 3:R=-180;break;case 4:N=-1;break;case 5:R=90,N=-1;break;case 6:R=90;break;case 7:R=90,P=-1;break;case 8:R=-90;break}return{rotate:R,scaleX:P,scaleY:N}}var At={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var R=this.element,P=this.options,N=this.container,X=this.cropper,q=Number(P.minContainerWidth),K=Number(P.minContainerHeight);pt(X,M),Lt(R,M);var oe={width:Math.max(N.offsetWidth,q>=0?q:Ie),height:Math.max(N.offsetHeight,K>=0?K:He)};this.containerData=oe,It(X,{width:oe.width,height:oe.height}),pt(R,M),Lt(X,M)},initCanvas:function(){var R=this.containerData,P=this.imageData,N=this.options.viewMode,X=Math.abs(P.rotate)%180===90,q=X?P.naturalHeight:P.naturalWidth,K=X?P.naturalWidth:P.naturalHeight,oe=q/K,ge=R.width,me=R.height;R.height*oe>R.width?N===3?ge=R.height*oe:me=R.width/oe:N===3?me=R.width/oe:ge=R.height*oe;var he={aspectRatio:oe,naturalWidth:q,naturalHeight:K,width:ge,height:me};this.canvasData=he,this.limited=N===1||N===2,this.limitCanvas(!0,!0),he.width=Math.min(Math.max(he.width,he.minWidth),he.maxWidth),he.height=Math.min(Math.max(he.height,he.minHeight),he.maxHeight),he.left=(R.width-he.width)/2,he.top=(R.height-he.height)/2,he.oldLeft=he.left,he.oldTop=he.top,this.initialCanvasData=De({},he)},limitCanvas:function(R,P){var N=this.options,X=this.containerData,q=this.canvasData,K=this.cropBoxData,oe=N.viewMode,ge=q.aspectRatio,me=this.cropped&&K;if(R){var he=Number(N.minCanvasWidth)||0,_e=Number(N.minCanvasHeight)||0;oe>1?(he=Math.max(he,X.width),_e=Math.max(_e,X.height),oe===3&&(_e*ge>he?he=_e*ge:_e=he/ge)):oe>0&&(he?he=Math.max(he,me?K.width:0):_e?_e=Math.max(_e,me?K.height:0):me&&(he=K.width,_e=K.height,_e*ge>he?he=_e*ge:_e=he/ge));var ke=Se({aspectRatio:ge,width:he,height:_e});he=ke.width,_e=ke.height,q.minWidth=he,q.minHeight=_e,q.maxWidth=1/0,q.maxHeight=1/0}if(P)if(oe>(me?0:1)){var je=X.width-q.width,Ve=X.height-q.height;q.minLeft=Math.min(0,je),q.minTop=Math.min(0,Ve),q.maxLeft=Math.max(0,je),q.maxTop=Math.max(0,Ve),me&&this.limited&&(q.minLeft=Math.min(K.left,K.left+(K.width-q.width)),q.minTop=Math.min(K.top,K.top+(K.height-q.height)),q.maxLeft=K.left,q.maxTop=K.top,oe===2&&(q.width>=X.width&&(q.minLeft=Math.min(0,je),q.maxLeft=Math.max(0,je)),q.height>=X.height&&(q.minTop=Math.min(0,Ve),q.maxTop=Math.max(0,Ve))))}else q.minLeft=-q.width,q.minTop=-q.height,q.maxLeft=X.width,q.maxTop=X.height},renderCanvas:function(R,P){var N=this.canvasData,X=this.imageData;if(P){var q=Re({width:X.naturalWidth*Math.abs(X.scaleX||1),height:X.naturalHeight*Math.abs(X.scaleY||1),degree:X.rotate||0}),K=q.width,oe=q.height,ge=N.width*(K/N.naturalWidth),me=N.height*(oe/N.naturalHeight);N.left-=(ge-N.width)/2,N.top-=(me-N.height)/2,N.width=ge,N.height=me,N.aspectRatio=K/oe,N.naturalWidth=K,N.naturalHeight=oe,this.limitCanvas(!0,!1)}(N.width>N.maxWidth||N.width<N.minWidth)&&(N.left=N.oldLeft),(N.height>N.maxHeight||N.height<N.minHeight)&&(N.top=N.oldTop),N.width=Math.min(Math.max(N.width,N.minWidth),N.maxWidth),N.height=Math.min(Math.max(N.height,N.minHeight),N.maxHeight),this.limitCanvas(!1,!0),N.left=Math.min(Math.max(N.left,N.minLeft),N.maxLeft),N.top=Math.min(Math.max(N.top,N.minTop),N.maxTop),N.oldLeft=N.left,N.oldTop=N.top,It(this.canvas,De({width:N.width,height:N.height},Z({translateX:N.left,translateY:N.top}))),this.renderImage(R),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(R){var P=this.canvasData,N=this.imageData,X=N.naturalWidth*(P.width/P.naturalWidth),q=N.naturalHeight*(P.height/P.naturalHeight);De(N,{width:X,height:q,left:(P.width-X)/2,top:(P.height-q)/2}),It(this.image,De({width:N.width,height:N.height},Z(De({translateX:N.left,translateY:N.top},N)))),R&&this.output()},initCropBox:function(){var R=this.options,P=this.canvasData,N=R.aspectRatio||R.initialAspectRatio,X=Number(R.autoCropArea)||.8,q={width:P.width,height:P.height};N&&(P.height*N>P.width?q.height=q.width/N:q.width=q.height*N),this.cropBoxData=q,this.limitCropBox(!0,!0),q.width=Math.min(Math.max(q.width,q.minWidth),q.maxWidth),q.height=Math.min(Math.max(q.height,q.minHeight),q.maxHeight),q.width=Math.max(q.minWidth,q.width*X),q.height=Math.max(q.minHeight,q.height*X),q.left=P.left+(P.width-q.width)/2,q.top=P.top+(P.height-q.height)/2,q.oldLeft=q.left,q.oldTop=q.top,this.initialCropBoxData=De({},q)},limitCropBox:function(R,P){var N=this.options,X=this.containerData,q=this.canvasData,K=this.cropBoxData,oe=this.limited,ge=N.aspectRatio;if(R){var me=Number(N.minCropBoxWidth)||0,he=Number(N.minCropBoxHeight)||0,_e=oe?Math.min(X.width,q.width,q.width+q.left,X.width-q.left):X.width,ke=oe?Math.min(X.height,q.height,q.height+q.top,X.height-q.top):X.height;me=Math.min(me,X.width),he=Math.min(he,X.height),ge&&(me&&he?he*ge>me?he=me/ge:me=he*ge:me?he=me/ge:he&&(me=he*ge),ke*ge>_e?ke=_e/ge:_e=ke*ge),K.minWidth=Math.min(me,_e),K.minHeight=Math.min(he,ke),K.maxWidth=_e,K.maxHeight=ke}P&&(oe?(K.minLeft=Math.max(0,q.left),K.minTop=Math.max(0,q.top),K.maxLeft=Math.min(X.width,q.left+q.width)-K.width,K.maxTop=Math.min(X.height,q.top+q.height)-K.height):(K.minLeft=0,K.minTop=0,K.maxLeft=X.width-K.width,K.maxTop=X.height-K.height))},renderCropBox:function(){var R=this.options,P=this.containerData,N=this.cropBoxData;(N.width>N.maxWidth||N.width<N.minWidth)&&(N.left=N.oldLeft),(N.height>N.maxHeight||N.height<N.minHeight)&&(N.top=N.oldTop),N.width=Math.min(Math.max(N.width,N.minWidth),N.maxWidth),N.height=Math.min(Math.max(N.height,N.minHeight),N.maxHeight),this.limitCropBox(!1,!0),N.left=Math.min(Math.max(N.left,N.minLeft),N.maxLeft),N.top=Math.min(Math.max(N.top,N.minTop),N.maxTop),N.oldLeft=N.left,N.oldTop=N.top,R.movable&&R.cropBoxMovable&&Pt(this.face,te,N.width>=P.width&&N.height>=P.height?_:O),It(this.cropBox,De({width:N.width,height:N.height},Z({translateX:N.left,translateY:N.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),wt(this.element,re,this.getData())}},$t={initPreview:function(){var R=this.element,P=this.crossOrigin,N=this.options.preview,X=P?this.crossOriginUrl:this.url,q=R.alt||"The image to preview",K=document.createElement("img");if(P&&(K.crossOrigin=P),K.src=X,K.alt=q,this.viewBox.appendChild(K),this.viewBoxImage=K,!!N){var oe=N;typeof N=="string"?oe=R.ownerDocument.querySelectorAll(N):N.querySelector&&(oe=[N]),this.previews=oe,dt(oe,function(ge){var me=document.createElement("img");Pt(ge,se,{width:ge.offsetWidth,height:ge.offsetHeight,html:ge.innerHTML}),P&&(me.crossOrigin=P),me.src=X,me.alt=q,me.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',ge.innerHTML="",ge.appendChild(me)})}},resetPreview:function(){dt(this.previews,function(R){var P=ri(R,se);It(R,{width:P.width,height:P.height}),R.innerHTML=P.html,hi(R,se)})},preview:function(){var R=this.imageData,P=this.canvasData,N=this.cropBoxData,X=N.width,q=N.height,K=R.width,oe=R.height,ge=N.left-P.left-R.left,me=N.top-P.top-R.top;!this.cropped||this.disabled||(It(this.viewBoxImage,De({width:K,height:oe},Z(De({translateX:-ge,translateY:-me},R)))),dt(this.previews,function(he){var _e=ri(he,se),ke=_e.width,je=_e.height,Ve=ke,ft=je,ot=1;X&&(ot=ke/X,ft=q*ot),q&&ft>je&&(ot=je/q,Ve=X*ot,ft=je),It(he,{width:Ve,height:ft}),It(he.getElementsByTagName("img")[0],De({width:K*ot,height:oe*ot},Z(De({translateX:-ge*ot,translateY:-me*ot},R))))}))}},xt={bind:function(){var R=this.element,P=this.options,N=this.cropper;Qe(P.cropstart)&&Et(R,pe,P.cropstart),Qe(P.cropmove)&&Et(R,ee,P.cropmove),Qe(P.cropend)&&Et(R,Q,P.cropend),Qe(P.crop)&&Et(R,re,P.crop),Qe(P.zoom)&&Et(R,Xe,P.zoom),Et(N,xe,this.onCropStart=this.cropStart.bind(this)),P.zoomable&&P.zoomOnWheel&&Et(N,tt,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),P.toggleDragModeOnDblclick&&Et(N,be,this.onDblclick=this.dblclick.bind(this)),Et(R.ownerDocument,Ne,this.onCropMove=this.cropMove.bind(this)),Et(R.ownerDocument,Be,this.onCropEnd=this.cropEnd.bind(this)),P.responsive&&Et(window,Ze,this.onResize=this.resize.bind(this))},unbind:function(){var R=this.element,P=this.options,N=this.cropper;Qe(P.cropstart)&&Tt(R,pe,P.cropstart),Qe(P.cropmove)&&Tt(R,ee,P.cropmove),Qe(P.cropend)&&Tt(R,Q,P.cropend),Qe(P.crop)&&Tt(R,re,P.crop),Qe(P.zoom)&&Tt(R,Xe,P.zoom),Tt(N,xe,this.onCropStart),P.zoomable&&P.zoomOnWheel&&Tt(N,tt,this.onWheel,{passive:!1,capture:!0}),P.toggleDragModeOnDblclick&&Tt(N,be,this.onDblclick),Tt(R.ownerDocument,Ne,this.onCropMove),Tt(R.ownerDocument,Be,this.onCropEnd),P.responsive&&Tt(window,Ze,this.onResize)}},St={resize:function(){if(!this.disabled){var R=this.options,P=this.container,N=this.containerData,X=P.offsetWidth/N.width,q=P.offsetHeight/N.height,K=Math.abs(X-1)>Math.abs(q-1)?X:q;if(K!==1){var oe,ge;R.restore&&(oe=this.getCanvasData(),ge=this.getCropBoxData()),this.render(),R.restore&&(this.setCanvasData(dt(oe,function(me,he){oe[he]=me*K})),this.setCropBoxData(dt(ge,function(me,he){ge[he]=me*K})))}}},dblclick:function(){this.disabled||this.options.dragMode===ie||this.setDragMode(di(this.dragBox,B)?Y:W)},wheel:function(R){var P=this,N=Number(this.options.wheelZoomRatio)||.1,X=1;this.disabled||(R.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){P.wheeling=!1},50),R.deltaY?X=R.deltaY>0?1:-1:R.wheelDelta?X=-R.wheelDelta/120:R.detail&&(X=R.detail>0?1:-1),this.zoom(-X*N,R)))},cropStart:function(R){var P=R.buttons,N=R.button;if(!(this.disabled||(R.type==="mousedown"||R.type==="pointerdown"&&R.pointerType==="mouse")&&(Me(P)&&P!==1||Me(N)&&N!==0||R.ctrlKey))){var X=this.options,q=this.pointers,K;R.changedTouches?dt(R.changedTouches,function(oe){q[oe.identifier]=le(oe)}):q[R.pointerId||0]=le(R),Object.keys(q).length>1&&X.zoomable&&X.zoomOnTouch?K=m:K=ri(R.target,te),!!nt.test(K)&&wt(this.element,pe,{originalEvent:R,action:K})!==!1&&(R.preventDefault(),this.action=K,this.cropping=!1,K===d&&(this.cropping=!0,pt(this.dragBox,U)))}},cropMove:function(R){var P=this.action;if(!(this.disabled||!P)){var N=this.pointers;R.preventDefault(),wt(this.element,ee,{originalEvent:R,action:P})!==!1&&(R.changedTouches?dt(R.changedTouches,function(X){De(N[X.identifier]||{},le(X,!0))}):De(N[R.pointerId||0]||{},le(R,!0)),this.change(R))}},cropEnd:function(R){if(!this.disabled){var P=this.action,N=this.pointers;R.changedTouches?dt(R.changedTouches,function(X){delete N[X.identifier]}):delete N[R.pointerId||0],P&&(R.preventDefault(),Object.keys(N).length||(this.action=""),this.cropping&&(this.cropping=!1,Xt(this.dragBox,U,this.cropped&&this.options.modal)),wt(this.element,Q,{originalEvent:R,action:P}))}}},F={change:function(R){var P=this.options,N=this.canvasData,X=this.containerData,q=this.cropBoxData,K=this.pointers,oe=this.action,ge=P.aspectRatio,me=q.left,he=q.top,_e=q.width,ke=q.height,je=me+_e,Ve=he+ke,ft=0,ot=0,kt=X.width,Ot=X.height,Ct=!0,ai;!ge&&R.shiftKey&&(ge=_e&&ke?_e/ke:1),this.limited&&(ft=q.minLeft,ot=q.minTop,kt=ft+Math.min(X.width,N.width,N.left+N.width),Ot=ot+Math.min(X.height,N.height,N.top+N.height));var Dt=K[Object.keys(K)[0]],Oe={x:Dt.endX-Dt.startX,y:Dt.endY-Dt.startY},ct=function(Jt){switch(Jt){case y:je+Oe.x>kt&&(Oe.x=kt-je);break;case x:me+Oe.x<ft&&(Oe.x=ft-me);break;case w:he+Oe.y<ot&&(Oe.y=ot-he);break;case S:Ve+Oe.y>Ot&&(Oe.y=Ot-Ve);break}};switch(oe){case O:me+=Oe.x,he+=Oe.y;break;case y:if(Oe.x>=0&&(je>=kt||ge&&(he<=ot||Ve>=Ot))){Ct=!1;break}ct(y),_e+=Oe.x,_e<0&&(oe=x,_e=-_e,me-=_e),ge&&(ke=_e/ge,he+=(q.height-ke)/2);break;case w:if(Oe.y<=0&&(he<=ot||ge&&(me<=ft||je>=kt))){Ct=!1;break}ct(w),ke-=Oe.y,he+=Oe.y,ke<0&&(oe=S,ke=-ke,he-=ke),ge&&(_e=ke*ge,me+=(q.width-_e)/2);break;case x:if(Oe.x<=0&&(me<=ft||ge&&(he<=ot||Ve>=Ot))){Ct=!1;break}ct(x),_e-=Oe.x,me+=Oe.x,_e<0&&(oe=y,_e=-_e,me-=_e),ge&&(ke=_e/ge,he+=(q.height-ke)/2);break;case S:if(Oe.y>=0&&(Ve>=Ot||ge&&(me<=ft||je>=kt))){Ct=!1;break}ct(S),ke+=Oe.y,ke<0&&(oe=w,ke=-ke,he-=ke),ge&&(_e=ke*ge,me+=(q.width-_e)/2);break;case E:if(ge){if(Oe.y<=0&&(he<=ot||je>=kt)){Ct=!1;break}ct(w),ke-=Oe.y,he+=Oe.y,_e=ke*ge}else ct(w),ct(y),Oe.x>=0?je<kt?_e+=Oe.x:Oe.y<=0&&he<=ot&&(Ct=!1):_e+=Oe.x,Oe.y<=0?he>ot&&(ke-=Oe.y,he+=Oe.y):(ke-=Oe.y,he+=Oe.y);_e<0&&ke<0?(oe=A,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(oe=L,_e=-_e,me-=_e):ke<0&&(oe=I,ke=-ke,he-=ke);break;case L:if(ge){if(Oe.y<=0&&(he<=ot||me<=ft)){Ct=!1;break}ct(w),ke-=Oe.y,he+=Oe.y,_e=ke*ge,me+=q.width-_e}else ct(w),ct(x),Oe.x<=0?me>ft?(_e-=Oe.x,me+=Oe.x):Oe.y<=0&&he<=ot&&(Ct=!1):(_e-=Oe.x,me+=Oe.x),Oe.y<=0?he>ot&&(ke-=Oe.y,he+=Oe.y):(ke-=Oe.y,he+=Oe.y);_e<0&&ke<0?(oe=I,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(oe=E,_e=-_e,me-=_e):ke<0&&(oe=A,ke=-ke,he-=ke);break;case A:if(ge){if(Oe.x<=0&&(me<=ft||Ve>=Ot)){Ct=!1;break}ct(x),_e-=Oe.x,me+=Oe.x,ke=_e/ge}else ct(S),ct(x),Oe.x<=0?me>ft?(_e-=Oe.x,me+=Oe.x):Oe.y>=0&&Ve>=Ot&&(Ct=!1):(_e-=Oe.x,me+=Oe.x),Oe.y>=0?Ve<Ot&&(ke+=Oe.y):ke+=Oe.y;_e<0&&ke<0?(oe=E,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(oe=I,_e=-_e,me-=_e):ke<0&&(oe=L,ke=-ke,he-=ke);break;case I:if(ge){if(Oe.x>=0&&(je>=kt||Ve>=Ot)){Ct=!1;break}ct(y),_e+=Oe.x,ke=_e/ge}else ct(S),ct(y),Oe.x>=0?je<kt?_e+=Oe.x:Oe.y>=0&&Ve>=Ot&&(Ct=!1):_e+=Oe.x,Oe.y>=0?Ve<Ot&&(ke+=Oe.y):ke+=Oe.y;_e<0&&ke<0?(oe=L,ke=-ke,_e=-_e,he-=ke,me-=_e):_e<0?(oe=A,_e=-_e,me-=_e):ke<0&&(oe=E,ke=-ke,he-=ke);break;case _:this.move(Oe.x,Oe.y),Ct=!1;break;case m:this.zoom(de(K),R),Ct=!1;break;case d:if(!Oe.x||!Oe.y){Ct=!1;break}ai=Ee(this.cropper),me=Dt.startX-ai.left,he=Dt.startY-ai.top,_e=q.minWidth,ke=q.minHeight,Oe.x>0?oe=Oe.y>0?I:E:Oe.x<0&&(me-=_e,oe=Oe.y>0?A:L),Oe.y<0&&(he-=ke),this.cropped||(Lt(this.cropBox,M),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}Ct&&(q.width=_e,q.height=ke,q.left=me,q.top=he,this.action=oe,this.renderCropBox()),dt(K,function(Rt){Rt.startX=Rt.endX,Rt.startY=Rt.endY})}},ne={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&pt(this.dragBox,U),Lt(this.cropBox,M),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=De({},this.initialImageData),this.canvasData=De({},this.initialCanvasData),this.cropBoxData=De({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(De(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),Lt(this.dragBox,U),pt(this.cropBox,M)),this},replace:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&R&&(this.isImg&&(this.element.src=R),P?(this.url=R,this.image.src=R,this.ready&&(this.viewBoxImage.src=R,dt(this.previews,function(N){N.getElementsByTagName("img")[0].src=R}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(R))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,Lt(this.cropper,T)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,pt(this.cropper,T)),this},destroy:function(){var R=this.element;return R[C]?(R[C]=void 0,this.isImg&&this.replaced&&(R.src=this.originalUrl),this.uncreate(),this):this},move:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,N=this.canvasData,X=N.left,q=N.top;return this.moveTo(Vt(R)?R:X+Number(R),Vt(P)?P:q+Number(P))},moveTo:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,N=this.canvasData,X=!1;return R=Number(R),P=Number(P),this.ready&&!this.disabled&&this.options.movable&&(Me(R)&&(N.left=R,X=!0),Me(P)&&(N.top=P,X=!0),X&&this.renderCanvas(!0)),this},zoom:function(R,P){var N=this.canvasData;return R=Number(R),R<0?R=1/(1-R):R=1+R,this.zoomTo(N.width*R/N.naturalWidth,null,P)},zoomTo:function(R,P,N){var X=this.options,q=this.canvasData,K=q.width,oe=q.height,ge=q.naturalWidth,me=q.naturalHeight;if(R=Number(R),R>=0&&this.ready&&!this.disabled&&X.zoomable){var he=ge*R,_e=me*R;if(wt(this.element,Xe,{ratio:R,oldRatio:K/ge,originalEvent:N})===!1)return this;if(N){var ke=this.pointers,je=Ee(this.cropper),Ve=ke&&Object.keys(ke).length?Ce(ke):{pageX:N.pageX,pageY:N.pageY};q.left-=(he-K)*((Ve.pageX-je.left-q.left)/K),q.top-=(_e-oe)*((Ve.pageY-je.top-q.top)/oe)}else Ge(P)&&Me(P.x)&&Me(P.y)?(q.left-=(he-K)*((P.x-q.left)/K),q.top-=(_e-oe)*((P.y-q.top)/oe)):(q.left-=(he-K)/2,q.top-=(_e-oe)/2);q.width=he,q.height=_e,this.renderCanvas(!0)}return this},rotate:function(R){return this.rotateTo((this.imageData.rotate||0)+Number(R))},rotateTo:function(R){return R=Number(R),Me(R)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=R%360,this.renderCanvas(!0,!0)),this},scaleX:function(R){var P=this.imageData.scaleY;return this.scale(R,Me(P)?P:1)},scaleY:function(R){var P=this.imageData.scaleX;return this.scale(Me(P)?P:1,R)},scale:function(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R,N=this.imageData,X=!1;return R=Number(R),P=Number(P),this.ready&&!this.disabled&&this.options.scalable&&(Me(R)&&(N.scaleX=R,X=!0),Me(P)&&(N.scaleY=P,X=!0),X&&this.renderCanvas(!0,!0)),this},getData:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,P=this.options,N=this.imageData,X=this.canvasData,q=this.cropBoxData,K;if(this.ready&&this.cropped){K={x:q.left-X.left,y:q.top-X.top,width:q.width,height:q.height};var oe=N.width/N.naturalWidth;if(dt(K,function(he,_e){K[_e]=he/oe}),R){var ge=Math.round(K.y+K.height),me=Math.round(K.x+K.width);K.x=Math.round(K.x),K.y=Math.round(K.y),K.width=me-K.x,K.height=ge-K.y}}else K={x:0,y:0,width:0,height:0};return P.rotatable&&(K.rotate=N.rotate||0),P.scalable&&(K.scaleX=N.scaleX||1,K.scaleY=N.scaleY||1),K},setData:function(R){var P=this.options,N=this.imageData,X=this.canvasData,q={};if(this.ready&&!this.disabled&&Ge(R)){var K=!1;P.rotatable&&Me(R.rotate)&&R.rotate!==N.rotate&&(N.rotate=R.rotate,K=!0),P.scalable&&(Me(R.scaleX)&&R.scaleX!==N.scaleX&&(N.scaleX=R.scaleX,K=!0),Me(R.scaleY)&&R.scaleY!==N.scaleY&&(N.scaleY=R.scaleY,K=!0)),K&&this.renderCanvas(!0,!0);var oe=N.width/N.naturalWidth;Me(R.x)&&(q.left=R.x*oe+X.left),Me(R.y)&&(q.top=R.y*oe+X.top),Me(R.width)&&(q.width=R.width*oe),Me(R.height)&&(q.height=R.height*oe),this.setCropBoxData(q)}return this},getContainerData:function(){return this.ready?De({},this.containerData):{}},getImageData:function(){return this.sized?De({},this.imageData):{}},getCanvasData:function(){var R=this.canvasData,P={};return this.ready&&dt(["left","top","width","height","naturalWidth","naturalHeight"],function(N){P[N]=R[N]}),P},setCanvasData:function(R){var P=this.canvasData,N=P.aspectRatio;return this.ready&&!this.disabled&&Ge(R)&&(Me(R.left)&&(P.left=R.left),Me(R.top)&&(P.top=R.top),Me(R.width)?(P.width=R.width,P.height=R.width/N):Me(R.height)&&(P.height=R.height,P.width=R.height*N),this.renderCanvas(!0)),this},getCropBoxData:function(){var R=this.cropBoxData,P;return this.ready&&this.cropped&&(P={left:R.left,top:R.top,width:R.width,height:R.height}),P||{}},setCropBoxData:function(R){var P=this.cropBoxData,N=this.options.aspectRatio,X,q;return this.ready&&this.cropped&&!this.disabled&&Ge(R)&&(Me(R.left)&&(P.left=R.left),Me(R.top)&&(P.top=R.top),Me(R.width)&&R.width!==P.width&&(X=!0,P.width=R.width),Me(R.height)&&R.height!==P.height&&(q=!0,P.height=R.height),N&&(X?P.height=P.width/N:q&&(P.width=P.height*N)),this.renderCropBox()),this},getCroppedCanvas:function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var P=this.canvasData,N=Ae(this.image,this.imageData,P,R);if(!this.cropped)return N;var X=this.getData(),q=X.x,K=X.y,oe=X.width,ge=X.height,me=N.width/Math.floor(P.naturalWidth);me!==1&&(q*=me,K*=me,oe*=me,ge*=me);var he=oe/ge,_e=Se({aspectRatio:he,width:R.maxWidth||1/0,height:R.maxHeight||1/0}),ke=Se({aspectRatio:he,width:R.minWidth||0,height:R.minHeight||0},"cover"),je=Se({aspectRatio:he,width:R.width||(me!==1?N.width:oe),height:R.height||(me!==1?N.height:ge)}),Ve=je.width,ft=je.height;Ve=Math.min(_e.width,Math.max(ke.width,Ve)),ft=Math.min(_e.height,Math.max(ke.height,ft));var ot=document.createElement("canvas"),kt=ot.getContext("2d");ot.width=et(Ve),ot.height=et(ft),kt.fillStyle=R.fillColor||"transparent",kt.fillRect(0,0,Ve,ft);var Ot=R.imageSmoothingEnabled,Ct=Ot===void 0?!0:Ot,ai=R.imageSmoothingQuality;kt.imageSmoothingEnabled=Ct,ai&&(kt.imageSmoothingQuality=ai);var Dt=N.width,Oe=N.height,ct=q,Rt=K,Jt,_i,Ci,Si,bi,fi;ct<=-oe||ct>Dt?(ct=0,Jt=0,Ci=0,bi=0):ct<=0?(Ci=-ct,ct=0,Jt=Math.min(Dt,oe+ct),bi=Jt):ct<=Dt&&(Ci=0,Jt=Math.min(oe,Dt-ct),bi=Jt),Jt<=0||Rt<=-ge||Rt>Oe?(Rt=0,_i=0,Si=0,fi=0):Rt<=0?(Si=-Rt,Rt=0,_i=Math.min(Oe,ge+Rt),fi=_i):Rt<=Oe&&(Si=0,_i=Math.min(ge,Oe-Rt),fi=_i);var qt=[ct,Rt,Jt,_i];if(bi>0&&fi>0){var Ti=Ve/oe;qt.push(Ci*Ti,Si*Ti,bi*Ti,fi*Ti)}return kt.drawImage.apply(kt,[N].concat(o(qt.map(function(Lr){return Math.floor(et(Lr))})))),ot},setAspectRatio:function(R){var P=this.options;return!this.disabled&&!Vt(R)&&(P.aspectRatio=Math.max(0,R)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(R){var P=this.options,N=this.dragBox,X=this.face;if(this.ready&&!this.disabled){var q=R===W,K=P.movable&&R===Y;R=q||K?R:ie,P.dragMode=R,Pt(N,te,R),Xt(N,B,q),Xt(N,H,K),P.cropBoxMovable||(Pt(X,te,R),Xt(X,B,q),Xt(X,H,K))}return this}},V=b.Cropper,ae=function(){function D(R){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r(this,D),!R||!ve.test(R.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=R,this.options=De({},st,Ge(P)&&P),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return a(D,[{key:"init",value:function(){var P=this.element,N=P.tagName.toLowerCase(),X;if(!P[C]){if(P[C]=this,N==="img"){if(this.isImg=!0,X=P.getAttribute("src")||"",this.originalUrl=X,!X)return;X=P.src}else N==="canvas"&&window.HTMLCanvasElement&&(X=P.toDataURL());this.load(X)}}},{key:"load",value:function(P){var N=this;if(!!P){this.url=P,this.imageData={};var X=this.element,q=this.options;if(!q.rotatable&&!q.scalable&&(q.checkOrientation=!1),!q.checkOrientation||!window.ArrayBuffer){this.clone();return}if(at.test(P)){ce.test(P)?this.read(it(P)):this.clone();return}var K=new XMLHttpRequest,oe=this.clone.bind(this);this.reloading=!0,this.xhr=K,K.onabort=oe,K.onerror=oe,K.ontimeout=oe,K.onprogress=function(){K.getResponseHeader("content-type")!==Ke&&K.abort()},K.onload=function(){N.read(K.response)},K.onloadend=function(){N.reloading=!1,N.xhr=null},q.checkCrossOrigin&&z(P)&&X.crossOrigin&&(P=G(P)),K.open("GET",P,!0),K.responseType="arraybuffer",K.withCredentials=X.crossOrigin==="use-credentials",K.send()}}},{key:"read",value:function(P){var N=this.options,X=this.imageData,q=Je(P),K=0,oe=1,ge=1;if(q>1){this.url=mt(P,Ke);var me=Ue(q);K=me.rotate,oe=me.scaleX,ge=me.scaleY}N.rotatable&&(X.rotate=K),N.scalable&&(X.scaleX=oe,X.scaleY=ge),this.clone()}},{key:"clone",value:function(){var P=this.element,N=this.url,X=P.crossOrigin,q=N;this.options.checkCrossOrigin&&z(N)&&(X||(X="anonymous"),q=G(N)),this.crossOrigin=X,this.crossOriginUrl=q;var K=document.createElement("img");X&&(K.crossOrigin=X),K.src=q||N,K.alt=P.alt||"The image to crop",this.image=K,K.onload=this.start.bind(this),K.onerror=this.stop.bind(this),pt(K,j),P.parentNode.insertBefore(K,P.nextSibling)}},{key:"start",value:function(){var P=this,N=this.image;N.onload=null,N.onerror=null,this.sizing=!0;var X=b.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(b.navigator.userAgent),q=function(me,he){De(P.imageData,{naturalWidth:me,naturalHeight:he,aspectRatio:me/he}),P.initialImageData=De({},P.imageData),P.sizing=!1,P.sized=!0,P.build()};if(N.naturalWidth&&!X){q(N.naturalWidth,N.naturalHeight);return}var K=document.createElement("img"),oe=document.body||document.documentElement;this.sizingImage=K,K.onload=function(){q(K.width,K.height),X||oe.removeChild(K)},K.src=N.src,X||(K.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",oe.appendChild(K))}},{key:"stop",value:function(){var P=this.image;P.onload=null,P.onerror=null,P.parentNode.removeChild(P),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var P=this.element,N=this.options,X=this.image,q=P.parentNode,K=document.createElement("div");K.innerHTML=vt;var oe=K.querySelector(".".concat(C,"-container")),ge=oe.querySelector(".".concat(C,"-canvas")),me=oe.querySelector(".".concat(C,"-drag-box")),he=oe.querySelector(".".concat(C,"-crop-box")),_e=he.querySelector(".".concat(C,"-face"));this.container=q,this.cropper=oe,this.canvas=ge,this.dragBox=me,this.cropBox=he,this.viewBox=oe.querySelector(".".concat(C,"-view-box")),this.face=_e,ge.appendChild(X),pt(P,M),q.insertBefore(oe,P.nextSibling),this.isImg||Lt(X,j),this.initPreview(),this.bind(),N.initialAspectRatio=Math.max(0,N.initialAspectRatio)||NaN,N.aspectRatio=Math.max(0,N.aspectRatio)||NaN,N.viewMode=Math.max(0,Math.min(3,Math.round(N.viewMode)))||0,pt(he,M),N.guides||pt(he.getElementsByClassName("".concat(C,"-dashed")),M),N.center||pt(he.getElementsByClassName("".concat(C,"-center")),M),N.background&&pt(oe,"".concat(C,"-bg")),N.highlight||pt(_e,J),N.cropBoxMovable&&(pt(_e,H),Pt(_e,te,O)),N.cropBoxResizable||(pt(he.getElementsByClassName("".concat(C,"-line")),M),pt(he.getElementsByClassName("".concat(C,"-point")),M)),this.render(),this.ready=!0,this.setDragMode(N.dragMode),N.autoCrop&&this.crop(),this.setData(N.data),Qe(N.ready)&&Et(P,Pe,N.ready,{once:!0}),wt(P,Pe)}}},{key:"unbuild",value:function(){!this.ready||(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),Lt(this.element,M))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=V,D}},{key:"setDefaults",value:function(P){De(st,Ge(P)&&P)}}]),D}();return De(ae.prototype,At,$t,xt,St,F,ne),ae})});var Dd=ye((exports,module)=>{frappe.provide("frappe.search");frappe.provide("frappe.tags");frappe.search.AwesomeBar=class{setup(i){var t=this;$(".search-bar").removeClass("hidden");var e=$(i),r=e.get(0);this.options=[],this.global_results=[];var n=new Awesomplete(r,{minChars:0,maxItems:99,autoFirst:!0,list:[],filter:function(s,o){return!0},data:function(s,o){return{label:s.index||"",value:s.value}},item:function(s,o){var l=this.get_item(s.value),u=__(l.label||l.value),c="<span>"+u+"</span>";return l.description&&l.value!==l.description&&(c+='<br><span class="text-muted ellipsis">'+__(l.description)+"</span>"),$("<li></li>").data("item.autocomplete",l).html(`<a style="font-weight:normal">${c}</a>`).get(0)},sort:function(s,o){return o.label-s.label}});r.awesomplete=n,this.awesomplete=n,e.on("input",frappe.utils.debounce(function(s){var o=s.target.value,l=o.trim().replace(/\s\s+/g," "),u=l.lastIndexOf(" ");t.global_results=[],t.options=[],l&&l.length>1?(u!==-1&&t.set_specifics(l.slice(0,u),l.slice(u+1)),t.add_defaults(l),t.options=t.options.concat(t.build_options(l)),t.options=t.options.concat(t.global_results)):(t.options=t.options.concat(t.deduplicate(frappe.search.utils.get_recent_pages(l||""))),t.options=t.options.concat(frappe.search.utils.get_frequent_links())),t.add_help(),n.list=t.deduplicate(t.options)},100));var a=function(){this.autocomplete_open||$(this).trigger("input")};e.on("focus",a),e.on("awesomplete-open",function(s){t.autocomplete_open=s.target}),e.on("awesomplete-close",function(s){t.autocomplete_open=!1}),e.on("awesomplete-select",function(s){var o=s.originalEvent,l=o.text.value,u=n.get_item(l);u.route_options&&(frappe.route_options=u.route_options),u.onclick?u.onclick(u.match):frappe.set_route(u.route),e.val(""),e.trigger("blur")}),e.on("awesomplete-selectcomplete",function(s){e.val("")}),e.on("keydown",s=>{s.key=="Escape"&&e.trigger("blur")}),frappe.search.utils.setup_recent(),frappe.tags.utils.fetch_tags()}add_help(){this.options.push({value:__("Help on Search"),index:-10,default:"Help",onclick:function(){var i='<table class="table table-bordered">					<tr><td style="width: 50%">'+__("Create a new record")+"</td><td>"+__("new type of document")+"</td></tr>					<tr><td>"+__("List a document type")+"</td><td>"+__("document type..., e.g. customer")+"</td></tr>					<tr><td>"+__("Search in a document type")+"</td><td>"+__("text in document type")+"</td></tr>					<tr><td>"+__("Tags")+"</td><td>"+__("tag name..., e.g. #tag")+"</td></tr>					<tr><td>"+__("Open a module or tool")+"</td><td>"+__("module name...")+"</td></tr>					<tr><td>"+__("Calculate")+"</td><td>"+__("e.g. (55 + 434) / 4 or =Math.sin(Math.PI/2)...")+"</td></tr>				</table>";frappe.msgprint(i,__("Search Help"))}})}set_specifics(i,t){var e=this,r=this.build_options(i);r.forEach(function(n){n.type&&n.type.toLowerCase().indexOf(t.toLowerCase())===0&&e.options.push(n)})}add_defaults(i){this.make_global_search(i),this.make_search_in_current(i),this.make_calculator(i),this.make_random(i)}build_options(i){var t=frappe.search.utils.get_creatables(i).concat(frappe.search.utils.get_search_in_list(i),frappe.search.utils.get_doctypes(i),frappe.search.utils.get_reports(i),frappe.search.utils.get_pages(i),frappe.search.utils.get_workspaces(i),frappe.search.utils.get_dashboards(i),frappe.search.utils.get_recent_pages(i||""),frappe.search.utils.get_executables(i));i.charAt(0)==="#"&&(t=frappe.tags.utils.get_tags(i));var e=this.deduplicate(t);return e.sort(function(r,n){return n.index-r.index})}deduplicate(i){var t=[],e=[];return i.forEach(function(r){if(r.route){r.route[0]==="List"&&r.route[2]!=="Report"&&r.route[2]!=="Inbox"&&r.route.splice(2);var n=typeof r.route=="string"?r.route:r.route.join("/");if(e.indexOf(n)===-1)t.push(r),e.push(n);else{var a=e.indexOf(n);t[a].index<r.index&&!r.recent&&(t[a]=r)}}else t.push(r),e.push("")}),t}set_global_results(i,t){this.global_results=this.global_results.concat(i)}make_global_search(i){i.charAt(0)!=="#"&&this.options.push({label:`
				<span class="flex justify-between text-medium">
					<span class="ellipsis">${__("Search for {0}",[frappe.utils.xss_sanitise(i).bold()])}</span>
					<kbd>\u21B5</kbd>
				</span>
			`,value:__("Search for {0}",[i]),match:i,index:100,default:"Search",onclick:function(){frappe.searchdialog.search.init_search(i,"global_search")}})}make_search_in_current(i){var t=frappe.get_route();if(t[0]==="List"&&i.indexOf(" in")===-1){var e=frappe.get_meta(frappe.container.page.list_view.doctype),r=e.title_field||"name",n={};n[r]=["like","%"+i+"%"],this.options.push({label:__("Find {0} in {1}",[i.bold(),__(t[1]).bold()]),value:__("Find {0} in {1}",[i,__(t[1])]),route_options:n,onclick:function(){cur_list.show()},index:90,default:"Current",match:i})}}make_calculator(txt){var first=txt.substr(0,1);if(first==parseInt(first)||first==="("||first==="="){first==="="&&(txt=txt.substr(1));try{var val=eval(txt),formatted_value=__("{0} = {1}",[txt,(val+"").bold()]);this.options.push({label:formatted_value,value:__("{0} = {1}",[txt,val]),match:val,index:80,default:"Calculator",onclick:function(){frappe.msgprint(formatted_value,__("Result"))}})}catch(i){}}}make_random(i){i.toLowerCase().includes("random")&&this.options.push({label:__("Generate Random Password"),value:frappe.utils.get_random(16),onclick:function(){frappe.msgprint(frappe.utils.get_random(16),__("Result"))}})}}});var Wa=ye((qd,Ua)=>{(function(i){if(typeof qd=="object"&&typeof Ua!="undefined")Ua.exports=i();else if(typeof define=="function"&&define.amd)define([],i);else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.localforage=i()}})(function(){var i,t,e;return function r(n,a,s){function o(c,h){if(!a[c]){if(!n[c]){var p=typeof tr=="function"&&tr;if(!h&&p)return p(c,!0);if(l)return l(c,!0);var g=new Error("Cannot find module '"+c+"'");throw g.code="MODULE_NOT_FOUND",g}var b=a[c]={exports:{}};n[c][0].call(b.exports,function(v){var k=n[c][1][v];return o(k||v)},b,b.exports,r,n,a,s)}return a[c].exports}for(var l=typeof tr=="function"&&tr,u=0;u<s.length;u++)o(s[u]);return o}({1:[function(r,n,a){(function(s){"use strict";var o=s.MutationObserver||s.WebKitMutationObserver,l;if(o){var u=0,c=new o(v),h=s.document.createTextNode("");c.observe(h,{characterData:!0}),l=function(){h.data=u=++u%2}}else if(!s.setImmediate&&typeof s.MessageChannel!="undefined"){var p=new s.MessageChannel;p.port1.onmessage=v,l=function(){p.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?l=function(){var C=s.document.createElement("script");C.onreadystatechange=function(){v(),C.onreadystatechange=null,C.parentNode.removeChild(C),C=null},s.document.documentElement.appendChild(C)}:l=function(){setTimeout(v,0)};var g,b=[];function v(){g=!0;for(var C,O,d=b.length;d;){for(O=b,b=[],C=-1;++C<d;)O[C]();d=b.length}g=!1}n.exports=k;function k(C){b.push(C)===1&&!g&&l()}}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],2:[function(r,n,a){"use strict";var s=r(1);function o(){}var l={},u=["REJECTED"],c=["FULFILLED"],h=["PENDING"];n.exports=p;function p(y){if(typeof y!="function")throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,y!==o&&k(this,y)}p.prototype.catch=function(y){return this.then(null,y)},p.prototype.then=function(y,x){if(typeof y!="function"&&this.state===c||typeof x!="function"&&this.state===u)return this;var S=new this.constructor(o);if(this.state!==h){var w=this.state===c?y:x;b(S,w,this.outcome)}else this.queue.push(new g(S,y,x));return S};function g(y,x,S){this.promise=y,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}g.prototype.callFulfilled=function(y){l.resolve(this.promise,y)},g.prototype.otherCallFulfilled=function(y){b(this.promise,this.onFulfilled,y)},g.prototype.callRejected=function(y){l.reject(this.promise,y)},g.prototype.otherCallRejected=function(y){b(this.promise,this.onRejected,y)};function b(y,x,S){s(function(){var w;try{w=x(S)}catch(E){return l.reject(y,E)}w===y?l.reject(y,new TypeError("Cannot resolve promise with itself")):l.resolve(y,w)})}l.resolve=function(y,x){var S=C(v,x);if(S.status==="error")return l.reject(y,S.value);var w=S.value;if(w)k(y,w);else{y.state=c,y.outcome=x;for(var E=-1,L=y.queue.length;++E<L;)y.queue[E].callFulfilled(x)}return y},l.reject=function(y,x){y.state=u,y.outcome=x;for(var S=-1,w=y.queue.length;++S<w;)y.queue[S].callRejected(x);return y};function v(y){var x=y&&y.then;if(y&&(typeof y=="object"||typeof y=="function")&&typeof x=="function")return function(){x.apply(y,arguments)}}function k(y,x){var S=!1;function w(A){S||(S=!0,l.reject(y,A))}function E(A){S||(S=!0,l.resolve(y,A))}function L(){x(E,w)}var I=C(L);I.status==="error"&&w(I.value)}function C(y,x){var S={};try{S.value=y(x),S.status="success"}catch(w){S.status="error",S.value=w}return S}p.resolve=O;function O(y){return y instanceof this?y:l.resolve(new this(o),y)}p.reject=d;function d(y){var x=new this(o);return l.reject(x,y)}p.all=_;function _(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,w=!1;if(!S)return this.resolve([]);for(var E=new Array(S),L=0,I=-1,A=new this(o);++I<S;)B(y[I],I);return A;function B(T,M){x.resolve(T).then(j,function(J){w||(w=!0,l.reject(A,J))});function j(J){E[M]=J,++L===S&&!w&&(w=!0,l.resolve(A,E))}}}p.race=m;function m(y){var x=this;if(Object.prototype.toString.call(y)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=y.length,w=!1;if(!S)return this.resolve([]);for(var E=-1,L=new this(o);++E<S;)I(y[E]);return L;function I(A){x.resolve(A).then(function(B){w||(w=!0,l.resolve(L,B))},function(B){w||(w=!0,l.reject(L,B))})}}},{"1":1}],3:[function(r,n,a){(function(s){"use strict";typeof s.Promise!="function"&&(s.Promise=r(2))}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"2":2}],4:[function(r,n,a){"use strict";var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F};function o(F,ne){if(!(F instanceof ne))throw new TypeError("Cannot call a class as a function")}function l(){try{if(typeof indexedDB!="undefined")return indexedDB;if(typeof webkitIndexedDB!="undefined")return webkitIndexedDB;if(typeof mozIndexedDB!="undefined")return mozIndexedDB;if(typeof OIndexedDB!="undefined")return OIndexedDB;if(typeof msIndexedDB!="undefined")return msIndexedDB}catch(F){return}}var u=l();function c(){try{if(!u||!u.open)return!1;var F=typeof openDatabase!="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ne=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!F||ne)&&typeof indexedDB!="undefined"&&typeof IDBKeyRange!="undefined"}catch(V){return!1}}function h(F,ne){F=F||[],ne=ne||{};try{return new Blob(F,ne)}catch(R){if(R.name!=="TypeError")throw R;for(var V=typeof BlobBuilder!="undefined"?BlobBuilder:typeof MSBlobBuilder!="undefined"?MSBlobBuilder:typeof MozBlobBuilder!="undefined"?MozBlobBuilder:WebKitBlobBuilder,ae=new V,D=0;D<F.length;D+=1)ae.append(F[D]);return ae.getBlob(ne.type)}}typeof Promise=="undefined"&&r(3);var p=Promise;function g(F,ne){ne&&F.then(function(V){ne(null,V)},function(V){ne(V)})}function b(F,ne,V){typeof ne=="function"&&F.then(ne),typeof V=="function"&&F.catch(V)}function v(F){return typeof F!="string"&&(console.warn(F+" used as a key, but it is not a string."),F=String(F)),F}function k(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var C="local-forage-detect-blob-support",O=void 0,d={},_=Object.prototype.toString,m="readonly",y="readwrite";function x(F){for(var ne=F.length,V=new ArrayBuffer(ne),ae=new Uint8Array(V),D=0;D<ne;D++)ae[D]=F.charCodeAt(D);return V}function S(F){return new p(function(ne){var V=F.transaction(C,y),ae=h([""]);V.objectStore(C).put(ae,"key"),V.onabort=function(D){D.preventDefault(),D.stopPropagation(),ne(!1)},V.oncomplete=function(){var D=navigator.userAgent.match(/Chrome\/(\d+)/),R=navigator.userAgent.match(/Edge\//);ne(R||!D||parseInt(D[1],10)>=43)}}).catch(function(){return!1})}function w(F){return typeof O=="boolean"?p.resolve(O):S(F).then(function(ne){return O=ne,O})}function E(F){var ne=d[F.name],V={};V.promise=new p(function(ae,D){V.resolve=ae,V.reject=D}),ne.deferredOperations.push(V),ne.dbReady?ne.dbReady=ne.dbReady.then(function(){return V.promise}):ne.dbReady=V.promise}function L(F){var ne=d[F.name],V=ne.deferredOperations.pop();if(V)return V.resolve(),V.promise}function I(F,ne){var V=d[F.name],ae=V.deferredOperations.pop();if(ae)return ae.reject(ne),ae.promise}function A(F,ne){return new p(function(V,ae){if(d[F.name]=d[F.name]||W(),F.db)if(ne)E(F),F.db.close();else return V(F.db);var D=[F.name];ne&&D.push(F.version);var R=u.open.apply(u,D);ne&&(R.onupgradeneeded=function(P){var N=R.result;try{N.createObjectStore(F.storeName),P.oldVersion<=1&&N.createObjectStore(C)}catch(X){if(X.name==="ConstraintError")console.warn('The database "'+F.name+'" has been upgraded from version '+P.oldVersion+" to version "+P.newVersion+', but the storage "'+F.storeName+'" already exists.');else throw X}}),R.onerror=function(P){P.preventDefault(),ae(R.error)},R.onsuccess=function(){V(R.result),L(F)}})}function B(F){return A(F,!1)}function T(F){return A(F,!0)}function M(F,ne){if(!F.db)return!0;var V=!F.db.objectStoreNames.contains(F.storeName),ae=F.version<F.db.version,D=F.version>F.db.version;if(ae&&(F.version!==ne&&console.warn('The database "'+F.name+`" can't be downgraded from version `+F.db.version+" to version "+F.version+"."),F.version=F.db.version),D||V){if(V){var R=F.db.version+1;R>F.version&&(F.version=R)}return!0}return!1}function j(F){return new p(function(ne,V){var ae=new FileReader;ae.onerror=V,ae.onloadend=function(D){var R=btoa(D.target.result||"");ne({__local_forage_encoded_blob:!0,data:R,type:F.type})},ae.readAsBinaryString(F)})}function J(F){var ne=x(atob(F.data));return h([ne],{type:F.type})}function U(F){return F&&F.__local_forage_encoded_blob}function H(F){var ne=this,V=ne._initReady().then(function(){var ae=d[ne._dbInfo.name];if(ae&&ae.dbReady)return ae.dbReady});return b(V,F,F),V}function te(F){E(F);for(var ne=d[F.name],V=ne.forages,ae=0;ae<V.length;ae++){var D=V[ae];D._dbInfo.db&&(D._dbInfo.db.close(),D._dbInfo.db=null)}return F.db=null,B(F).then(function(R){return F.db=R,M(F)?T(F):R}).then(function(R){F.db=ne.db=R;for(var P=0;P<V.length;P++)V[P]._dbInfo.db=R}).catch(function(R){throw I(F,R),R})}function se(F,ne,V,ae){ae===void 0&&(ae=1);try{var D=F.db.transaction(F.storeName,ne);V(null,D)}catch(R){if(ae>0&&(!F.db||R.name==="InvalidStateError"||R.name==="NotFoundError"))return p.resolve().then(function(){if(!F.db||R.name==="NotFoundError"&&!F.db.objectStoreNames.contains(F.storeName)&&F.version<=F.db.version)return F.db&&(F.version=F.db.version+1),T(F)}).then(function(){return te(F).then(function(){se(F,ne,V,ae-1)})}).catch(V);V(R)}}function W(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Y(F){var ne=this,V={db:null};if(F)for(var ae in F)V[ae]=F[ae];var D=d[V.name];D||(D=W(),d[V.name]=D),D.forages.push(ne),ne._initReady||(ne._initReady=ne.ready,ne.ready=H);var R=[];function P(){return p.resolve()}for(var N=0;N<D.forages.length;N++){var X=D.forages[N];X!==ne&&R.push(X._initReady().catch(P))}var q=D.forages.slice(0);return p.all(R).then(function(){return V.db=D.db,B(V)}).then(function(K){return V.db=K,M(V,ne._defaultConfig.version)?T(V):K}).then(function(K){V.db=D.db=K,ne._dbInfo=V;for(var oe=0;oe<q.length;oe++){var ge=q[oe];ge!==ne&&(ge._dbInfo.db=V.db,ge._dbInfo.version=V.version)}})}function ie(F,ne){var V=this;F=v(F);var ae=new p(function(D,R){V.ready().then(function(){se(V._dbInfo,m,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=X.get(F);q.onsuccess=function(){var K=q.result;K===void 0&&(K=null),U(K)&&(K=J(K)),D(K)},q.onerror=function(){R(q.error)}}catch(K){R(K)}})}).catch(R)});return g(ae,ne),ae}function re(F,ne){var V=this,ae=new p(function(D,R){V.ready().then(function(){se(V._dbInfo,m,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=X.openCursor(),K=1;q.onsuccess=function(){var oe=q.result;if(oe){var ge=oe.value;U(ge)&&(ge=J(ge));var me=F(ge,oe.key,K++);me!==void 0?D(me):oe.continue()}else D()},q.onerror=function(){R(q.error)}}catch(oe){R(oe)}})}).catch(R)});return g(ae,ne),ae}function Q(F,ne,V){var ae=this;F=v(F);var D=new p(function(R,P){var N;ae.ready().then(function(){return N=ae._dbInfo,_.call(ne)==="[object Blob]"?w(N.db).then(function(X){return X?ne:j(ne)}):ne}).then(function(X){se(ae._dbInfo,y,function(q,K){if(q)return P(q);try{var oe=K.objectStore(ae._dbInfo.storeName);X===null&&(X=void 0);var ge=oe.put(X,F);K.oncomplete=function(){X===void 0&&(X=null),R(X)},K.onabort=K.onerror=function(){var me=ge.error?ge.error:ge.transaction.error;P(me)}}catch(me){P(me)}})}).catch(P)});return g(D,V),D}function ee(F,ne){var V=this;F=v(F);var ae=new p(function(D,R){V.ready().then(function(){se(V._dbInfo,y,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=X.delete(F);N.oncomplete=function(){D()},N.onerror=function(){R(q.error)},N.onabort=function(){var K=q.error?q.error:q.transaction.error;R(K)}}catch(K){R(K)}})}).catch(R)});return g(ae,ne),ae}function pe(F){var ne=this,V=new p(function(ae,D){ne.ready().then(function(){se(ne._dbInfo,y,function(R,P){if(R)return D(R);try{var N=P.objectStore(ne._dbInfo.storeName),X=N.clear();P.oncomplete=function(){ae()},P.onabort=P.onerror=function(){var q=X.error?X.error:X.transaction.error;D(q)}}catch(q){D(q)}})}).catch(D)});return g(V,F),V}function be(F){var ne=this,V=new p(function(ae,D){ne.ready().then(function(){se(ne._dbInfo,m,function(R,P){if(R)return D(R);try{var N=P.objectStore(ne._dbInfo.storeName),X=N.count();X.onsuccess=function(){ae(X.result)},X.onerror=function(){D(X.error)}}catch(q){D(q)}})}).catch(D)});return g(V,F),V}function we(F,ne){var V=this,ae=new p(function(D,R){if(F<0){D(null);return}V.ready().then(function(){se(V._dbInfo,m,function(P,N){if(P)return R(P);try{var X=N.objectStore(V._dbInfo.storeName),q=!1,K=X.openKeyCursor();K.onsuccess=function(){var oe=K.result;if(!oe){D(null);return}F===0||q?D(oe.key):(q=!0,oe.advance(F))},K.onerror=function(){R(K.error)}}catch(oe){R(oe)}})}).catch(R)});return g(ae,ne),ae}function Le(F){var ne=this,V=new p(function(ae,D){ne.ready().then(function(){se(ne._dbInfo,m,function(R,P){if(R)return D(R);try{var N=P.objectStore(ne._dbInfo.storeName),X=N.openKeyCursor(),q=[];X.onsuccess=function(){var K=X.result;if(!K){ae(q);return}q.push(K.key),K.continue()},X.onerror=function(){D(X.error)}}catch(K){D(K)}})}).catch(D)});return g(V,F),V}function fe(F,ne){ne=k.apply(this,arguments);var V=this.config();F=typeof F!="function"&&F||{},F.name||(F.name=F.name||V.name,F.storeName=F.storeName||V.storeName);var ae=this,D;if(!F.name)D=p.reject("Invalid arguments");else{var R=F.name===V.name&&ae._dbInfo.db,P=R?p.resolve(ae._dbInfo.db):B(F).then(function(N){var X=d[F.name],q=X.forages;X.db=N;for(var K=0;K<q.length;K++)q[K]._dbInfo.db=N;return N});F.storeName?D=P.then(function(N){if(!!N.objectStoreNames.contains(F.storeName)){var X=N.version+1;E(F);var q=d[F.name],K=q.forages;N.close();for(var oe=0;oe<K.length;oe++){var ge=K[oe];ge._dbInfo.db=null,ge._dbInfo.version=X}var me=new p(function(he,_e){var ke=u.open(F.name,X);ke.onerror=function(je){var Ve=ke.result;Ve.close(),_e(je)},ke.onupgradeneeded=function(){var je=ke.result;je.deleteObjectStore(F.storeName)},ke.onsuccess=function(){var je=ke.result;je.close(),he(je)}});return me.then(function(he){q.db=he;for(var _e=0;_e<K.length;_e++){var ke=K[_e];ke._dbInfo.db=he,L(ke._dbInfo)}}).catch(function(he){throw(I(F,he)||p.resolve()).catch(function(){}),he})}}):D=P.then(function(N){E(F);var X=d[F.name],q=X.forages;N.close();for(var K=0;K<q.length;K++){var oe=q[K];oe._dbInfo.db=null}var ge=new p(function(me,he){var _e=u.deleteDatabase(F.name);_e.onerror=_e.onblocked=function(ke){var je=_e.result;je&&je.close(),he(ke)},_e.onsuccess=function(){var ke=_e.result;ke&&ke.close(),me(ke)}});return ge.then(function(me){X.db=me;for(var he=0;he<q.length;he++){var _e=q[he];L(_e._dbInfo)}}).catch(function(me){throw(I(F,me)||p.resolve()).catch(function(){}),me})})}return g(D,ne),D}var xe={_driver:"asyncStorage",_initStorage:Y,_support:c(),iterate:re,getItem:ie,setItem:Q,removeItem:ee,clear:pe,length:be,key:we,keys:Le,dropInstance:fe};function Ne(){return typeof openDatabase=="function"}var Be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pe="~~local_forage_type~",Ze=/^~~local_forage_type~([^~]+)~/,tt="__lfsc__:",Xe=tt.length,Ke="arbf",nt="blob",at="si08",ce="ui08",ve="uic8",Ie="si16",He="si32",st="ur16",vt="ui32",bt="fl32",Me="fl64",yt=Xe+Ke.length,Vt=Object.prototype.toString;function Ft(F){var ne=F.length*.75,V=F.length,ae,D=0,R,P,N,X;F[F.length-1]==="="&&(ne--,F[F.length-2]==="="&&ne--);var q=new ArrayBuffer(ne),K=new Uint8Array(q);for(ae=0;ae<V;ae+=4)R=Be.indexOf(F[ae]),P=Be.indexOf(F[ae+1]),N=Be.indexOf(F[ae+2]),X=Be.indexOf(F[ae+3]),K[D++]=R<<2|P>>4,K[D++]=(P&15)<<4|N>>2,K[D++]=(N&3)<<6|X&63;return q}function Ye(F){var ne=new Uint8Array(F),V="",ae;for(ae=0;ae<ne.length;ae+=3)V+=Be[ne[ae]>>2],V+=Be[(ne[ae]&3)<<4|ne[ae+1]>>4],V+=Be[(ne[ae+1]&15)<<2|ne[ae+2]>>6],V+=Be[ne[ae+2]&63];return ne.length%3===2?V=V.substring(0,V.length-1)+"=":ne.length%3===1&&(V=V.substring(0,V.length-2)+"=="),V}function Ge(F,ne){var V="";if(F&&(V=Vt.call(F)),F&&(V==="[object ArrayBuffer]"||F.buffer&&Vt.call(F.buffer)==="[object ArrayBuffer]")){var ae,D=tt;F instanceof ArrayBuffer?(ae=F,D+=Ke):(ae=F.buffer,V==="[object Int8Array]"?D+=at:V==="[object Uint8Array]"?D+=ce:V==="[object Uint8ClampedArray]"?D+=ve:V==="[object Int16Array]"?D+=Ie:V==="[object Uint16Array]"?D+=st:V==="[object Int32Array]"?D+=He:V==="[object Uint32Array]"?D+=vt:V==="[object Float32Array]"?D+=bt:V==="[object Float64Array]"?D+=Me:ne(new Error("Failed to get type for BinaryArray"))),ne(D+Ye(ae))}else if(V==="[object Blob]"){var R=new FileReader;R.onload=function(){var P=Pe+F.type+"~"+Ye(this.result);ne(tt+nt+P)},R.readAsArrayBuffer(F)}else try{ne(JSON.stringify(F))}catch(P){console.error("Couldn't convert value into a JSON string: ",F),ne(null,P)}}function Qe(F){if(F.substring(0,Xe)!==tt)return JSON.parse(F);var ne=F.substring(yt),V=F.substring(Xe,yt),ae;if(V===nt&&Ze.test(ne)){var D=ne.match(Ze);ae=D[1],ne=ne.substring(D[0].length)}var R=Ft(ne);switch(V){case Ke:return R;case nt:return h([R],{type:ae});case at:return new Int8Array(R);case ce:return new Uint8Array(R);case ve:return new Uint8ClampedArray(R);case Ie:return new Int16Array(R);case st:return new Uint16Array(R);case He:return new Int32Array(R);case vt:return new Uint32Array(R);case bt:return new Float32Array(R);case Me:return new Float64Array(R);default:throw new Error("Unkown type: "+V)}}var qe={serialize:Ge,deserialize:Qe,stringToBuffer:Ft,bufferToString:Ye};function ei(F,ne,V,ae){F.executeSql("CREATE TABLE IF NOT EXISTS "+ne.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],V,ae)}function dt(F){var ne=this,V={db:null};if(F)for(var ae in F)V[ae]=typeof F[ae]!="string"?F[ae].toString():F[ae];var D=new p(function(R,P){try{V.db=openDatabase(V.name,String(V.version),V.description,V.size)}catch(N){return P(N)}V.db.transaction(function(N){ei(N,V,function(){ne._dbInfo=V,R()},function(X,q){P(q)})},P)});return V.serializer=qe,D}function De(F,ne,V,ae,D,R){F.executeSql(V,ae,D,function(P,N){N.code===N.SYNTAX_ERR?P.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ne.storeName],function(X,q){q.rows.length?R(X,N):ei(X,ne,function(){X.executeSql(V,ae,D,R)},R)},R):R(P,N)},R)}function ti(F,ne){var V=this;F=v(F);var ae=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"SELECT * FROM "+P.storeName+" WHERE key = ? LIMIT 1",[F],function(X,q){var K=q.rows.length?q.rows.item(0).value:null;K&&(K=P.serializer.deserialize(K)),D(K)},function(X,q){R(q)})})}).catch(R)});return g(ae,ne),ae}function et(F,ne){var V=this,ae=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"SELECT * FROM "+P.storeName,[],function(X,q){for(var K=q.rows,oe=K.length,ge=0;ge<oe;ge++){var me=K.item(ge),he=me.value;if(he&&(he=P.serializer.deserialize(he)),he=F(he,me.key,ge+1),he!==void 0){D(he);return}}D()},function(X,q){R(q)})})}).catch(R)});return g(ae,ne),ae}function ii(F,ne,V,ae){var D=this;F=v(F);var R=new p(function(P,N){D.ready().then(function(){ne===void 0&&(ne=null);var X=ne,q=D._dbInfo;q.serializer.serialize(ne,function(K,oe){oe?N(oe):q.db.transaction(function(ge){De(ge,q,"INSERT OR REPLACE INTO "+q.storeName+" (key, value) VALUES (?, ?)",[F,K],function(){P(X)},function(me,he){N(he)})},function(ge){if(ge.code===ge.QUOTA_ERR){if(ae>0){P(ii.apply(D,[F,X,V,ae-1]));return}N(ge)}})})}).catch(N)});return g(R,V),R}function It(F,ne,V){return ii.apply(this,[F,ne,V,1])}function di(F,ne){var V=this;F=v(F);var ae=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"DELETE FROM "+P.storeName+" WHERE key = ?",[F],function(){D()},function(X,q){R(q)})})}).catch(R)});return g(ae,ne),ae}function pt(F){var ne=this,V=new p(function(ae,D){ne.ready().then(function(){var R=ne._dbInfo;R.db.transaction(function(P){De(P,R,"DELETE FROM "+R.storeName,[],function(){ae()},function(N,X){D(X)})})}).catch(D)});return g(V,F),V}function Lt(F){var ne=this,V=new p(function(ae,D){ne.ready().then(function(){var R=ne._dbInfo;R.db.transaction(function(P){De(P,R,"SELECT COUNT(key) as c FROM "+R.storeName,[],function(N,X){var q=X.rows.item(0).c;ae(q)},function(N,X){D(X)})})}).catch(D)});return g(V,F),V}function Xt(F,ne){var V=this,ae=new p(function(D,R){V.ready().then(function(){var P=V._dbInfo;P.db.transaction(function(N){De(N,P,"SELECT key FROM "+P.storeName+" WHERE id = ? LIMIT 1",[F+1],function(X,q){var K=q.rows.length?q.rows.item(0).key:null;D(K)},function(X,q){R(q)})})}).catch(R)});return g(ae,ne),ae}function xi(F){var ne=this,V=new p(function(ae,D){ne.ready().then(function(){var R=ne._dbInfo;R.db.transaction(function(P){De(P,R,"SELECT key FROM "+R.storeName,[],function(N,X){for(var q=[],K=0;K<X.rows.length;K++)q.push(X.rows.item(K).key);ae(q)},function(N,X){D(X)})})}).catch(D)});return g(V,F),V}function Nt(F){return new p(function(ne,V){F.transaction(function(ae){ae.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(D,R){for(var P=[],N=0;N<R.rows.length;N++)P.push(R.rows.item(N).name);ne({db:F,storeNames:P})},function(D,R){V(R)})},function(ae){V(ae)})})}function ri(F,ne){ne=k.apply(this,arguments);var V=this.config();F=typeof F!="function"&&F||{},F.name||(F.name=F.name||V.name,F.storeName=F.storeName||V.storeName);var ae=this,D;return F.name?D=new p(function(R){var P;F.name===V.name?P=ae._dbInfo.db:P=openDatabase(F.name,"","",0),F.storeName?R({db:P,storeNames:[F.storeName]}):R(Nt(P))}).then(function(R){return new p(function(P,N){R.db.transaction(function(X){function q(me){return new p(function(he,_e){X.executeSql("DROP TABLE IF EXISTS "+me,[],function(){he()},function(ke,je){_e(je)})})}for(var K=[],oe=0,ge=R.storeNames.length;oe<ge;oe++)K.push(q(R.storeNames[oe]));p.all(K).then(function(){P()}).catch(function(me){N(me)})},function(X){N(X)})})}):D=p.reject("Invalid arguments"),g(D,ne),D}var Pt={_driver:"webSQLStorage",_initStorage:dt,_support:Ne(),iterate:et,getItem:ti,setItem:It,removeItem:di,clear:pt,length:Lt,key:Xt,keys:xi,dropInstance:ri};function hi(){try{return typeof localStorage!="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(F){return!1}}function Kt(F,ne){var V=F.name+"/";return F.storeName!==ne.storeName&&(V+=F.storeName+"/"),V}function ni(){var F="_localforage_support_test";try{return localStorage.setItem(F,!0),localStorage.removeItem(F),!1}catch(ne){return!0}}function Tt(){return!ni()||localStorage.length>0}function Et(F){var ne=this,V={};if(F)for(var ae in F)V[ae]=F[ae];return V.keyPrefix=Kt(F,ne._defaultConfig),Tt()?(ne._dbInfo=V,V.serializer=qe,p.resolve()):p.reject()}function wt(F){var ne=this,V=ne.ready().then(function(){for(var ae=ne._dbInfo.keyPrefix,D=localStorage.length-1;D>=0;D--){var R=localStorage.key(D);R.indexOf(ae)===0&&localStorage.removeItem(R)}});return g(V,F),V}function Ee(F,ne){var V=this;F=v(F);var ae=V.ready().then(function(){var D=V._dbInfo,R=localStorage.getItem(D.keyPrefix+F);return R&&(R=D.serializer.deserialize(R)),R});return g(ae,ne),ae}function Te(F,ne){var V=this,ae=V.ready().then(function(){for(var D=V._dbInfo,R=D.keyPrefix,P=R.length,N=localStorage.length,X=1,q=0;q<N;q++){var K=localStorage.key(q);if(K.indexOf(R)===0){var oe=localStorage.getItem(K);if(oe&&(oe=D.serializer.deserialize(oe)),oe=F(oe,K.substring(P),X++),oe!==void 0)return oe}}});return g(ae,ne),ae}function ze(F,ne){var V=this,ae=V.ready().then(function(){var D=V._dbInfo,R;try{R=localStorage.key(F)}catch(P){R=null}return R&&(R=R.substring(D.keyPrefix.length)),R});return g(ae,ne),ae}function z(F){var ne=this,V=ne.ready().then(function(){for(var ae=ne._dbInfo,D=localStorage.length,R=[],P=0;P<D;P++){var N=localStorage.key(P);N.indexOf(ae.keyPrefix)===0&&R.push(N.substring(ae.keyPrefix.length))}return R});return g(V,F),V}function G(F){var ne=this,V=ne.keys().then(function(ae){return ae.length});return g(V,F),V}function Z(F,ne){var V=this;F=v(F);var ae=V.ready().then(function(){var D=V._dbInfo;localStorage.removeItem(D.keyPrefix+F)});return g(ae,ne),ae}function de(F,ne,V){var ae=this;F=v(F);var D=ae.ready().then(function(){ne===void 0&&(ne=null);var R=ne;return new p(function(P,N){var X=ae._dbInfo;X.serializer.serialize(ne,function(q,K){if(K)N(K);else try{localStorage.setItem(X.keyPrefix+F,q),P(R)}catch(oe){(oe.name==="QuotaExceededError"||oe.name==="NS_ERROR_DOM_QUOTA_REACHED")&&N(oe),N(oe)}})})});return g(D,V),D}function le(F,ne){if(ne=k.apply(this,arguments),F=typeof F!="function"&&F||{},!F.name){var V=this.config();F.name=F.name||V.name,F.storeName=F.storeName||V.storeName}var ae=this,D;return F.name?D=new p(function(R){F.storeName?R(Kt(F,ae._defaultConfig)):R(F.name+"/")}).then(function(R){for(var P=localStorage.length-1;P>=0;P--){var N=localStorage.key(P);N.indexOf(R)===0&&localStorage.removeItem(N)}}):D=p.reject("Invalid arguments"),g(D,ne),D}var Ce={_driver:"localStorageWrapper",_initStorage:Et,_support:hi(),iterate:Te,getItem:Ee,setItem:de,removeItem:Z,clear:wt,length:G,key:ze,keys:z,dropInstance:le},Se=function(ne,V){return ne===V||typeof ne=="number"&&typeof V=="number"&&isNaN(ne)&&isNaN(V)},Re=function(ne,V){for(var ae=ne.length,D=0;D<ae;){if(Se(ne[D],V))return!0;D++}return!1},Ae=Array.isArray||function(F){return Object.prototype.toString.call(F)==="[object Array]"},$e={},We={},Fe={INDEXEDDB:xe,WEBSQL:Pt,LOCALSTORAGE:Ce},it=[Fe.INDEXEDDB._driver,Fe.WEBSQL._driver,Fe.LOCALSTORAGE._driver],mt=["dropInstance"],Je=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(mt),Ue={description:"",driver:it.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function At(F,ne){F[ne]=function(){var V=arguments;return F.ready().then(function(){return F[ne].apply(F,V)})}}function $t(){for(var F=1;F<arguments.length;F++){var ne=arguments[F];if(ne)for(var V in ne)ne.hasOwnProperty(V)&&(Ae(ne[V])?arguments[0][V]=ne[V].slice():arguments[0][V]=ne[V])}return arguments[0]}var xt=function(){function F(ne){o(this,F);for(var V in Fe)if(Fe.hasOwnProperty(V)){var ae=Fe[V],D=ae._driver;this[V]=D,$e[D]||this.defineDriver(ae)}this._defaultConfig=$t({},Ue),this._config=$t({},this._defaultConfig,ne),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return F.prototype.config=function(V){if((typeof V=="undefined"?"undefined":s(V))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var ae in V){if(ae==="storeName"&&(V[ae]=V[ae].replace(/\W/g,"_")),ae==="version"&&typeof V[ae]!="number")return new Error("Database version must be a number.");this._config[ae]=V[ae]}return"driver"in V&&V.driver?this.setDriver(this._config.driver):!0}else return typeof V=="string"?this._config[V]:this._config},F.prototype.defineDriver=function(V,ae,D){var R=new p(function(P,N){try{var X=V._driver,q=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!V._driver){N(q);return}for(var K=Je.concat("_initStorage"),oe=0,ge=K.length;oe<ge;oe++){var me=K[oe],he=!Re(mt,me);if((he||V[me])&&typeof V[me]!="function"){N(q);return}}var _e=function(){for(var Ve=function(Ct){return function(){var ai=new Error("Method "+Ct+" is not implemented by the current driver"),Dt=p.reject(ai);return g(Dt,arguments[arguments.length-1]),Dt}},ft=0,ot=mt.length;ft<ot;ft++){var kt=mt[ft];V[kt]||(V[kt]=Ve(kt))}};_e();var ke=function(Ve){$e[X]&&console.info("Redefining LocalForage driver: "+X),$e[X]=V,We[X]=Ve,P()};"_support"in V?V._support&&typeof V._support=="function"?V._support().then(ke,N):ke(!!V._support):ke(!0)}catch(je){N(je)}});return b(R,ae,D),R},F.prototype.driver=function(){return this._driver||null},F.prototype.getDriver=function(V,ae,D){var R=$e[V]?p.resolve($e[V]):p.reject(new Error("Driver not found."));return b(R,ae,D),R},F.prototype.getSerializer=function(V){var ae=p.resolve(qe);return b(ae,V),ae},F.prototype.ready=function(V){var ae=this,D=ae._driverSet.then(function(){return ae._ready===null&&(ae._ready=ae._initDriver()),ae._ready});return b(D,V,V),D},F.prototype.setDriver=function(V,ae,D){var R=this;Ae(V)||(V=[V]);var P=this._getSupportedDrivers(V);function N(){R._config.driver=R.driver()}function X(oe){return R._extend(oe),N(),R._ready=R._initStorage(R._config),R._ready}function q(oe){return function(){var ge=0;function me(){for(;ge<oe.length;){var he=oe[ge];return ge++,R._dbInfo=null,R._ready=null,R.getDriver(he).then(X).catch(me)}N();var _e=new Error("No available storage method found.");return R._driverSet=p.reject(_e),R._driverSet}return me()}}var K=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=K.then(function(){var oe=P[0];return R._dbInfo=null,R._ready=null,R.getDriver(oe).then(function(ge){R._driver=ge._driver,N(),R._wrapLibraryMethodsWithReady(),R._initDriver=q(P)})}).catch(function(){N();var oe=new Error("No available storage method found.");return R._driverSet=p.reject(oe),R._driverSet}),b(this._driverSet,ae,D),this._driverSet},F.prototype.supports=function(V){return!!We[V]},F.prototype._extend=function(V){$t(this,V)},F.prototype._getSupportedDrivers=function(V){for(var ae=[],D=0,R=V.length;D<R;D++){var P=V[D];this.supports(P)&&ae.push(P)}return ae},F.prototype._wrapLibraryMethodsWithReady=function(){for(var V=0,ae=Je.length;V<ae;V++)At(this,Je[V])},F.prototype.createInstance=function(V){return new F(V)},F}(),St=new xt;n.exports=St},{"3":3}]},{},[4])(4)})});var Wd=ye((fn,Va)=>{(function(i,t){typeof fn=="object"&&typeof Va=="object"?Va.exports=t():typeof define=="function"&&define.amd?define([],t):typeof fn=="object"?fn.EditorJS=t():i.EditorJS=t()})(window,function(){return function(i){var t={};function e(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return i[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=i,e.c=t,e.d=function(r,n,a){e.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:a})},e.r=function(r){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,n){if(1&n&&(r=e(r)),8&n||4&n&&typeof r=="object"&&r&&r.__esModule)return r;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:r}),2&n&&typeof r!="string")for(var s in r)e.d(a,s,function(o){return r[o]}.bind(null,s));return a},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,"a",n),n},e.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},e.p="",e(e.s=183)}([function(i,t,e){var r=e(10),n=e(17),a=e(27),s=e(23),o=e(31),l=function(u,c,h){var p,g,b,v,k=u&l.F,C=u&l.G,O=u&l.S,d=u&l.P,_=u&l.B,m=C?r:O?r[c]||(r[c]={}):(r[c]||{}).prototype,y=C?n:n[c]||(n[c]={}),x=y.prototype||(y.prototype={});for(p in C&&(h=c),h)b=((g=!k&&m&&m[p]!==void 0)?m:h)[p],v=_&&g?o(b,r):d&&typeof b=="function"?o(Function.call,b):b,m&&s(m,p,b,u&l.U),y[p]!=b&&a(y,p,v),d&&x[p]!=b&&(x[p]=b)};r.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,i.exports=l},function(i,t){i.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(i,t){i.exports=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}},function(i,t){function e(r,n){for(var a=0;a<n.length;a++){var s=n[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,s.key,s)}}i.exports=function(r,n,a){return n&&e(r.prototype,n),a&&e(r,a),r}},function(i,t){function e(r){return i.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},e(r)}i.exports=e},function(i,t,e){var r=e(107);i.exports=function(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),a&&r(n,a)}},function(i,t,e){var r=e(143),n=e(368);i.exports=function(a,s){return!s||r(s)!=="object"&&typeof s!="function"?n(a):s}},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(374)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);function h(b){if(typeof Symbol=="undefined"||b[Symbol.iterator]==null){if(Array.isArray(b)||(b=function(m,y){if(m){if(typeof m=="string")return p(m,y);var x=Object.prototype.toString.call(m).slice(8,-1);return x==="Object"&&m.constructor&&(x=m.constructor.name),x==="Map"||x==="Set"?Array.from(x):x==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(x)?p(m,y):void 0}}(b))){var v=0,k=function(){};return{s:k,n:function(){return v>=b.length?{done:!0}:{done:!1,value:b[v++]}},e:function(m){throw m},f:k}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var C,O,d=!0,_=!1;return{s:function(){C=b[Symbol.iterator]()},n:function(){var m=C.next();return d=m.done,m},e:function(m){_=!0,O=m},f:function(){try{d||C.return==null||C.return()}finally{if(_)throw O}}}}function p(b,v){(v==null||v>b.length)&&(v=b.length);for(var k=0,C=new Array(v);k<v;k++)C[k]=b[k];return C}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var g=function(){function b(v){var k=this,C=v.config,O=v.eventsDispatcher;if((0,o.default)(this,b),this.nodes={},this.listeners=new u.default,this.readOnlyMutableListeners={on:function(d,_,m){var y=arguments.length>3&&arguments[3]!==void 0&&arguments[3];k.mutableListenerIds.push(k.listeners.on(d,_,m,y))},clearAll:function(){var d,_=h(k.mutableListenerIds);try{for(_.s();!(d=_.n()).done;){var m=d.value;k.listeners.offById(m)}}catch(y){_.e(y)}finally{_.f()}k.mutableListenerIds=[]}},this.mutableListenerIds=[],(this instanceof b?this.constructor:void 0)===b)throw new TypeError("Constructors for abstract class Module are not allowed.");this.config=C,this.eventsDispatcher=O}return(0,l.default)(b,[{key:"removeAllNodes",value:function(){for(var v in this.nodes){var k=this.nodes[v];k instanceof HTMLElement&&k.remove()}}},{key:"state",set:function(v){this.Editor=v}},{key:"isRtl",get:function(){return this.config.i18n.direction==="rtl"}}]),b}();s.default=g,g.displayName="Module",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(367),e(22),e(15)],(a=typeof(r=function(s,o,l,u,c){"use strict";var h,p=e(1);function g(x,S){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"log",E=arguments.length>3?arguments[3]:void 0,L=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"color: inherit";if("console"in window&&window.console[w]){var I=["info","log","warn","error"].includes(w),A=[];switch(g.logLevel){case h.ERROR:if(w!=="error")return;break;case h.WARN:if(!["error","warn"].includes(w))return;break;case h.INFO:if(!I||x)return}E&&A.push(E);var B="Editor.js ".concat("2.20.0"),T=`line-height: 1em;
            color: #006FEA;
            display: inline-block;
            font-size: 11px;
            line-height: 1em;
            background-color: #fff;
            padding: 4px 9px;
            border-radius: 30px;
            border: 1px solid rgba(56, 138, 229, 0.16);
            margin: 4px 5px 4px 0;`;x&&(I?(A.unshift(T,L),S="%c".concat(B,"%c ").concat(S)):S="( ".concat(B," )").concat(S));try{if(I)if(E){var M;(M=console)[w].apply(M,["".concat(S," %o")].concat(A))}else{var j;(j=console)[w].apply(j,[S].concat(A))}else console[w](S)}catch(J){}}}Object.defineProperty(s,"__esModule",{value:!0}),s.setLogLevel=function(x){g.logLevel=x},s.typeOf=k,s.isFunction=C,s.isObject=O,s.isString=function(x){return k(x)==="string"},s.isBoolean=function(x){return k(x)==="boolean"},s.isNumber=function(x){return k(x)==="number"},s.isUndefined=d,s.isClass=function(x){return C(x)&&/^\s*class\s+/.test(x.toString())},s.isEmpty=function(x){return!x||Object.keys(x).length===0&&x.constructor===Object},s.isPromise=function(x){return Promise.resolve(x)===x},s.isPrintableKey=function(x){return x>47&&x<58||x===32||x===13||x===229||x>64&&x<91||x>95&&x<112||x>185&&x<193||x>218&&x<223},s.sequence=function(x){return _.apply(this,arguments)},s.array=function(x){return Array.prototype.slice.call(x)},s.delay=function(x,S){return function(){var w=this,E=arguments;window.setTimeout(function(){return x.apply(w,E)},S)}},s.getFileExtension=function(x){return x.name.split(".").pop()},s.isValidMimeType=function(x){return/^[-\w]+\/([-+\w]+|\*)$/.test(x)},s.debounce=function(x,S,w){var E,L=arguments,I=this;return function(){var A=I,B=L,T=w&&!E;window.clearTimeout(E),E=window.setTimeout(function(){E=null,w||x.apply(A,B)},S),T&&x.apply(A,B)}},s.copyTextToClipboard=function(x){var S=c.default.make("div","codex-editor-clipboard",{innerHTML:x});document.body.appendChild(S);var w=window.getSelection(),E=document.createRange();E.selectNode(S),window.getSelection().removeAllRanges(),w.addRange(E),document.execCommand("copy"),document.body.removeChild(S)},s.getUserOS=m,s.capitalize=function(x){return x[0].toUpperCase()+x.slice(1)},s.deepMerge=function x(S){for(var w=arguments.length,E=new Array(w>1?w-1:0),L=1;L<w;L++)E[L-1]=arguments[L];if(!E.length)return S;var I=E.shift();if(O(S)&&O(I))for(var A in I)O(I[A])?(S[A]||Object.assign(S,(0,l.default)({},A,{})),x(S[A],I[A])):Object.assign(S,(0,l.default)({},A,I[A]));return x.apply(void 0,[S].concat(E))},s.beautifyShortcut=function(x){var S=m();return x=x.replace(/shift/gi,"\u21E7").replace(/backspace/gi,"\u232B").replace(/enter/gi,"\u23CE").replace(/up/gi,"\u2191").replace(/left/gi,"\u2192").replace(/down/gi,"\u2193").replace(/right/gi,"\u2190").replace(/escape/gi,"\u238B").replace(/insert/gi,"Ins").replace(/delete/gi,"\u2421").replace(/\+/gi," + "),x=S.mac?x.replace(/ctrl|cmd/gi,"\u2318").replace(/alt/gi,"\u2325"):x.replace(/cmd/gi,"Ctrl").replace(/windows/gi,"WIN")},s.getValidUrl=function(x){try{return new URL(x).href}catch(S){}return x.substring(0,2)==="//"?window.location.protocol+x:window.location.origin+x},s.openTab=function(x){window.open(x,"_blank")},s.generateId=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return"".concat(x).concat(Math.floor(1e8*Math.random()).toString(16))},s.deprecationAssert=function(x,S,w){var E="\xAB".concat(S,"\xBB is deprecated and will be removed in the next major release. Please use the \xAB").concat(w,"\xBB instead.");x&&v(E,"warn")},s.isTouchSupported=s.logLabeled=s.log=s.mouseButtons=s.keyCodes=s.LogLevels=void 0,o=p(o),l=p(l),u=p(u),c=p(c),s.LogLevels=h,function(x){x.VERBOSE="VERBOSE",x.INFO="INFO",x.WARN="WARN",x.ERROR="ERROR"}(h||(s.LogLevels=h={})),s.keyCodes={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,LEFT:37,UP:38,DOWN:40,RIGHT:39,DELETE:46,META:91},s.mouseButtons={LEFT:0,WHEEL:1,RIGHT:2,BACKWARD:3,FORWARD:4},g.logLevel=h.VERBOSE;var b=g.bind(window,!1);s.log=b;var v=g.bind(window,!0);function k(x){return Object.prototype.toString.call(x).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}function C(x){return k(x)==="function"}function O(x){return k(x)==="object"}function d(x){return k(x)==="undefined"}function _(){return(_=(0,u.default)(o.default.mark(function x(S){var w,E,L,I,A=arguments;return o.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return I=function(){return(I=(0,u.default)(o.default.mark(function T(M,j,J){return o.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.prev=0,U.next=3,M.function(M.data);case 3:return U.next=5,j(d(M.data)?{}:M.data);case 5:U.next=10;break;case 7:U.prev=7,U.t0=U.catch(0),J(d(M.data)?{}:M.data);case 10:case"end":return U.stop()}},T,null,[[0,7]])}))).apply(this,arguments)},L=function(T,M,j){return I.apply(this,arguments)},w=A.length>1&&A[1]!==void 0?A[1]:function(){},E=A.length>2&&A[2]!==void 0?A[2]:function(){},B.abrupt("return",S.reduce(function(){var T=(0,u.default)(o.default.mark(function M(j,J){return o.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.next=2,j;case 2:return U.abrupt("return",L(J,w,E));case 3:case"end":return U.stop()}},M)}));return function(M,j){return T.apply(this,arguments)}}(),Promise.resolve()));case 5:case"end":return B.stop()}},x)}))).apply(this,arguments)}function m(){var x={win:!1,mac:!1,x11:!1,linux:!1},S=Object.keys(x).find(function(w){return navigator.appVersion.toLowerCase().indexOf(w)!==-1});return S&&(x[S]=!0),x}s.logLabeled=v;var y="ontouchstart"in document.documentElement;s.isTouchSupported=y})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(143);function n(){if(typeof WeakMap!="function")return null;var a=new WeakMap;return n=function(){return a},a}i.exports=function(a){if(a&&a.__esModule)return a;if(a===null||r(a)!=="object"&&typeof a!="function")return{default:a};var s=n();if(s&&s.has(a))return s.get(a);var o={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in a)if(Object.prototype.hasOwnProperty.call(a,u)){var c=l?Object.getOwnPropertyDescriptor(a,u):null;c&&(c.get||c.set)?Object.defineProperty(o,u,c):o[u]=a[u]}return o.default=a,s&&s.set(a,o),o}},function(i,t){var e=i.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)},function(i,t){i.exports=function(e){try{return!!e()}catch(r){return!0}}},function(i,t,e){var r=e(13);i.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(i,t){i.exports=function(e){return typeof e=="object"?e!==null:typeof e=="function"}},function(i,t,e){var r=e(67)("wks"),n=e(44),a=e(10).Symbol,s=typeof a=="function";(i.exports=function(o){return r[o]||(r[o]=s&&a[o]||(s?a:n)("Symbol."+o))}).store=r},function(i,t,e){var r,n,a;n=[t,e(42),e(2),e(3),e(8)],(a=typeof(r=function(s,o,l,u,c){"use strict";var h=e(9),p=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=p(o),l=p(l),u=p(u),c=h(c);var g=function(){function b(){(0,l.default)(this,b)}return(0,u.default)(b,null,[{key:"isSingleTag",value:function(v){return v.tagName&&["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"].includes(v.tagName)}},{key:"isLineBreakTag",value:function(v){return v&&v.tagName&&["BR","WBR"].includes(v.tagName)}},{key:"make",value:function(v){var k,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=document.createElement(v);for(var _ in Array.isArray(C)?(k=d.classList).add.apply(k,(0,o.default)(C)):C&&d.classList.add(C),O)Object.prototype.hasOwnProperty.call(O,_)&&(d[_]=O[_]);return d}},{key:"text",value:function(v){return document.createTextNode(v)}},{key:"svg",value:function(v){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:14,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:14,O=document.createElementNS("http://www.w3.org/2000/svg","svg");return O.classList.add("icon","icon--"+v),O.setAttribute("width",k+"px"),O.setAttribute("height",C+"px"),O.innerHTML='<use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#'.concat(v,'"></use>'),O}},{key:"append",value:function(v,k){Array.isArray(k)?k.forEach(function(C){return v.appendChild(C)}):v.appendChild(k)}},{key:"prepend",value:function(v,k){Array.isArray(k)?(k=k.reverse()).forEach(function(C){return v.prepend(C)}):v.prepend(k)}},{key:"swap",value:function(v,k){var C=document.createElement("div"),O=v.parentNode;O.insertBefore(C,v),O.insertBefore(v,k),O.insertBefore(k,C),O.removeChild(C)}},{key:"find",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,k=arguments.length>1?arguments[1]:void 0;return v.querySelector(k)}},{key:"get",value:function(v){return document.getElementById(v)}},{key:"findAll",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,k=arguments.length>1?arguments[1]:void 0;return v.querySelectorAll(k)}},{key:"findAllInputs",value:function(v){return c.array(v.querySelectorAll(b.allInputsSelector)).reduce(function(k,C){return b.isNativeInput(C)||b.containsOnlyInlineElements(C)?[].concat((0,o.default)(k),[C]):[].concat((0,o.default)(k),(0,o.default)(b.getDeepestBlockElements(C)))},[])}},{key:"getDeepestNode",value:function(v){var k=arguments.length>1&&arguments[1]!==void 0&&arguments[1],C=k?"lastChild":"firstChild",O=k?"previousSibling":"nextSibling";if(v&&v.nodeType===Node.ELEMENT_NODE&&v[C]){var d=v[C];if(b.isSingleTag(d)&&!b.isNativeInput(d)&&!b.isLineBreakTag(d))if(d[O])d=d[O];else{if(!d.parentNode[O])return d.parentNode;d=d.parentNode[O]}return this.getDeepestNode(d,k)}return v}},{key:"isElement",value:function(v){return!c.isNumber(v)&&v&&v.nodeType&&v.nodeType===Node.ELEMENT_NODE}},{key:"isFragment",value:function(v){return!c.isNumber(v)&&v&&v.nodeType&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE}},{key:"isContentEditable",value:function(v){return v.contentEditable==="true"}},{key:"isNativeInput",value:function(v){return!(!v||!v.tagName)&&["INPUT","TEXTAREA"].includes(v.tagName)}},{key:"canSetCaret",value:function(v){var k=!0;if(b.isNativeInput(v))switch(v.type){case"file":case"checkbox":case"radio":case"hidden":case"submit":case"button":case"image":case"reset":k=!1}else k=b.isContentEditable(v);return k}},{key:"isNodeEmpty",value:function(v){return!(this.isSingleTag(v)&&!this.isLineBreakTag(v))&&(this.isElement(v)&&this.isNativeInput(v)?v.value:v.textContent.replace("\u200B","")).trim().length===0}},{key:"isLeaf",value:function(v){return!!v&&v.childNodes.length===0}},{key:"isEmpty",value:function(v){v.normalize();for(var k=[v];k.length>0;)if(v=k.shift()){if(this.isLeaf(v)&&!this.isNodeEmpty(v))return!1;v.childNodes&&k.push.apply(k,(0,o.default)(Array.from(v.childNodes)))}return!0}},{key:"isHTMLString",value:function(v){var k=b.make("div");return k.innerHTML=v,k.childElementCount>0}},{key:"getContentLength",value:function(v){return b.isNativeInput(v)?v.value.length:v.nodeType===Node.TEXT_NODE?v.length:v.textContent.length}},{key:"containsOnlyInlineElements",value:function(v){var k;return c.isString(v)?(k=document.createElement("div")).innerHTML=v:k=v,Array.from(k.children).every(function C(O){return!b.blockElements.includes(O.tagName.toLowerCase())&&Array.from(O.children).every(C)})}},{key:"getDeepestBlockElements",value:function(v){return b.containsOnlyInlineElements(v)?[v]:Array.from(v.children).reduce(function(k,C){return[].concat((0,o.default)(k),(0,o.default)(b.getDeepestBlockElements(C)))},[])}},{key:"getHolder",value:function(v){return c.isString(v)?document.getElementById(v):v}},{key:"isExtensionNode",value:function(v){return v&&["GRAMMARLY-EXTENSION"].includes(v.nodeName)}},{key:"isAnchor",value:function(v){return v.tagName.toLowerCase()==="a"}},{key:"allInputsSelector",get:function(){return"[contenteditable], textarea, input:not([type]), "+["text","password","email","number","search","tel","url"].map(function(v){return'input[type="'.concat(v,'"]')}).join(", ")}},{key:"blockElements",get:function(){return["address","article","aside","blockquote","canvas","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","ruby","section","table","tr","tfoot","ul","video"]}}]),b}();s.default=g,g.displayName="Dom",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(33),n=Math.min;i.exports=function(a){return a>0?n(r(a),9007199254740991):0}},function(i,t){var e=i.exports={version:"2.6.11"};typeof __e=="number"&&(__e=e)},function(i,t,e){i.exports=!e(11)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(i,t,e){var r=e(12),n=e(109),a=e(40),s=Object.defineProperty;t.f=e(18)?Object.defineProperty:function(o,l,u){if(r(o),l=a(l,!0),r(u),n)try{return s(o,l,u)}catch(c){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(o[l]=u.value),o}},function(i,t,e){var r=e(38);i.exports=function(n){return Object(r(n))}},function(i,t,e){i.exports=e(140)},function(i,t){function e(r,n,a,s,o,l,u){try{var c=r[l](u),h=c.value}catch(p){return void a(p)}c.done?n(h):Promise.resolve(h).then(s,o)}i.exports=function(r){return function(){var n=this,a=arguments;return new Promise(function(s,o){var l=r.apply(n,a);function u(h){e(l,s,o,u,c,"next",h)}function c(h){e(l,s,o,u,c,"throw",h)}u(void 0)})}}},function(i,t,e){var r=e(10),n=e(27),a=e(26),s=e(44)("src"),o=e(188),l=(""+o).split("toString");e(17).inspectSource=function(u){return o.call(u)},(i.exports=function(u,c,h,p){var g=typeof h=="function";g&&(a(h,"name")||n(h,"name",c)),u[c]!==h&&(g&&(a(h,s)||n(h,s,u[c]?""+u[c]:l.join(String(c)))),u===r?u[c]=h:p?u[c]?u[c]=h:n(u,c,h):(delete u[c],n(u,c,h)))})(Function.prototype,"toString",function(){return typeof this=="function"&&this[s]||o.call(this)})},function(i,t,e){var r=e(0),n=e(11),a=e(38),s=/"/g,o=function(l,u,c,h){var p=String(a(l)),g="<"+u;return c!==""&&(g+=" "+c+'="'+String(h).replace(s,"&quot;")+'"'),g+">"+p+"</"+u+">"};i.exports=function(l,u){var c={};c[l]=u(o),r(r.P+r.F*n(function(){var h=""[l]('"');return h!==h.toLowerCase()||h.split('"').length>3}),"String",c)}},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(8),e(15)],(a=typeof(r=function(s,o,l,u,c){"use strict";var h=e(9),p=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=p(o),l=p(l),u=h(u),c=p(c);var g=function(){function b(){(0,o.default)(this,b),this.instance=null,this.selection=null,this.savedSelectionRange=null,this.isFakeBackgroundEnabled=!1,this.commandBackground="backColor",this.commandRemoveFormat="removeFormat"}return(0,l.default)(b,[{key:"removeFakeBackground",value:function(){this.isFakeBackgroundEnabled&&(this.isFakeBackgroundEnabled=!1,document.execCommand(this.commandRemoveFormat))}},{key:"setFakeBackground",value:function(){document.execCommand(this.commandBackground,!1,"#a8d6ff"),this.isFakeBackgroundEnabled=!0}},{key:"save",value:function(){this.savedSelectionRange=b.range}},{key:"restore",value:function(){if(this.savedSelectionRange){var v=window.getSelection();v.removeAllRanges(),v.addRange(this.savedSelectionRange)}}},{key:"clearSaved",value:function(){this.savedSelectionRange=null}},{key:"collapseToEnd",value:function(){var v=window.getSelection(),k=document.createRange();k.selectNodeContents(v.focusNode),k.collapse(!1),v.removeAllRanges(),v.addRange(k)}},{key:"findParentTag",value:function(v,k){var C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,O=window.getSelection(),d=null;if(!O||!O.anchorNode||!O.focusNode)return null;var _=[O.anchorNode,O.focusNode];return _.forEach(function(m){for(var y=C;y>0&&m.parentNode&&(m.tagName!==v||(d=m,k&&m.classList&&!m.classList.contains(k)&&(d=null),!d));)m=m.parentNode,y--}),d}},{key:"expandToTag",value:function(v){var k=window.getSelection();k.removeAllRanges();var C=document.createRange();C.selectNodeContents(v),k.addRange(C)}}],[{key:"get",value:function(){return window.getSelection()}},{key:"setCursor",value:function(v){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=document.createRange(),O=window.getSelection();return c.default.isNativeInput(v)?c.default.canSetCaret(v)?(v.focus(),v.selectionStart=v.selectionEnd=k,v.getBoundingClientRect()):void 0:(C.setStart(v,k),C.setEnd(v,k),O.removeAllRanges(),O.addRange(C),C.getBoundingClientRect())}},{key:"CSS",get:function(){return{editorWrapper:"codex-editor",editorZone:"codex-editor__redactor"}}},{key:"anchorNode",get:function(){var v=window.getSelection();return v?v.anchorNode:null}},{key:"anchorElement",get:function(){var v=window.getSelection();if(!v)return null;var k=v.anchorNode;return k?c.default.isElement(k)?k:k.parentElement:null}},{key:"anchorOffset",get:function(){var v=window.getSelection();return v?v.anchorOffset:null}},{key:"isCollapsed",get:function(){var v=window.getSelection();return v?v.isCollapsed:null}},{key:"isAtEditor",get:function(){var v=b.get(),k=v.anchorNode||v.focusNode;k&&k.nodeType===Node.TEXT_NODE&&(k=k.parentNode);var C=null;return k&&(C=k.closest(".".concat(b.CSS.editorZone))),C&&C.nodeType===Node.ELEMENT_NODE}},{key:"isSelectionExists",get:function(){return!!b.get().anchorNode}},{key:"range",get:function(){var v=window.getSelection();return v&&v.rangeCount?v.getRangeAt(0):null}},{key:"rect",get:function(){var v,k=document.selection,C={x:0,y:0,width:0,height:0};if(k&&k.type!=="Control")return v=(k=k).createRange(),C.x=v.boundingLeft,C.y=v.boundingTop,C.width=v.boundingWidth,C.height=v.boundingHeight,C;if(!window.getSelection)return u.log("Method window.getSelection is not supported","warn"),C;if((k=window.getSelection()).rangeCount===null||isNaN(k.rangeCount))return u.log("Method SelectionUtils.rangeCount is not supported","warn"),C;if(k.rangeCount===0)return C;if((v=k.getRangeAt(0).cloneRange()).getBoundingClientRect&&(C=v.getBoundingClientRect()),C.x===0&&C.y===0){var O=document.createElement("span");if(O.getBoundingClientRect){O.appendChild(document.createTextNode("\u200B")),v.insertNode(O),C=O.getBoundingClientRect();var d=O.parentNode;d.removeChild(O),d.normalize()}}return C}},{key:"text",get:function(){return window.getSelection?window.getSelection().toString():""}}]),b}();s.default=g,g.displayName="SelectionUtils",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t){var e={}.hasOwnProperty;i.exports=function(r,n){return e.call(r,n)}},function(i,t,e){var r=e(19),n=e(43);i.exports=e(18)?function(a,s,o){return r.f(a,s,n(1,o))}:function(a,s,o){return a[s]=o,a}},function(i,t,e){var r=e(62),n=e(38);i.exports=function(a){return r(n(a))}},function(i,t,e){var r=e(357),n=e(358),a=e(141),s=e(359);i.exports=function(o,l){return r(o)||n(o,l)||a(o,l)||s()}},function(i,t,e){"use strict";var r=e(11);i.exports=function(n,a){return!!n&&r(function(){a?n.call(null,function(){},1):n.call(null)})}},function(i,t,e){var r=e(32);i.exports=function(n,a,s){if(r(n),a===void 0)return n;switch(s){case 1:return function(o){return n.call(a,o)};case 2:return function(o,l){return n.call(a,o,l)};case 3:return function(o,l,u){return n.call(a,o,l,u)}}return function(){return n.apply(a,arguments)}}},function(i,t){i.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(i,t){var e=Math.ceil,r=Math.floor;i.exports=function(n){return isNaN(n=+n)?0:(n>0?r:e)(n)}},function(i,t,e){var r=e(63),n=e(43),a=e(28),s=e(40),o=e(26),l=e(109),u=Object.getOwnPropertyDescriptor;t.f=e(18)?u:function(c,h){if(c=a(c),h=s(h,!0),l)try{return u(c,h)}catch(p){}if(o(c,h))return n(!r.f.call(c,h),c[h])}},function(i,t,e){var r=e(0),n=e(17),a=e(11);i.exports=function(s,o){var l=(n.Object||{})[s]||Object[s],u={};u[s]=o(l),r(r.S+r.F*a(function(){l(1)}),"Object",u)}},function(i,t,e){var r=e(31),n=e(62),a=e(20),s=e(16),o=e(125);i.exports=function(l,u){var c=l==1,h=l==2,p=l==3,g=l==4,b=l==6,v=l==5||b,k=u||o;return function(C,O,d){for(var _,m,y=a(C),x=n(y),S=r(O,d,3),w=s(x.length),E=0,L=c?k(C,w):h?k(C,0):void 0;w>E;E++)if((v||E in x)&&(m=S(_=x[E],E,y),l)){if(c)L[E]=m;else if(m)switch(l){case 3:return!0;case 5:return _;case 6:return E;case 2:L.push(_)}else if(g)return!1}return b?-1:p||g?g:L}}},function(i,t){var e={}.toString;i.exports=function(r){return e.call(r).slice(8,-1)}},function(i,t){i.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},function(i,t,e){"use strict";if(e(18)){var r=e(45),n=e(10),a=e(11),s=e(0),o=e(78),l=e(106),u=e(31),c=e(57),h=e(43),p=e(27),g=e(58),b=e(33),v=e(16),k=e(136),C=e(47),O=e(40),d=e(26),_=e(64),m=e(13),y=e(20),x=e(98),S=e(48),w=e(50),E=e(49).f,L=e(100),I=e(44),A=e(14),B=e(36),T=e(68),M=e(65),j=e(102),J=e(55),U=e(71),H=e(56),te=e(101),se=e(127),W=e(19),Y=e(34),ie=W.f,re=Y.f,Q=n.RangeError,ee=n.TypeError,pe=n.Uint8Array,be=Array.prototype,we=l.ArrayBuffer,Le=l.DataView,fe=B(0),xe=B(2),Ne=B(3),Be=B(4),Pe=B(5),Ze=B(6),tt=T(!0),Xe=T(!1),Ke=j.values,nt=j.keys,at=j.entries,ce=be.lastIndexOf,ve=be.reduce,Ie=be.reduceRight,He=be.join,st=be.sort,vt=be.slice,bt=be.toString,Me=be.toLocaleString,yt=A("iterator"),Vt=A("toStringTag"),Ft=I("typed_constructor"),Ye=I("def_constructor"),Ge=o.CONSTR,Qe=o.TYPED,qe=o.VIEW,ei=B(1,function(Ee,Te){return ii(M(Ee,Ee[Ye]),Te)}),dt=a(function(){return new pe(new Uint16Array([1]).buffer)[0]===1}),De=!!pe&&!!pe.prototype.set&&a(function(){new pe(1).set({})}),ti=function(Ee,Te){var ze=b(Ee);if(ze<0||ze%Te)throw Q("Wrong offset!");return ze},et=function(Ee){if(m(Ee)&&Qe in Ee)return Ee;throw ee(Ee+" is not a typed array!")},ii=function(Ee,Te){if(!m(Ee)||!(Ft in Ee))throw ee("It is not a typed array constructor!");return new Ee(Te)},It=function(Ee,Te){return di(M(Ee,Ee[Ye]),Te)},di=function(Ee,Te){for(var ze=0,z=Te.length,G=ii(Ee,z);z>ze;)G[ze]=Te[ze++];return G},pt=function(Ee,Te,ze){ie(Ee,Te,{get:function(){return this._d[ze]}})},Lt=function(Ee){var Te,ze,z,G,Z,de,le=y(Ee),Ce=arguments.length,Se=Ce>1?arguments[1]:void 0,Re=Se!==void 0,Ae=L(le);if(Ae!=null&&!x(Ae)){for(de=Ae.call(le),z=[],Te=0;!(Z=de.next()).done;Te++)z.push(Z.value);le=z}for(Re&&Ce>2&&(Se=u(Se,arguments[2],2)),Te=0,ze=v(le.length),G=ii(this,ze);ze>Te;Te++)G[Te]=Re?Se(le[Te],Te):le[Te];return G},Xt=function(){for(var Ee=0,Te=arguments.length,ze=ii(this,Te);Te>Ee;)ze[Ee]=arguments[Ee++];return ze},xi=!!pe&&a(function(){Me.call(new pe(1))}),Nt=function(){return Me.apply(xi?vt.call(et(this)):et(this),arguments)},ri={copyWithin:function(Ee,Te){return se.call(et(this),Ee,Te,arguments.length>2?arguments[2]:void 0)},every:function(Ee){return Be(et(this),Ee,arguments.length>1?arguments[1]:void 0)},fill:function(Ee){return te.apply(et(this),arguments)},filter:function(Ee){return It(this,xe(et(this),Ee,arguments.length>1?arguments[1]:void 0))},find:function(Ee){return Pe(et(this),Ee,arguments.length>1?arguments[1]:void 0)},findIndex:function(Ee){return Ze(et(this),Ee,arguments.length>1?arguments[1]:void 0)},forEach:function(Ee){fe(et(this),Ee,arguments.length>1?arguments[1]:void 0)},indexOf:function(Ee){return Xe(et(this),Ee,arguments.length>1?arguments[1]:void 0)},includes:function(Ee){return tt(et(this),Ee,arguments.length>1?arguments[1]:void 0)},join:function(Ee){return He.apply(et(this),arguments)},lastIndexOf:function(Ee){return ce.apply(et(this),arguments)},map:function(Ee){return ei(et(this),Ee,arguments.length>1?arguments[1]:void 0)},reduce:function(Ee){return ve.apply(et(this),arguments)},reduceRight:function(Ee){return Ie.apply(et(this),arguments)},reverse:function(){for(var Ee,Te=et(this).length,ze=Math.floor(Te/2),z=0;z<ze;)Ee=this[z],this[z++]=this[--Te],this[Te]=Ee;return this},some:function(Ee){return Ne(et(this),Ee,arguments.length>1?arguments[1]:void 0)},sort:function(Ee){return st.call(et(this),Ee)},subarray:function(Ee,Te){var ze=et(this),z=ze.length,G=C(Ee,z);return new(M(ze,ze[Ye]))(ze.buffer,ze.byteOffset+G*ze.BYTES_PER_ELEMENT,v((Te===void 0?z:C(Te,z))-G))}},Pt=function(Ee,Te){return It(this,vt.call(et(this),Ee,Te))},hi=function(Ee){et(this);var Te=ti(arguments[1],1),ze=this.length,z=y(Ee),G=v(z.length),Z=0;if(G+Te>ze)throw Q("Wrong length!");for(;Z<G;)this[Te+Z]=z[Z++]},Kt={entries:function(){return at.call(et(this))},keys:function(){return nt.call(et(this))},values:function(){return Ke.call(et(this))}},ni=function(Ee,Te){return m(Ee)&&Ee[Qe]&&typeof Te!="symbol"&&Te in Ee&&String(+Te)==String(Te)},Tt=function(Ee,Te){return ni(Ee,Te=O(Te,!0))?h(2,Ee[Te]):re(Ee,Te)},Et=function(Ee,Te,ze){return!(ni(Ee,Te=O(Te,!0))&&m(ze)&&d(ze,"value"))||d(ze,"get")||d(ze,"set")||ze.configurable||d(ze,"writable")&&!ze.writable||d(ze,"enumerable")&&!ze.enumerable?ie(Ee,Te,ze):(Ee[Te]=ze.value,Ee)};Ge||(Y.f=Tt,W.f=Et),s(s.S+s.F*!Ge,"Object",{getOwnPropertyDescriptor:Tt,defineProperty:Et}),a(function(){bt.call({})})&&(bt=Me=function(){return He.call(this)});var wt=g({},ri);g(wt,Kt),p(wt,yt,Kt.values),g(wt,{slice:Pt,set:hi,constructor:function(){},toString:bt,toLocaleString:Nt}),pt(wt,"buffer","b"),pt(wt,"byteOffset","o"),pt(wt,"byteLength","l"),pt(wt,"length","e"),ie(wt,Vt,{get:function(){return this[Qe]}}),i.exports=function(Ee,Te,ze,z){var G=Ee+((z=!!z)?"Clamped":"")+"Array",Z="get"+Ee,de="set"+Ee,le=n[G],Ce=le||{},Se=le&&w(le),Re=!le||!o.ABV,Ae={},$e=le&&le.prototype,We=function(Je,Ue){ie(Je,Ue,{get:function(){return function(At,$t){var xt=At._d;return xt.v[Z]($t*Te+xt.o,dt)}(this,Ue)},set:function(At){return function($t,xt,St){var F=$t._d;z&&(St=(St=Math.round(St))<0?0:St>255?255:255&St),F.v[de](xt*Te+F.o,St,dt)}(this,Ue,At)},enumerable:!0})};Re?(le=ze(function(Je,Ue,At,$t){c(Je,le,G,"_d");var xt,St,F,ne,V=0,ae=0;if(m(Ue)){if(!(Ue instanceof we||(ne=_(Ue))=="ArrayBuffer"||ne=="SharedArrayBuffer"))return Qe in Ue?di(le,Ue):Lt.call(le,Ue);xt=Ue,ae=ti(At,Te);var D=Ue.byteLength;if($t===void 0){if(D%Te||(St=D-ae)<0)throw Q("Wrong length!")}else if((St=v($t)*Te)+ae>D)throw Q("Wrong length!");F=St/Te}else F=k(Ue),xt=new we(St=F*Te);for(p(Je,"_d",{b:xt,o:ae,l:St,e:F,v:new Le(xt)});V<F;)We(Je,V++)}),$e=le.prototype=S(wt),p($e,"constructor",le)):a(function(){le(1)})&&a(function(){new le(-1)})&&U(function(Je){new le,new le(null),new le(1.5),new le(Je)},!0)||(le=ze(function(Je,Ue,At,$t){var xt;return c(Je,le,G),m(Ue)?Ue instanceof we||(xt=_(Ue))=="ArrayBuffer"||xt=="SharedArrayBuffer"?$t!==void 0?new Ce(Ue,ti(At,Te),$t):At!==void 0?new Ce(Ue,ti(At,Te)):new Ce(Ue):Qe in Ue?di(le,Ue):Lt.call(le,Ue):new Ce(k(Ue))}),fe(Se!==Function.prototype?E(Ce).concat(E(Se)):E(Ce),function(Je){Je in le||p(le,Je,Ce[Je])}),le.prototype=$e,r||($e.constructor=le));var Fe=$e[yt],it=!!Fe&&(Fe.name=="values"||Fe.name==null),mt=Kt.values;p(le,Ft,!0),p($e,Qe,G),p($e,qe,!0),p($e,Ye,le),(z?new le(1)[Vt]==G:Vt in $e)||ie($e,Vt,{get:function(){return G}}),Ae[G]=le,s(s.G+s.W+s.F*(le!=Ce),Ae),s(s.S,G,{BYTES_PER_ELEMENT:Te}),s(s.S+s.F*a(function(){Ce.of.call(le,1)}),G,{from:Lt,of:Xt}),"BYTES_PER_ELEMENT"in $e||p($e,"BYTES_PER_ELEMENT",Te),s(s.P,G,ri),H(G),s(s.P+s.F*De,G,{set:hi}),s(s.P+s.F*!it,G,Kt),r||$e.toString==bt||($e.toString=bt),s(s.P+s.F*a(function(){new le(1).slice()}),G,{slice:Pt}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new le([1,2]).toLocaleString()})||!a(function(){$e.toLocaleString.call([1,2])})),G,{toLocaleString:Nt}),J[G]=it?Fe:mt,r||it||p($e,yt,mt)}}else i.exports=function(){}},function(i,t,e){var r=e(13);i.exports=function(n,a){if(!r(n))return n;var s,o;if(a&&typeof(s=n.toString)=="function"&&!r(o=s.call(n))||typeof(s=n.valueOf)=="function"&&!r(o=s.call(n))||!a&&typeof(s=n.toString)=="function"&&!r(o=s.call(n)))return o;throw TypeError("Can't convert object to primitive value")}},function(i,t,e){var r=e(44)("meta"),n=e(13),a=e(26),s=e(19).f,o=0,l=Object.isExtensible||function(){return!0},u=!e(11)(function(){return l(Object.preventExtensions({}))}),c=function(p){s(p,r,{value:{i:"O"+ ++o,w:{}}})},h=i.exports={KEY:r,NEED:!1,fastKey:function(p,g){if(!n(p))return typeof p=="symbol"?p:(typeof p=="string"?"S":"P")+p;if(!a(p,r)){if(!l(p))return"F";if(!g)return"E";c(p)}return p[r].i},getWeak:function(p,g){if(!a(p,r)){if(!l(p))return!0;if(!g)return!1;c(p)}return p[r].w},onFreeze:function(p){return u&&h.NEED&&l(p)&&!a(p,r)&&c(p),p}}},function(i,t,e){var r=e(364),n=e(365),a=e(141),s=e(366);i.exports=function(o){return r(o)||n(o)||a(o)||s()}},function(i,t){i.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}},function(i,t){var e=0,r=Math.random();i.exports=function(n){return"Symbol(".concat(n===void 0?"":n,")_",(++e+r).toString(36))}},function(i,t){i.exports=!1},function(i,t,e){var r=e(111),n=e(85);i.exports=Object.keys||function(a){return r(a,n)}},function(i,t,e){var r=e(33),n=Math.max,a=Math.min;i.exports=function(s,o){return(s=r(s))<0?n(s+o,0):a(s,o)}},function(i,t,e){var r=e(12),n=e(112),a=e(85),s=e(84)("IE_PROTO"),o=function(){},l=function(){var u,c=e(82)("iframe"),h=a.length;for(c.style.display="none",e(86).appendChild(c),c.src="javascript:",(u=c.contentWindow.document).open(),u.write("<script>document.F=Object<\/script>"),u.close(),l=u.F;h--;)delete l.prototype[a[h]];return l()};i.exports=Object.create||function(u,c){var h;return u!==null?(o.prototype=r(u),h=new o,o.prototype=null,h[s]=u):h=l(),c===void 0?h:n(h,c)}},function(i,t,e){var r=e(111),n=e(85).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(a){return r(a,n)}},function(i,t,e){var r=e(26),n=e(20),a=e(84)("IE_PROTO"),s=Object.prototype;i.exports=Object.getPrototypeOf||function(o){return o=n(o),r(o,a)?o[a]:typeof o.constructor=="function"&&o instanceof o.constructor?o.constructor.prototype:o instanceof Object?s:null}},function(i,t,e){var r=e(14)("unscopables"),n=Array.prototype;n[r]==null&&e(27)(n,r,{}),i.exports=function(a){n[r][a]=!0}},function(i,t,e){var r=e(13);i.exports=function(n,a){if(!r(n)||n._t!==a)throw TypeError("Incompatible receiver, "+a+" required!");return n}},function(i,t,e){var r=e(19).f,n=e(26),a=e(14)("toStringTag");i.exports=function(s,o,l){s&&!n(s=l?s:s.prototype,a)&&r(s,a,{configurable:!0,value:o})}},function(i,t,e){var r=e(0),n=e(38),a=e(11),s=e(88),o="["+s+"]",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),c=function(p,g,b){var v={},k=a(function(){return!!s[p]()||"\u200B\x85"[p]()!="\u200B\x85"}),C=v[p]=k?g(h):s[p];b&&(v[b]=C),r(r.P+r.F*k,"String",v)},h=c.trim=function(p,g){return p=String(n(p)),1&g&&(p=p.replace(l,"")),2&g&&(p=p.replace(u,"")),p};i.exports=c},function(i,t){i.exports={}},function(i,t,e){"use strict";var r=e(10),n=e(19),a=e(18),s=e(14)("species");i.exports=function(o){var l=r[o];a&&l&&!l[s]&&n.f(l,s,{configurable:!0,get:function(){return this}})}},function(i,t){i.exports=function(e,r,n,a){if(!(e instanceof r)||a!==void 0&&a in e)throw TypeError(n+": incorrect invocation!");return e}},function(i,t,e){var r=e(23);i.exports=function(n,a,s){for(var o in a)r(n,o,a[o],s);return n}},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(144)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(){(0,o.default)(this,p)}return(0,l.default)(p,null,[{key:"ui",value:function(g,b){return p._t(g,b)}},{key:"t",value:function(g,b){return p._t(g,b)}},{key:"setDictionary",value:function(g){p.currentDictionary=g}},{key:"_t",value:function(g,b){var v=p.getNamespace(g);return v&&v[b]?v[b]:b}},{key:"getNamespace",value:function(g){return g.split(".").reduce(function(b,v){return b&&Object.keys(b).length?b[v]:{}},p.currentDictionary)}}]),p}();s.default=h,h.displayName="I18n",h.currentDictionary=u.default,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(375),e(8)],(a=typeof(r=function(s,o,l,u,c){"use strict";var h=e(9),p=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=p(o),l=p(l),u=p(u),c=h(c);var g=function(){function b(v){var k=this;(0,o.default)(this,b),this.iterator=null,this.activated=!1,this.allowArrows=!0,this.onKeyDown=function(C){if(k.isEventReadyForHandling(C))switch(b.usedKeys.includes(C.keyCode)&&C.preventDefault(),C.keyCode){case c.keyCodes.TAB:k.handleTabPress(C);break;case c.keyCodes.LEFT:case c.keyCodes.UP:k.flipLeft();break;case c.keyCodes.RIGHT:case c.keyCodes.DOWN:k.flipRight();break;case c.keyCodes.ENTER:k.handleEnterPress(C)}},this.allowArrows=!c.isBoolean(v.allowArrows)||v.allowArrows,this.iterator=new u.default(v.items,v.focusedItemClass),this.activateCallback=v.activateCallback}return(0,l.default)(b,[{key:"activate",value:function(v){this.activated=!0,v&&this.iterator.setItems(v),document.addEventListener("keydown",this.onKeyDown)}},{key:"deactivate",value:function(){this.activated=!1,this.dropCursor(),document.removeEventListener("keydown",this.onKeyDown)}},{key:"focusFirst",value:function(){this.dropCursor(),this.flipRight()}},{key:"flipLeft",value:function(){this.iterator.previous()}},{key:"flipRight",value:function(){this.iterator.next()}},{key:"dropCursor",value:function(){this.iterator.dropCursor()}},{key:"isEventReadyForHandling",value:function(v){var k=[c.keyCodes.TAB,c.keyCodes.ENTER],C=this.iterator.currentItem==document.activeElement;return this.allowArrows&&!C&&k.push(c.keyCodes.LEFT,c.keyCodes.RIGHT,c.keyCodes.UP,c.keyCodes.DOWN),this.activated&&k.indexOf(v.keyCode)!==-1}},{key:"handleTabPress",value:function(v){switch(v.shiftKey?u.default.directions.LEFT:u.default.directions.RIGHT){case u.default.directions.RIGHT:this.flipRight();break;case u.default.directions.LEFT:this.flipLeft()}}},{key:"handleEnterPress",value:function(v){this.activated&&(this.iterator.currentItem&&this.iterator.currentItem.click(),c.isFunction(this.activateCallback)&&this.activateCallback(this.iterator.currentItem),v.preventDefault(),v.stopPropagation())}},{key:"currentItem",get:function(){return this.iterator.currentItem}}],[{key:"usedKeys",get:function(){return[c.keyCodes.TAB,c.keyCodes.LEFT,c.keyCodes.RIGHT,c.keyCodes.ENTER,c.keyCodes.UP,c.keyCodes.DOWN]}}]),b}();s.default=g,g.displayName="Flipper",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(42),e(21),e(22),e(2),e(3),e(15),e(8),e(148),e(25)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k){"use strict";var C,O=e(9),d=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.BlockToolAPI=void 0,o=d(o),l=d(l),u=d(u),c=d(c),h=d(h),p=d(p),g=d(g),b=O(b),v=d(v),k=d(k),s.BlockToolAPI=C,function(m){m.APPEND_CALLBACK="appendCallback",m.RENDERED="rendered",m.MOVED="moved",m.UPDATED="updated",m.REMOVED="removed",m.ON_PASTE="onPaste"}(C||(s.BlockToolAPI=C={}));var _=function(){function m(w){var E=this,L=w.data,I=w.tool,A=w.api,B=w.readOnly,T=w.tunes,M=w.tunesData;(0,h.default)(this,m),this.cachedInputs=[],this.tunesInstances=new Map,this.defaultTunesInstances=new Map,this.unavailableTunesData={},this.inputIndex=0,this.modificationDebounceTimer=450,this.didMutated=b.debounce(function(){E.cachedInputs=[],E.updateCurrentInput(),E.call(C.UPDATED)},this.modificationDebounceTimer),this.handleFocus=function(){E.cachedInputs=[],E.updateCurrentInput()},this.name=I.name,this.settings=I.settings,this.config=I.settings.config||{},this.api=A,this.blockAPI=new v.default(this),this.mutationObserver=new MutationObserver(this.didMutated),this.tool=I,this.toolInstance=I.create(L,this.blockAPI,B),this.tunes=T,this.composeTunes(M),this.holder=this.compose()}var y,x,S;return(0,p.default)(m,[{key:"call",value:function(w,E){if(this.toolInstance[w]&&this.toolInstance[w]instanceof Function){w===C.APPEND_CALLBACK&&b.log("`appendCallback` hook is deprecated and will be removed in the next major release. Use `rendered` hook instead","warn");try{this.toolInstance[w].call(this.toolInstance,E)}catch(L){b.log("Error during '".concat(w,"' call: ").concat(L.message),"error")}}}},{key:"mergeWith",value:(S=(0,c.default)(u.default.mark(function w(E){return u.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.toolInstance.merge(E);case 2:case"end":return L.stop()}},w,this)})),function(w){return S.apply(this,arguments)})},{key:"save",value:(x=(0,c.default)(u.default.mark(function w(){var E,L,I,A,B=this;return u.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.next=2,this.toolInstance.save(this.pluginsContent);case 2:return E=T.sent,L=this.unavailableTunesData,[].concat((0,l.default)(this.tunesInstances.entries()),(0,l.default)(this.defaultTunesInstances.entries())).forEach(function(M){var j=(0,o.default)(M,2),J=j[0],U=j[1];if(b.isFunction(U.save))try{L[J]=U.save()}catch(H){b.log("Tune ".concat(U.constructor.name," save method throws an Error %o"),"warn",H)}}),I=window.performance.now(),T.abrupt("return",Promise.resolve(E).then(function(M){return A=window.performance.now(),{tool:B.name,data:M,tunes:L,time:A-I}}).catch(function(M){b.log("Saving proccess for ".concat(B.name," tool failed due to the ").concat(M),"log","red")}));case 7:case"end":return T.stop()}},w,this)})),function(){return x.apply(this,arguments)})},{key:"validate",value:(y=(0,c.default)(u.default.mark(function w(E){var L;return u.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(L=!0,!(this.toolInstance.validate instanceof Function)){I.next=5;break}return I.next=4,this.toolInstance.validate(E);case 4:L=I.sent;case 5:return I.abrupt("return",L);case 6:case"end":return I.stop()}},w,this)})),function(w){return y.apply(this,arguments)})},{key:"renderTunes",value:function(){var w=document.createDocumentFragment(),E=document.createDocumentFragment();return this.tunesInstances.forEach(function(L){g.default.append(w,L.render())}),this.defaultTunesInstances.forEach(function(L){g.default.append(E,L.render())}),[w,E]}},{key:"updateCurrentInput",value:function(){this.currentInput=g.default.isNativeInput(document.activeElement)||!k.default.anchorNode?document.activeElement:k.default.anchorNode}},{key:"willSelect",value:function(){this.mutationObserver.observe(this.holder.firstElementChild,{childList:!0,subtree:!0,characterData:!0,attributes:!0}),this.addInputEvents()}},{key:"willUnselect",value:function(){this.mutationObserver.disconnect(),this.removeInputEvents()}},{key:"destroy",value:function(){b.isFunction(this.toolInstance.destroy)&&this.toolInstance.destroy()}},{key:"renderSettings",value:function(){if(b.isFunction(this.toolInstance.renderSettings))return this.toolInstance.renderSettings()}},{key:"compose",value:function(){var w=g.default.make("div",m.CSS.wrapper),E=g.default.make("div",m.CSS.content),L=this.toolInstance.render();E.appendChild(L);var I=E;return[].concat((0,l.default)(this.tunesInstances.values()),(0,l.default)(this.defaultTunesInstances.values())).forEach(function(A){if(b.isFunction(A.wrap))try{I=A.wrap(I)}catch(B){b.log("Tune ".concat(A.constructor.name," wrap method throws an Error %o"),"warn",B)}}),w.appendChild(I),w}},{key:"composeTunes",value:function(w){var E=this;Array.from(this.tunes.values()).forEach(function(L){(L.isInternal?E.defaultTunesInstances:E.tunesInstances).set(L.name,L.create(w[L.name],E.blockAPI))}),Object.entries(w).forEach(function(L){var I=(0,o.default)(L,2),A=I[0],B=I[1];E.tunesInstances.has(A)||(E.unavailableTunesData[A]=B)})}},{key:"addInputEvents",value:function(){var w=this;this.inputs.forEach(function(E){E.addEventListener("focus",w.handleFocus)})}},{key:"removeInputEvents",value:function(){var w=this;this.inputs.forEach(function(E){E.removeEventListener("focus",w.handleFocus)})}},{key:"inputs",get:function(){if(this.cachedInputs.length!==0)return this.cachedInputs;var w=g.default.findAllInputs(this.holder);return this.inputIndex>w.length-1&&(this.inputIndex=w.length-1),this.cachedInputs=w,w}},{key:"currentInput",get:function(){return this.inputs[this.inputIndex]},set:function(w){var E=this.inputs.findIndex(function(L){return L===w||L.contains(w)});E!==-1&&(this.inputIndex=E)}},{key:"firstInput",get:function(){return this.inputs[0]}},{key:"lastInput",get:function(){var w=this.inputs;return w[w.length-1]}},{key:"nextInput",get:function(){return this.inputs[this.inputIndex+1]}},{key:"previousInput",get:function(){return this.inputs[this.inputIndex-1]}},{key:"data",get:function(){return this.save().then(function(w){return w&&!b.isEmpty(w.data)?w.data:{}})}},{key:"sanitize",get:function(){return this.tool.sanitizeConfig}},{key:"mergeable",get:function(){return b.isFunction(this.toolInstance.merge)}},{key:"isEmpty",get:function(){var w=g.default.isEmpty(this.pluginsContent),E=!this.hasMedia;return w&&E}},{key:"hasMedia",get:function(){return!!this.holder.querySelector(["img","iframe","video","audio","source","input","textarea","twitterwidget"].join(","))}},{key:"focused",set:function(w){this.holder.classList.toggle(m.CSS.focused,w)},get:function(){return this.holder.classList.contains(m.CSS.focused)}},{key:"selected",set:function(w){w?this.holder.classList.add(m.CSS.selected):this.holder.classList.remove(m.CSS.selected)},get:function(){return this.holder.classList.contains(m.CSS.selected)}},{key:"stretched",set:function(w){this.holder.classList.toggle(m.CSS.wrapperStretched,w)},get:function(){return this.holder.classList.contains(m.CSS.wrapperStretched)}},{key:"dropTarget",set:function(w){this.holder.classList.toggle(m.CSS.dropTarget,w)}},{key:"pluginsContent",get:function(){var w=this.holder.querySelector(".".concat(m.CSS.content));if(w&&w.childNodes.length)for(var E=w.childNodes.length-1;E>=0;E--){var L=w.childNodes[E];if(!g.default.isExtensionNode(L))return L}return null}}],[{key:"CSS",get:function(){return{wrapper:"ce-block",wrapperStretched:"ce-block--stretched",content:"ce-block__content",focused:"ce-block--focused",selected:"ce-block--selected",dropTarget:"ce-block--drop-target"}}}]),m}();s.default=_,_.displayName="Block"})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(37);i.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return r(n)=="String"?n.split(""):Object(n)}},function(i,t){t.f={}.propertyIsEnumerable},function(i,t,e){var r=e(37),n=e(14)("toStringTag"),a=r(function(){return arguments}())=="Arguments";i.exports=function(s){var o,l,u;return s===void 0?"Undefined":s===null?"Null":typeof(l=function(c,h){try{return c[h]}catch(p){}}(o=Object(s),n))=="string"?l:a?r(o):(u=r(o))=="Object"&&typeof o.callee=="function"?"Arguments":u}},function(i,t,e){var r=e(12),n=e(32),a=e(14)("species");i.exports=function(s,o){var l,u=r(s).constructor;return u===void 0||(l=r(u)[a])==null?o:n(l)}},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(8)],(a=typeof(r=function(s,o,l,u){"use strict";var c,h,p,g,b,v,k=e(9),C=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=s.InternalTuneSettings=s.InternalInlineToolSettings=s.InternalBlockToolSettings=s.CommonInternalSettings=s.UserSettings=s.ToolType=void 0,o=C(o),l=C(l),u=k(u),s.ToolType=c,function(d){d[d.Block=0]="Block",d[d.Inline=1]="Inline",d[d.Tune=2]="Tune"}(c||(s.ToolType=c={})),s.UserSettings=h,function(d){d.Shortcut="shortcut",d.Toolbox="toolbox",d.EnabledInlineTools="inlineToolbar",d.EnabledBlockTunes="tunes",d.Config="config"}(h||(s.UserSettings=h={})),s.CommonInternalSettings=p,function(d){d.Shortcut="shortcut",d.SanitizeConfig="sanitize"}(p||(s.CommonInternalSettings=p={})),s.InternalBlockToolSettings=g,function(d){d.IsEnabledLineBreaks="enableLineBreaks",d.Toolbox="toolbox",d.ConversionConfig="conversionConfig",d.IsReadOnlySupported="isReadOnlySupported",d.PasteConfig="pasteConfig"}(g||(s.InternalBlockToolSettings=g={})),s.InternalInlineToolSettings=b,function(d){d.IsInline="isInline",d.Title="title"}(b||(s.InternalInlineToolSettings=b={})),s.InternalTuneSettings=v,function(d){d.IsTune="isTune"}(v||(s.InternalTuneSettings=v={}));var O=function(){function d(_){var m=_.name,y=_.constructable,x=_.config,S=_.api,w=_.isDefault,E=_.isInternal,L=E!==void 0&&E,I=_.defaultPlaceholder;(0,o.default)(this,d),this.api=S,this.name=m,this.constructable=y,this.config=x,this.isDefault=w,this.isInternal=L,this.defaultPlaceholder=I}return(0,l.default)(d,[{key:"reset",value:function(){if(u.isFunction(this.constructable.reset))return this.constructable.reset()}},{key:"prepare",value:function(){if(u.isFunction(this.constructable.prepare))return this.constructable.prepare({toolName:this.name,config:this.settings})}},{key:"isInline",value:function(){return this.type===c.Inline}},{key:"isBlock",value:function(){return this.type===c.Block}},{key:"isTune",value:function(){return this.type===c.Tune}},{key:"settings",get:function(){var _=this.config[h.Config]||{};return this.isDefault&&!("placeholder"in _)&&this.defaultPlaceholder&&(_.placeholder=this.defaultPlaceholder),_}},{key:"shortcut",get:function(){var _=this.constructable[p.Shortcut];return this.config[h.Shortcut]||_}},{key:"sanitizeConfig",get:function(){return this.constructable[p.SanitizeConfig]}}]),d}();s.default=O,O.displayName="BaseTool"})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(17),n=e(10),a=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(i.exports=function(s,o){return a[s]||(a[s]=o!==void 0?o:{})})("versions",[]).push({version:r.version,mode:e(45)?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},function(i,t,e){var r=e(28),n=e(16),a=e(47);i.exports=function(s){return function(o,l,u){var c,h=r(o),p=n(h.length),g=a(u,p);if(s&&l!=l){for(;p>g;)if((c=h[g++])!=c)return!0}else for(;p>g;g++)if((s||g in h)&&h[g]===l)return s||g||0;return!s&&-1}}},function(i,t){t.f=Object.getOwnPropertySymbols},function(i,t,e){var r=e(37);i.exports=Array.isArray||function(n){return r(n)=="Array"}},function(i,t,e){var r=e(14)("iterator"),n=!1;try{var a=[7][r]();a.return=function(){n=!0},Array.from(a,function(){throw 2})}catch(s){}i.exports=function(s,o){if(!o&&!n)return!1;var l=!1;try{var u=[7],c=u[r]();c.next=function(){return{done:l=!0}},u[r]=function(){return c},s(u)}catch(h){}return l}},function(i,t,e){"use strict";var r=e(12);i.exports=function(){var n=r(this),a="";return n.global&&(a+="g"),n.ignoreCase&&(a+="i"),n.multiline&&(a+="m"),n.unicode&&(a+="u"),n.sticky&&(a+="y"),a}},function(i,t,e){"use strict";var r=e(64),n=RegExp.prototype.exec;i.exports=function(a,s){var o=a.exec;if(typeof o=="function"){var l=o.call(a,s);if(typeof l!="object")throw new TypeError("RegExp exec method returned something other than an Object or null");return l}if(r(a)!=="RegExp")throw new TypeError("RegExp#exec called on incompatible receiver");return n.call(a,s)}},function(i,t,e){"use strict";e(129);var r=e(23),n=e(27),a=e(11),s=e(38),o=e(14),l=e(103),u=o("species"),c=!a(function(){var p=/./;return p.exec=function(){var g=[];return g.groups={a:"7"},g},"".replace(p,"$<a>")!=="7"}),h=function(){var p=/(?:)/,g=p.exec;p.exec=function(){return g.apply(this,arguments)};var b="ab".split(p);return b.length===2&&b[0]==="a"&&b[1]==="b"}();i.exports=function(p,g,b){var v=o(p),k=!a(function(){var y={};return y[v]=function(){return 7},""[p](y)!=7}),C=k?!a(function(){var y=!1,x=/a/;return x.exec=function(){return y=!0,null},p==="split"&&(x.constructor={},x.constructor[u]=function(){return x}),x[v](""),!y}):void 0;if(!k||!C||p==="replace"&&!c||p==="split"&&!h){var O=/./[v],d=b(s,v,""[p],function(y,x,S,w,E){return x.exec===l?k&&!E?{done:!0,value:O.call(x,S,w)}:{done:!0,value:y.call(S,x,w)}:{done:!1}}),_=d[0],m=d[1];r(String.prototype,p,_),n(RegExp.prototype,v,g==2?function(y,x){return m.call(y,this,x)}:function(y){return m.call(y,this)})}}},function(i,t,e){var r=e(31),n=e(124),a=e(98),s=e(12),o=e(16),l=e(100),u={},c={};(t=i.exports=function(h,p,g,b,v){var k,C,O,d,_=v?function(){return h}:l(h),m=r(g,b,p?2:1),y=0;if(typeof _!="function")throw TypeError(h+" is not iterable!");if(a(_)){for(k=o(h.length);k>y;y++)if((d=p?m(s(C=h[y])[0],C[1]):m(h[y]))===u||d===c)return d}else for(O=_.call(h);!(C=O.next()).done;)if((d=n(O,m,C.value,p))===u||d===c)return d}).BREAK=u,t.RETURN=c},function(i,t,e){var r=e(10).navigator;i.exports=r&&r.userAgent||""},function(i,t,e){"use strict";var r=e(10),n=e(0),a=e(23),s=e(58),o=e(41),l=e(75),u=e(57),c=e(13),h=e(11),p=e(71),g=e(53),b=e(89);i.exports=function(v,k,C,O,d,_){var m=r[v],y=m,x=d?"set":"add",S=y&&y.prototype,w={},E=function(M){var j=S[M];a(S,M,M=="delete"||M=="has"?function(J){return!(_&&!c(J))&&j.call(this,J===0?0:J)}:M=="get"?function(J){return _&&!c(J)?void 0:j.call(this,J===0?0:J)}:M=="add"?function(J){return j.call(this,J===0?0:J),this}:function(J,U){return j.call(this,J===0?0:J,U),this})};if(typeof y=="function"&&(_||S.forEach&&!h(function(){new y().entries().next()}))){var L=new y,I=L[x](_?{}:-0,1)!=L,A=h(function(){L.has(1)}),B=p(function(M){new y(M)}),T=!_&&h(function(){for(var M=new y,j=5;j--;)M[x](j,j);return!M.has(-0)});B||((y=k(function(M,j){u(M,y,v);var J=b(new m,M,y);return j!=null&&l(j,d,J[x],J),J})).prototype=S,S.constructor=y),(A||T)&&(E("delete"),E("has"),d&&E("get")),(T||I)&&E(x),_&&S.clear&&delete S.clear}else y=O.getConstructor(k,v,d,x),s(y.prototype,C),o.NEED=!0;return g(y,v),w[v]=y,n(n.G+n.W+n.F*(y!=m),w),_||O.setStrong(y,v,d),y}},function(i,t,e){for(var r,n=e(10),a=e(27),s=e(44),o=s("typed_array"),l=s("view"),u=!(!n.ArrayBuffer||!n.DataView),c=u,h=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=n[p[h++]])?(a(r.prototype,o,!0),a(r.prototype,l,!0)):c=!1;i.exports={ABV:u,CONSTR:c,TYPED:o,VIEW:l}},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"getMethodsForTool",value:function(_){return Object.assign(this.methods,{i18n:this.Editor.I18nAPI.getMethodsForTool(_)})}},{key:"methods",get:function(){return{blocks:this.Editor.BlocksAPI.methods,caret:this.Editor.CaretAPI.methods,events:this.Editor.EventsAPI.methods,listeners:this.Editor.ListenersAPI.methods,notifier:this.Editor.NotifierAPI.methods,sanitizer:this.Editor.SanitizerAPI.methods,saver:this.Editor.SaverAPI.methods,selection:this.Editor.SelectionAPI.methods,styles:this.Editor.StylesAPI.classes,toolbar:this.Editor.ToolbarAPI.methods,inlineToolbar:this.Editor.InlineToolbarAPI.methods,tooltip:this.Editor.TooltipAPI.methods,i18n:this.Editor.I18nAPI.methods,readOnly:this.Editor.ReadOnlyAPI.methods}}}]),d}((p=g(p)).default);s.default=v,v.displayName="API",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8),e(59),e(81)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k){"use strict";var C=e(9),O=e(1);function d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=O(o),l=O(l),u=O(u),c=O(c),h=O(h),p=O(p),g=O(g),b=C(b),v=O(v);var _=function(m){(0,u.default)(S,m);var y,x=(y=S,function(){var w,E=(0,h.default)(y);if(d()){var L=(0,h.default)(this).constructor;w=Reflect.construct(E,arguments,L)}else w=E.apply(this,arguments);return(0,c.default)(this,w)});function S(){return(0,o.default)(this,S),x.apply(this,arguments)}return(0,l.default)(S,[{key:"toggleReadOnly",value:function(w){w?(this.destroy(),this.Editor.Toolbox.destroy(),this.Editor.BlockSettings.destroy(),this.disableModuleBindings()):(this.drawUI(),this.enableModuleBindings())}},{key:"move",value:function(){var w=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];w&&(this.Editor.Toolbox.close(),this.Editor.BlockSettings.close());var E=this.Editor.BlockManager.currentBlock.holder;if(E){var L=this.Editor.UI.isMobile,I=E.offsetHeight,A=E.offsetTop;if(L)A+=I;else{var B=Math.floor(I/2);this.nodes.plusButton.style.transform="translate3d(0, calc(".concat(B,"px - 50%), 0)"),this.Editor.Toolbox.nodes.toolbox.style.transform="translate3d(0, calc(".concat(B,"px - 50%), 0)")}this.nodes.wrapper.style.transform="translate3D(0, ".concat(Math.floor(A),"px, 0)")}}},{key:"open",value:function(){var w=this,E=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],L=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];b.delay(function(){w.move(L),w.nodes.wrapper.classList.add(w.CSS.toolbarOpened),E?w.blockActions.show():w.blockActions.hide()},50)()}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(this.CSS.toolbarOpened),this.blockActions.hide(),this.Editor.Toolbox.close(),this.Editor.BlockSettings.close()}},{key:"make",value:function(){var w=this;this.nodes.wrapper=g.default.make("div",this.CSS.toolbar),["content","actions"].forEach(function(I){w.nodes[I]=g.default.make("div",w.CSS[I])}),g.default.append(this.nodes.wrapper,this.nodes.content),g.default.append(this.nodes.content,this.nodes.actions),this.nodes.plusButton=g.default.make("div",this.CSS.plusButton),g.default.append(this.nodes.plusButton,g.default.svg("plus",14,14)),g.default.append(this.nodes.content,this.nodes.plusButton),this.readOnlyMutableListeners.on(this.nodes.plusButton,"click",function(){w.plusButtonClicked()},!1);var E=g.default.make("div");E.appendChild(document.createTextNode(v.default.ui(k.I18nInternalNS.ui.toolbar.toolbox,"Add"))),E.appendChild(g.default.make("div",this.CSS.plusButtonShortcut,{textContent:"\u21E5 Tab"})),this.Editor.Tooltip.onHover(this.nodes.plusButton,E),this.nodes.blockActionsButtons=g.default.make("div",this.CSS.blockActionsButtons),this.nodes.settingsToggler=g.default.make("span",this.CSS.settingsToggler);var L=g.default.svg("dots",8,8);g.default.append(this.nodes.settingsToggler,L),g.default.append(this.nodes.blockActionsButtons,this.nodes.settingsToggler),g.default.append(this.nodes.actions,this.nodes.blockActionsButtons),this.Editor.Tooltip.onHover(this.nodes.settingsToggler,v.default.ui(k.I18nInternalNS.ui.blockTunes.toggler,"Click to tune"),{placement:"top"}),g.default.append(this.nodes.content,this.Editor.Toolbox.nodes.toolbox),g.default.append(this.nodes.actions,this.Editor.BlockSettings.nodes.wrapper),g.default.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper)}},{key:"plusButtonClicked",value:function(){this.Editor.Toolbox.toggle()}},{key:"enableModuleBindings",value:function(){var w=this;this.readOnlyMutableListeners.on(this.nodes.settingsToggler,"click",function(){w.settingsTogglerClicked()})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"settingsTogglerClicked",value:function(){this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.BlockSettings.open()}},{key:"drawUI",value:function(){this.Editor.BlockSettings.make(),this.Editor.Toolbox.make(),this.make()}},{key:"destroy",value:function(){this.removeAllNodes()}},{key:"CSS",get:function(){return{toolbar:"ce-toolbar",content:"ce-toolbar__content",actions:"ce-toolbar__actions",actionsOpened:"ce-toolbar__actions--opened",toolbarOpened:"ce-toolbar--opened",plusButton:"ce-toolbar__plus",plusButtonShortcut:"ce-toolbar__plus-shortcut",plusButtonHidden:"ce-toolbar__plus--hidden",blockActionsButtons:"ce-toolbar__actions-buttons",settingsToggler:"ce-toolbar__settings-btn"}}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(this.CSS.toolbarOpened)}},{key:"plusButton",get:function(){var w=this;return{hide:function(){return w.nodes.plusButton.classList.add(w.CSS.plusButtonHidden)},show:function(){w.Editor.Toolbox.isEmpty||w.nodes.plusButton.classList.remove(w.CSS.plusButtonHidden)}}}},{key:"blockActions",get:function(){var w=this;return{hide:function(){w.nodes.actions.classList.remove(w.CSS.actionsOpened)},show:function(){w.nodes.actions.classList.add(w.CSS.actionsOpened)}}}}]),S}(p.default);s.default=_,_.displayName="Toolbar",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(144),e(8)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.I18nInternalNS=void 0,o=c(o);var h=function p(g,b){var v={};return Object.entries(g).forEach(function(k){var C=(0,o.default)(k,2),O=C[0],d=C[1];if((0,u.isObject)(d)){var _=b?"".concat(b,".").concat(O):O,m=Object.values(d).every(function(y){return(0,u.isString)(y)});v[O]=m?_:p(d,_)}else v[O]=d}),v}((l=c(l)).default);s.I18nInternalNS=h})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(13),n=e(10).document,a=r(n)&&r(n.createElement);i.exports=function(s){return a?n.createElement(s):{}}},function(i,t,e){t.f=e(14)},function(i,t,e){var r=e(67)("keys"),n=e(44);i.exports=function(a){return r[a]||(r[a]=n(a))}},function(i,t){i.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(i,t,e){var r=e(10).document;i.exports=r&&r.documentElement},function(i,t,e){var r=e(13),n=e(12),a=function(s,o){if(n(s),!r(o)&&o!==null)throw TypeError(o+": can't set as prototype!")};i.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(s,o,l){try{(l=e(31)(Function.call,e(34).f(Object.prototype,"__proto__").set,2))(s,[]),o=!(s instanceof Array)}catch(u){o=!0}return function(u,c){return a(u,c),o?u.__proto__=c:l(u,c),u}}({},!1):void 0),check:a}},function(i,t){i.exports=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},function(i,t,e){var r=e(13),n=e(87).set;i.exports=function(a,s,o){var l,u=s.constructor;return u!==o&&typeof u=="function"&&(l=u.prototype)!==o.prototype&&r(l)&&n&&n(a,l),a}},function(i,t,e){"use strict";var r=e(33),n=e(38);i.exports=function(a){var s=String(n(this)),o="",l=r(a);if(l<0||l==1/0)throw RangeError("Count can't be negative");for(;l>0;(l>>>=1)&&(s+=s))1&l&&(o+=s);return o}},function(i,t){i.exports=Math.sign||function(e){return(e=+e)==0||e!=e?e:e<0?-1:1}},function(i,t){var e=Math.expm1;i.exports=!e||e(10)>22025.465794806718||e(10)<22025.465794806718||e(-2e-17)!=-2e-17?function(r){return(r=+r)==0?r:r>-1e-6&&r<1e-6?r+r*r/2:Math.exp(r)-1}:e},function(i,t,e){var r=e(33),n=e(38);i.exports=function(a){return function(s,o){var l,u,c=String(n(s)),h=r(o),p=c.length;return h<0||h>=p?a?"":void 0:(l=c.charCodeAt(h))<55296||l>56319||h+1===p||(u=c.charCodeAt(h+1))<56320||u>57343?a?c.charAt(h):l:a?c.slice(h,h+2):u-56320+(l-55296<<10)+65536}}},function(i,t,e){"use strict";var r=e(45),n=e(0),a=e(23),s=e(27),o=e(55),l=e(123),u=e(53),c=e(50),h=e(14)("iterator"),p=!([].keys&&"next"in[].keys()),g=function(){return this};i.exports=function(b,v,k,C,O,d,_){l(k,v,C);var m,y,x,S=function(j){if(!p&&j in I)return I[j];switch(j){case"keys":case"values":return function(){return new k(this,j)}}return function(){return new k(this,j)}},w=v+" Iterator",E=O=="values",L=!1,I=b.prototype,A=I[h]||I["@@iterator"]||O&&I[O],B=A||S(O),T=O?E?S("entries"):B:void 0,M=v=="Array"&&I.entries||A;if(M&&(x=c(M.call(new b)))!==Object.prototype&&x.next&&(u(x,w,!0),r||typeof x[h]=="function"||s(x,h,g)),E&&A&&A.name!=="values"&&(L=!0,B=function(){return A.call(this)}),r&&!_||!p&&!L&&I[h]||s(I,h,B),o[v]=B,o[w]=g,O)if(m={values:E?B:S("values"),keys:d?B:S("keys"),entries:T},_)for(y in m)y in I||a(I,y,m[y]);else n(n.P+n.F*(p||L),v,m);return m}},function(i,t,e){var r=e(96),n=e(38);i.exports=function(a,s,o){if(r(s))throw TypeError("String#"+o+" doesn't accept regex!");return String(n(a))}},function(i,t,e){var r=e(13),n=e(37),a=e(14)("match");i.exports=function(s){var o;return r(s)&&((o=s[a])!==void 0?!!o:n(s)=="RegExp")}},function(i,t,e){var r=e(14)("match");i.exports=function(n){var a=/./;try{"/./"[n](a)}catch(s){try{return a[r]=!1,!"/./"[n](a)}catch(o){}}return!0}},function(i,t,e){var r=e(55),n=e(14)("iterator"),a=Array.prototype;i.exports=function(s){return s!==void 0&&(r.Array===s||a[n]===s)}},function(i,t,e){"use strict";var r=e(19),n=e(43);i.exports=function(a,s,o){s in a?r.f(a,s,n(0,o)):a[s]=o}},function(i,t,e){var r=e(64),n=e(14)("iterator"),a=e(55);i.exports=e(17).getIteratorMethod=function(s){if(s!=null)return s[n]||s["@@iterator"]||a[r(s)]}},function(i,t,e){"use strict";var r=e(20),n=e(47),a=e(16);i.exports=function(s){for(var o=r(this),l=a(o.length),u=arguments.length,c=n(u>1?arguments[1]:void 0,l),h=u>2?arguments[2]:void 0,p=h===void 0?l:n(h,l);p>c;)o[c++]=s;return o}},function(i,t,e){"use strict";var r=e(51),n=e(128),a=e(55),s=e(28);i.exports=e(94)(Array,"Array",function(o,l){this._t=s(o),this._i=0,this._k=l},function(){var o=this._t,l=this._k,u=this._i++;return!o||u>=o.length?(this._t=void 0,n(1)):n(0,l=="keys"?u:l=="values"?o[u]:[u,o[u]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(i,t,e){"use strict";var r,n,a=e(72),s=RegExp.prototype.exec,o=String.prototype.replace,l=s,u=(r=/a/,n=/b*/g,s.call(r,"a"),s.call(n,"a"),r.lastIndex!==0||n.lastIndex!==0),c=/()??/.exec("")[1]!==void 0;(u||c)&&(l=function(h){var p,g,b,v,k=this;return c&&(g=new RegExp("^"+k.source+"$(?!\\s)",a.call(k))),u&&(p=k.lastIndex),b=s.call(k,h),u&&b&&(k.lastIndex=k.global?b.index+b[0].length:p),c&&b&&b.length>1&&o.call(b[0],g,function(){for(v=1;v<arguments.length-2;v++)arguments[v]===void 0&&(b[v]=void 0)}),b}),i.exports=l},function(i,t,e){"use strict";var r=e(93)(!0);i.exports=function(n,a,s){return a+(s?r(n,a).length:1)}},function(i,t,e){var r,n,a,s=e(31),o=e(117),l=e(86),u=e(82),c=e(10),h=c.process,p=c.setImmediate,g=c.clearImmediate,b=c.MessageChannel,v=c.Dispatch,k=0,C={},O=function(){var _=+this;if(C.hasOwnProperty(_)){var m=C[_];delete C[_],m()}},d=function(_){O.call(_.data)};p&&g||(p=function(_){for(var m=[],y=1;arguments.length>y;)m.push(arguments[y++]);return C[++k]=function(){o(typeof _=="function"?_:Function(_),m)},r(k),k},g=function(_){delete C[_]},e(37)(h)=="process"?r=function(_){h.nextTick(s(O,_,1))}:v&&v.now?r=function(_){v.now(s(O,_,1))}:b?(a=(n=new b).port2,n.port1.onmessage=d,r=s(a.postMessage,a,1)):c.addEventListener&&typeof postMessage=="function"&&!c.importScripts?(r=function(_){c.postMessage(_+"","*")},c.addEventListener("message",d,!1)):r="onreadystatechange"in u("script")?function(_){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),O.call(_)}}:function(_){setTimeout(s(O,_,1),0)}),i.exports={set:p,clear:g}},function(i,t,e){"use strict";var r=e(10),n=e(18),a=e(45),s=e(78),o=e(27),l=e(58),u=e(11),c=e(57),h=e(33),p=e(16),g=e(136),b=e(49).f,v=e(19).f,k=e(101),C=e(53),O=r.ArrayBuffer,d=r.DataView,_=r.Math,m=r.RangeError,y=r.Infinity,x=O,S=_.abs,w=_.pow,E=_.floor,L=_.log,I=_.LN2,A=n?"_b":"buffer",B=n?"_l":"byteLength",T=n?"_o":"byteOffset";function M(fe,xe,Ne){var Be,Pe,Ze,tt=new Array(Ne),Xe=8*Ne-xe-1,Ke=(1<<Xe)-1,nt=Ke>>1,at=xe===23?w(2,-24)-w(2,-77):0,ce=0,ve=fe<0||fe===0&&1/fe<0?1:0;for((fe=S(fe))!=fe||fe===y?(Pe=fe!=fe?1:0,Be=Ke):(Be=E(L(fe)/I),fe*(Ze=w(2,-Be))<1&&(Be--,Ze*=2),(fe+=Be+nt>=1?at/Ze:at*w(2,1-nt))*Ze>=2&&(Be++,Ze/=2),Be+nt>=Ke?(Pe=0,Be=Ke):Be+nt>=1?(Pe=(fe*Ze-1)*w(2,xe),Be+=nt):(Pe=fe*w(2,nt-1)*w(2,xe),Be=0));xe>=8;tt[ce++]=255&Pe,Pe/=256,xe-=8);for(Be=Be<<xe|Pe,Xe+=xe;Xe>0;tt[ce++]=255&Be,Be/=256,Xe-=8);return tt[--ce]|=128*ve,tt}function j(fe,xe,Ne){var Be,Pe=8*Ne-xe-1,Ze=(1<<Pe)-1,tt=Ze>>1,Xe=Pe-7,Ke=Ne-1,nt=fe[Ke--],at=127&nt;for(nt>>=7;Xe>0;at=256*at+fe[Ke],Ke--,Xe-=8);for(Be=at&(1<<-Xe)-1,at>>=-Xe,Xe+=xe;Xe>0;Be=256*Be+fe[Ke],Ke--,Xe-=8);if(at===0)at=1-tt;else{if(at===Ze)return Be?NaN:nt?-y:y;Be+=w(2,xe),at-=tt}return(nt?-1:1)*Be*w(2,at-xe)}function J(fe){return fe[3]<<24|fe[2]<<16|fe[1]<<8|fe[0]}function U(fe){return[255&fe]}function H(fe){return[255&fe,fe>>8&255]}function te(fe){return[255&fe,fe>>8&255,fe>>16&255,fe>>24&255]}function se(fe){return M(fe,52,8)}function W(fe){return M(fe,23,4)}function Y(fe,xe,Ne){v(fe.prototype,xe,{get:function(){return this[Ne]}})}function ie(fe,xe,Ne,Be){var Pe=g(+Ne);if(Pe+xe>fe[B])throw m("Wrong index!");var Ze=fe[A]._b,tt=Pe+fe[T],Xe=Ze.slice(tt,tt+xe);return Be?Xe:Xe.reverse()}function re(fe,xe,Ne,Be,Pe,Ze){var tt=g(+Ne);if(tt+xe>fe[B])throw m("Wrong index!");for(var Xe=fe[A]._b,Ke=tt+fe[T],nt=Be(+Pe),at=0;at<xe;at++)Xe[Ke+at]=nt[Ze?at:xe-at-1]}if(s.ABV){if(!u(function(){O(1)})||!u(function(){new O(-1)})||u(function(){return new O,new O(1.5),new O(NaN),O.name!="ArrayBuffer"})){for(var Q,ee=(O=function(fe){return c(this,O),new x(g(fe))}).prototype=x.prototype,pe=b(x),be=0;pe.length>be;)(Q=pe[be++])in O||o(O,Q,x[Q]);a||(ee.constructor=O)}var we=new d(new O(2)),Le=d.prototype.setInt8;we.setInt8(0,2147483648),we.setInt8(1,2147483649),!we.getInt8(0)&&we.getInt8(1)||l(d.prototype,{setInt8:function(fe,xe){Le.call(this,fe,xe<<24>>24)},setUint8:function(fe,xe){Le.call(this,fe,xe<<24>>24)}},!0)}else O=function(fe){c(this,O,"ArrayBuffer");var xe=g(fe);this._b=k.call(new Array(xe),0),this[B]=xe},d=function(fe,xe,Ne){c(this,d,"DataView"),c(fe,O,"DataView");var Be=fe[B],Pe=h(xe);if(Pe<0||Pe>Be)throw m("Wrong offset!");if(Pe+(Ne=Ne===void 0?Be-Pe:p(Ne))>Be)throw m("Wrong length!");this[A]=fe,this[T]=Pe,this[B]=Ne},n&&(Y(O,"byteLength","_l"),Y(d,"buffer","_b"),Y(d,"byteLength","_l"),Y(d,"byteOffset","_o")),l(d.prototype,{getInt8:function(fe){return ie(this,1,fe)[0]<<24>>24},getUint8:function(fe){return ie(this,1,fe)[0]},getInt16:function(fe){var xe=ie(this,2,fe,arguments[1]);return(xe[1]<<8|xe[0])<<16>>16},getUint16:function(fe){var xe=ie(this,2,fe,arguments[1]);return xe[1]<<8|xe[0]},getInt32:function(fe){return J(ie(this,4,fe,arguments[1]))},getUint32:function(fe){return J(ie(this,4,fe,arguments[1]))>>>0},getFloat32:function(fe){return j(ie(this,4,fe,arguments[1]),23,4)},getFloat64:function(fe){return j(ie(this,8,fe,arguments[1]),52,8)},setInt8:function(fe,xe){re(this,1,fe,U,xe)},setUint8:function(fe,xe){re(this,1,fe,U,xe)},setInt16:function(fe,xe){re(this,2,fe,H,xe,arguments[2])},setUint16:function(fe,xe){re(this,2,fe,H,xe,arguments[2])},setInt32:function(fe,xe){re(this,4,fe,te,xe,arguments[2])},setUint32:function(fe,xe){re(this,4,fe,te,xe,arguments[2])},setFloat32:function(fe,xe){re(this,4,fe,W,xe,arguments[2])},setFloat64:function(fe,xe){re(this,8,fe,se,xe,arguments[2])}});C(O,"ArrayBuffer"),C(d,"DataView"),o(d.prototype,s.VIEW,!0),t.ArrayBuffer=O,t.DataView=d},function(i,t){function e(r,n){return i.exports=e=Object.setPrototypeOf||function(a,s){return a.__proto__=s,a},e(r,n)}i.exports=e},function(i,t,e){var r,n,a;n=[t,e(42),e(2),e(3),e(377)],(a=typeof(r=function(s,o,l,u,c){"use strict";var h=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=h(o),l=h(l),u=h(u),c=h(c);var p=function(){function b(){(0,l.default)(this,b),this.registeredShortcuts=new Map}return(0,u.default)(b,[{key:"add",value:function(v){if(this.findShortcut(v.on,v.name))throw Error("Shortcut ".concat(v.name," is already registered for ").concat(v.on,". Please remove it before add a new handler."));var k=new c.default({name:v.name,on:v.on,callback:v.handler}),C=this.registeredShortcuts.get(v.on)||[];this.registeredShortcuts.set(v.on,[].concat((0,o.default)(C),[k]))}},{key:"remove",value:function(v,k){var C=this.findShortcut(v,k);if(C){C.remove();var O=this.registeredShortcuts.get(v);this.registeredShortcuts.set(v,O.filter(function(d){return d!==C}))}}},{key:"findShortcut",value:function(v,k){return(this.registeredShortcuts.get(v)||[]).find(function(C){return C.name===k})}}]),b}();p.displayName="Shortcuts";var g=new p;s.default=g,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){i.exports=!e(18)&&!e(11)(function(){return Object.defineProperty(e(82)("div"),"a",{get:function(){return 7}}).a!=7})},function(i,t,e){var r=e(10),n=e(17),a=e(45),s=e(83),o=e(19).f;i.exports=function(l){var u=n.Symbol||(n.Symbol=a?{}:r.Symbol||{});l.charAt(0)=="_"||l in u||o(u,l,{value:s.f(l)})}},function(i,t,e){var r=e(26),n=e(28),a=e(68)(!1),s=e(84)("IE_PROTO");i.exports=function(o,l){var u,c=n(o),h=0,p=[];for(u in c)u!=s&&r(c,u)&&p.push(u);for(;l.length>h;)r(c,u=l[h++])&&(~a(p,u)||p.push(u));return p}},function(i,t,e){var r=e(19),n=e(12),a=e(46);i.exports=e(18)?Object.defineProperties:function(s,o){n(s);for(var l,u=a(o),c=u.length,h=0;c>h;)r.f(s,l=u[h++],o[l]);return s}},function(i,t,e){var r=e(28),n=e(49).f,a={}.toString,s=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];i.exports.f=function(o){return s&&a.call(o)=="[object Window]"?function(l){try{return n(l)}catch(u){return s.slice()}}(o):n(r(o))}},function(i,t,e){"use strict";var r=e(18),n=e(46),a=e(69),s=e(63),o=e(20),l=e(62),u=Object.assign;i.exports=!u||e(11)(function(){var c={},h={},p=Symbol(),g="abcdefghijklmnopqrst";return c[p]=7,g.split("").forEach(function(b){h[b]=b}),u({},c)[p]!=7||Object.keys(u({},h)).join("")!=g})?function(c,h){for(var p=o(c),g=arguments.length,b=1,v=a.f,k=s.f;g>b;)for(var C,O=l(arguments[b++]),d=v?n(O).concat(v(O)):n(O),_=d.length,m=0;_>m;)C=d[m++],r&&!k.call(O,C)||(p[C]=O[C]);return p}:u},function(i,t){i.exports=Object.is||function(e,r){return e===r?e!==0||1/e==1/r:e!=e&&r!=r}},function(i,t,e){"use strict";var r=e(32),n=e(13),a=e(117),s=[].slice,o={},l=function(u,c,h){if(!(c in o)){for(var p=[],g=0;g<c;g++)p[g]="a["+g+"]";o[c]=Function("F,a","return new F("+p.join(",")+")")}return o[c](u,h)};i.exports=Function.bind||function(u){var c=r(this),h=s.call(arguments,1),p=function(){var g=h.concat(s.call(arguments));return this instanceof p?l(c,g.length,g):a(c,g,u)};return n(c.prototype)&&(p.prototype=c.prototype),p}},function(i,t){i.exports=function(e,r,n){var a=n===void 0;switch(r.length){case 0:return a?e():e.call(n);case 1:return a?e(r[0]):e.call(n,r[0]);case 2:return a?e(r[0],r[1]):e.call(n,r[0],r[1]);case 3:return a?e(r[0],r[1],r[2]):e.call(n,r[0],r[1],r[2]);case 4:return a?e(r[0],r[1],r[2],r[3]):e.call(n,r[0],r[1],r[2],r[3])}return e.apply(n,r)}},function(i,t,e){var r=e(10).parseInt,n=e(54).trim,a=e(88),s=/^[-+]?0[xX]/;i.exports=r(a+"08")!==8||r(a+"0x16")!==22?function(o,l){var u=n(String(o),3);return r(u,l>>>0||(s.test(u)?16:10))}:r},function(i,t,e){var r=e(10).parseFloat,n=e(54).trim;i.exports=1/r(e(88)+"-0")!=-1/0?function(a){var s=n(String(a),3),o=r(s);return o===0&&s.charAt(0)=="-"?-0:o}:r},function(i,t,e){var r=e(37);i.exports=function(n,a){if(typeof n!="number"&&r(n)!="Number")throw TypeError(a);return+n}},function(i,t,e){var r=e(13),n=Math.floor;i.exports=function(a){return!r(a)&&isFinite(a)&&n(a)===a}},function(i,t){i.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(i,t,e){"use strict";var r=e(48),n=e(43),a=e(53),s={};e(27)(s,e(14)("iterator"),function(){return this}),i.exports=function(o,l,u){o.prototype=r(s,{next:n(1,u)}),a(o,l+" Iterator")}},function(i,t,e){var r=e(12);i.exports=function(n,a,s,o){try{return o?a(r(s)[0],s[1]):a(s)}catch(u){var l=n.return;throw l!==void 0&&r(l.call(n)),u}}},function(i,t,e){var r=e(278);i.exports=function(n,a){return new(r(n))(a)}},function(i,t,e){var r=e(32),n=e(20),a=e(62),s=e(16);i.exports=function(o,l,u,c,h){r(l);var p=n(o),g=a(p),b=s(p.length),v=h?b-1:0,k=h?-1:1;if(u<2)for(;;){if(v in g){c=g[v],v+=k;break}if(v+=k,h?v<0:b<=v)throw TypeError("Reduce of empty array with no initial value")}for(;h?v>=0:b>v;v+=k)v in g&&(c=l(c,g[v],v,p));return c}},function(i,t,e){"use strict";var r=e(20),n=e(47),a=e(16);i.exports=[].copyWithin||function(s,o){var l=r(this),u=a(l.length),c=n(s,u),h=n(o,u),p=arguments.length>2?arguments[2]:void 0,g=Math.min((p===void 0?u:n(p,u))-h,u-c),b=1;for(h<c&&c<h+g&&(b=-1,h+=g-1,c+=g-1);g-- >0;)h in l?l[c]=l[h]:delete l[c],c+=b,h+=b;return l}},function(i,t){i.exports=function(e,r){return{value:r,done:!!e}}},function(i,t,e){"use strict";var r=e(103);e(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(i,t,e){e(18)&&/./g.flags!="g"&&e(19).f(RegExp.prototype,"flags",{configurable:!0,get:e(72)})},function(i,t,e){"use strict";var r,n,a,s,o=e(45),l=e(10),u=e(31),c=e(64),h=e(0),p=e(13),g=e(32),b=e(57),v=e(75),k=e(65),C=e(105).set,O=e(298)(),d=e(132),_=e(299),m=e(76),y=e(133),x=l.TypeError,S=l.process,w=S&&S.versions,E=w&&w.v8||"",L=l.Promise,I=c(S)=="process",A=function(){},B=n=d.f,T=!!function(){try{var W=L.resolve(1),Y=(W.constructor={})[e(14)("species")]=function(ie){ie(A,A)};return(I||typeof PromiseRejectionEvent=="function")&&W.then(A)instanceof Y&&E.indexOf("6.6")!==0&&m.indexOf("Chrome/66")===-1}catch(ie){}}(),M=function(W){var Y;return!(!p(W)||typeof(Y=W.then)!="function")&&Y},j=function(W,Y){if(!W._n){W._n=!0;var ie=W._c;O(function(){for(var re=W._v,Q=W._s==1,ee=0,pe=function(be){var we,Le,fe,xe=Q?be.ok:be.fail,Ne=be.resolve,Be=be.reject,Pe=be.domain;try{xe?(Q||(W._h==2&&H(W),W._h=1),xe===!0?we=re:(Pe&&Pe.enter(),we=xe(re),Pe&&(Pe.exit(),fe=!0)),we===be.promise?Be(x("Promise-chain cycle")):(Le=M(we))?Le.call(we,Ne,Be):Ne(we)):Be(re)}catch(Ze){Pe&&!fe&&Pe.exit(),Be(Ze)}};ie.length>ee;)pe(ie[ee++]);W._c=[],W._n=!1,Y&&!W._h&&J(W)})}},J=function(W){C.call(l,function(){var Y,ie,re,Q=W._v,ee=U(W);if(ee&&(Y=_(function(){I?S.emit("unhandledRejection",Q,W):(ie=l.onunhandledrejection)?ie({promise:W,reason:Q}):(re=l.console)&&re.error&&re.error("Unhandled promise rejection",Q)}),W._h=I||U(W)?2:1),W._a=void 0,ee&&Y.e)throw Y.v})},U=function(W){return W._h!==1&&(W._a||W._c).length===0},H=function(W){C.call(l,function(){var Y;I?S.emit("rejectionHandled",W):(Y=l.onrejectionhandled)&&Y({promise:W,reason:W._v})})},te=function(W){var Y=this;Y._d||(Y._d=!0,(Y=Y._w||Y)._v=W,Y._s=2,Y._a||(Y._a=Y._c.slice()),j(Y,!0))},se=function(W){var Y,ie=this;if(!ie._d){ie._d=!0,ie=ie._w||ie;try{if(ie===W)throw x("Promise can't be resolved itself");(Y=M(W))?O(function(){var re={_w:ie,_d:!1};try{Y.call(W,u(se,re,1),u(te,re,1))}catch(Q){te.call(re,Q)}}):(ie._v=W,ie._s=1,j(ie,!1))}catch(re){te.call({_w:ie,_d:!1},re)}}};T||(L=function(W){b(this,L,"Promise","_h"),g(W),r.call(this);try{W(u(se,this,1),u(te,this,1))}catch(Y){te.call(this,Y)}},(r=function(W){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=e(58)(L.prototype,{then:function(W,Y){var ie=B(k(this,L));return ie.ok=typeof W!="function"||W,ie.fail=typeof Y=="function"&&Y,ie.domain=I?S.domain:void 0,this._c.push(ie),this._a&&this._a.push(ie),this._s&&j(this,!1),ie.promise},catch:function(W){return this.then(void 0,W)}}),a=function(){var W=new r;this.promise=W,this.resolve=u(se,W,1),this.reject=u(te,W,1)},d.f=B=function(W){return W===L||W===s?new a(W):n(W)}),h(h.G+h.W+h.F*!T,{Promise:L}),e(53)(L,"Promise"),e(56)("Promise"),s=e(17).Promise,h(h.S+h.F*!T,"Promise",{reject:function(W){var Y=B(this);return(0,Y.reject)(W),Y.promise}}),h(h.S+h.F*(o||!T),"Promise",{resolve:function(W){return y(o&&this===s?L:this,W)}}),h(h.S+h.F*!(T&&e(71)(function(W){L.all(W).catch(A)})),"Promise",{all:function(W){var Y=this,ie=B(Y),re=ie.resolve,Q=ie.reject,ee=_(function(){var pe=[],be=0,we=1;v(W,!1,function(Le){var fe=be++,xe=!1;pe.push(void 0),we++,Y.resolve(Le).then(function(Ne){xe||(xe=!0,pe[fe]=Ne,--we||re(pe))},Q)}),--we||re(pe)});return ee.e&&Q(ee.v),ie.promise},race:function(W){var Y=this,ie=B(Y),re=ie.reject,Q=_(function(){v(W,!1,function(ee){Y.resolve(ee).then(ie.resolve,re)})});return Q.e&&re(Q.v),ie.promise}})},function(i,t,e){"use strict";var r=e(32);function n(a){var s,o;this.promise=new a(function(l,u){if(s!==void 0||o!==void 0)throw TypeError("Bad Promise constructor");s=l,o=u}),this.resolve=r(s),this.reject=r(o)}i.exports.f=function(a){return new n(a)}},function(i,t,e){var r=e(12),n=e(13),a=e(132);i.exports=function(s,o){if(r(s),n(o)&&o.constructor===s)return o;var l=a.f(s);return(0,l.resolve)(o),l.promise}},function(i,t,e){"use strict";var r=e(19).f,n=e(48),a=e(58),s=e(31),o=e(57),l=e(75),u=e(94),c=e(128),h=e(56),p=e(18),g=e(41).fastKey,b=e(52),v=p?"_s":"size",k=function(C,O){var d,_=g(O);if(_!=="F")return C._i[_];for(d=C._f;d;d=d.n)if(d.k==O)return d};i.exports={getConstructor:function(C,O,d,_){var m=C(function(y,x){o(y,m,O,"_i"),y._t=O,y._i=n(null),y._f=void 0,y._l=void 0,y[v]=0,x!=null&&l(x,d,y[_],y)});return a(m.prototype,{clear:function(){for(var y=b(this,O),x=y._i,S=y._f;S;S=S.n)S.r=!0,S.p&&(S.p=S.p.n=void 0),delete x[S.i];y._f=y._l=void 0,y[v]=0},delete:function(y){var x=b(this,O),S=k(x,y);if(S){var w=S.n,E=S.p;delete x._i[S.i],S.r=!0,E&&(E.n=w),w&&(w.p=E),x._f==S&&(x._f=w),x._l==S&&(x._l=E),x[v]--}return!!S},forEach:function(y){b(this,O);for(var x,S=s(y,arguments.length>1?arguments[1]:void 0,3);x=x?x.n:this._f;)for(S(x.v,x.k,this);x&&x.r;)x=x.p},has:function(y){return!!k(b(this,O),y)}}),p&&r(m.prototype,"size",{get:function(){return b(this,O)[v]}}),m},def:function(C,O,d){var _,m,y=k(C,O);return y?y.v=d:(C._l=y={i:m=g(O,!0),k:O,v:d,p:_=C._l,n:void 0,r:!1},C._f||(C._f=y),_&&(_.n=y),C[v]++,m!=="F"&&(C._i[m]=y)),C},getEntry:k,setStrong:function(C,O,d){u(C,O,function(_,m){this._t=b(_,O),this._k=m,this._l=void 0},function(){for(var _=this._k,m=this._l;m&&m.r;)m=m.p;return this._t&&(this._l=m=m?m.n:this._t._f)?c(0,_=="keys"?m.k:_=="values"?m.v:[m.k,m.v]):(this._t=void 0,c(1))},d?"entries":"values",!d,!0),h(O)}}},function(i,t,e){"use strict";var r=e(58),n=e(41).getWeak,a=e(12),s=e(13),o=e(57),l=e(75),u=e(36),c=e(26),h=e(52),p=u(5),g=u(6),b=0,v=function(O){return O._l||(O._l=new k)},k=function(){this.a=[]},C=function(O,d){return p(O.a,function(_){return _[0]===d})};k.prototype={get:function(O){var d=C(this,O);if(d)return d[1]},has:function(O){return!!C(this,O)},set:function(O,d){var _=C(this,O);_?_[1]=d:this.a.push([O,d])},delete:function(O){var d=g(this.a,function(_){return _[0]===O});return~d&&this.a.splice(d,1),!!~d}},i.exports={getConstructor:function(O,d,_,m){var y=O(function(x,S){o(x,y,d,"_i"),x._t=d,x._i=b++,x._l=void 0,S!=null&&l(S,_,x[m],x)});return r(y.prototype,{delete:function(x){if(!s(x))return!1;var S=n(x);return S===!0?v(h(this,d)).delete(x):S&&c(S,this._i)&&delete S[this._i]},has:function(x){if(!s(x))return!1;var S=n(x);return S===!0?v(h(this,d)).has(x):S&&c(S,this._i)}}),y},def:function(O,d,_){var m=n(a(d),!0);return m===!0?v(O).set(d,_):m[O._i]=_,O},ufstore:v}},function(i,t,e){var r=e(33),n=e(16);i.exports=function(a){if(a===void 0)return 0;var s=r(a),o=n(s);if(s!==o)throw RangeError("Wrong length!");return o}},function(i,t,e){var r=e(49),n=e(69),a=e(12),s=e(10).Reflect;i.exports=s&&s.ownKeys||function(o){var l=r.f(a(o)),u=n.f;return u?l.concat(u(o)):l}},function(i,t,e){var r=e(16),n=e(90),a=e(38);i.exports=function(s,o,l,u){var c=String(a(s)),h=c.length,p=l===void 0?" ":String(l),g=r(o);if(g<=h||p=="")return c;var b=g-h,v=n.call(p,Math.ceil(b/p.length));return v.length>b&&(v=v.slice(0,b)),u?v+c:c+v}},function(i,t,e){var r=e(18),n=e(46),a=e(28),s=e(63).f;i.exports=function(o){return function(l){for(var u,c=a(l),h=n(c),p=h.length,g=0,b=[];p>g;)u=h[g++],r&&!s.call(c,u)||b.push(o?[u,c[u]]:c[u]);return b}}},function(i,t,e){var r=function(n){"use strict";var a=Object.prototype,s=a.hasOwnProperty,o=typeof Symbol=="function"?Symbol:{},l=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function h(A,B,T,M){var j=B&&B.prototype instanceof b?B:b,J=Object.create(j.prototype),U=new E(M||[]);return J._invoke=function(H,te,se){var W="suspendedStart";return function(Y,ie){if(W==="executing")throw new Error("Generator is already running");if(W==="completed"){if(Y==="throw")throw ie;return I()}for(se.method=Y,se.arg=ie;;){var re=se.delegate;if(re){var Q=x(re,se);if(Q){if(Q===g)continue;return Q}}if(se.method==="next")se.sent=se._sent=se.arg;else if(se.method==="throw"){if(W==="suspendedStart")throw W="completed",se.arg;se.dispatchException(se.arg)}else se.method==="return"&&se.abrupt("return",se.arg);W="executing";var ee=p(H,te,se);if(ee.type==="normal"){if(W=se.done?"completed":"suspendedYield",ee.arg===g)continue;return{value:ee.arg,done:se.done}}ee.type==="throw"&&(W="completed",se.method="throw",se.arg=ee.arg)}}}(A,T,U),J}function p(A,B,T){try{return{type:"normal",arg:A.call(B,T)}}catch(M){return{type:"throw",arg:M}}}n.wrap=h;var g={};function b(){}function v(){}function k(){}var C={};C[l]=function(){return this};var O=Object.getPrototypeOf,d=O&&O(O(L([])));d&&d!==a&&s.call(d,l)&&(C=d);var _=k.prototype=b.prototype=Object.create(C);function m(A){["next","throw","return"].forEach(function(B){A[B]=function(T){return this._invoke(B,T)}})}function y(A,B){var T;this._invoke=function(M,j){function J(){return new B(function(U,H){(function te(se,W,Y,ie){var re=p(A[se],A,W);if(re.type!=="throw"){var Q=re.arg,ee=Q.value;return ee&&typeof ee=="object"&&s.call(ee,"__await")?B.resolve(ee.__await).then(function(pe){te("next",pe,Y,ie)},function(pe){te("throw",pe,Y,ie)}):B.resolve(ee).then(function(pe){Q.value=pe,Y(Q)},function(pe){return te("throw",pe,Y,ie)})}ie(re.arg)})(M,j,U,H)})}return T=T?T.then(J,J):J()}}function x(A,B){var T=A.iterator[B.method];if(T===void 0){if(B.delegate=null,B.method==="throw"){if(A.iterator.return&&(B.method="return",B.arg=void 0,x(A,B),B.method==="throw"))return g;B.method="throw",B.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var M=p(T,A.iterator,B.arg);if(M.type==="throw")return B.method="throw",B.arg=M.arg,B.delegate=null,g;var j=M.arg;return j?j.done?(B[A.resultName]=j.value,B.next=A.nextLoc,B.method!=="return"&&(B.method="next",B.arg=void 0),B.delegate=null,g):j:(B.method="throw",B.arg=new TypeError("iterator result is not an object"),B.delegate=null,g)}function S(A){var B={tryLoc:A[0]};1 in A&&(B.catchLoc=A[1]),2 in A&&(B.finallyLoc=A[2],B.afterLoc=A[3]),this.tryEntries.push(B)}function w(A){var B=A.completion||{};B.type="normal",delete B.arg,A.completion=B}function E(A){this.tryEntries=[{tryLoc:"root"}],A.forEach(S,this),this.reset(!0)}function L(A){if(A){var B=A[l];if(B)return B.call(A);if(typeof A.next=="function")return A;if(!isNaN(A.length)){var T=-1,M=function j(){for(;++T<A.length;)if(s.call(A,T))return j.value=A[T],j.done=!1,j;return j.value=void 0,j.done=!0,j};return M.next=M}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=_.constructor=k,k.constructor=v,k[c]=v.displayName="GeneratorFunction",n.isGeneratorFunction=function(A){var B=typeof A=="function"&&A.constructor;return!!B&&(B===v||(B.displayName||B.name)==="GeneratorFunction")},n.mark=function(A){return Object.setPrototypeOf?Object.setPrototypeOf(A,k):(A.__proto__=k,c in A||(A[c]="GeneratorFunction")),A.prototype=Object.create(_),A},n.awrap=function(A){return{__await:A}},m(y.prototype),y.prototype[u]=function(){return this},n.AsyncIterator=y,n.async=function(A,B,T,M,j){j===void 0&&(j=Promise);var J=new y(h(A,B,T,M),j);return n.isGeneratorFunction(B)?J:J.next().then(function(U){return U.done?U.value:J.next()})},m(_),_[c]="Generator",_[l]=function(){return this},_.toString=function(){return"[object Generator]"},n.keys=function(A){var B=[];for(var T in A)B.push(T);return B.reverse(),function M(){for(;B.length;){var j=B.pop();if(j in A)return M.value=j,M.done=!1,M}return M.done=!0,M}},n.values=L,E.prototype={constructor:E,reset:function(A){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!A)for(var B in this)B.charAt(0)==="t"&&s.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=void 0)},stop:function(){this.done=!0;var A=this.tryEntries[0].completion;if(A.type==="throw")throw A.arg;return this.rval},dispatchException:function(A){if(this.done)throw A;var B=this;function T(te,se){return J.type="throw",J.arg=A,B.next=te,se&&(B.method="next",B.arg=void 0),!!se}for(var M=this.tryEntries.length-1;M>=0;--M){var j=this.tryEntries[M],J=j.completion;if(j.tryLoc==="root")return T("end");if(j.tryLoc<=this.prev){var U=s.call(j,"catchLoc"),H=s.call(j,"finallyLoc");if(U&&H){if(this.prev<j.catchLoc)return T(j.catchLoc,!0);if(this.prev<j.finallyLoc)return T(j.finallyLoc)}else if(U){if(this.prev<j.catchLoc)return T(j.catchLoc,!0)}else{if(!H)throw new Error("try statement without catch or finally");if(this.prev<j.finallyLoc)return T(j.finallyLoc)}}}},abrupt:function(A,B){for(var T=this.tryEntries.length-1;T>=0;--T){var M=this.tryEntries[T];if(M.tryLoc<=this.prev&&s.call(M,"finallyLoc")&&this.prev<M.finallyLoc){var j=M;break}}j&&(A==="break"||A==="continue")&&j.tryLoc<=B&&B<=j.finallyLoc&&(j=null);var J=j?j.completion:{};return J.type=A,J.arg=B,j?(this.method="next",this.next=j.finallyLoc,g):this.complete(J)},complete:function(A,B){if(A.type==="throw")throw A.arg;return A.type==="break"||A.type==="continue"?this.next=A.arg:A.type==="return"?(this.rval=this.arg=A.arg,this.method="return",this.next="end"):A.type==="normal"&&B&&(this.next=B),g},finish:function(A){for(var B=this.tryEntries.length-1;B>=0;--B){var T=this.tryEntries[B];if(T.finallyLoc===A)return this.complete(T.completion,T.afterLoc),w(T),g}},catch:function(A){for(var B=this.tryEntries.length-1;B>=0;--B){var T=this.tryEntries[B];if(T.tryLoc===A){var M=T.completion;if(M.type==="throw"){var j=M.arg;w(T)}return j}}throw new Error("illegal catch attempt")},delegateYield:function(A,B,T){return this.delegate={iterator:L(A),resultName:B,nextLoc:T},this.method==="next"&&(this.arg=void 0),g}},n}(i.exports);try{regeneratorRuntime=r}catch(n){Function("r","regeneratorRuntime = r")(r)}},function(i,t,e){var r=e(142);i.exports=function(n,a){if(n){if(typeof n=="string")return r(n,a);var s=Object.prototype.toString.call(n).slice(8,-1);return s==="Object"&&n.constructor&&(s=n.constructor.name),s==="Map"||s==="Set"?Array.from(s):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?r(n,a):void 0}}},function(i,t){i.exports=function(e,r){(r==null||r>e.length)&&(r=e.length);for(var n=0,a=new Array(r);n<r;n++)a[n]=e[n];return a}},function(i,t){function e(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i.exports=e=function(n){return typeof n}:i.exports=e=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e(r)}i.exports=e},function(i){i.exports=JSON.parse('{"ui":{"blockTunes":{"toggler":{"Click to tune":"","or drag to move":""}},"inlineToolbar":{"converter":{"Convert to":""}},"toolbar":{"toolbox":{"Add":""}}},"toolNames":{"Text":"","Link":"","Bold":"","Italic":""},"tools":{"link":{"Add a link":""},"stub":{"The block can not be displayed correctly.":""}},"blockTunes":{"delete":{"Delete":""},"moveUp":{"Move up":""},"moveDown":{"Move down":""}}}')},function(i,t,e){var r,n,a;n=[t,e(2),e(5),e(6),e(4),e(146)],(a=typeof(r=function(s,o,l,u,c,h){"use strict";var p=e(1);function g(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(v){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.CriticalError=void 0,o=p(o),l=p(l),u=p(u),c=p(c);var b=function(v){(0,l.default)(O,v);var k,C=(k=O,function(){var d,_=(0,c.default)(k);if(g()){var m=(0,c.default)(this).constructor;d=Reflect.construct(_,arguments,m)}else d=_.apply(this,arguments);return(0,u.default)(this,d)});function O(){return(0,o.default)(this,O),C.apply(this,arguments)}return O}((0,(h=p(h)).default)(Error));s.CriticalError=b,b.displayName="CriticalError"})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(4),n=e(107),a=e(369),s=e(370);function o(l){var u=typeof Map=="function"?new Map:void 0;return i.exports=o=function(c){if(c===null||!a(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(u!==void 0){if(u.has(c))return u.get(c);u.set(c,h)}function h(){return s(c,arguments,r(this).constructor)}return h.prototype=Object.create(c.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),n(h,c)},o(l)}i.exports=o},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(8),e(148),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b){"use strict";var v=e(9),k=e(1);function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=k(o),l=k(l),u=k(u),c=k(c),h=k(h),p=v(p),g=k(g);var O=function(d){(0,u.default)(y,d);var _,m=(_=y,function(){var x,S=(0,h.default)(_);if(C()){var w=(0,h.default)(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return(0,c.default)(this,x)});function y(){var x;return(0,o.default)(this,y),(x=m.apply(this,arguments)).insert=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:x.config.defaultBlock,w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E=(arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),L=arguments.length>4?arguments[4]:void 0;x.Editor.BlockManager.insert({tool:S,data:w,index:E,needToFocus:L})},x}return(0,l.default)(y,[{key:"getBlocksCount",value:function(){return this.Editor.BlockManager.blocks.length}},{key:"getCurrentBlockIndex",value:function(){return this.Editor.BlockManager.currentBlockIndex}},{key:"getBlockByIndex",value:function(x){var S=this.Editor.BlockManager.getBlockByIndex(x);if(S!==void 0)return new g.default(S);p.logLabeled("There is no block at index `"+x+"`","warn")}},{key:"swap",value:function(x,S){p.log("`blocks.swap()` method is deprecated and will be removed in the next major release. Use `block.move()` method instead","info"),this.Editor.BlockManager.swap(x,S),this.Editor.Toolbar.move(!1)}},{key:"move",value:function(x,S){this.Editor.BlockManager.move(x,S),this.Editor.Toolbar.move(!1)}},{key:"delete",value:function(x){try{this.Editor.BlockManager.removeBlock(x)}catch(S){return void p.logLabeled(S,"warn")}this.Editor.BlockManager.blocks.length===0&&this.Editor.BlockManager.insert(),this.Editor.BlockManager.currentBlock&&this.Editor.Caret.setToBlock(this.Editor.BlockManager.currentBlock,this.Editor.Caret.positions.END),this.Editor.Toolbar.close()}},{key:"clear",value:function(){this.Editor.BlockManager.clear(!0),this.Editor.InlineToolbar.close()}},{key:"render",value:function(x){return this.Editor.BlockManager.clear(),this.Editor.Renderer.render(x.blocks)}},{key:"renderFromHTML",value:function(x){return this.Editor.BlockManager.clear(),this.Editor.Paste.processText(x,!0)}},{key:"stretchBlock",value:function(x){var S=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];p.deprecationAssert(!0,"blocks.stretchBlock()","BlockAPI");var w=this.Editor.BlockManager.getBlockByIndex(x);w&&(w.stretched=S)}},{key:"insertNewBlock",value:function(){p.log("Method blocks.insertNewBlock() is deprecated and it will be removed in the next major release. Use blocks.insert() instead.","warn"),this.insert()}},{key:"methods",get:function(){var x=this;return{clear:function(){return x.clear()},render:function(S){return x.render(S)},renderFromHTML:function(S){return x.renderFromHTML(S)},delete:function(S){return x.delete(S)},swap:function(S,w){return x.swap(S,w)},move:function(S,w){return x.move(S,w)},getBlockByIndex:function(S){return x.getBlockByIndex(S)},getCurrentBlockIndex:function(){return x.getCurrentBlockIndex()},getBlocksCount:function(){return x.getBlocksCount()},stretchBlock:function(S){var w=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return x.stretchBlock(S,w)},insertNewBlock:function(){return x.insertNewBlock()},insert:this.insert}}}]),y}((b=k(b)).default);s.default=O,O.displayName="BlocksAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t],(a=typeof(r=function(s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;var o=function(l){var u={get name(){return l.name},get config(){return l.config},get holder(){return l.holder},get isEmpty(){return l.isEmpty},get selected(){return l.selected},set stretched(c){l.stretched=c},get stretched(){return l.stretched},call:function(c,h){return l.call(c,h)},save:function(){return l.save()},validate:function(c){return l.validate(c)}};Object.setPrototypeOf(this,u)};s.default=o,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){var _;return(0,o.default)(this,d),(_=O.apply(this,arguments)).setToFirstBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.firstBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.firstBlock,m,y),!0)},_.setToLastBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.lastBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.lastBlock,m,y),!0)},_.setToPreviousBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.previousBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.previousBlock,m,y),!0)},_.setToNextBlock=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.Editor.Caret.positions.DEFAULT,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return!!_.Editor.BlockManager.nextBlock&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.nextBlock,m,y),!0)},_.setToBlock=function(m){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.Editor.Caret.positions.DEFAULT,x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return!!_.Editor.BlockManager.blocks[m]&&(_.Editor.Caret.setToBlock(_.Editor.BlockManager.blocks[m],y,x),!0)},_.focus=function(){var m=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return m?_.setToLastBlock(_.Editor.Caret.positions.END):_.setToFirstBlock(_.Editor.Caret.positions.START)},_}return(0,l.default)(d,[{key:"methods",get:function(){return{setToFirstBlock:this.setToFirstBlock,setToLastBlock:this.setToLastBlock,setToPreviousBlock:this.setToPreviousBlock,setToNextBlock:this.setToNextBlock,setToBlock:this.setToBlock,focus:this.focus}}}]),d}((p=g(p)).default);s.default=v,v.displayName="CaretAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"on",value:function(_,m){this.eventsDispatcher.on(_,m)}},{key:"emit",value:function(_,m){this.eventsDispatcher.emit(_,m)}},{key:"off",value:function(_,m){this.eventsDispatcher.off(_,m)}},{key:"methods",get:function(){var _=this;return{emit:function(m,y){return _.emit(m,y)},off:function(m,y){return _.off(m,y)},on:function(m,y){return _.on(m,y)}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="EventsAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(59),e(8),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b){"use strict";var v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=v(o),l=v(l),u=v(u),c=v(c),h=v(h),p=v(p);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){return(0,o.default)(this,m),_.apply(this,arguments)}return(0,l.default)(m,[{key:"getMethodsForTool",value:function(y){return Object.assign(this.methods,{t:function(x){return p.default.t(m.getNamespace(y),x)}})}},{key:"methods",get:function(){return{t:function(){(0,g.logLabeled)("I18n.t() method can be accessed only from Tools","warn")}}}}],[{key:"getNamespace",value:function(y){return y.isTune?"blockTunes.".concat(y.name):"tools.".concat(y.name)}}]),m}((b=v(b)).default);s.default=C,C.displayName="I18nAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"open",value:function(){this.Editor.InlineToolbar.tryToShow()}},{key:"close",value:function(){this.Editor.InlineToolbar.close()}},{key:"methods",get:function(){var _=this;return{close:function(){return _.close()},open:function(){return _.open()}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="InlineToolbarAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"on",value:function(_,m,y,x){this.listeners.on(_,m,y,x)}},{key:"off",value:function(_,m,y,x){this.listeners.off(_,m,y,x)}},{key:"methods",get:function(){var _=this;return{on:function(m,y,x,S){return _.on(m,y,x,S)},off:function(m,y,x,S){return _.off(m,y,x,S)}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="ListenersAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"show",value:function(_){return this.Editor.Notifier.show(_)}},{key:"methods",get:function(){var _=this;return{show:function(m){return _.show(m)}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="NotifierAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"toggle",value:function(_){return this.Editor.ReadOnly.toggle(_)}},{key:"methods",get:function(){var _=this;return{toggle:function(m){return _.toggle(m)}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="ReadOnlyAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"clean",value:function(_,m){return this.Editor.Sanitizer.clean(_,m)}},{key:"methods",get:function(){var _=this;return{clean:function(m,y){return _.clean(m,y)}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="SanitizerAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(8),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=v(o),l=v(l),u=v(u),c=v(c),h=v(h),p=b(p);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){return(0,o.default)(this,m),_.apply(this,arguments)}return(0,l.default)(m,[{key:"save",value:function(){var y="Editor's content can not be saved in read-only mode";return this.Editor.ReadOnly.isEnabled?(p.logLabeled(y,"warn"),Promise.reject(new Error(y))):this.Editor.Saver.save()}},{key:"methods",get:function(){var y=this;return{save:function(){return y.save()}}}}]),m}((g=v(g)).default);s.default=C,C.displayName="SaverAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(25),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=b(o),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){return(0,o.default)(this,_),d.apply(this,arguments)}return(0,l.default)(_,[{key:"findParentTag",value:function(m,y){return new p.default().findParentTag(m,y)}},{key:"expandToTag",value:function(m){new p.default().expandToTag(m)}},{key:"methods",get:function(){var m=this;return{findParentTag:function(y,x){return m.findParentTag(y,x)},expandToTag:function(y){return m.expandToTag(y)}}}}]),_}((g=b(g)).default);s.default=k,k.displayName="SelectionAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"classes",get:function(){return{block:"cdx-block",inlineToolButton:"ce-inline-tool",inlineToolButtonActive:"ce-inline-tool--active",input:"cdx-input",loader:"cdx-loader",button:"cdx-button",settingsButton:"cdx-settings-button",settingsButtonActive:"cdx-settings-button--active"}}}]),d}((p=g(p)).default);s.default=v,v.displayName="StylesAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=v(o),l=v(l),u=v(u),c=v(c),h=v(h),p=v(p),g=b(g);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){return(0,o.default)(this,m),_.apply(this,arguments)}return(0,l.default)(m,[{key:"open",value:function(){this.Editor.Toolbar.open()}},{key:"close",value:function(){this.Editor.Toolbar.close()}},{key:"toggleBlockSettings",value:function(y){if(this.Editor.BlockManager.currentBlockIndex!==-1){var x=y!=null?y:!this.Editor.BlockSettings.opened;y!==this.Editor.BlockSettings.opened&&(x?(this.Editor.Toolbar.opened||(this.Editor.Toolbar.open(!0,!1),this.Editor.Toolbar.plusButton.hide()),this.Editor.BlockSettings.open()):this.Editor.BlockSettings.close())}else g.logLabeled("Could't toggle the Toolbar because there is no block selected ","warn")}},{key:"methods",get:function(){var y=this;return{close:function(){return y.close()},open:function(){return y.open()},toggleBlockSettings:function(x){return y.toggleBlockSettings(x)}}}}]),m}(p.default);s.default=C,C.displayName="ToolbarAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);function b(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(k){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=g(h);var v=function(k){(0,u.default)(d,k);var C,O=(C=d,function(){var _,m=(0,h.default)(C);if(b()){var y=(0,h.default)(this).constructor;_=Reflect.construct(m,arguments,y)}else _=m.apply(this,arguments);return(0,c.default)(this,_)});function d(){return(0,o.default)(this,d),O.apply(this,arguments)}return(0,l.default)(d,[{key:"show",value:function(_,m,y){this.Editor.Tooltip.show(_,m,y)}},{key:"hide",value:function(){this.Editor.Tooltip.hide()}},{key:"onHover",value:function(_,m,y){this.Editor.Tooltip.onHover(_,m,y)}},{key:"methods",get:function(){var _=this;return{show:function(m,y,x){return _.show(m,y,x)},hide:function(){return _.hide()},onHover:function(m,y,x){return _.onHover(m,y,x)}}}}]),d}((p=g(p)).default);s.default=v,v.displayName="TooltipAPI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(25),e(60)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C){"use strict";var O=e(9),d=e(1);function _(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(y){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=d(o),l=d(l),u=d(u),c=d(c),h=d(h),p=d(p),g=d(g),b=d(b),v=O(v),k=d(k),C=d(C);var m=function(y){(0,h.default)(E,y);var x,S,w=(x=E,function(){var L,I=(0,g.default)(x);if(_()){var A=(0,g.default)(this).constructor;L=Reflect.construct(I,arguments,A)}else L=I.apply(this,arguments);return(0,p.default)(this,L)});function E(){return(0,u.default)(this,E),w.apply(this,arguments)}return(0,c.default)(E,[{key:"keydown",value:function(L){switch(this.beforeKeydownProcessing(L),L.keyCode){case v.keyCodes.BACKSPACE:this.backspace(L);break;case v.keyCodes.ENTER:this.enter(L);break;case v.keyCodes.DOWN:case v.keyCodes.RIGHT:this.arrowRightAndDown(L);break;case v.keyCodes.UP:case v.keyCodes.LEFT:this.arrowLeftAndUp(L);break;case v.keyCodes.TAB:this.tabPressed(L)}}},{key:"beforeKeydownProcessing",value:function(L){this.needToolbarClosing(L)&&v.isPrintableKey(L.keyCode)&&(this.Editor.Toolbar.close(),this.Editor.ConversionToolbar.close(),L.ctrlKey||L.metaKey||L.altKey||L.shiftKey||(this.Editor.BlockManager.clearFocused(),this.Editor.BlockSelection.clearSelection(L)))}},{key:"keyup",value:function(L){L.shiftKey||this.Editor.UI.checkEmptiness()}},{key:"tabPressed",value:function(L){this.Editor.BlockSelection.clearSelection(L);var I=this.Editor,A=I.BlockManager,B=I.InlineToolbar,T=I.ConversionToolbar,M=A.currentBlock;if(M){var j=M.tool.isDefault&&M.isEmpty,J=!M.isEmpty&&T.opened,U=!M.isEmpty&&!k.default.isCollapsed&&B.opened;j?this.activateToolbox():J||U||this.activateBlockSettings()}}},{key:"dragOver",value:function(L){this.Editor.BlockManager.getBlockByChildNode(L.target).dropTarget=!0}},{key:"dragLeave",value:function(L){this.Editor.BlockManager.getBlockByChildNode(L.target).dropTarget=!1}},{key:"handleCommandC",value:function(L){var I=this.Editor.BlockSelection;if(I.anyBlockSelected)return I.copySelectedBlocks(L)}},{key:"handleCommandX",value:(S=(0,l.default)(o.default.mark(function L(I){var A,B,T,M,j;return o.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(A=this.Editor,B=A.BlockSelection,T=A.BlockManager,M=A.Caret,B.anyBlockSelected){J.next=3;break}return J.abrupt("return");case 3:return J.next=5,B.copySelectedBlocks(I);case 5:j=T.removeSelectedBlocks(),M.setToBlock(T.insertDefaultBlockAtIndex(j,!0),M.positions.START),B.clearSelection(I);case 8:case"end":return J.stop()}},L,this)})),function(L){return S.apply(this,arguments)})},{key:"enter",value:function(L){var I=this.Editor,A=I.BlockManager,B=I.UI;if(!A.currentBlock.tool.isLineBreaksEnabled&&!(B.someToolbarOpened&&B.someFlipperButtonFocused||L.shiftKey)){var T=this.Editor.BlockManager.currentBlock;this.Editor.Caret.isAtStart&&!this.Editor.BlockManager.currentBlock.hasMedia?this.Editor.BlockManager.insertDefaultBlockAtIndex(this.Editor.BlockManager.currentBlockIndex):T=this.Editor.BlockManager.split(),this.Editor.Caret.setToBlock(T),T.tool.isDefault&&T.isEmpty&&(this.Editor.Toolbar.open(!1),this.Editor.Toolbar.plusButton.show()),L.preventDefault()}}},{key:"backspace",value:function(L){var I=this.Editor,A=I.BlockManager,B=I.BlockSelection,T=I.Caret,M=A.currentBlock,j=M.tool;if(M.selected||M.isEmpty&&M.currentInput===M.firstInput){L.preventDefault();var J=A.currentBlockIndex;return A.previousBlock&&A.previousBlock.inputs.length===0?A.removeBlock(J-1):A.removeBlock(),T.setToBlock(A.currentBlock,J?T.positions.END:T.positions.START),this.Editor.Toolbar.close(),void B.clearSelection(L)}if(!j.isLineBreaksEnabled||T.isAtStart){var U=A.currentBlockIndex===0;T.isAtStart&&k.default.isCollapsed&&M.currentInput===M.firstInput&&!U&&(L.preventDefault(),this.mergeBlocks())}}},{key:"mergeBlocks",value:function(){var L=this.Editor,I=L.BlockManager,A=L.Caret,B=L.Toolbar,T=I.previousBlock,M=I.currentBlock;if(M.name!==T.name||!T.mergeable)return T.inputs.length===0||T.isEmpty?(I.removeBlock(I.currentBlockIndex-1),A.setToBlock(I.currentBlock),void B.close()):void(A.navigatePrevious()&&B.close());A.createShadow(T.pluginsContent),I.mergeBlocks(T,M).then(function(){A.restoreCaret(T.pluginsContent),T.pluginsContent.normalize(),B.close()})}},{key:"arrowRightAndDown",value:function(L){var I=this,A=C.default.usedKeys.includes(L.keyCode)&&(!L.shiftKey||L.keyCode===v.keyCodes.TAB);if(!this.Editor.UI.someToolbarOpened||!A){this.Editor.BlockManager.clearFocused(),this.Editor.Toolbar.close();var B=this.Editor.Caret.isAtEnd||this.Editor.BlockSelection.anyBlockSelected;L.shiftKey&&L.keyCode===v.keyCodes.DOWN&&B?this.Editor.CrossBlockSelection.toggleBlockSelectedState():((L.keyCode===v.keyCodes.DOWN||L.keyCode===v.keyCodes.RIGHT&&!this.isRtl?this.Editor.Caret.navigateNext():this.Editor.Caret.navigatePrevious())?L.preventDefault():v.delay(function(){I.Editor.BlockManager.currentBlock&&I.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(L))}}},{key:"arrowLeftAndUp",value:function(L){var I=this;if(this.Editor.UI.someToolbarOpened){if(C.default.usedKeys.includes(L.keyCode)&&(!L.shiftKey||L.keyCode===v.keyCodes.TAB))return;this.Editor.UI.closeAllToolbars()}this.Editor.BlockManager.clearFocused(),this.Editor.Toolbar.close();var A=this.Editor.Caret.isAtStart||this.Editor.BlockSelection.anyBlockSelected;L.shiftKey&&L.keyCode===v.keyCodes.UP&&A?this.Editor.CrossBlockSelection.toggleBlockSelectedState(!1):((L.keyCode===v.keyCodes.UP||L.keyCode===v.keyCodes.LEFT&&!this.isRtl?this.Editor.Caret.navigatePrevious():this.Editor.Caret.navigateNext())?L.preventDefault():v.delay(function(){I.Editor.BlockManager.currentBlock&&I.Editor.BlockManager.currentBlock.updateCurrentInput()},20)(),this.Editor.BlockSelection.clearSelection(L))}},{key:"needToolbarClosing",value:function(L){var I=L.keyCode===v.keyCodes.ENTER&&this.Editor.Toolbox.opened,A=L.keyCode===v.keyCodes.ENTER&&this.Editor.BlockSettings.opened,B=L.keyCode===v.keyCodes.ENTER&&this.Editor.InlineToolbar.opened,T=L.keyCode===v.keyCodes.ENTER&&this.Editor.ConversionToolbar.opened,M=L.keyCode===v.keyCodes.TAB;return!(L.shiftKey||M||I||A||B||T)}},{key:"activateToolbox",value:function(){this.Editor.Toolbar.opened||(this.Editor.Toolbar.open(!1,!1),this.Editor.Toolbar.plusButton.show()),this.Editor.Toolbox.open()}},{key:"activateBlockSettings",value:function(){this.Editor.Toolbar.opened||(this.Editor.BlockManager.currentBlock.focused=!0,this.Editor.Toolbar.open(!0,!1),this.Editor.Toolbar.plusButton.hide()),this.Editor.BlockSettings.opened||this.Editor.BlockSettings.open()}}]),E}(b.default);s.default=m,m.displayName="BlockEvents",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(61),e(7),e(15),e(8),e(376)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O){"use strict";var d=e(9),_=e(1);function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(x){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=_(o),l=_(l),u=_(u),c=_(c),h=_(h),p=_(p),g=_(g),b=d(b),v=_(v),k=_(k),C=d(C),O=_(O);var y=function(x){(0,h.default)(I,x);var S,w,E,L=(S=I,function(){var A,B=(0,g.default)(S);if(m()){var T=(0,g.default)(this).constructor;A=Reflect.construct(B,arguments,T)}else A=B.apply(this,arguments);return(0,p.default)(this,A)});function I(){var A;return(0,u.default)(this,I),(A=L.apply(this,arguments))._currentBlockIndex=-1,A._blocks=null,A}return(0,c.default)(I,[{key:"prepare",value:function(){var A=this,B=new O.default(this.Editor.UI.nodes.redactor);this._blocks=new Proxy(B,{set:O.default.set,get:O.default.get}),this.listeners.on(document,"copy",function(T){return A.Editor.BlockEvents.handleCommandC(T)})}},{key:"toggleReadOnly",value:function(A){A?this.disableModuleBindings():this.enableModuleBindings()}},{key:"composeBlock",value:function(A){var B=A.tool,T=A.data,M=T===void 0?{}:T,j=A.tunes,J=j===void 0?{}:j,U=this.Editor.ReadOnly.isEnabled,H=this.Editor.Tools.blockTools.get(B),te=this.Editor.Tools.getTunesForTool(H),se=new b.default({data:M,tool:H,api:this.Editor.API,readOnly:U,tunes:te,tunesData:J});return U||this.bindBlockEvents(se),se}},{key:"insert",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},B=A.tool,T=B===void 0?this.config.defaultBlock:B,M=A.data,j=M===void 0?{}:M,J=A.index,U=A.needToFocus,H=U===void 0||U,te=A.replace,se=te!==void 0&&te,W=A.tunes,Y=W===void 0?{}:W,ie=J;ie===void 0&&(ie=this.currentBlockIndex+(se?0:1));var re=this.composeBlock({tool:T,data:j,tunes:Y});return this._blocks.insert(ie,re,se),H?this.currentBlockIndex=ie:ie<=this.currentBlockIndex&&this.currentBlockIndex++,re}},{key:"replace",value:function(A){var B=A.tool,T=B===void 0?this.config.defaultBlock:B,M=A.data,j=M===void 0?{}:M;return this.insert({tool:T,data:j,index:this.currentBlockIndex,replace:!0})}},{key:"paste",value:function(A,B){var T=arguments.length>2&&arguments[2]!==void 0&&arguments[2],M=this.insert({tool:A,replace:T});try{M.call(b.BlockToolAPI.ON_PASTE,B)}catch(j){C.log("".concat(A,": onPaste callback call is failed"),"error",j)}return M}},{key:"insertDefaultBlockAtIndex",value:function(A){var B=arguments.length>1&&arguments[1]!==void 0&&arguments[1],T=this.composeBlock({tool:this.config.defaultBlock});return this._blocks[A]=T,B?this.currentBlockIndex=A:A<=this.currentBlockIndex&&this.currentBlockIndex++,T}},{key:"insertAtEnd",value:function(){return this.currentBlockIndex=this.blocks.length-1,this.insert()}},{key:"mergeBlocks",value:(E=(0,l.default)(o.default.mark(function A(B,T){var M,j;return o.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:if(M=this._blocks.indexOf(T),!T.isEmpty){J.next=3;break}return J.abrupt("return");case 3:return J.next=5,T.data;case 5:if(j=J.sent,C.isEmpty(j)){J.next=9;break}return J.next=9,B.mergeWith(j);case 9:this.removeBlock(M),this.currentBlockIndex=this._blocks.indexOf(B);case 11:case"end":return J.stop()}},A,this)})),function(A,B){return E.apply(this,arguments)})},{key:"removeBlock",value:function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.currentBlockIndex;if(!this.validateIndex(A))throw new Error("Can't find a Block to remove");this._blocks.remove(A),this.currentBlockIndex>=A&&this.currentBlockIndex--,this.blocks.length?A===0&&(this.currentBlockIndex=0):(this.currentBlockIndex=-1,this.insert())}},{key:"removeSelectedBlocks",value:function(){for(var A,B=this.blocks.length-1;B>=0;B--)this.blocks[B].selected&&(this.removeBlock(B),A=B);return A}},{key:"removeAllBlocks",value:function(){for(var A=this.blocks.length-1;A>=0;A--)this._blocks.remove(A);this.currentBlockIndex=-1,this.insert(),this.currentBlock.firstInput.focus()}},{key:"split",value:function(){var A=this.Editor.Caret.extractFragmentFromCaretPosition(),B=k.default.make("div");B.appendChild(A);var T={text:k.default.isEmpty(B)?"":B.innerHTML};return this.insert({data:T})}},{key:"getBlockByIndex",value:function(A){return this._blocks[A]}},{key:"getBlock",value:function(A){k.default.isElement(A)||(A=A.parentNode);var B=this._blocks.nodes,T=A.closest(".".concat(b.default.CSS.wrapper)),M=B.indexOf(T);if(M>=0)return this._blocks[M]}},{key:"highlightCurrentNode",value:function(){this.clearFocused(),this.currentBlock.focused=!0}},{key:"clearFocused",value:function(){this.blocks.forEach(function(A){A.focused=!1})}},{key:"setCurrentBlockByChildNode",value:function(A){k.default.isElement(A)||(A=A.parentNode);var B=A.closest(".".concat(b.default.CSS.wrapper));if(B){var T=B.closest(".".concat(this.Editor.UI.CSS.editorWrapper));if(T!=null&&T.isEqualNode(this.Editor.UI.nodes.wrapper))return this.currentBlockIndex=this._blocks.nodes.indexOf(B),this.currentBlock.updateCurrentInput(),this.currentBlock}}},{key:"getBlockByChildNode",value:function(A){k.default.isElement(A)||(A=A.parentNode);var B=A.closest(".".concat(b.default.CSS.wrapper));return this.blocks.find(function(T){return T.holder===B})}},{key:"swap",value:function(A,B){this._blocks.swap(A,B),this.currentBlockIndex=B}},{key:"move",value:function(A){var B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.currentBlockIndex;isNaN(A)||isNaN(B)?C.log("Warning during 'move' call: incorrect indices provided.","warn"):this.validateIndex(A)&&this.validateIndex(B)?(this._blocks.move(A,B),this.currentBlockIndex=A):C.log("Warning during 'move' call: indices cannot be lower than 0 or greater than the amount of blocks.","warn")}},{key:"dropPointer",value:function(){this.currentBlockIndex=-1,this.clearFocused()}},{key:"clear",value:function(){var A=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._blocks.removeAll(),this.dropPointer(),A&&this.insert(),this.Editor.UI.checkEmptiness()}},{key:"destroy",value:(w=(0,l.default)(o.default.mark(function A(){return o.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,Promise.all(this.blocks.map(function(T){return T.destroy()}));case 2:case"end":return B.stop()}},A,this)})),function(){return w.apply(this,arguments)})},{key:"bindBlockEvents",value:function(A){var B=this.Editor.BlockEvents;this.readOnlyMutableListeners.on(A.holder,"keydown",function(T){B.keydown(T)}),this.readOnlyMutableListeners.on(A.holder,"keyup",function(T){B.keyup(T)}),this.readOnlyMutableListeners.on(A.holder,"dragover",function(T){B.dragOver(T)}),this.readOnlyMutableListeners.on(A.holder,"dragleave",function(T){B.dragLeave(T)})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"enableModuleBindings",value:function(){var A=this;this.readOnlyMutableListeners.on(document,"cut",function(B){return A.Editor.BlockEvents.handleCommandX(B)}),this.blocks.forEach(function(B){A.bindBlockEvents(B)})}},{key:"validateIndex",value:function(A){return!(A<0||A>=this._blocks.length)}},{key:"currentBlockIndex",get:function(){return this._currentBlockIndex},set:function(A){this._blocks[this._currentBlockIndex]&&this._blocks[this._currentBlockIndex].willUnselect(),this._blocks[A]&&this._blocks[A].willSelect(),this._currentBlockIndex=A}},{key:"firstBlock",get:function(){return this._blocks[0]}},{key:"lastBlock",get:function(){return this._blocks[this._blocks.length-1]}},{key:"currentBlock",get:function(){return this._blocks[this.currentBlockIndex]}},{key:"nextBlock",get:function(){return this.currentBlockIndex===this._blocks.length-1?null:this._blocks[this.currentBlockIndex+1]}},{key:"nextContentfulBlock",get:function(){return this.blocks.slice(this.currentBlockIndex+1).find(function(A){return!!A.inputs.length})}},{key:"previousContentfulBlock",get:function(){return this.blocks.slice(0,this.currentBlockIndex).reverse().find(function(A){return!!A.inputs.length})}},{key:"previousBlock",get:function(){return this.currentBlockIndex===0?null:this._blocks[this.currentBlockIndex-1]}},{key:"blocks",get:function(){return this._blocks.array}},{key:"isEditorEmpty",get:function(){return this.blocks.every(function(A){return A.isEmpty})}}]),I}(v.default);s.default=y,y.displayName="BlockManager",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(15),e(108),e(25)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O){"use strict";var d=e(9),_=e(1);function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(x){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=_(o),l=_(l),u=_(u),c=_(c),h=_(h),p=_(p),g=_(g),b=_(b),v=d(v),k=_(k),C=_(C),O=_(O);var y=function(x){(0,h.default)(L,x);var S,w,E=(S=L,function(){var I,A=(0,g.default)(S);if(m()){var B=(0,g.default)(this).constructor;I=Reflect.construct(A,arguments,B)}else I=A.apply(this,arguments);return(0,p.default)(this,I)});function L(){var I;return(0,u.default)(this,L),(I=E.apply(this,arguments)).anyBlockSelectedCache=null,I.needToSelectAll=!1,I.nativeInputSelected=!1,I.readyToBlockSelection=!1,I}return(0,c.default)(L,[{key:"prepare",value:function(){var I=this;this.selection=new O.default,C.default.add({name:"CMD+A",handler:function(A){var B=I.Editor,T=B.BlockManager;if(B.ReadOnly.isEnabled)return A.preventDefault(),void I.selectAllBlocks();T.currentBlock&&I.handleCommandA(A)},on:this.Editor.UI.nodes.redactor})}},{key:"toggleReadOnly",value:function(I){O.default.get().removeAllRanges(),this.allBlocksSelected=!1}},{key:"unSelectBlockByIndex",value:function(I){var A=this.Editor.BlockManager;(isNaN(I)?A.currentBlock:A.getBlockByIndex(I)).selected=!1,this.clearCache()}},{key:"clearSelection",value:function(I){var A=arguments.length>1&&arguments[1]!==void 0&&arguments[1],B=this.Editor,T=B.BlockManager,M=B.Caret,j=B.RectangleSelection;this.needToSelectAll=!1,this.nativeInputSelected=!1,this.readyToBlockSelection=!1;var J=I&&I instanceof KeyboardEvent,U=J&&v.isPrintableKey(I.keyCode);if(this.anyBlockSelected&&J&&U&&!O.default.isSelectionExists){var H=T.removeSelectedBlocks();T.insertDefaultBlockAtIndex(H,!0),M.setToBlock(T.currentBlock),v.delay(function(){var te=I.key;M.insertContentAtCaretPosition(te.length>1?"":te)},20)()}this.Editor.CrossBlockSelection.clear(I),this.anyBlockSelected&&!j.isRectActivated()?(A&&this.selection.restore(),this.allBlocksSelected=!1):this.Editor.RectangleSelection.clearSelection()}},{key:"copySelectedBlocks",value:(w=(0,l.default)(o.default.mark(function I(A){var B,T,M,j,J=this;return o.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return A.preventDefault(),B=k.default.make("div"),this.selectedBlocks.forEach(function(H){var te=J.Editor.Sanitizer.clean(H.holder.innerHTML,J.sanitizerConfig),se=k.default.make("p");se.innerHTML=te,B.appendChild(se)}),U.next=5,Promise.all(this.selectedBlocks.map(function(H){return H.save()}));case 5:T=U.sent,M=Array.from(B.childNodes).map(function(H){return H.textContent}).join(`

`),j=B.innerHTML,A.clipboardData.setData("text/plain",M),A.clipboardData.setData("text/html",j),A.clipboardData.setData(this.Editor.Paste.MIME_TYPE,JSON.stringify(T));case 11:case"end":return U.stop()}},I,this)})),function(I){return w.apply(this,arguments)})},{key:"selectBlockByIndex",value:function(I){var A,B=this.Editor.BlockManager;B.clearFocused(),A=isNaN(I)?B.currentBlock:B.getBlockByIndex(I),this.selection.save(),O.default.get().removeAllRanges(),A.selected=!0,this.clearCache(),this.Editor.InlineToolbar.close()}},{key:"clearCache",value:function(){this.anyBlockSelectedCache=null}},{key:"destroy",value:function(){C.default.remove(this.Editor.UI.nodes.redactor,"CMD+A")}},{key:"handleCommandA",value:function(I){if(this.Editor.RectangleSelection.clearSelection(),!k.default.isNativeInput(I.target)||this.readyToBlockSelection){var A=this.Editor.BlockManager.getBlock(I.target).inputs;A.length>1&&!this.readyToBlockSelection?this.readyToBlockSelection=!0:A.length!==1||this.needToSelectAll?this.needToSelectAll?(I.preventDefault(),this.selectAllBlocks(),this.needToSelectAll=!1,this.readyToBlockSelection=!1,this.Editor.ConversionToolbar.close()):this.readyToBlockSelection&&(I.preventDefault(),this.selectBlockByIndex(),this.needToSelectAll=!0):this.needToSelectAll=!0}else this.readyToBlockSelection=!0}},{key:"selectAllBlocks",value:function(){this.selection.save(),O.default.get().removeAllRanges(),this.allBlocksSelected=!0,this.Editor.InlineToolbar.close()}},{key:"sanitizerConfig",get:function(){return{p:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},ol:{},ul:{},li:{},br:!0,img:{src:!0,width:!0,height:!0},a:{href:!0},b:{},i:{},u:{}}}},{key:"allBlocksSelected",get:function(){return this.Editor.BlockManager.blocks.every(function(I){return I.selected===!0})},set:function(I){this.Editor.BlockManager.blocks.forEach(function(A){A.selected=I}),this.clearCache()}},{key:"anyBlockSelected",get:function(){var I=this.Editor.BlockManager;return this.anyBlockSelectedCache===null&&(this.anyBlockSelectedCache=I.blocks.some(function(A){return A.selected===!0})),this.anyBlockSelectedCache}},{key:"selectedBlocks",get:function(){return this.Editor.BlockManager.blocks.filter(function(I){return I.selected})}}]),L}(b.default);s.default=y,y.displayName="BlockSelection",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(25),e(7),e(15),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=C(o),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b),v=k(v);var d=function(_){(0,u.default)(x,_);var m,y=(m=x,function(){var S,w=(0,h.default)(m);if(O()){var E=(0,h.default)(this).constructor;S=Reflect.construct(w,arguments,E)}else S=w.apply(this,arguments);return(0,c.default)(this,S)});function x(){return(0,o.default)(this,x),y.apply(this,arguments)}return(0,l.default)(x,[{key:"setToBlock",value:function(S){var w,E=this,L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.positions.DEFAULT,I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,A=this.Editor.BlockManager;switch(L){case this.positions.START:w=S.firstInput;break;case this.positions.END:w=S.lastInput;break;default:w=S.currentInput}if(w){var B=b.default.getDeepestNode(w,L===this.positions.END),T=b.default.getContentLength(B);switch(!0){case L===this.positions.START:I=0;break;case L===this.positions.END:case I>T:I=T}v.delay(function(){E.set(B,I)},20)(),A.setCurrentBlockByChildNode(S.holder),A.currentBlock.currentInput=w}}},{key:"setToInput",value:function(S){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.positions.DEFAULT,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,L=this.Editor.BlockManager.currentBlock,I=b.default.getDeepestNode(S);switch(w){case this.positions.START:this.set(I,0);break;case this.positions.END:this.set(I,b.default.getContentLength(I));break;default:E&&this.set(I,E)}L.currentInput=S}},{key:"set",value:function(S){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=p.default.setCursor(S,w),L=E.top,I=E.bottom,A=window,B=A.innerHeight;L<0&&window.scrollBy(0,L),I>B&&window.scrollBy(0,I-B)}},{key:"setToTheLastBlock",value:function(){var S=this.Editor.BlockManager.lastBlock;if(S)if(S.tool.isDefault&&S.isEmpty)this.setToBlock(S);else{var w=this.Editor.BlockManager.insertAtEnd();this.setToBlock(w)}}},{key:"extractFragmentFromCaretPosition",value:function(){var S=p.default.get();if(S.rangeCount){var w=S.getRangeAt(0),E=this.Editor.BlockManager.currentBlock.currentInput;if(w.deleteContents(),E){if(b.default.isNativeInput(E)){var L=E,I=document.createDocumentFragment(),A=L.value.substring(0,L.selectionStart),B=L.value.substring(L.selectionStart);return I.textContent=B,L.value=A,I}var T=w.cloneRange();return T.selectNodeContents(E),T.setStart(w.endContainer,w.endOffset),T.extractContents()}}}},{key:"navigateNext",value:function(){var S=this.Editor,w=S.BlockManager,E=(S.Tools,w.currentBlock),L=w.nextContentfulBlock,I=E.nextInput,A=this.isAtEnd,B=L;if(!B&&!I){if(E.tool.isDefault||!A)return!1;B=w.insertAtEnd()}return!!A&&(I?this.setToInput(I,this.positions.START):this.setToBlock(B,this.positions.START),!0)}},{key:"navigatePrevious",value:function(){var S=this.Editor.BlockManager,w=S.currentBlock,E=S.previousContentfulBlock;if(!w)return!1;var L=w.previousInput;return!(!E&&!L||!this.isAtStart||(L?this.setToInput(L,this.positions.END):this.setToBlock(E,this.positions.END),0))}},{key:"createShadow",value:function(S){var w=document.createElement("span");w.classList.add(x.CSS.shadowCaret),S.insertAdjacentElement("beforeend",w)}},{key:"restoreCaret",value:function(S){var w=S.querySelector(".".concat(x.CSS.shadowCaret));w&&(new p.default().expandToTag(w),setTimeout(function(){var E=document.createRange();E.selectNode(w),E.extractContents()},50))}},{key:"insertContentAtCaretPosition",value:function(S){var w=document.createDocumentFragment(),E=document.createElement("div"),L=p.default.get(),I=p.default.range;E.innerHTML=S,Array.from(E.childNodes).forEach(function(T){return w.appendChild(T)}),w.childNodes.length===0&&w.appendChild(new Text(""));var A=w.lastChild;I.deleteContents(),I.insertNode(w);var B=document.createRange();B.setStart(A,A.textContent.length),L.removeAllRanges(),L.addRange(B)}},{key:"getHigherLevelSiblings",value:function(S,w){for(var E=S,L=[];E.parentNode&&E.parentNode.contentEditable!=="true";)E=E.parentNode;for(var I=w==="left"?"previousSibling":"nextSibling";E[I];)E=E[I],L.push(E);return L}},{key:"positions",get:function(){return{START:"start",END:"end",DEFAULT:"default"}}},{key:"isAtStart",get:function(){var S=p.default.get(),w=b.default.getDeepestNode(this.Editor.BlockManager.currentBlock.currentInput),E=S.focusNode;if(b.default.isNativeInput(w))return w.selectionEnd===0;if(!S.anchorNode)return!1;var L=E.textContent.search(/\S/);L===-1&&(L=0);var I=S.focusOffset;return E.nodeType!==Node.TEXT_NODE&&E.childNodes.length&&(E.childNodes[I]?(E=E.childNodes[I],I=0):I=(E=E.childNodes[I-1]).textContent.length),!(!b.default.isLineBreakTag(w)&&!b.default.isEmpty(w)||!this.getHigherLevelSiblings(E,"left").every(function(A){var B=b.default.isLineBreakTag(A),T=A.children.length===1&&b.default.isLineBreakTag(A.children[0]),M=B||T;return b.default.isEmpty(A)&&!M})||I!==L)||w===null||E===w&&I<=L}},{key:"isAtEnd",get:function(){var S=p.default.get(),w=S.focusNode,E=b.default.getDeepestNode(this.Editor.BlockManager.currentBlock.currentInput,!0);if(b.default.isNativeInput(E))return E.selectionEnd===E.value.length;if(!S.focusNode)return!1;var L=S.focusOffset;if(w.nodeType!==Node.TEXT_NODE&&w.childNodes.length&&(w.childNodes[L-1]?L=(w=w.childNodes[L-1]).textContent.length:(w=w.childNodes[0],L=0)),b.default.isLineBreakTag(E)||b.default.isEmpty(E)){var I=this.getHigherLevelSiblings(w,"right");if(I.every(function(B,T){return T===I.length-1&&b.default.isLineBreakTag(B)||b.default.isEmpty(B)&&!b.default.isLineBreakTag(B)})&&L===w.textContent.length)return!0}var A=E.textContent.replace(/\s+$/,"");return w===E&&L>=A.length}}],[{key:"CSS",get:function(){return{shadowCaret:"cdx-shadow-caret"}}}]),x}(g.default);s.default=d,d.displayName="Caret",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(25),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k){"use strict";var C=e(9),O=e(1);function d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=O(o),l=O(l),u=O(u),c=O(c),h=O(h),p=O(p),g=O(g),b=O(b),v=O(v),k=C(k);var _=function(m){(0,h.default)(w,m);var y,x,S=(y=w,function(){var E,L=(0,g.default)(y);if(d()){var I=(0,g.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,p.default)(this,E)});function w(){var E;return(0,u.default)(this,w),(E=S.apply(this,arguments)).onMouseUp=function(){E.listeners.off(document,"mouseover",E.onMouseOver),E.listeners.off(document,"mouseup",E.onMouseUp)},E.onMouseOver=function(L){var I=E.Editor,A=I.BlockManager,B=I.BlockSelection,T=A.getBlockByChildNode(L.relatedTarget)||E.lastSelectedBlock,M=A.getBlockByChildNode(L.target);if(T&&M&&M!==T){if(T===E.firstSelectedBlock)return v.default.get().removeAllRanges(),T.selected=!0,M.selected=!0,void B.clearCache();if(M===E.firstSelectedBlock)return T.selected=!1,M.selected=!1,void B.clearCache();E.Editor.InlineToolbar.close(),E.toggleBlocksSelectedState(T,M),E.lastSelectedBlock=M}},E}return(0,c.default)(w,[{key:"prepare",value:(x=(0,l.default)(o.default.mark(function E(){var L=this;return o.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:this.listeners.on(document,"mousedown",function(A){L.enableCrossBlockSelection(A)});case 1:case"end":return I.stop()}},E,this)})),function(){return x.apply(this,arguments)})},{key:"watchSelection",value:function(E){if(E.button===k.mouseButtons.LEFT){var L=this.Editor.BlockManager;this.firstSelectedBlock=L.getBlock(E.target),this.lastSelectedBlock=this.firstSelectedBlock,this.listeners.on(document,"mouseover",this.onMouseOver),this.listeners.on(document,"mouseup",this.onMouseUp)}}},{key:"toggleBlockSelectedState",value:function(){var E=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],L=this.Editor,I=L.BlockManager,A=L.BlockSelection;this.lastSelectedBlock||(this.lastSelectedBlock=this.firstSelectedBlock=I.currentBlock),this.firstSelectedBlock===this.lastSelectedBlock&&(this.firstSelectedBlock.selected=!0,A.clearCache(),v.default.get().removeAllRanges());var B=I.blocks.indexOf(this.lastSelectedBlock)+(E?1:-1),T=I.blocks[B];T&&(this.lastSelectedBlock.selected!==T.selected?(T.selected=!0,A.clearCache()):(this.lastSelectedBlock.selected=!1,A.clearCache()),this.lastSelectedBlock=T,this.Editor.InlineToolbar.close(),T.holder.scrollIntoView({block:"nearest"}))}},{key:"clear",value:function(E){var L=this.Editor,I=L.BlockManager,A=L.BlockSelection,B=L.Caret,T=I.blocks.indexOf(this.firstSelectedBlock),M=I.blocks.indexOf(this.lastSelectedBlock);if(A.anyBlockSelected&&T>-1&&M>-1)if(E&&E instanceof KeyboardEvent)switch(E.keyCode){case k.keyCodes.DOWN:case k.keyCodes.RIGHT:B.setToBlock(I.blocks[Math.max(T,M)],B.positions.END);break;case k.keyCodes.UP:case k.keyCodes.LEFT:B.setToBlock(I.blocks[Math.min(T,M)],B.positions.START);break;default:B.setToBlock(I.blocks[Math.max(T,M)],B.positions.END)}else B.setToBlock(I.blocks[Math.max(T,M)],B.positions.END);this.firstSelectedBlock=this.lastSelectedBlock=null}},{key:"enableCrossBlockSelection",value:function(E){var L=this.Editor.UI;v.default.isCollapsed||this.Editor.BlockSelection.clearSelection(E),L.nodes.redactor.contains(E.target)?this.watchSelection(E):this.Editor.BlockSelection.clearSelection(E)}},{key:"toggleBlocksSelectedState",value:function(E,L){for(var I=this.Editor,A=I.BlockManager,B=I.BlockSelection,T=A.blocks.indexOf(E),M=A.blocks.indexOf(L),j=E.selected!==L.selected,J=Math.min(T,M);J<=Math.max(T,M);J++){var U=A.blocks[J];U!==this.firstSelectedBlock&&U!==(j?E:L)&&(A.blocks[J].selected=!A.blocks[J].selected,B.clearCache())}}},{key:"isCrossBlockSelectionStarted",get:function(){return!!this.firstSelectedBlock&&!!this.lastSelectedBlock}}]),w}(b.default);s.default=_,_.displayName="CrossBlockSelection",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(25),e(7)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(1);function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=k(o),l=k(l),u=k(u),c=k(c),h=k(h),p=k(p),g=k(g),b=k(b);var O=function(d){(0,h.default)(x,d);var _,m,y=(_=x,function(){var S,w=(0,g.default)(_);if(C()){var E=(0,g.default)(this).constructor;S=Reflect.construct(w,arguments,E)}else S=w.apply(this,arguments);return(0,p.default)(this,S)});function x(){var S;return(0,u.default)(this,x),(S=y.apply(this,arguments)).isStartedAtEditor=!1,S}return(0,c.default)(x,[{key:"toggleReadOnly",value:function(S){S?this.disableModuleBindings():this.enableModuleBindings()}},{key:"enableModuleBindings",value:function(){var S=this,w=this.Editor.UI;this.readOnlyMutableListeners.on(w.nodes.holder,"drop",function(){var E=(0,l.default)(o.default.mark(function L(I){return o.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,S.processDrop(I);case 2:case"end":return A.stop()}},L)}));return function(L){return E.apply(this,arguments)}}(),!0),this.readOnlyMutableListeners.on(w.nodes.holder,"dragstart",function(){S.processDragStart()}),this.readOnlyMutableListeners.on(w.nodes.holder,"dragover",function(E){S.processDragOver(E)},!0)}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"processDrop",value:(m=(0,l.default)(o.default.mark(function S(w){var E,L,I,A,B,T;return o.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return E=this.Editor,L=E.BlockManager,I=E.Caret,A=E.Paste,w.preventDefault(),L.blocks.forEach(function(j){j.dropTarget=!1}),b.default.isAtEditor&&!b.default.isCollapsed&&this.isStartedAtEditor&&document.execCommand("delete"),this.isStartedAtEditor=!1,(B=L.setCurrentBlockByChildNode(w.target))?this.Editor.Caret.setToBlock(B,I.positions.END):(T=L.setCurrentBlockByChildNode(L.lastBlock.holder),this.Editor.Caret.setToBlock(T,I.positions.END)),M.next=9,A.processDataTransfer(w.dataTransfer,!0);case 9:case"end":return M.stop()}},S,this)})),function(S){return m.apply(this,arguments)})},{key:"processDragStart",value:function(){b.default.isAtEditor&&!b.default.isCollapsed&&(this.isStartedAtEditor=!0),this.Editor.InlineToolbar.close()}},{key:"processDragOver",value:function(S){S.preventDefault()}}]),x}((v=k(v)).default);s.default=O,O.displayName="DragNDrop",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(61)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b){"use strict";var v=e(9),k=e(1);function C(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(d){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=k(o),l=k(l),u=k(u),c=k(c),h=k(h),p=k(p),g=v(g),b=k(b);var O=function(d){(0,u.default)(y,d);var _,m=(_=y,function(){var x,S=(0,h.default)(_);if(C()){var w=(0,h.default)(this).constructor;x=Reflect.construct(S,arguments,w)}else x=S.apply(this,arguments);return(0,c.default)(this,x)});function y(){var x;return(0,o.default)(this,y),(x=m.apply(this,arguments)).disabled=!1,x.mutationDebouncer=g.debounce(function(){x.updateNativeInputs(),g.isFunction(x.config.onChange)&&x.config.onChange(x.Editor.API.methods)},y.DebounceTimer),x.nativeInputs=[],x}return(0,l.default)(y,[{key:"destroy",value:function(){var x=this;this.mutationDebouncer=null,this.observer&&this.observer.disconnect(),this.observer=null,this.nativeInputs.forEach(function(S){return x.listeners.off(S,"input",x.mutationDebouncer)}),this.mutationDebouncer=null}},{key:"toggleReadOnly",value:function(x){x?this.disableModule():this.enableModule()}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"setObserver",value:function(){var x=this,S=this.Editor.UI;this.observer=new MutationObserver(function(w,E){x.mutationHandler(w,E)}),this.observer.observe(S.nodes.redactor,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(x,S){if(!this.disabled){var w=!1;x.forEach(function(E){switch(E.type){case"childList":case"characterData":w=!0;break;case"attributes":E.target.classList.contains(b.default.CSS.wrapper)||(w=!0)}}),w&&this.mutationDebouncer()}}},{key:"updateNativeInputs",value:function(){var x=this;this.nativeInputs&&this.nativeInputs.forEach(function(S){x.listeners.off(S,"input")}),this.nativeInputs=Array.from(this.Editor.UI.nodes.redactor.querySelectorAll("textarea, input, select")),this.nativeInputs.forEach(function(S){return x.listeners.on(S,"input",x.mutationDebouncer)})}},{key:"enableModule",value:function(){var x=this;window.setTimeout(function(){x.setObserver(),x.updateNativeInputs(),x.enable()},1e3)}},{key:"disableModule",value:function(){this.disable()}}]),y}(p.default);s.default=O,O.displayName="ModificationsObserver",O.DebounceTimer=450,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(378)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=b(o),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p),g=b(g);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){return(0,o.default)(this,_),d.apply(this,arguments)}return(0,l.default)(_,[{key:"show",value:function(m){g.default.show(m)}}]),_}(p.default);s.default=k,k.displayName="Notifier",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(42),e(29),e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O){"use strict";var d=e(9),_=e(1);function m(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(x){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=_(o),l=_(l),u=_(u),c=_(c),h=_(h),p=_(p),g=_(g),b=_(b),v=_(v),k=_(k),C=_(C),O=d(O);var y=function(x){(0,g.default)(J,x);var S,w,E,L,I,A,B,T,M,j=(S=J,function(){var U,H=(0,v.default)(S);if(m()){var te=(0,v.default)(this).constructor;U=Reflect.construct(H,arguments,te)}else U=H.apply(this,arguments);return(0,b.default)(this,U)});function J(){var U;return(0,h.default)(this,J),(U=j.apply(this,arguments)).MIME_TYPE="application/x-editor-js",U.toolsTags={},U.tagsByTool={},U.toolsPatterns=[],U.toolsFiles={},U.exceptionList=[],U.processTool=function(H){try{var te=H.create({},{},!1);if(H.pasteConfig===!1)return void U.exceptionList.push(H.name);if(!O.isFunction(te.onPaste))return;U.getTagsConfig(H),U.getFilesConfig(H),U.getPatternsConfig(H)}catch(se){O.log("Paste handling for \xAB".concat(H.name,"\xBB Tool hasn't been set up because of the error"),"warn",se)}},U.handlePasteEvent=function(){var H=(0,c.default)(u.default.mark(function te(se){var W,Y,ie;return u.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(W=U.Editor,Y=W.BlockManager,ie=W.Toolbar,Y.currentBlock&&(!U.isNativeBehaviour(se.target)||se.clipboardData.types.includes("Files"))){re.next=3;break}return re.abrupt("return");case 3:if(!Y.currentBlock||!U.exceptionList.includes(Y.currentBlock.name)){re.next=5;break}return re.abrupt("return");case 5:se.preventDefault(),U.processDataTransfer(se.clipboardData),Y.clearFocused(),ie.close();case 9:case"end":return re.stop()}},te)}));return function(te){return H.apply(this,arguments)}}(),U}return(0,p.default)(J,[{key:"prepare",value:(M=(0,c.default)(u.default.mark(function U(){return u.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:this.processTools();case 1:case"end":return H.stop()}},U,this)})),function(){return M.apply(this,arguments)})},{key:"toggleReadOnly",value:function(U){U?this.unsetCallback():this.setCallback()}},{key:"processDataTransfer",value:(T=(0,c.default)(u.default.mark(function U(H){var te,se,W,Y,ie,re,Q,ee,pe,be=arguments;return u.default.wrap(function(we){for(;;)switch(we.prev=we.next){case 0:if(te=be.length>1&&be[1]!==void 0&&be[1],se=this.Editor.Sanitizer,!((W=H.types).includes?W.includes("Files"):W.contains("Files"))){we.next=8;break}return we.next=7,this.processFiles(H.files);case 7:return we.abrupt("return");case 8:if(Y=H.getData(this.MIME_TYPE),ie=H.getData("text/plain"),re=H.getData("text/html"),!Y){we.next=19;break}return we.prev=12,this.insertEditorJSData(JSON.parse(Y)),we.abrupt("return");case 17:we.prev=17,we.t0=we.catch(12);case 19:if(te&&ie.trim()&&re.trim()&&(re="<p>"+(re.trim()?re:ie)+"</p>"),Q=Object.keys(this.toolsTags).reduce(function(Le,fe){return Le[fe.toLowerCase()]=!0,Le},{}),ee=Object.assign({},Q,se.getAllInlineToolsConfig(),{br:{}}),(pe=se.clean(re,ee)).trim()&&pe.trim()!==ie&&C.default.isHTMLString(pe)){we.next=28;break}return we.next=26,this.processText(ie);case 26:we.next=30;break;case 28:return we.next=30,this.processText(pe,!0);case 30:case"end":return we.stop()}},U,this,[[12,17]])})),function(U){return T.apply(this,arguments)})},{key:"processText",value:(B=(0,c.default)(u.default.mark(function U(H){var te,se,W,Y,ie,re,Q,ee=this,pe=arguments;return u.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(te=pe.length>1&&pe[1]!==void 0&&pe[1],se=this.Editor,W=se.Caret,Y=se.BlockManager,(ie=te?this.processHTML(H):this.processPlain(H)).length){be.next=5;break}return be.abrupt("return");case 5:if(ie.length!==1){be.next=8;break}return ie[0].isBlock?this.processSingleBlock(ie.pop()):this.processInlinePaste(ie.pop()),be.abrupt("return");case 8:re=Y.currentBlock&&Y.currentBlock.tool.isDefault,Q=re&&Y.currentBlock.isEmpty,ie.map(function(){var we=(0,c.default)(u.default.mark(function Le(fe,xe){return u.default.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return Ne.abrupt("return",ee.insertBlock(fe,xe===0&&Q));case 1:case"end":return Ne.stop()}},Le)}));return function(Le,fe){return we.apply(this,arguments)}}()),Y.currentBlock&&W.setToBlock(Y.currentBlock,W.positions.END);case 12:case"end":return be.stop()}},U,this)})),function(U){return B.apply(this,arguments)})},{key:"setCallback",value:function(){this.listeners.on(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}},{key:"unsetCallback",value:function(){this.listeners.off(this.Editor.UI.nodes.holder,"paste",this.handlePasteEvent)}},{key:"processTools",value:function(){var U=this.Editor.Tools.blockTools;Array.from(U.values()).forEach(this.processTool)}},{key:"getTagsConfig",value:function(U){var H=this,te=U.pasteConfig.tags||[];te.forEach(function(se){Object.prototype.hasOwnProperty.call(H.toolsTags,se)?O.log("Paste handler for \xAB".concat(U.name,"\xBB Tool on \xAB").concat(se,"\xBB tag is skipped ")+"because it is already used by \xAB".concat(H.toolsTags[se].tool.name,"\xBB Tool."),"warn"):H.toolsTags[se.toUpperCase()]={tool:U}}),this.tagsByTool[U.name]=te.map(function(se){return se.toUpperCase()})}},{key:"getFilesConfig",value:function(U){var H=U.pasteConfig.files,te=H===void 0?{}:H,se=te.extensions,W=te.mimeTypes;(se||W)&&(se&&!Array.isArray(se)&&(O.log("\xABextensions\xBB property of the onDrop config for \xAB".concat(U.name,"\xBB Tool should be an array")),se=[]),W&&!Array.isArray(W)&&(O.log("\xABmimeTypes\xBB property of the onDrop config for \xAB".concat(U.name,"\xBB Tool should be an array")),W=[]),W&&(W=W.filter(function(Y){return!!O.isValidMimeType(Y)||(O.log("MIME type value \xAB".concat(Y,"\xBB for the \xAB").concat(U.name,"\xBB Tool is not a valid MIME type"),"warn"),!1)})),this.toolsFiles[U.name]={extensions:se||[],mimeTypes:W||[]})}},{key:"getPatternsConfig",value:function(U){var H=this;U.pasteConfig.patterns&&!O.isEmpty(U.pasteConfig.patterns)&&Object.entries(U.pasteConfig.patterns).forEach(function(te){var se=(0,l.default)(te,2),W=se[0],Y=se[1];Y instanceof RegExp||O.log("Pattern ".concat(Y," for \xAB").concat(U.name,"\xBB Tool is skipped because it should be a Regexp instance."),"warn"),H.toolsPatterns.push({key:W,pattern:Y,tool:U})})}},{key:"isNativeBehaviour",value:function(U){return C.default.isNativeInput(U)}},{key:"processFiles",value:(A=(0,c.default)(u.default.mark(function U(H){var te,se,W,Y,ie=this;return u.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return te=this.Editor.BlockManager,re.next=3,Promise.all(Array.from(H).map(function(Q){return ie.processFile(Q)}));case 3:se=(se=re.sent).filter(function(Q){return!!Q}),W=te.currentBlock.tool.isDefault,Y=W&&te.currentBlock.isEmpty,se.forEach(function(Q,ee){te.paste(Q.type,Q.event,ee===0&&Y)});case 8:case"end":return re.stop()}},U,this)})),function(U){return A.apply(this,arguments)})},{key:"processFile",value:(I=(0,c.default)(u.default.mark(function U(H){var te,se,W,Y,ie;return u.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(te=O.getFileExtension(H),se=Object.entries(this.toolsFiles).find(function(Q){var ee=(0,l.default)(Q,2),pe=(ee[0],ee[1]),be=pe.mimeTypes,we=pe.extensions,Le=H.type.split("/"),fe=(0,l.default)(Le,2),xe=fe[0],Ne=fe[1],Be=we.find(function(Ze){return Ze.toLowerCase()===te.toLowerCase()}),Pe=be.find(function(Ze){var tt=Ze.split("/"),Xe=(0,l.default)(tt,2),Ke=Xe[0],nt=Xe[1];return Ke===xe&&(nt===Ne||nt==="*")});return!!Be||!!Pe})){re.next=4;break}return re.abrupt("return");case 4:return W=(0,l.default)(se,1),Y=W[0],ie=this.composePasteEvent("file",{file:H}),re.abrupt("return",{event:ie,type:Y});case 7:case"end":return re.stop()}},U,this)})),function(U){return I.apply(this,arguments)})},{key:"processHTML",value:function(U){var H=this,te=this.Editor,se=te.Tools,W=te.Sanitizer,Y=C.default.make("DIV");return Y.innerHTML=U,this.getNodes(Y).map(function(ie){var re,Q=se.defaultTool,ee=!1;switch(ie.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:(re=C.default.make("div")).appendChild(ie);break;case Node.ELEMENT_NODE:re=ie,ee=!0,H.toolsTags[re.tagName]&&(Q=H.toolsTags[re.tagName].tool)}var pe=Q.pasteConfig.tags.reduce(function(Le,fe){return Le[fe.toLowerCase()]={},Le},{}),be=Object.assign({},pe,W.getInlineToolsConfig(Q));re.innerHTML=W.clean(re.innerHTML,be);var we=H.composePasteEvent("tag",{data:re});return{content:re,isBlock:ee,tool:Q.name,event:we}}).filter(function(ie){return!C.default.isNodeEmpty(ie.content)||C.default.isSingleTag(ie.content)})}},{key:"processPlain",value:function(U){var H=this,te=this.config.defaultBlock;if(!U)return[];var se=te;return U.split(/\r?\n/).filter(function(W){return W.trim()}).map(function(W){var Y=C.default.make("div");Y.textContent=W;var ie=H.composePasteEvent("tag",{data:Y});return{content:Y,tool:se,isBlock:!1,event:ie}})}},{key:"processSingleBlock",value:(L=(0,c.default)(u.default.mark(function U(H){var te,se,W,Y;return u.default.wrap(function(ie){for(;;)switch(ie.prev=ie.next){case 0:if(te=this.Editor,se=te.Caret,W=te.BlockManager,(Y=W.currentBlock)&&H.tool===Y.name&&C.default.containsOnlyInlineElements(H.content.innerHTML)){ie.next=5;break}return this.insertBlock(H,(Y==null?void 0:Y.tool.isDefault)&&Y.isEmpty),ie.abrupt("return");case 5:se.insertContentAtCaretPosition(H.content.innerHTML);case 6:case"end":return ie.stop()}},U,this)})),function(U){return L.apply(this,arguments)})},{key:"processInlinePaste",value:(E=(0,c.default)(u.default.mark(function U(H){var te,se,W,Y,ie,re,Q,ee,pe;return u.default.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:if(te=this.Editor,se=te.BlockManager,W=te.Caret,Y=te.Sanitizer,ie=H.content,!(se.currentBlock&&se.currentBlock.tool.isDefault&&ie.textContent.length<J.PATTERN_PROCESSING_MAX_LENGTH)){be.next=12;break}return be.next=6,this.processPattern(ie.textContent);case 6:if(!(re=be.sent)){be.next=12;break}return Q=se.currentBlock&&se.currentBlock.tool.isDefault&&se.currentBlock.isEmpty,ee=se.paste(re.tool,re.event,Q),W.setToBlock(ee,W.positions.END),be.abrupt("return");case 12:se.currentBlock&&se.currentBlock.currentInput?(pe=Y.getInlineToolsConfig(se.currentBlock.tool),document.execCommand("insertHTML",!1,Y.clean(ie.innerHTML,pe))):this.insertBlock(H);case 13:case"end":return be.stop()}},U,this)})),function(U){return E.apply(this,arguments)})},{key:"processPattern",value:(w=(0,c.default)(u.default.mark(function U(H){var te,se;return u.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(te=this.toolsPatterns.find(function(Y){var ie=Y.pattern.exec(H);return!!ie&&H===ie.shift()})){W.next=3;break}return W.abrupt("return");case 3:return se=this.composePasteEvent("pattern",{key:te.key,data:H}),W.abrupt("return",{event:se,tool:te.tool.name});case 5:case"end":return W.stop()}},U,this)})),function(U){return w.apply(this,arguments)})},{key:"insertBlock",value:function(U){var H,te=arguments.length>1&&arguments[1]!==void 0&&arguments[1],se=this.Editor,W=se.BlockManager,Y=se.Caret,ie=W.currentBlock;if(te&&ie&&ie.isEmpty)return H=W.paste(U.tool,U.event,!0),void Y.setToBlock(H,Y.positions.END);H=W.paste(U.tool,U.event),Y.setToBlock(H,Y.positions.END)}},{key:"insertEditorJSData",value:function(U){var H=this.Editor,te=H.BlockManager,se=H.Caret;H.Sanitizer.sanitizeBlocks(U).forEach(function(W,Y){var ie=W.tool,re=W.data,Q=!1;Y===0&&(Q=te.currentBlock&&te.currentBlock.tool.isDefault&&te.currentBlock.isEmpty);var ee=te.insert({tool:ie,data:re,replace:Q});se.setToBlock(ee,se.positions.END)})}},{key:"processElementNode",value:function(U,H,te){var se=Object.keys(this.toolsTags),W=U,Y=(this.toolsTags[W.tagName]||{}).tool,ie=this.tagsByTool[Y==null?void 0:Y.name]||[],re=se.includes(W.tagName),Q=C.default.blockElements.includes(W.tagName.toLowerCase()),ee=Array.from(W.children).some(function(be){var we=be.tagName;return se.includes(we)&&!ie.includes(we)}),pe=Array.from(W.children).some(function(be){var we=be.tagName;return C.default.blockElements.includes(we.toLowerCase())});return Q||re||ee?re&&!ee||Q&&!pe&&!ee?[].concat((0,o.default)(H),[te,W]):void 0:(te.appendChild(W),[].concat((0,o.default)(H),[te]))}},{key:"getNodes",value:function(U){var H,te=this;return Array.from(U.childNodes).reduce(function se(W,Y){if(C.default.isEmpty(Y)&&!C.default.isSingleTag(Y))return W;var ie=W[W.length-1],re=new DocumentFragment;switch(ie&&C.default.isFragment(ie)&&(re=W.pop()),Y.nodeType){case Node.ELEMENT_NODE:if(H=te.processElementNode(Y,W,re))return H;break;case Node.TEXT_NODE:return re.appendChild(Y),[].concat((0,o.default)(W),[re]);default:return[].concat((0,o.default)(W),[re])}return[].concat((0,o.default)(W),(0,o.default)(Array.from(Y.childNodes).reduce(se,[])))},[])}},{key:"composePasteEvent",value:function(U,H){return new CustomEvent(U,{detail:H})}}]),J}(k.default);s.default=y,y.displayName="Paste",y.PATTERN_PROCESSING_MAX_LENGTH=450,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(29),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(145)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k){"use strict";var C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=C(o),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b);var d=function(_){(0,p.default)(w,_);var m,y,x,S=(m=w,function(){var E,L=(0,b.default)(m);if(O()){var I=(0,b.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,g.default)(this,E)});function w(){var E;return(0,c.default)(this,w),(E=S.apply(this,arguments)).toolsDontSupportReadOnly=[],E.readOnlyEnabled=!1,E}return(0,h.default)(w,[{key:"prepare",value:(x=(0,u.default)(o.default.mark(function E(){var L,I,A;return o.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:L=this.Editor.Tools,I=L.blockTools,A=[],Array.from(I.entries()).forEach(function(T){var M=(0,l.default)(T,2),j=M[0];M[1].isReadOnlySupported||A.push(j)}),this.toolsDontSupportReadOnly=A,this.config.readOnly&&A.length>0&&this.throwCriticalError(),this.toggle(this.config.readOnly);case 7:case"end":return B.stop()}},E,this)})),function(){return x.apply(this,arguments)})},{key:"toggle",value:(y=(0,u.default)(o.default.mark(function E(){var L,I,A,B,T=arguments;return o.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:(L=T.length>0&&T[0]!==void 0?T[0]:!this.readOnlyEnabled)&&this.toolsDontSupportReadOnly.length>0&&this.throwCriticalError(),I=this.readOnlyEnabled,this.readOnlyEnabled=L,M.t0=o.default.keys(this.Editor);case 5:if((M.t1=M.t0()).done){M.next=12;break}if(A=M.t1.value,this.Editor[A].toggleReadOnly){M.next=9;break}return M.abrupt("continue",5);case 9:this.Editor[A].toggleReadOnly(L),M.next=5;break;case 12:if(I!==L){M.next=14;break}return M.abrupt("return",this.readOnlyEnabled);case 14:return M.next=16,this.Editor.Saver.save();case 16:return B=M.sent,M.next=19,this.Editor.BlockManager.clear();case 19:return M.next=21,this.Editor.Renderer.render(B.blocks);case 21:return M.abrupt("return",this.readOnlyEnabled);case 22:case"end":return M.stop()}},E,this)})),function(){return y.apply(this,arguments)})},{key:"throwCriticalError",value:function(){throw new k.CriticalError("To enable read-only mode all connected tools should support it. Tools ".concat(this.toolsDontSupportReadOnly.join(", ")," don't support read-only mode."))}},{key:"isEnabled",get:function(){return this.readOnlyEnabled}}]),w}((v=C(v)).default);s.default=d,d.displayName="ReadOnly",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(25),e(61)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(1);function C(m){if(typeof Symbol=="undefined"||m[Symbol.iterator]==null){if(Array.isArray(m)||(m=function(I,A){if(I){if(typeof I=="string")return O(I,A);var B=Object.prototype.toString.call(I).slice(8,-1);return B==="Object"&&I.constructor&&(B=I.constructor.name),B==="Map"||B==="Set"?Array.from(B):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?O(I,A):void 0}}(m))){var y=0,x=function(){};return{s:x,n:function(){return y>=m.length?{done:!0}:{done:!1,value:m[y++]}},e:function(I){throw I},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S,w,E=!0,L=!1;return{s:function(){S=m[Symbol.iterator]()},n:function(){var I=S.next();return E=I.done,I},e:function(I){L=!0,w=I},f:function(){try{E||S.return==null||S.return()}finally{if(L)throw w}}}}function O(m,y){(y==null||y>m.length)&&(y=m.length);for(var x=0,S=new Array(y);x<y;x++)S[x]=m[x];return S}function d(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=k(o),l=k(l),u=k(u),c=k(c),h=k(h),p=k(p),g=k(g),b=k(b),v=k(v);var _=function(m){(0,u.default)(S,m);var y,x=(y=S,function(){var w,E=(0,h.default)(y);if(d()){var L=(0,h.default)(this).constructor;w=Reflect.construct(E,arguments,L)}else w=E.apply(this,arguments);return(0,c.default)(this,w)});function S(){var w;return(0,o.default)(this,S),(w=x.apply(this,arguments)).isRectSelectionActivated=!1,w.SCROLL_SPEED=3,w.HEIGHT_OF_SCROLL_ZONE=40,w.BOTTOM_SCROLL_ZONE=1,w.TOP_SCROLL_ZONE=2,w.MAIN_MOUSE_BUTTON=0,w.mousedown=!1,w.isScrolling=!1,w.inScrollZone=null,w.startX=0,w.startY=0,w.mouseX=0,w.mouseY=0,w.stackOfSelected=[],w.listenerIds=[],w}return(0,l.default)(S,[{key:"prepare",value:function(){this.enableModuleBindings()}},{key:"startSelection",value:function(w,E){var L=document.elementFromPoint(w-window.pageXOffset,E-window.pageYOffset);L.closest(".".concat(this.Editor.Toolbar.CSS.toolbar))||(this.Editor.BlockSelection.allBlocksSelected=!1,this.clearSelection(),this.stackOfSelected=[]);var I=[".".concat(v.default.CSS.content),".".concat(this.Editor.Toolbar.CSS.toolbar),".".concat(this.Editor.InlineToolbar.CSS.inlineToolbar)],A=L.closest("."+this.Editor.UI.CSS.editorWrapper),B=I.some(function(T){return!!L.closest(T)});A&&!B&&(this.mousedown=!0,this.startX=w,this.startY=E)}},{key:"endSelection",value:function(){this.mousedown=!1,this.startX=0,this.startY=0,this.overlayRectangle.style.display="none"}},{key:"isRectActivated",value:function(){return this.isRectSelectionActivated}},{key:"clearSelection",value:function(){this.isRectSelectionActivated=!1}},{key:"enableModuleBindings",value:function(){var w=this,E=this.genHTML().container;this.listeners.on(E,"mousedown",function(L){w.processMouseDown(L)},!1),this.listeners.on(document.body,"mousemove",function(L){w.processMouseMove(L)},!1),this.listeners.on(document.body,"mouseleave",function(){w.processMouseLeave()}),this.listeners.on(window,"scroll",function(L){w.processScroll(L)},!1),this.listeners.on(document.body,"mouseup",function(){w.processMouseUp()},!1)}},{key:"processMouseDown",value:function(w){w.button===this.MAIN_MOUSE_BUTTON&&this.startSelection(w.pageX,w.pageY)}},{key:"processMouseMove",value:function(w){this.changingRectangle(w),this.scrollByZones(w.clientY)}},{key:"processMouseLeave",value:function(){this.clearSelection(),this.endSelection()}},{key:"processScroll",value:function(w){this.changingRectangle(w)}},{key:"processMouseUp",value:function(){this.endSelection()}},{key:"scrollByZones",value:function(w){this.inScrollZone=null,w<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.TOP_SCROLL_ZONE),document.documentElement.clientHeight-w<=this.HEIGHT_OF_SCROLL_ZONE&&(this.inScrollZone=this.BOTTOM_SCROLL_ZONE),this.inScrollZone?this.isScrolling||(this.scrollVertical(this.inScrollZone===this.TOP_SCROLL_ZONE?-this.SCROLL_SPEED:this.SCROLL_SPEED),this.isScrolling=!0):this.isScrolling=!1}},{key:"genHTML",value:function(){var w=this.Editor.UI,E=w.nodes.holder.querySelector("."+w.CSS.editorWrapper),L=g.default.make("div",S.CSS.overlay,{}),I=g.default.make("div",S.CSS.overlayContainer,{}),A=g.default.make("div",S.CSS.rect,{});return I.appendChild(A),L.appendChild(I),E.appendChild(L),this.overlayRectangle=A,{container:E,overlay:L}}},{key:"scrollVertical",value:function(w){var E=this;if(this.inScrollZone&&this.mousedown){var L=window.pageYOffset;window.scrollBy(0,w),this.mouseY+=window.pageYOffset-L,setTimeout(function(){E.scrollVertical(w)},0)}}},{key:"changingRectangle",value:function(w){if(this.mousedown){w.pageY!==void 0&&(this.mouseX=w.pageX,this.mouseY=w.pageY);var E=this.genInfoForMouseSelection(),L=E.rightPos,I=E.leftPos,A=E.index,B=this.startX>L&&this.mouseX>L,T=this.startX<I&&this.mouseX<I;this.rectCrossesBlocks=!(B||T),this.isRectSelectionActivated||(this.rectCrossesBlocks=!1,this.isRectSelectionActivated=!0,this.shrinkRectangleToPoint(),this.overlayRectangle.style.display="block"),this.updateRectangleSize(),A!==void 0&&(this.trySelectNextBlock(A),this.inverseSelection(),b.default.get().removeAllRanges(),w.preventDefault())}}},{key:"shrinkRectangleToPoint",value:function(){this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px")}},{key:"inverseSelection",value:function(){var w=this.Editor.BlockManager.getBlockByIndex(this.stackOfSelected[0]).selected;if(this.rectCrossesBlocks&&!w){var E,L=C(this.stackOfSelected);try{for(L.s();!(E=L.n()).done;){var I=E.value;this.Editor.BlockSelection.selectBlockByIndex(I)}}catch(M){L.e(M)}finally{L.f()}}if(!this.rectCrossesBlocks&&w){var A,B=C(this.stackOfSelected);try{for(B.s();!(A=B.n()).done;){var T=A.value;this.Editor.BlockSelection.unSelectBlockByIndex(T)}}catch(M){B.e(M)}finally{B.f()}}}},{key:"updateRectangleSize",value:function(){this.mouseY>=this.startY?(this.overlayRectangle.style.top="".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.bottom="calc(100% - ".concat(this.mouseY-window.pageYOffset,"px")):(this.overlayRectangle.style.bottom="calc(100% - ".concat(this.startY-window.pageYOffset,"px"),this.overlayRectangle.style.top="".concat(this.mouseY-window.pageYOffset,"px")),this.mouseX>=this.startX?(this.overlayRectangle.style.left="".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.right="calc(100% - ".concat(this.mouseX-window.pageXOffset,"px")):(this.overlayRectangle.style.right="calc(100% - ".concat(this.startX-window.pageXOffset,"px"),this.overlayRectangle.style.left="".concat(this.mouseX-window.pageXOffset,"px"))}},{key:"genInfoForMouseSelection",value:function(){var w,E=document.body.offsetWidth/2,L=this.mouseY-window.pageYOffset,I=document.elementFromPoint(E,L),A=this.Editor.BlockManager.getBlockByChildNode(I);A!==void 0&&(w=this.Editor.BlockManager.blocks.findIndex(function(M){return M.holder===A.holder}));var B=this.Editor.BlockManager.lastBlock.holder.querySelector("."+v.default.CSS.content),T=Number.parseInt(window.getComputedStyle(B).width,10)/2;return{index:w,leftPos:E-T,rightPos:E+T}}},{key:"addBlockInSelection",value:function(w){this.rectCrossesBlocks&&this.Editor.BlockSelection.selectBlockByIndex(w),this.stackOfSelected.push(w)}},{key:"trySelectNextBlock",value:function(w){var E=this,L=this.stackOfSelected[this.stackOfSelected.length-1]===w,I=this.stackOfSelected.length;if(!L){var A=this.stackOfSelected[I-1]-this.stackOfSelected[I-2]>0,B=0;I>1&&(B=A?1:-1);var T=w>this.stackOfSelected[I-1]&&B===1,M=w<this.stackOfSelected[I-1]&&B===-1,j=!(T||M||B===0);if(j||!(w>this.stackOfSelected[I-1]||this.stackOfSelected[I-1]===void 0)){if(!j&&w<this.stackOfSelected[I-1])for(var J=this.stackOfSelected[I-1]-1;J>=w;J--)this.addBlockInSelection(J);else if(j){var U,H=I-1;for(U=w>this.stackOfSelected[I-1]?function(){return w>E.stackOfSelected[H]}:function(){return w<E.stackOfSelected[H]};U();)this.rectCrossesBlocks&&this.Editor.BlockSelection.unSelectBlockByIndex(this.stackOfSelected[H]),this.stackOfSelected.pop(),H--}}else for(var te=this.stackOfSelected[I-1]+1||w;te<=w;te++)this.addBlockInSelection(te)}}}],[{key:"CSS",get:function(){return{overlay:"codex-editor-overlay",overlayContainer:"codex-editor-overlay__container",rect:"codex-editor-overlay__rectangle",topScrollZone:"codex-editor-overlay__scroll-zone--top",bottomScrollZone:"codex-editor-overlay__scroll-zone--bottom"}}}]),S}(p.default);s.default=_,_.displayName="RectangleSelection",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=C(o),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b),v=k(v);var d=function(_){(0,h.default)(w,_);var m,y,x,S=(m=w,function(){var E,L=(0,g.default)(m);if(O()){var I=(0,g.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,p.default)(this,E)});function w(){return(0,u.default)(this,w),S.apply(this,arguments)}return(0,c.default)(w,[{key:"render",value:(x=(0,l.default)(o.default.mark(function E(L){var I,A,B=this;return o.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return I=L.map(function(M){return{function:function(){return B.insertBlock(M)}}}),T.next=3,v.sequence(I);case 3:return A=T.sent,this.Editor.UI.checkEmptiness(),T.abrupt("return",A);case 6:case"end":return T.stop()}},E,this)})),function(E){return x.apply(this,arguments)})},{key:"insertBlock",value:(y=(0,l.default)(o.default.mark(function E(L){var I,A,B,T,M,j,J,U;return o.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:if(I=this.Editor,A=I.Tools,B=I.BlockManager,T=L.type,M=L.data,j=L.tunes,!A.available.has(T)){H.next=13;break}H.prev=3,B.insert({tool:T,data:M,tunes:j}),H.next=11;break;case 7:throw H.prev=7,H.t0=H.catch(3),v.log("Block \xAB".concat(T,"\xBB skipped because of plugins error"),"warn",M),Error(H.t0);case 11:H.next=18;break;case 13:J={savedData:{type:T,data:M},title:T},A.unavailable.has(T)&&(U=A.unavailable.get(T).toolbox,J.title=(U==null?void 0:U.title)||J.title),B.insert({tool:A.stubTool,data:J}).stretched=!0,v.log("Tool \xAB".concat(T,"\xBB is not found. Check 'tools' property at your initial Editor.js config."),"warn");case 18:case"end":return H.stop()}},E,this,[[3,7]])})),function(E){return y.apply(this,arguments)})}]),w}(b.default);s.default=d,d.displayName="Renderer",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(2),e(3),e(5),e(6),e(4),e(7),e(8),e(379)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=C(o),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=k(b),v=C(v);var d=function(_){(0,c.default)(x,_);var m,y=(m=x,function(){var S,w=(0,p.default)(m);if(O()){var E=(0,p.default)(this).constructor;S=Reflect.construct(w,arguments,E)}else S=w.apply(this,arguments);return(0,h.default)(this,S)});function x(){var S;return(0,l.default)(this,x),(S=y.apply(this,arguments)).configCache={},S.inlineToolsConfigCache=null,S}return(0,u.default)(x,[{key:"sanitizeBlocks",value:function(S){var w=this;return S.map(function(E){var L=w.composeToolConfig(E.tool);return b.isEmpty(L)||(E.data=w.deepSanitize(E.data,L)),E})}},{key:"deepSanitize",value:function(S,w){return Array.isArray(S)?this.cleanArray(S,w):b.isObject(S)?this.cleanObject(S,w):b.isString(S)?this.cleanOneItem(S,w):S}},{key:"clean",value:function(S){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},E={tags:w},L=this.createHTMLJanitorInstance(E);return L.clean(S)}},{key:"composeToolConfig",value:function(S){if(this.configCache[S])return this.configCache[S];var w=this.Editor.Tools.available.get(S),E=this.getInlineToolsConfig(w);if(!w.sanitizeConfig||w.sanitizeConfig&&b.isEmpty(w.sanitizeConfig))return E;var L=w.sanitizeConfig,I={};for(var A in L)if(Object.prototype.hasOwnProperty.call(L,A)){var B=L[A];b.isObject(B)?I[A]=Object.assign({},E,B):I[A]=B}return this.configCache[S]=I,I}},{key:"getInlineToolsConfig",value:function(S){var w=this.Editor.Tools,E=S.enabledInlineTools||[],L={};return b.isBoolean(E)&&E?L=this.getAllInlineToolsConfig():E.map(function(I){L=Object.assign(L,w.inlineTools.get(I).sanitizeConfig)}),L.br=!0,L.wbr=!0,L}},{key:"getAllInlineToolsConfig",value:function(){var S=this.Editor.Tools;if(this.inlineToolsConfigCache)return this.inlineToolsConfigCache;var w={};return Object.entries(S.inlineTools).forEach(function(E){var L=(0,o.default)(E,2)[1];Object.assign(w,L.sanitizeConfig)}),this.inlineToolsConfigCache=w,this.inlineToolsConfigCache}},{key:"cleanArray",value:function(S,w){var E=this;return S.map(function(L){return E.deepSanitize(L,w)})}},{key:"cleanObject",value:function(S,w){var E={};for(var L in S)if(Object.prototype.hasOwnProperty.call(S,L)){var I=S[L],A=this.isRule(w[L])?w[L]:w;E[L]=this.deepSanitize(I,A)}return E}},{key:"cleanOneItem",value:function(S,w){return b.isObject(w)?this.clean(S,w):w===!1?this.clean(S,{}):S}},{key:"isRule",value:function(S){return b.isObject(S)||b.isBoolean(S)||b.isFunction(S)}},{key:"createHTMLJanitorInstance",value:function(S){return S?new v.default(S):null}}]),x}(g.default);s.default=d,d.displayName="Sanitizer",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(7),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(_){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=C(o),l=C(l),u=C(u),c=C(c),h=C(h),p=C(p),g=C(g),b=C(b),v=k(v);var d=function(_){(0,h.default)(w,_);var m,y,x,S=(m=w,function(){var E,L=(0,g.default)(m);if(O()){var I=(0,g.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,p.default)(this,E)});function w(){return(0,u.default)(this,w),S.apply(this,arguments)}return(0,c.default)(w,[{key:"save",value:(x=(0,l.default)(o.default.mark(function E(){var L,I,A,B,T,M,j,J,U=this;return o.default.wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return L=this.Editor,I=L.BlockManager,A=L.Sanitizer,B=L.ModificationsObserver,T=I.blocks,M=[],B.disable(),H.prev=3,T.forEach(function(te){M.push(U.getSavedData(te))}),H.next=7,Promise.all(M);case 7:return j=H.sent,H.next=10,A.sanitizeBlocks(j);case 10:return J=H.sent,H.abrupt("return",this.makeOutput(J));case 12:return H.prev=12,B.enable(),H.finish(12);case 15:case"end":return H.stop()}},E,this,[[3,,12,15]])})),function(){return x.apply(this,arguments)})},{key:"getSavedData",value:(y=(0,l.default)(o.default.mark(function E(L){var I,A;return o.default.wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return B.next=2,L.save();case 2:if(I=B.sent,B.t0=I,!B.t0){B.next=8;break}return B.next=7,L.validate(I.data);case 7:B.t0=B.sent;case 8:return A=B.t0,B.abrupt("return",Object.assign(Object.assign({},I),{isValid:A}));case 10:case"end":return B.stop()}},E)})),function(E){return y.apply(this,arguments)})},{key:"makeOutput",value:function(E){var L=this,I=0,A=[];return v.log("[Editor.js saving]:","groupCollapsed"),E.forEach(function(B){var T=B.tool,M=B.data,j=B.tunes,J=B.time,U=B.isValid;if(I+=J,v.log("".concat(T.charAt(0).toUpperCase()+T.slice(1)),"group"),!U)return v.log("Block \xAB".concat(T,"\xBB skipped because saved data is invalid")),void v.log(void 0,"groupEnd");if(v.log(M),v.log(void 0,"groupEnd"),T!==L.Editor.Tools.stubTool){var H={type:T,data:M};v.isEmpty(j)||(H.tunes=j),A.push(H)}else A.push(M)}),v.log("Total","log",I),v.log(void 0,"groupEnd"),{time:+new Date,blocks:A,version:"2.20.0"}}}]),w}(b.default);s.default=d,d.displayName="Saver",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(60),e(8),e(25)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C){"use strict";var O=e(9),d=e(1);function _(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(y){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=d(o),l=d(l),u=d(u),c=d(c),h=d(h),p=d(p),g=d(g),b=d(b),v=d(v),k=O(k),C=d(C);var m=function(y){(0,c.default)(w,y);var x,S=(x=w,function(){var E,L=(0,p.default)(x);if(_()){var I=(0,p.default)(this).constructor;E=Reflect.construct(L,arguments,I)}else E=L.apply(this,arguments);return(0,h.default)(this,E)});function w(){var E;return(0,l.default)(this,w),(E=S.apply(this,arguments)).buttons=[],E.flipper=null,E.selection=new C.default,E}return(0,u.default)(w,[{key:"make",value:function(){this.nodes.wrapper=b.default.make("div",this.CSS.wrapper),this.nodes.toolSettings=b.default.make("div",this.CSS.toolSettings),this.nodes.defaultSettings=b.default.make("div",this.CSS.defaultSettings),b.default.append(this.nodes.wrapper,[this.nodes.toolSettings,this.nodes.defaultSettings]),this.enableFlipper()}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}},{key:"open",value:function(){this.nodes.wrapper.classList.add(this.CSS.wrapperOpened),this.selection.save(),this.Editor.BlockManager.currentBlock.selected=!0,this.Editor.BlockSelection.clearCache(),this.addToolSettings(),this.addTunes(),this.eventsDispatcher.emit(this.events.opened),this.flipper.activate(this.blockTunesButtons)}},{key:"close",value:function(){this.nodes.wrapper.classList.remove(this.CSS.wrapperOpened),C.default.isAtEditor||this.selection.restore(),this.selection.clearSaved(),!this.Editor.CrossBlockSelection.isCrossBlockSelectionStarted&&this.Editor.BlockManager.currentBlock&&(this.Editor.BlockManager.currentBlock.selected=!1),this.nodes.toolSettings.innerHTML="",this.nodes.defaultSettings.innerHTML="",this.eventsDispatcher.emit(this.events.closed),this.buttons=[],this.flipper.deactivate()}},{key:"addToolSettings",value:function(){var E=this.Editor.BlockManager.currentBlock.renderSettings();E&&b.default.append(this.nodes.toolSettings,E)}},{key:"addTunes",value:function(){var E=this.Editor.BlockManager.currentBlock.renderTunes(),L=(0,o.default)(E,2),I=L[0],A=L[1];b.default.append(this.nodes.toolSettings,I),b.default.append(this.nodes.defaultSettings,A)}},{key:"enableFlipper",value:function(){var E=this;this.flipper=new v.default({focusedItemClass:this.CSS.focusedButton,activateCallback:function(L){L&&b.default.canSetCaret(L)?E.close():k.delay(function(){E.Editor.Caret.setToBlock(E.Editor.BlockManager.currentBlock)},50)()}})}},{key:"events",get:function(){return{opened:"block-settings-opened",closed:"block-settings-closed"}}},{key:"CSS",get:function(){return{wrapper:"ce-settings",wrapperOpened:"ce-settings--opened",toolSettings:"ce-settings__plugin-zone",defaultSettings:"ce-settings__default-zone",button:"ce-settings__button",focusedButton:"ce-settings__button--focused",focusedButtonAnimated:"ce-settings__button--focused-animated"}}},{key:"opened",get:function(){return this.nodes.wrapper.classList.contains(this.CSS.wrapperOpened)}},{key:"blockTunesButtons",get:function(){var E=this,L=this.Editor.StylesAPI;if(this.buttons.length!==0)return this.buttons;var I=this.nodes.toolSettings.querySelectorAll(".".concat(L.classes.settingsButton,", ").concat(b.default.allInputsSelector)),A=this.nodes.defaultSettings.querySelectorAll(".".concat(this.CSS.button));return I.forEach(function(B){E.buttons.push(B)}),A.forEach(function(B){E.buttons.push(B)}),this.buttons}}]),w}(g.default);s.default=m,m.displayName="BlockSettings",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(21),e(22),e(42),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8),e(60),e(59),e(81)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O,d,_,m){"use strict";var y=e(9),x=e(1);function S(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(E){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=x(o),l=x(l),u=x(u),c=x(c),h=x(h),p=x(p),g=x(g),b=x(b),v=x(v),k=x(k),C=x(C),O=y(O),d=x(d),_=x(_);var w=function(E){(0,g.default)(B,E);var L,I,A=(L=B,function(){var T,M=(0,v.default)(L);if(S()){var j=(0,v.default)(this).constructor;T=Reflect.construct(M,arguments,j)}else T=M.apply(this,arguments);return(0,b.default)(this,T)});function B(){var T;return(0,h.default)(this,B),(T=A.apply(this,arguments)).opened=!1,T.tools={},T.flipper=null,T.togglingCallback=null,T}return(0,p.default)(B,[{key:"make",value:function(){this.nodes.wrapper=C.default.make("div",[B.CSS.conversionToolbarWrapper].concat((0,c.default)(this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]))),this.nodes.tools=C.default.make("div",B.CSS.conversionToolbarTools);var T=C.default.make("div",B.CSS.conversionToolbarLabel,{textContent:_.default.ui(m.I18nInternalNS.ui.inlineToolbar.converter,"Convert to")});return this.addTools(),this.enableFlipper(),C.default.append(this.nodes.wrapper,T),C.default.append(this.nodes.wrapper,this.nodes.tools),this.nodes.wrapper}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}},{key:"toggle",value:function(T){this.opened?this.close():this.open(),O.isFunction(T)&&(this.togglingCallback=T)}},{key:"open",value:function(){var T=this;this.filterTools(),this.opened=!0,this.nodes.wrapper.classList.add(B.CSS.conversionToolbarShowed),setTimeout(function(){T.flipper.activate(Object.values(T.tools).filter(function(M){return!M.classList.contains(B.CSS.conversionToolHidden)})),T.flipper.focusFirst(),O.isFunction(T.togglingCallback)&&T.togglingCallback(!0)},50)}},{key:"close",value:function(){this.opened=!1,this.flipper.deactivate(),this.nodes.wrapper.classList.remove(B.CSS.conversionToolbarShowed),O.isFunction(this.togglingCallback)&&this.togglingCallback(!1)}},{key:"hasTools",value:function(){var T=Object.keys(this.tools);return!(T.length===1&&T.shift()===this.config.defaultBlock)}},{key:"replaceWithBlock",value:(I=(0,u.default)(l.default.mark(function T(M){var j,J,U,H,te,se,W,Y,ie,re,Q=this;return l.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return j=this.Editor.BlockManager.currentBlock.tool,J=this.Editor.BlockManager.currentBlock.name,ee.next=4,this.Editor.BlockManager.currentBlock.save();case 4:if(U=ee.sent,H=U.data,J===M&&(M=this.config.defaultBlock),te=this.Editor.Tools.blockTools.get(M),se="",W=j.conversionConfig.export,!O.isFunction(W)){ee.next=14;break}se=W(H),ee.next=20;break;case 14:if(!O.isString(W)){ee.next=18;break}se=H[W],ee.next=20;break;case 18:return O.log("Conversion \xABexport\xBB property must be a string or function. String means key of saved data object to export. Function should export processed string to export."),ee.abrupt("return");case 20:if(Y=this.Editor.Sanitizer.clean(se,te.sanitizeConfig),ie={},re=te.conversionConfig.import,!O.isFunction(re)){ee.next=27;break}ie=re(Y),ee.next=33;break;case 27:if(!O.isString(re)){ee.next=31;break}ie[re]=Y,ee.next=33;break;case 31:return O.log("Conversion \xABimport\xBB property must be a string or function. String means key of tool data to import. Function accepts a imported string and return composed tool data."),ee.abrupt("return");case 33:this.Editor.BlockManager.replace({tool:M,data:ie}),this.Editor.BlockSelection.clearSelection(),this.close(),this.Editor.InlineToolbar.close(),O.delay(function(){Q.Editor.Caret.setToBlock(Q.Editor.BlockManager.currentBlock)},10)();case 38:case"end":return ee.stop()}},T,this)})),function(T){return I.apply(this,arguments)})},{key:"addTools",value:function(){var T=this,M=this.Editor.Tools.blockTools;Array.from(M.entries()).forEach(function(j){var J=(0,o.default)(j,2),U=J[0],H=J[1],te=H.toolbox,se=H.conversionConfig;!O.isEmpty(te)&&te.icon&&se&&se.import&&T.addTool(U,te.icon,te.title)})}},{key:"addTool",value:function(T,M,j){var J=this,U=C.default.make("div",[B.CSS.conversionTool]),H=C.default.make("div",[B.CSS.conversionToolIcon]);U.dataset.tool=T,H.innerHTML=M,C.default.append(U,H),C.default.append(U,C.default.text(_.default.t(m.I18nInternalNS.toolNames,j||O.capitalize(T)))),C.default.append(this.nodes.tools,U),this.tools[T]=U,this.listeners.on(U,"click",(0,u.default)(l.default.mark(function te(){return l.default.wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return se.next=2,J.replaceWithBlock(T);case 2:case"end":return se.stop()}},te)})))}},{key:"filterTools",value:function(){var T=this.Editor.BlockManager.currentBlock;Object.entries(this.tools).forEach(function(M){var j=(0,o.default)(M,2),J=j[0],U=j[1];U.hidden=!1,U.classList.toggle(B.CSS.conversionToolHidden,J===T.name)})}},{key:"enableFlipper",value:function(){this.flipper=new d.default({focusedItemClass:B.CSS.conversionToolFocused})}}],[{key:"CSS",get:function(){return{conversionToolbarWrapper:"ce-conversion-toolbar",conversionToolbarShowed:"ce-conversion-toolbar--showed",conversionToolbarTools:"ce-conversion-toolbar__tools",conversionToolbarLabel:"ce-conversion-toolbar__label",conversionTool:"ce-conversion-tool",conversionToolHidden:"ce-conversion-tool--hidden",conversionToolIcon:"ce-conversion-tool__icon",conversionToolFocused:"ce-conversion-tool--focused",conversionToolActive:"ce-conversion-tool--active"}}}]),B}(k.default);s.default=w,w.displayName="ConversionToolbar",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(42),e(29),e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(25),e(8),e(60),e(59),e(81),e(108),e(66)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O,d,_,m,y){"use strict";var x=e(9),S=e(1);function w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(L){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=S(o),l=S(l),u=S(u),c=S(c),h=S(h),p=S(p),g=S(g),b=S(b),v=S(v),k=S(k),C=x(C),O=S(O),d=S(d),m=S(m);var E=function(L){(0,h.default)(B,L);var I,A=(I=B,function(){var T,M=(0,g.default)(I);if(w()){var j=(0,g.default)(this).constructor;T=Reflect.construct(M,arguments,j)}else T=M.apply(this,arguments);return(0,p.default)(this,T)});function B(){var T;return(0,u.default)(this,B),(T=A.apply(this,arguments)).CSS={inlineToolbar:"ce-inline-toolbar",inlineToolbarShowed:"ce-inline-toolbar--showed",inlineToolbarLeftOriented:"ce-inline-toolbar--left-oriented",inlineToolbarRightOriented:"ce-inline-toolbar--right-oriented",inlineToolbarShortcut:"ce-inline-toolbar__shortcut",buttonsWrapper:"ce-inline-toolbar__buttons",actionsWrapper:"ce-inline-toolbar__actions",inlineToolButton:"ce-inline-tool",inputField:"cdx-input",focusedButton:"ce-inline-tool--focused",conversionToggler:"ce-inline-toolbar__dropdown",conversionTogglerHidden:"ce-inline-toolbar__dropdown--hidden",conversionTogglerContent:"ce-inline-toolbar__dropdown-content",togglerAndButtonsWrapper:"ce-inline-toolbar__toggler-and-button-wrapper"},T.opened=!1,T.toolbarVerticalMargin=5,T.buttonsList=null,T.width=0,T.flipper=null,T}return(0,c.default)(B,[{key:"toggleReadOnly",value:function(T){T?(this.destroy(),this.Editor.ConversionToolbar.destroy()):this.make()}},{key:"tryToShow",value:function(){var T=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.allowedToShow()?(this.move(),this.open(),this.Editor.Toolbar.close()):T&&this.close()}},{key:"move",value:function(){var T=k.default.rect,M=this.Editor.UI.nodes.wrapper.getBoundingClientRect(),j={x:T.x-M.left,y:T.y+T.height-M.top+this.toolbarVerticalMargin};T.width&&(j.x+=Math.floor(T.width/2));var J=j.x-this.width/2,U=j.x+this.width/2;this.nodes.wrapper.classList.toggle(this.CSS.inlineToolbarLeftOriented,J<this.Editor.UI.contentRect.left),this.nodes.wrapper.classList.toggle(this.CSS.inlineToolbarRightOriented,U>this.Editor.UI.contentRect.right),this.nodes.wrapper.style.left=Math.floor(j.x)+"px",this.nodes.wrapper.style.top=Math.floor(j.y)+"px"}},{key:"close",value:function(){var T=this;this.opened&&(this.Editor.ReadOnly.isEnabled||(this.nodes.wrapper.classList.remove(this.CSS.inlineToolbarShowed),Array.from(this.toolsInstances.entries()).forEach(function(M){var j=(0,l.default)(M,2),J=j[0],U=j[1],H=T.getToolShortcut(J);H&&m.default.remove(T.Editor.UI.nodes.redactor,H),C.isFunction(U.clear)&&U.clear()}),this.opened=!1,this.flipper.deactivate(),this.Editor.ConversionToolbar.close()))}},{key:"open",value:function(){if(!this.opened){this.addToolsFiltered(),this.nodes.wrapper.classList.add(this.CSS.inlineToolbarShowed),this.buttonsList=this.nodes.buttons.querySelectorAll(".".concat(this.CSS.inlineToolButton)),this.opened=!0,this.Editor.ConversionToolbar.hasTools()?this.setConversionTogglerContent():this.nodes.conversionToggler.hidden=!0;var T=Array.from(this.buttonsList);T.unshift(this.nodes.conversionToggler),T=T.filter(function(M){return!M.hidden}),this.flipper.activate(T)}}},{key:"containsNode",value:function(T){return this.nodes.wrapper.contains(T)}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes()}},{key:"getInlineToolbarSettings",value:function(T){var M=T.enabledInlineTools;if(M!==!0&&!Array.isArray(M))return!1;if(Array.isArray(M))return M;var j=this.config.inlineToolbar;return Array.isArray(j)?j:j===!0&&Array.from(this.Editor.Tools.inlineTools.keys())}},{key:"make",value:function(){var T=this;this.nodes.wrapper=v.default.make("div",[this.CSS.inlineToolbar].concat((0,o.default)(this.isRtl?[this.Editor.UI.CSS.editorRtlFix]:[]))),this.nodes.togglerAndButtonsWrapper=v.default.make("div",this.CSS.togglerAndButtonsWrapper),this.nodes.buttons=v.default.make("div",this.CSS.buttonsWrapper),this.nodes.actions=v.default.make("div",this.CSS.actionsWrapper),this.listeners.on(this.nodes.wrapper,"mousedown",function(M){M.target.closest(".".concat(T.CSS.actionsWrapper))||M.preventDefault()}),v.default.append(this.nodes.wrapper,[this.nodes.togglerAndButtonsWrapper,this.nodes.actions]),v.default.append(this.Editor.UI.nodes.wrapper,this.nodes.wrapper),this.addConversionToggler(),v.default.append(this.nodes.togglerAndButtonsWrapper,this.nodes.buttons),this.prepareConversionToolbar(),this.recalculateWidth(),this.enableFlipper()}},{key:"allowedToShow",value:function(){var T=k.default.get(),M=k.default.text;if(!T||!T.anchorNode||T.isCollapsed||M.length<1)return!1;var j=v.default.isElement(T.anchorNode)?T.anchorNode:T.anchorNode.parentElement;if(T&&["IMG","INPUT"].includes(j.tagName)||j.closest('[contenteditable="true"]')===null)return!1;var J=this.Editor.BlockManager.getBlock(T.anchorNode);return!!J&&this.getInlineToolbarSettings(J.tool)!==!1}},{key:"recalculateWidth",value:function(){this.width=this.nodes.wrapper.offsetWidth}},{key:"addConversionToggler",value:function(){var T=this;this.nodes.conversionToggler=v.default.make("div",this.CSS.conversionToggler),this.nodes.conversionTogglerContent=v.default.make("div",this.CSS.conversionTogglerContent);var M=v.default.svg("toggler-down",13,13);this.nodes.conversionToggler.appendChild(this.nodes.conversionTogglerContent),this.nodes.conversionToggler.appendChild(M),this.nodes.togglerAndButtonsWrapper.appendChild(this.nodes.conversionToggler),this.listeners.on(this.nodes.conversionToggler,"click",function(){T.Editor.ConversionToolbar.toggle(function(j){!j&&T.opened?T.flipper.activate():T.opened&&T.flipper.deactivate()})}),this.Editor.Tooltip.onHover(this.nodes.conversionToggler,d.default.ui(_.I18nInternalNS.ui.inlineToolbar.converter,"Convert to"),{placement:"top",hidingDelay:100})}},{key:"setConversionTogglerContent",value:function(){var T=this.Editor.BlockManager.currentBlock,M=T.name,j=T.tool.conversionConfig,J=j&&j.export;this.nodes.conversionToggler.hidden=!J,this.nodes.conversionToggler.classList.toggle(this.CSS.conversionTogglerHidden,!J);var U=T.tool.toolbox||{};this.nodes.conversionTogglerContent.innerHTML=U.icon||U.title||C.capitalize(M)}},{key:"prepareConversionToolbar",value:function(){var T=this.Editor.ConversionToolbar.make();v.default.append(this.nodes.wrapper,T)}},{key:"addToolsFiltered",value:function(){var T=this,M=k.default.get(),j=this.Editor.BlockManager.getBlock(M.anchorNode);this.nodes.buttons.innerHTML="",this.nodes.actions.innerHTML="",this.toolsInstances=new Map,this.getInlineToolbarSettings(j.tool).forEach(function(J){var U=T.Editor.Tools.inlineTools.get(J);T.addTool(U)}),this.recalculateWidth()}},{key:"addTool",value:function(T){var M=this,j=this.Editor.Tooltip,J=T.create(),U=J.render();if(U){if(U.dataset.tool=T.name,this.nodes.buttons.appendChild(U),this.toolsInstances.set(T.name,J),C.isFunction(J.renderActions)){var H=J.renderActions();this.nodes.actions.appendChild(H)}this.listeners.on(U,"click",function(Y){M.toolClicked(J),Y.preventDefault()});var te=this.getToolShortcut(T.name);if(te)try{this.enableShortcuts(J,te)}catch(Y){}var se=v.default.make("div"),W=d.default.t(_.I18nInternalNS.toolNames,T.title||C.capitalize(T.name));se.appendChild(v.default.text(W)),te&&se.appendChild(v.default.make("div",this.CSS.inlineToolbarShortcut,{textContent:C.beautifyShortcut(te)})),j.onHover(U,se,{placement:"top",hidingDelay:100}),J.checkState(k.default.get())}else C.log("Render method must return an instance of Node","warn",T.name)}},{key:"getToolShortcut",value:function(T){var M=this.Editor.Tools,j=M.inlineTools.get(T),J=M.internal.inlineTools;return Array.from(J.keys()).includes(T)?this.inlineTools[T][y.CommonInternalSettings.Shortcut]:j.shortcut}},{key:"enableShortcuts",value:function(T,M){var j=this;m.default.add({name:M,handler:function(J){var U=j.Editor.BlockManager.currentBlock;U&&U.tool.enabledInlineTools&&(J.preventDefault(),j.toolClicked(T))},on:this.Editor.UI.nodes.redactor})}},{key:"toolClicked",value:function(T){var M=k.default.range;T.surround(M),this.checkToolsState()}},{key:"checkToolsState",value:function(){this.toolsInstances.forEach(function(T){T.checkState(k.default.get())})}},{key:"enableFlipper",value:function(){this.flipper=new O.default({focusedItemClass:this.CSS.focusedButton,allowArrows:!1})}},{key:"inlineTools",get:function(){var T={};return Array.from(this.Editor.Tools.inlineTools.entries()).forEach(function(M){var j=(0,l.default)(M,2),J=j[0],U=j[1];T[J]=U.create()}),T}}]),B}(b.default);s.default=E,E.displayName="InlineToolbar",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(15),e(8),e(60),e(61),e(59),e(81),e(108)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O,d){"use strict";var _=e(9),m=e(1);function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(S){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=m(o),l=m(l),u=m(u),c=m(c),h=m(h),p=m(p),g=m(g),b=_(b),v=m(v),C=m(C),d=m(d);var x=function(S){(0,u.default)(L,S);var w,E=(w=L,function(){var I,A=(0,h.default)(w);if(y()){var B=(0,h.default)(this).constructor;I=Reflect.construct(A,arguments,B)}else I=A.apply(this,arguments);return(0,c.default)(this,I)});function L(){var I;return(0,o.default)(this,L),(I=E.apply(this,arguments)).nodes={toolbox:null,buttons:[]},I.opened=!1,I.displayedToolsCount=0,I.flipper=null,I}return(0,l.default)(L,[{key:"make",value:function(){this.nodes.toolbox=g.default.make("div",this.CSS.toolbox),this.addTools(),this.enableFlipper()}},{key:"destroy",value:function(){this.flipper&&(this.flipper.deactivate(),this.flipper=null),this.removeAllNodes(),this.removeAllShortcuts()}},{key:"toolButtonActivate",value:function(I,A){this.insertNewBlock(A)}},{key:"open",value:function(){this.isEmpty||(this.Editor.UI.nodes.wrapper.classList.add(this.CSS.openedToolbarHolderModifier),this.nodes.toolbox.classList.add(this.CSS.toolboxOpened),this.opened=!0,this.flipper.activate())}},{key:"close",value:function(){this.nodes.toolbox.classList.remove(this.CSS.toolboxOpened),this.Editor.UI.nodes.wrapper.classList.remove(this.CSS.openedToolbarHolderModifier),this.opened=!1,this.flipper.deactivate()}},{key:"toggle",value:function(){this.opened?this.close():this.open()}},{key:"addTools",value:function(){var I=this,A=this.Editor.Tools.blockTools;Array.from(A.values()).forEach(function(B){return I.addTool(B)})}},{key:"addTool",value:function(I){var A=this,B=I.toolbox;if(B)if(!B||B.icon){var T=g.default.make("li",[this.CSS.toolboxButton]);T.dataset.tool=I.name,T.innerHTML=B.icon,g.default.append(this.nodes.toolbox,T),this.nodes.toolbox.appendChild(T),this.nodes.buttons.push(T),this.listeners.on(T,"click",function(J){A.toolButtonActivate(J,I.name)});var M=this.drawTooltip(I);this.Editor.Tooltip.onHover(T,M,{placement:"bottom",hidingDelay:200});var j=I.shortcut;j&&this.enableShortcut(I.name,j),this.displayedToolsCount++}else b.log("Toolbar icon is missed. Tool %o skipped","warn",I.name)}},{key:"drawTooltip",value:function(I){var A=I.toolbox||{},B=C.default.t(O.I18nInternalNS.toolNames,A.title||I.name),T=I.shortcut,M=g.default.make("div",this.CSS.buttonTooltip),j=document.createTextNode(b.capitalize(B));return M.appendChild(j),T&&(T=b.beautifyShortcut(T),M.appendChild(g.default.make("div",this.CSS.buttonShortcut,{textContent:T}))),M}},{key:"enableShortcut",value:function(I,A){var B=this;d.default.add({name:A,handler:function(T){T.preventDefault(),B.insertNewBlock(I)},on:this.Editor.UI.nodes.redactor})}},{key:"removeAllShortcuts",value:function(){var I=this,A=this.Editor.Tools.blockTools;Array.from(A.values()).forEach(function(B){var T=B.shortcut;T&&d.default.remove(I.Editor.UI.nodes.redactor,T)})}},{key:"enableFlipper",value:function(){var I=Array.from(this.nodes.toolbox.childNodes);this.flipper=new v.default({items:I,focusedItemClass:this.CSS.toolboxButtonActive})}},{key:"insertNewBlock",value:function(I){var A=this.Editor,B=A.BlockManager,T=A.Caret,M=B.currentBlock,j=B.insert({tool:I,replace:M.isEmpty});j.call(k.BlockToolAPI.APPEND_CALLBACK),this.Editor.Caret.setToBlock(j),j.inputs.length===0&&(j===B.lastBlock?(B.insertAtEnd(),T.setToBlock(B.lastBlock)):T.setToBlock(B.nextBlock)),this.Editor.Toolbar.close()}},{key:"CSS",get:function(){return{toolbox:"ce-toolbox",toolboxButton:"ce-toolbox__button",toolboxButtonActive:"ce-toolbox__button--active",toolboxOpened:"ce-toolbox--opened",openedToolbarHolderModifier:"codex-editor--toolbox-opened",buttonTooltip:"ce-toolbox-button-tooltip",buttonShortcut:"ce-toolbox-button-tooltip__shortcut"}}},{key:"isEmpty",get:function(){return this.displayedToolsCount===0}}]),L}(p.default);s.default=x,x.displayName="Toolbox",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(42),e(29),e(2),e(3),e(5),e(6),e(4),e(380),e(7),e(8),e(381),e(382),e(383),e(384),e(385),e(389),e(390),e(391),e(392)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O,d,_,m,y,x,S,w,E,L){"use strict";var I=e(9),A=e(1);function B(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(M){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=A(o),l=A(l),u=A(u),c=A(c),h=A(h),p=A(p),g=A(g),b=A(b),v=A(v),k=A(k),C=A(C),O=I(O),d=A(d),_=A(_),m=A(m),y=A(y),x=A(x),S=A(S),w=A(w),E=A(E),L=A(L);var T=function(M){(0,g.default)(U,M);var j,J=(j=U,function(){var H,te=(0,v.default)(j);if(B()){var se=(0,v.default)(this).constructor;H=Reflect.construct(te,arguments,se)}else H=te.apply(this,arguments);return(0,b.default)(this,H)});function U(){var H;return(0,h.default)(this,U),(H=J.apply(this,arguments)).stubTool="stub",H.toolsAvailable=new L.default,H.toolsUnavailable=new L.default,H}return(0,p.default)(U,[{key:"prepare",value:function(){var H=this;if(this.validateTools(),this.config.tools=O.deepMerge({},this.internalTools,this.config.tools),!Object.prototype.hasOwnProperty.call(this.config,"tools")||Object.keys(this.config.tools).length===0)throw Error("Can't start without tools");var te=this.prepareConfig();this.factory=new x.default(te,this.config,this.Editor.API);var se=this.getListOfPrepareFunctions(te);return se.length===0?Promise.resolve():O.sequence(se,function(W){H.toolPrepareMethodSuccess(W)},function(W){H.toolPrepareMethodFallback(W)})}},{key:"getTunesForTool",value:function(H){var te=H.enabledBlockTunes;if(te===!1)return new L.default;if(Array.isArray(te))return new L.default(Array.from(this.blockTunes.entries()).filter(function(W){var Y=(0,c.default)(W,2)[1];return te.includes(Y.name)}).concat((0,u.default)(this.blockTunes.internalTools.entries())));var se=this.config.tunes;return Array.isArray(se)?new L.default(Array.from(this.blockTunes.entries()).filter(function(W){var Y=(0,c.default)(W,2)[1];return se.includes(Y.name)}).concat((0,u.default)(this.blockTunes.internalTools.entries()))):this.blockTunes.internalTools}},{key:"destroy",value:function(){Object.values(this.available).forEach(function(){var H=(0,l.default)(o.default.mark(function te(se){return o.default.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(!O.isFunction(se.reset)){W.next=3;break}return W.next=3,se.reset();case 3:case"end":return W.stop()}},te)}));return function(te){return H.apply(this,arguments)}}())}},{key:"toolPrepareMethodSuccess",value:function(H){var te=this.factory.get(H.toolName);if(te.isInline()){var se=["render","surround","checkState"].filter(function(W){return!te.create()[W]});if(se.length)return O.log("Incorrect Inline Tool: ".concat(te.name,". Some of required methods is not implemented %o"),"warn",se),void this.toolsUnavailable.set(te.name,te)}this.toolsAvailable.set(te.name,te)}},{key:"toolPrepareMethodFallback",value:function(H){this.toolsUnavailable.set(H.toolName,this.factory.get(H.toolName))}},{key:"getListOfPrepareFunctions",value:function(H){var te=[];return Object.entries(H).forEach(function(se){var W=(0,c.default)(se,2),Y=W[0],ie=W[1];te.push({function:O.isFunction(ie.class.prepare)?ie.class.prepare:function(){},data:{toolName:Y}})}),te}},{key:"validateTools",value:function(){for(var H in this.config.tools)if(Object.prototype.hasOwnProperty.call(this.config.tools,H)){if(H in this.internalTools)return;var te=this.config.tools[H];if(!O.isFunction(te)&&!O.isFunction(te.class))throw Error("Tool \xAB".concat(H,"\xBB must be a constructor function or an object with function in the \xABclass\xBB property"))}}},{key:"prepareConfig",value:function(){var H={};for(var te in this.config.tools)O.isObject(this.config.tools[te])?H[te]=this.config.tools[te]:H[te]={class:this.config.tools[te]};return H}},{key:"available",get:function(){return this.toolsAvailable}},{key:"unavailable",get:function(){return this.toolsUnavailable}},{key:"inlineTools",get:function(){return this.available.inlineTools}},{key:"blockTools",get:function(){return this.available.blockTools}},{key:"blockTunes",get:function(){return this.available.blockTunes}},{key:"defaultTool",get:function(){return this.blockTools.get(this.config.defaultBlock)}},{key:"internal",get:function(){return this.available.internalTools}},{key:"internalTools",get:function(){return{bold:{class:d.default,isInternal:!0},italic:{class:_.default,isInternal:!0},link:{class:m.default,isInternal:!0},paragraph:{class:k.default,inlineToolbar:!0,isInternal:!0},stub:{class:y.default,isInternal:!0},moveUpTune:{class:E.default,isInternal:!0},deleteTune:{class:w.default,isInternal:!0},moveDownTune:{class:S.default,isInternal:!0}}}}]),U}(C.default);s.default=T,T.displayName="Tools",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(7),e(393)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=b(o),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p),g=b(g);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){var m;return(0,o.default)(this,_),(m=d.apply(this,arguments)).lib=new g.default,m}return(0,l.default)(_,[{key:"show",value:function(m,y,x){this.lib.show(m,y,x)}},{key:"hide",value:function(){this.lib.hide()}},{key:"onHover",value:function(m,y,x){this.lib.onHover(m,y,x)}}]),_}(p.default);s.default=k,k.displayName="Tooltip",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(42),e(21),e(22),e(2),e(3),e(5),e(6),e(4),e(394),e(7),e(15),e(8),e(25),e(61),e(60)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v,k,C,O,d,_,m,y){"use strict";var x=e(9),S=e(1);function w(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(L){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=S(o),l=S(l),u=S(u),c=S(c),h=S(h),p=S(p),g=S(g),b=S(b),v=S(v),k=S(k),C=S(C),O=S(O),d=x(d),_=S(_),m=S(m),y=S(y);var E=function(L){(0,g.default)(T,L);var I,A,B=(I=T,function(){var M,j=(0,v.default)(I);if(w()){var J=(0,v.default)(this).constructor;M=Reflect.construct(j,arguments,J)}else M=j.apply(this,arguments);return(0,b.default)(this,M)});function T(){var M;return(0,h.default)(this,T),(M=B.apply(this,arguments)).isMobile=!1,M.contentRectCache=void 0,M.resizeDebouncer=d.debounce(function(){M.windowResize()},200),M}return(0,p.default)(T,[{key:"addLoader",value:function(){this.nodes.loader=O.default.make("div",this.CSS.editorLoader),this.nodes.wrapper.prepend(this.nodes.loader),this.nodes.redactor.classList.add(this.CSS.editorZoneHidden)}},{key:"removeLoader",value:function(){this.nodes.loader.remove(),this.nodes.redactor.classList.remove(this.CSS.editorZoneHidden)}},{key:"prepare",value:(A=(0,c.default)(u.default.mark(function M(){return u.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:this.checkIsMobile(),this.make(),this.addLoader(),this.appendSVGSprite(),this.loadStyles();case 5:case"end":return j.stop()}},M,this)})),function(){return A.apply(this,arguments)})},{key:"toggleReadOnly",value:function(M){M?this.disableModuleBindings():this.enableModuleBindings()}},{key:"checkEmptiness",value:function(){var M=this.Editor.BlockManager;this.nodes.wrapper.classList.toggle(this.CSS.editorEmpty,M.isEditorEmpty)}},{key:"destroy",value:function(){this.nodes.holder.innerHTML=""}},{key:"closeAllToolbars",value:function(){var M=this.Editor,j=M.Toolbox,J=M.BlockSettings,U=M.InlineToolbar,H=M.ConversionToolbar;J.close(),U.close(),H.close(),j.close()}},{key:"checkIsMobile",value:function(){this.isMobile=window.innerWidth<650}},{key:"make",value:function(){this.nodes.holder=O.default.getHolder(this.config.holder),this.nodes.wrapper=O.default.make("div",[this.CSS.editorWrapper].concat((0,l.default)(this.isRtl?[this.CSS.editorRtlFix]:[]))),this.nodes.redactor=O.default.make("div",this.CSS.editorZone),this.nodes.holder.offsetWidth<this.contentRect.width&&this.nodes.wrapper.classList.add(this.CSS.editorWrapperNarrow),this.nodes.redactor.style.paddingBottom=this.config.minHeight+"px",this.nodes.wrapper.appendChild(this.nodes.redactor),this.nodes.holder.appendChild(this.nodes.wrapper)}},{key:"loadStyles",value:function(){var M=e(395);if(!O.default.get("editor-js-styles")){var j=O.default.make("style",null,{id:"editor-js-styles",textContent:M.toString()});O.default.prepend(document.head,j)}}},{key:"enableModuleBindings",value:function(){var M=this;this.readOnlyMutableListeners.on(this.nodes.redactor,"click",function(j){M.redactorClicked(j)},!1),this.readOnlyMutableListeners.on(this.nodes.redactor,"mousedown",function(j){M.documentTouched(j)},!0),this.readOnlyMutableListeners.on(this.nodes.redactor,"touchstart",function(j){M.documentTouched(j)},!0),this.readOnlyMutableListeners.on(document,"keydown",function(j){M.documentKeydown(j)},!0),this.readOnlyMutableListeners.on(document,"click",function(j){M.documentClicked(j)},!0),this.readOnlyMutableListeners.on(document,"selectionchange",function(j){M.selectionChanged(j)},!0),this.readOnlyMutableListeners.on(window,"resize",function(){M.resizeDebouncer()},{passive:!0})}},{key:"disableModuleBindings",value:function(){this.readOnlyMutableListeners.clearAll()}},{key:"windowResize",value:function(){this.contentRectCache=null,this.checkIsMobile()}},{key:"documentKeydown",value:function(M){switch(M.keyCode){case d.keyCodes.ENTER:this.enterPressed(M);break;case d.keyCodes.BACKSPACE:this.backspacePressed(M);break;case d.keyCodes.ESC:this.escapePressed(M);break;default:this.defaultBehaviour(M)}}},{key:"defaultBehaviour",value:function(M){var j=this.Editor.BlockManager.currentBlock,J=M.target.closest(".".concat(this.CSS.editorWrapper)),U=M.altKey||M.ctrlKey||M.metaKey||M.shiftKey;j===void 0||J!==null?J||j&&U||(this.Editor.BlockManager.dropPointer(),this.Editor.Toolbar.close()):this.Editor.BlockEvents.keydown(M)}},{key:"backspacePressed",value:function(M){var j=this.Editor,J=j.BlockManager,U=j.BlockSelection,H=j.Caret;if(U.anyBlockSelected&&!_.default.isSelectionExists){var te=J.removeSelectedBlocks();H.setToBlock(J.insertDefaultBlockAtIndex(te,!0),H.positions.START),U.clearSelection(M),M.preventDefault(),M.stopPropagation(),M.stopImmediatePropagation()}}},{key:"escapePressed",value:function(M){this.Editor.BlockSelection.clearSelection(M),this.Editor.Toolbox.opened?this.Editor.Toolbox.close():this.Editor.BlockSettings.opened?this.Editor.BlockSettings.close():this.Editor.ConversionToolbar.opened?this.Editor.ConversionToolbar.close():this.Editor.InlineToolbar.opened?this.Editor.InlineToolbar.close():this.Editor.Toolbar.close()}},{key:"enterPressed",value:function(M){var j=this.Editor,J=j.BlockManager,U=j.BlockSelection,H=J.currentBlockIndex>=0;if(U.anyBlockSelected&&!_.default.isSelectionExists)return U.clearSelection(M),M.preventDefault(),M.stopImmediatePropagation(),void M.stopPropagation();if(!this.someToolbarOpened&&H&&M.target.tagName==="BODY"){var te=this.Editor.BlockManager.insert();this.Editor.Caret.setToBlock(te),this.Editor.BlockManager.highlightCurrentNode(),this.Editor.Toolbar.move(),this.Editor.Toolbar.plusButton.show()}this.Editor.BlockSelection.clearSelection(M)}},{key:"documentClicked",value:function(M){if(M.isTrusted){var j=M.target;this.nodes.holder.contains(j)||_.default.isAtEditor||(this.Editor.BlockManager.dropPointer(),this.Editor.InlineToolbar.close(),this.Editor.Toolbar.close(),this.Editor.ConversionToolbar.close()),this.Editor.CrossBlockSelection.isCrossBlockSelectionStarted||this.Editor.BlockSelection.clearSelection(M)}}},{key:"documentTouched",value:function(M){var j=M.target;if(j===this.nodes.redactor){var J=M instanceof MouseEvent?M.clientX:M.touches[0].clientX,U=M instanceof MouseEvent?M.clientY:M.touches[0].clientY;j=document.elementFromPoint(J,U)}try{this.Editor.BlockManager.setCurrentBlockByChildNode(j),this.Editor.BlockManager.highlightCurrentNode()}catch(H){this.Editor.RectangleSelection.isRectActivated()||this.Editor.Caret.setToTheLastBlock()}this.Editor.Toolbar.open(),this.Editor.Toolbar.plusButton.hide()}},{key:"redactorClicked",value:function(M){if(_.default.isCollapsed){var j=function(){M.stopImmediatePropagation(),M.stopPropagation()},J=M.target,U=M.metaKey||M.ctrlKey;if(O.default.isAnchor(J)&&U){j();var H=J.getAttribute("href"),te=d.getValidUrl(H);d.openTab(te)}else this.Editor.BlockManager.currentBlock||(j(),this.Editor.BlockManager.insert()),this.Editor.BlockManager.currentBlock.tool.isDefault&&(j(),this.Editor.BlockManager.currentBlock.isEmpty&&this.Editor.Toolbar.plusButton.show())}}},{key:"selectionChanged",value:function(M){var j=this.Editor,J=j.CrossBlockSelection,U=j.BlockSelection,H=_.default.anchorElement;J.isCrossBlockSelectionStarted&&U.anyBlockSelected&&_.default.get().removeAllRanges(),H&&H.closest(".".concat(m.default.CSS.content))?(this.Editor.BlockManager.currentBlock||this.Editor.BlockManager.setCurrentBlockByChildNode(H),this.Editor.InlineToolbar.tryToShow(!0)):this.Editor.InlineToolbar.containsNode(H)||this.Editor.InlineToolbar.close()}},{key:"appendSVGSprite",value:function(){var M=O.default.make("div");M.hidden=!0,M.style.display="none",M.innerHTML=k.default,O.default.append(this.nodes.wrapper,M)}},{key:"CSS",get:function(){return{editorWrapper:"codex-editor",editorWrapperNarrow:"codex-editor--narrow",editorZone:"codex-editor__redactor",editorZoneHidden:"codex-editor__redactor--hidden",editorLoader:"codex-editor__loader",editorEmpty:"codex-editor--empty",editorRtlFix:"codex-editor--rtl"}}},{key:"contentRect",get:function(){if(this.contentRectCache)return this.contentRectCache;var M=this.nodes.wrapper.querySelector(".".concat(m.default.CSS.content));return M?(this.contentRectCache=M.getBoundingClientRect(),this.contentRectCache):{width:650,left:0,right:0}}},{key:"someToolbarOpened",get:function(){var M=this.Editor,j=M.Toolbox,J=M.BlockSettings,U=M.InlineToolbar,H=M.ConversionToolbar;return J.opened||U.opened||H.opened||j.opened}},{key:"someFlipperButtonFocused",get:function(){return Object.entries(this.Editor).filter(function(M){var j=(0,o.default)(M,2);return j[0],j[1].flipper instanceof y.default}).some(function(M){var j=(0,o.default)(M,2);return j[0],j[1].flipper.currentItem})}}]),T}(C.default);s.default=E,E.displayName="UI",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){e(184),i.exports=e(356)},function(i,t,e){e(185)},function(i,t,e){"use strict";e(186),e(329),e(331),e(334),e(336),e(338),e(340),e(342),e(344),e(346),e(348),e(350),e(352),e(140)},function(i,t,e){e(187),e(190),e(191),e(192),e(193),e(194),e(195),e(196),e(197),e(198),e(199),e(200),e(201),e(202),e(203),e(204),e(205),e(206),e(207),e(208),e(209),e(210),e(211),e(212),e(213),e(214),e(215),e(216),e(217),e(218),e(219),e(220),e(221),e(222),e(223),e(224),e(225),e(226),e(227),e(228),e(229),e(230),e(231),e(233),e(234),e(235),e(236),e(237),e(238),e(239),e(240),e(241),e(242),e(243),e(244),e(245),e(246),e(247),e(248),e(249),e(250),e(251),e(252),e(253),e(254),e(255),e(256),e(257),e(258),e(259),e(260),e(261),e(262),e(263),e(264),e(265),e(266),e(268),e(269),e(271),e(272),e(273),e(274),e(275),e(276),e(277),e(279),e(280),e(281),e(282),e(283),e(284),e(285),e(286),e(287),e(288),e(289),e(290),e(291),e(102),e(292),e(129),e(293),e(130),e(294),e(295),e(296),e(297),e(131),e(300),e(301),e(302),e(303),e(304),e(305),e(306),e(307),e(308),e(309),e(310),e(311),e(312),e(313),e(314),e(315),e(316),e(317),e(318),e(319),e(320),e(321),e(322),e(323),e(324),e(325),e(326),e(327),e(328),i.exports=e(17)},function(i,t,e){"use strict";var r=e(10),n=e(26),a=e(18),s=e(0),o=e(23),l=e(41).KEY,u=e(11),c=e(67),h=e(53),p=e(44),g=e(14),b=e(83),v=e(110),k=e(189),C=e(70),O=e(12),d=e(13),_=e(20),m=e(28),y=e(40),x=e(43),S=e(48),w=e(113),E=e(34),L=e(69),I=e(19),A=e(46),B=E.f,T=I.f,M=w.f,j=r.Symbol,J=r.JSON,U=J&&J.stringify,H=g("_hidden"),te=g("toPrimitive"),se={}.propertyIsEnumerable,W=c("symbol-registry"),Y=c("symbols"),ie=c("op-symbols"),re=Object.prototype,Q=typeof j=="function"&&!!L.f,ee=r.QObject,pe=!ee||!ee.prototype||!ee.prototype.findChild,be=a&&u(function(){return S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a!=7})?function(ce,ve,Ie){var He=B(re,ve);He&&delete re[ve],T(ce,ve,Ie),He&&ce!==re&&T(re,ve,He)}:T,we=function(ce){var ve=Y[ce]=S(j.prototype);return ve._k=ce,ve},Le=Q&&typeof j.iterator=="symbol"?function(ce){return typeof ce=="symbol"}:function(ce){return ce instanceof j},fe=function(ce,ve,Ie){return ce===re&&fe(ie,ve,Ie),O(ce),ve=y(ve,!0),O(Ie),n(Y,ve)?(Ie.enumerable?(n(ce,H)&&ce[H][ve]&&(ce[H][ve]=!1),Ie=S(Ie,{enumerable:x(0,!1)})):(n(ce,H)||T(ce,H,x(1,{})),ce[H][ve]=!0),be(ce,ve,Ie)):T(ce,ve,Ie)},xe=function(ce,ve){O(ce);for(var Ie,He=k(ve=m(ve)),st=0,vt=He.length;vt>st;)fe(ce,Ie=He[st++],ve[Ie]);return ce},Ne=function(ce){var ve=se.call(this,ce=y(ce,!0));return!(this===re&&n(Y,ce)&&!n(ie,ce))&&(!(ve||!n(this,ce)||!n(Y,ce)||n(this,H)&&this[H][ce])||ve)},Be=function(ce,ve){if(ce=m(ce),ve=y(ve,!0),ce!==re||!n(Y,ve)||n(ie,ve)){var Ie=B(ce,ve);return!Ie||!n(Y,ve)||n(ce,H)&&ce[H][ve]||(Ie.enumerable=!0),Ie}},Pe=function(ce){for(var ve,Ie=M(m(ce)),He=[],st=0;Ie.length>st;)n(Y,ve=Ie[st++])||ve==H||ve==l||He.push(ve);return He},Ze=function(ce){for(var ve,Ie=ce===re,He=M(Ie?ie:m(ce)),st=[],vt=0;He.length>vt;)!n(Y,ve=He[vt++])||Ie&&!n(re,ve)||st.push(Y[ve]);return st};Q||(o((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var ce=p(arguments.length>0?arguments[0]:void 0),ve=function(Ie){this===re&&ve.call(ie,Ie),n(this,H)&&n(this[H],ce)&&(this[H][ce]=!1),be(this,ce,x(1,Ie))};return a&&pe&&be(re,ce,{configurable:!0,set:ve}),we(ce)}).prototype,"toString",function(){return this._k}),E.f=Be,I.f=fe,e(49).f=w.f=Pe,e(63).f=Ne,L.f=Ze,a&&!e(45)&&o(re,"propertyIsEnumerable",Ne,!0),b.f=function(ce){return we(g(ce))}),s(s.G+s.W+s.F*!Q,{Symbol:j});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Xe=0;tt.length>Xe;)g(tt[Xe++]);for(var Ke=A(g.store),nt=0;Ke.length>nt;)v(Ke[nt++]);s(s.S+s.F*!Q,"Symbol",{for:function(ce){return n(W,ce+="")?W[ce]:W[ce]=j(ce)},keyFor:function(ce){if(!Le(ce))throw TypeError(ce+" is not a symbol!");for(var ve in W)if(W[ve]===ce)return ve},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),s(s.S+s.F*!Q,"Object",{create:function(ce,ve){return ve===void 0?S(ce):xe(S(ce),ve)},defineProperty:fe,defineProperties:xe,getOwnPropertyDescriptor:Be,getOwnPropertyNames:Pe,getOwnPropertySymbols:Ze});var at=u(function(){L.f(1)});s(s.S+s.F*at,"Object",{getOwnPropertySymbols:function(ce){return L.f(_(ce))}}),J&&s(s.S+s.F*(!Q||u(function(){var ce=j();return U([ce])!="[null]"||U({a:ce})!="{}"||U(Object(ce))!="{}"})),"JSON",{stringify:function(ce){for(var ve,Ie,He=[ce],st=1;arguments.length>st;)He.push(arguments[st++]);if(Ie=ve=He[1],(d(ve)||ce!==void 0)&&!Le(ce))return C(ve)||(ve=function(vt,bt){if(typeof Ie=="function"&&(bt=Ie.call(this,vt,bt)),!Le(bt))return bt}),He[1]=ve,U.apply(J,He)}}),j.prototype[te]||e(27)(j.prototype,te,j.prototype.valueOf),h(j,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(i,t,e){i.exports=e(67)("native-function-to-string",Function.toString)},function(i,t,e){var r=e(46),n=e(69),a=e(63);i.exports=function(s){var o=r(s),l=n.f;if(l)for(var u,c=l(s),h=a.f,p=0;c.length>p;)h.call(s,u=c[p++])&&o.push(u);return o}},function(i,t,e){var r=e(0);r(r.S,"Object",{create:e(48)})},function(i,t,e){var r=e(0);r(r.S+r.F*!e(18),"Object",{defineProperty:e(19).f})},function(i,t,e){var r=e(0);r(r.S+r.F*!e(18),"Object",{defineProperties:e(112)})},function(i,t,e){var r=e(28),n=e(34).f;e(35)("getOwnPropertyDescriptor",function(){return function(a,s){return n(r(a),s)}})},function(i,t,e){var r=e(20),n=e(50);e(35)("getPrototypeOf",function(){return function(a){return n(r(a))}})},function(i,t,e){var r=e(20),n=e(46);e(35)("keys",function(){return function(a){return n(r(a))}})},function(i,t,e){e(35)("getOwnPropertyNames",function(){return e(113).f})},function(i,t,e){var r=e(13),n=e(41).onFreeze;e(35)("freeze",function(a){return function(s){return a&&r(s)?a(n(s)):s}})},function(i,t,e){var r=e(13),n=e(41).onFreeze;e(35)("seal",function(a){return function(s){return a&&r(s)?a(n(s)):s}})},function(i,t,e){var r=e(13),n=e(41).onFreeze;e(35)("preventExtensions",function(a){return function(s){return a&&r(s)?a(n(s)):s}})},function(i,t,e){var r=e(13);e(35)("isFrozen",function(n){return function(a){return!r(a)||!!n&&n(a)}})},function(i,t,e){var r=e(13);e(35)("isSealed",function(n){return function(a){return!r(a)||!!n&&n(a)}})},function(i,t,e){var r=e(13);e(35)("isExtensible",function(n){return function(a){return!!r(a)&&(!n||n(a))}})},function(i,t,e){var r=e(0);r(r.S+r.F,"Object",{assign:e(114)})},function(i,t,e){var r=e(0);r(r.S,"Object",{is:e(115)})},function(i,t,e){var r=e(0);r(r.S,"Object",{setPrototypeOf:e(87).set})},function(i,t,e){"use strict";var r=e(64),n={};n[e(14)("toStringTag")]="z",n+""!="[object z]"&&e(23)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(i,t,e){var r=e(0);r(r.P,"Function",{bind:e(116)})},function(i,t,e){var r=e(19).f,n=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in n||e(18)&&r(n,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(s){return""}}})},function(i,t,e){"use strict";var r=e(13),n=e(50),a=e(14)("hasInstance"),s=Function.prototype;a in s||e(19).f(s,a,{value:function(o){if(typeof this!="function"||!r(o))return!1;if(!r(this.prototype))return o instanceof this;for(;o=n(o);)if(this.prototype===o)return!0;return!1}})},function(i,t,e){var r=e(0),n=e(118);r(r.G+r.F*(parseInt!=n),{parseInt:n})},function(i,t,e){var r=e(0),n=e(119);r(r.G+r.F*(parseFloat!=n),{parseFloat:n})},function(i,t,e){"use strict";var r=e(10),n=e(26),a=e(37),s=e(89),o=e(40),l=e(11),u=e(49).f,c=e(34).f,h=e(19).f,p=e(54).trim,g=r.Number,b=g,v=g.prototype,k=a(e(48)(v))=="Number",C="trim"in String.prototype,O=function(y){var x=o(y,!1);if(typeof x=="string"&&x.length>2){var S,w,E,L=(x=C?x.trim():p(x,3)).charCodeAt(0);if(L===43||L===45){if((S=x.charCodeAt(2))===88||S===120)return NaN}else if(L===48){switch(x.charCodeAt(1)){case 66:case 98:w=2,E=49;break;case 79:case 111:w=8,E=55;break;default:return+x}for(var I,A=x.slice(2),B=0,T=A.length;B<T;B++)if((I=A.charCodeAt(B))<48||I>E)return NaN;return parseInt(A,w)}}return+x};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(y){var x=arguments.length<1?0:y,S=this;return S instanceof g&&(k?l(function(){v.valueOf.call(S)}):a(S)!="Number")?s(new b(O(x)),S,g):O(x)};for(var d,_=e(18)?u(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),m=0;_.length>m;m++)n(b,d=_[m])&&!n(g,d)&&h(g,d,c(b,d));g.prototype=v,v.constructor=g,e(23)(r,"Number",g)}},function(i,t,e){"use strict";var r=e(0),n=e(33),a=e(120),s=e(90),o=1 .toFixed,l=Math.floor,u=[0,0,0,0,0,0],c="Number.toFixed: incorrect invocation!",h=function(v,k){for(var C=-1,O=k;++C<6;)O+=v*u[C],u[C]=O%1e7,O=l(O/1e7)},p=function(v){for(var k=6,C=0;--k>=0;)C+=u[k],u[k]=l(C/v),C=C%v*1e7},g=function(){for(var v=6,k="";--v>=0;)if(k!==""||v===0||u[v]!==0){var C=String(u[v]);k=k===""?C:k+s.call("0",7-C.length)+C}return k},b=function(v,k,C){return k===0?C:k%2==1?b(v,k-1,C*v):b(v*v,k/2,C)};r(r.P+r.F*(!!o&&(8e-5 .toFixed(3)!=="0.000"||.9 .toFixed(0)!=="1"||1.255 .toFixed(2)!=="1.25"||1000000000000000100 .toFixed(0)!=="1000000000000000128")||!e(11)(function(){o.call({})})),"Number",{toFixed:function(v){var k,C,O,d,_=a(this,c),m=n(v),y="",x="0";if(m<0||m>20)throw RangeError(c);if(_!=_)return"NaN";if(_<=-1e21||_>=1e21)return String(_);if(_<0&&(y="-",_=-_),_>1e-21)if(C=(k=function(S){for(var w=0,E=S;E>=4096;)w+=12,E/=4096;for(;E>=2;)w+=1,E/=2;return w}(_*b(2,69,1))-69)<0?_*b(2,-k,1):_/b(2,k,1),C*=4503599627370496,(k=52-k)>0){for(h(0,C),O=m;O>=7;)h(1e7,0),O-=7;for(h(b(10,O,1),0),O=k-1;O>=23;)p(1<<23),O-=23;p(1<<O),h(1,1),p(2),x=g()}else h(0,C),h(1<<-k,0),x=g()+s.call("0",m);return x=m>0?y+((d=x.length)<=m?"0."+s.call("0",m-d)+x:x.slice(0,d-m)+"."+x.slice(d-m)):y+x}})},function(i,t,e){"use strict";var r=e(0),n=e(11),a=e(120),s=1 .toPrecision;r(r.P+r.F*(n(function(){return s.call(1,void 0)!=="1"})||!n(function(){s.call({})})),"Number",{toPrecision:function(o){var l=a(this,"Number#toPrecision: incorrect invocation!");return o===void 0?s.call(l):s.call(l,o)}})},function(i,t,e){var r=e(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(i,t,e){var r=e(0),n=e(10).isFinite;r(r.S,"Number",{isFinite:function(a){return typeof a=="number"&&n(a)}})},function(i,t,e){var r=e(0);r(r.S,"Number",{isInteger:e(121)})},function(i,t,e){var r=e(0);r(r.S,"Number",{isNaN:function(n){return n!=n}})},function(i,t,e){var r=e(0),n=e(121),a=Math.abs;r(r.S,"Number",{isSafeInteger:function(s){return n(s)&&a(s)<=9007199254740991}})},function(i,t,e){var r=e(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(i,t,e){var r=e(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(i,t,e){var r=e(0),n=e(119);r(r.S+r.F*(Number.parseFloat!=n),"Number",{parseFloat:n})},function(i,t,e){var r=e(0),n=e(118);r(r.S+r.F*(Number.parseInt!=n),"Number",{parseInt:n})},function(i,t,e){var r=e(0),n=e(122),a=Math.sqrt,s=Math.acosh;r(r.S+r.F*!(s&&Math.floor(s(Number.MAX_VALUE))==710&&s(1/0)==1/0),"Math",{acosh:function(o){return(o=+o)<1?NaN:o>9490626562425156e-8?Math.log(o)+Math.LN2:n(o-1+a(o-1)*a(o+1))}})},function(i,t,e){var r=e(0),n=Math.asinh;r(r.S+r.F*!(n&&1/n(0)>0),"Math",{asinh:function a(s){return isFinite(s=+s)&&s!=0?s<0?-a(-s):Math.log(s+Math.sqrt(s*s+1)):s}})},function(i,t,e){var r=e(0),n=Math.atanh;r(r.S+r.F*!(n&&1/n(-0)<0),"Math",{atanh:function(a){return(a=+a)==0?a:Math.log((1+a)/(1-a))/2}})},function(i,t,e){var r=e(0),n=e(91);r(r.S,"Math",{cbrt:function(a){return n(a=+a)*Math.pow(Math.abs(a),1/3)}})},function(i,t,e){var r=e(0);r(r.S,"Math",{clz32:function(n){return(n>>>=0)?31-Math.floor(Math.log(n+.5)*Math.LOG2E):32}})},function(i,t,e){var r=e(0),n=Math.exp;r(r.S,"Math",{cosh:function(a){return(n(a=+a)+n(-a))/2}})},function(i,t,e){var r=e(0),n=e(92);r(r.S+r.F*(n!=Math.expm1),"Math",{expm1:n})},function(i,t,e){var r=e(0);r(r.S,"Math",{fround:e(232)})},function(i,t,e){var r=e(91),n=Math.pow,a=n(2,-52),s=n(2,-23),o=n(2,127)*(2-s),l=n(2,-126);i.exports=Math.fround||function(u){var c,h,p=Math.abs(u),g=r(u);return p<l?g*(p/l/s+1/a-1/a)*l*s:(h=(c=(1+s/a)*p)-(c-p))>o||h!=h?g*(1/0):g*h}},function(i,t,e){var r=e(0),n=Math.abs;r(r.S,"Math",{hypot:function(a,s){for(var o,l,u=0,c=0,h=arguments.length,p=0;c<h;)p<(o=n(arguments[c++]))?(u=u*(l=p/o)*l+1,p=o):u+=o>0?(l=o/p)*l:o;return p===1/0?1/0:p*Math.sqrt(u)}})},function(i,t,e){var r=e(0),n=Math.imul;r(r.S+r.F*e(11)(function(){return n(4294967295,5)!=-5||n.length!=2}),"Math",{imul:function(a,s){var o=+a,l=+s,u=65535&o,c=65535&l;return 0|u*c+((65535&o>>>16)*c+u*(65535&l>>>16)<<16>>>0)}})},function(i,t,e){var r=e(0);r(r.S,"Math",{log10:function(n){return Math.log(n)*Math.LOG10E}})},function(i,t,e){var r=e(0);r(r.S,"Math",{log1p:e(122)})},function(i,t,e){var r=e(0);r(r.S,"Math",{log2:function(n){return Math.log(n)/Math.LN2}})},function(i,t,e){var r=e(0);r(r.S,"Math",{sign:e(91)})},function(i,t,e){var r=e(0),n=e(92),a=Math.exp;r(r.S+r.F*e(11)(function(){return!Math.sinh(-2e-17)!=-2e-17}),"Math",{sinh:function(s){return Math.abs(s=+s)<1?(n(s)-n(-s))/2:(a(s-1)-a(-s-1))*(Math.E/2)}})},function(i,t,e){var r=e(0),n=e(92),a=Math.exp;r(r.S,"Math",{tanh:function(s){var o=n(s=+s),l=n(-s);return o==1/0?1:l==1/0?-1:(o-l)/(a(s)+a(-s))}})},function(i,t,e){var r=e(0);r(r.S,"Math",{trunc:function(n){return(n>0?Math.floor:Math.ceil)(n)}})},function(i,t,e){var r=e(0),n=e(47),a=String.fromCharCode,s=String.fromCodePoint;r(r.S+r.F*(!!s&&s.length!=1),"String",{fromCodePoint:function(o){for(var l,u=[],c=arguments.length,h=0;c>h;){if(l=+arguments[h++],n(l,1114111)!==l)throw RangeError(l+" is not a valid code point");u.push(l<65536?a(l):a(55296+((l-=65536)>>10),l%1024+56320))}return u.join("")}})},function(i,t,e){var r=e(0),n=e(28),a=e(16);r(r.S,"String",{raw:function(s){for(var o=n(s.raw),l=a(o.length),u=arguments.length,c=[],h=0;l>h;)c.push(String(o[h++])),h<u&&c.push(String(arguments[h]));return c.join("")}})},function(i,t,e){"use strict";e(54)("trim",function(r){return function(){return r(this,3)}})},function(i,t,e){"use strict";var r=e(93)(!0);e(94)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n,a=this._t,s=this._i;return s>=a.length?{value:void 0,done:!0}:(n=r(a,s),this._i+=n.length,{value:n,done:!1})})},function(i,t,e){"use strict";var r=e(0),n=e(93)(!1);r(r.P,"String",{codePointAt:function(a){return n(this,a)}})},function(i,t,e){"use strict";var r=e(0),n=e(16),a=e(95),s="".endsWith;r(r.P+r.F*e(97)("endsWith"),"String",{endsWith:function(o){var l=a(this,o,"endsWith"),u=arguments.length>1?arguments[1]:void 0,c=n(l.length),h=u===void 0?c:Math.min(n(u),c),p=String(o);return s?s.call(l,p,h):l.slice(h-p.length,h)===p}})},function(i,t,e){"use strict";var r=e(0),n=e(95);r(r.P+r.F*e(97)("includes"),"String",{includes:function(a){return!!~n(this,a,"includes").indexOf(a,arguments.length>1?arguments[1]:void 0)}})},function(i,t,e){var r=e(0);r(r.P,"String",{repeat:e(90)})},function(i,t,e){"use strict";var r=e(0),n=e(16),a=e(95),s="".startsWith;r(r.P+r.F*e(97)("startsWith"),"String",{startsWith:function(o){var l=a(this,o,"startsWith"),u=n(Math.min(arguments.length>1?arguments[1]:void 0,l.length)),c=String(o);return s?s.call(l,c,u):l.slice(u,u+c.length)===c}})},function(i,t,e){"use strict";e(24)("anchor",function(r){return function(n){return r(this,"a","name",n)}})},function(i,t,e){"use strict";e(24)("big",function(r){return function(){return r(this,"big","","")}})},function(i,t,e){"use strict";e(24)("blink",function(r){return function(){return r(this,"blink","","")}})},function(i,t,e){"use strict";e(24)("bold",function(r){return function(){return r(this,"b","","")}})},function(i,t,e){"use strict";e(24)("fixed",function(r){return function(){return r(this,"tt","","")}})},function(i,t,e){"use strict";e(24)("fontcolor",function(r){return function(n){return r(this,"font","color",n)}})},function(i,t,e){"use strict";e(24)("fontsize",function(r){return function(n){return r(this,"font","size",n)}})},function(i,t,e){"use strict";e(24)("italics",function(r){return function(){return r(this,"i","","")}})},function(i,t,e){"use strict";e(24)("link",function(r){return function(n){return r(this,"a","href",n)}})},function(i,t,e){"use strict";e(24)("small",function(r){return function(){return r(this,"small","","")}})},function(i,t,e){"use strict";e(24)("strike",function(r){return function(){return r(this,"strike","","")}})},function(i,t,e){"use strict";e(24)("sub",function(r){return function(){return r(this,"sub","","")}})},function(i,t,e){"use strict";e(24)("sup",function(r){return function(){return r(this,"sup","","")}})},function(i,t,e){var r=e(0);r(r.S,"Date",{now:function(){return new Date().getTime()}})},function(i,t,e){"use strict";var r=e(0),n=e(20),a=e(40);r(r.P+r.F*e(11)(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1}),"Date",{toJSON:function(s){var o=n(this),l=a(o);return typeof l!="number"||isFinite(l)?o.toISOString():null}})},function(i,t,e){var r=e(0),n=e(267);r(r.P+r.F*(Date.prototype.toISOString!==n),"Date",{toISOString:n})},function(i,t,e){"use strict";var r=e(11),n=Date.prototype.getTime,a=Date.prototype.toISOString,s=function(o){return o>9?o:"0"+o};i.exports=r(function(){return a.call(new Date(-50000000000001))!="0385-07-25T07:06:39.999Z"})||!r(function(){a.call(new Date(NaN))})?function(){if(!isFinite(n.call(this)))throw RangeError("Invalid time value");var o=this,l=o.getUTCFullYear(),u=o.getUTCMilliseconds(),c=l<0?"-":l>9999?"+":"";return c+("00000"+Math.abs(l)).slice(c?-6:-4)+"-"+s(o.getUTCMonth()+1)+"-"+s(o.getUTCDate())+"T"+s(o.getUTCHours())+":"+s(o.getUTCMinutes())+":"+s(o.getUTCSeconds())+"."+(u>99?u:"0"+s(u))+"Z"}:a},function(i,t,e){var r=Date.prototype,n=r.toString,a=r.getTime;new Date(NaN)+""!="Invalid Date"&&e(23)(r,"toString",function(){var s=a.call(this);return s==s?n.call(this):"Invalid Date"})},function(i,t,e){var r=e(14)("toPrimitive"),n=Date.prototype;r in n||e(27)(n,r,e(270))},function(i,t,e){"use strict";var r=e(12),n=e(40);i.exports=function(a){if(a!=="string"&&a!=="number"&&a!=="default")throw TypeError("Incorrect hint");return n(r(this),a!="number")}},function(i,t,e){var r=e(0);r(r.S,"Array",{isArray:e(70)})},function(i,t,e){"use strict";var r=e(31),n=e(0),a=e(20),s=e(124),o=e(98),l=e(16),u=e(99),c=e(100);n(n.S+n.F*!e(71)(function(h){Array.from(h)}),"Array",{from:function(h){var p,g,b,v,k=a(h),C=typeof this=="function"?this:Array,O=arguments.length,d=O>1?arguments[1]:void 0,_=d!==void 0,m=0,y=c(k);if(_&&(d=r(d,O>2?arguments[2]:void 0,2)),y==null||C==Array&&o(y))for(g=new C(p=l(k.length));p>m;m++)u(g,m,_?d(k[m],m):k[m]);else for(v=y.call(k),g=new C;!(b=v.next()).done;m++)u(g,m,_?s(v,d,[b.value,m],!0):b.value);return g.length=m,g}})},function(i,t,e){"use strict";var r=e(0),n=e(99);r(r.S+r.F*e(11)(function(){function a(){}return!(Array.of.call(a)instanceof a)}),"Array",{of:function(){for(var a=0,s=arguments.length,o=new(typeof this=="function"?this:Array)(s);s>a;)n(o,a,arguments[a++]);return o.length=s,o}})},function(i,t,e){"use strict";var r=e(0),n=e(28),a=[].join;r(r.P+r.F*(e(62)!=Object||!e(30)(a)),"Array",{join:function(s){return a.call(n(this),s===void 0?",":s)}})},function(i,t,e){"use strict";var r=e(0),n=e(86),a=e(37),s=e(47),o=e(16),l=[].slice;r(r.P+r.F*e(11)(function(){n&&l.call(n)}),"Array",{slice:function(u,c){var h=o(this.length),p=a(this);if(c=c===void 0?h:c,p=="Array")return l.call(this,u,c);for(var g=s(u,h),b=s(c,h),v=o(b-g),k=new Array(v),C=0;C<v;C++)k[C]=p=="String"?this.charAt(g+C):this[g+C];return k}})},function(i,t,e){"use strict";var r=e(0),n=e(32),a=e(20),s=e(11),o=[].sort,l=[1,2,3];r(r.P+r.F*(s(function(){l.sort(void 0)})||!s(function(){l.sort(null)})||!e(30)(o)),"Array",{sort:function(u){return u===void 0?o.call(a(this)):o.call(a(this),n(u))}})},function(i,t,e){"use strict";var r=e(0),n=e(36)(0),a=e(30)([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(s){return n(this,s,arguments[1])}})},function(i,t,e){var r=e(13),n=e(70),a=e(14)("species");i.exports=function(s){var o;return n(s)&&(typeof(o=s.constructor)!="function"||o!==Array&&!n(o.prototype)||(o=void 0),r(o)&&(o=o[a])===null&&(o=void 0)),o===void 0?Array:o}},function(i,t,e){"use strict";var r=e(0),n=e(36)(1);r(r.P+r.F*!e(30)([].map,!0),"Array",{map:function(a){return n(this,a,arguments[1])}})},function(i,t,e){"use strict";var r=e(0),n=e(36)(2);r(r.P+r.F*!e(30)([].filter,!0),"Array",{filter:function(a){return n(this,a,arguments[1])}})},function(i,t,e){"use strict";var r=e(0),n=e(36)(3);r(r.P+r.F*!e(30)([].some,!0),"Array",{some:function(a){return n(this,a,arguments[1])}})},function(i,t,e){"use strict";var r=e(0),n=e(36)(4);r(r.P+r.F*!e(30)([].every,!0),"Array",{every:function(a){return n(this,a,arguments[1])}})},function(i,t,e){"use strict";var r=e(0),n=e(126);r(r.P+r.F*!e(30)([].reduce,!0),"Array",{reduce:function(a){return n(this,a,arguments.length,arguments[1],!1)}})},function(i,t,e){"use strict";var r=e(0),n=e(126);r(r.P+r.F*!e(30)([].reduceRight,!0),"Array",{reduceRight:function(a){return n(this,a,arguments.length,arguments[1],!0)}})},function(i,t,e){"use strict";var r=e(0),n=e(68)(!1),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(s||!e(30)(a)),"Array",{indexOf:function(o){return s?a.apply(this,arguments)||0:n(this,o,arguments[1])}})},function(i,t,e){"use strict";var r=e(0),n=e(28),a=e(33),s=e(16),o=[].lastIndexOf,l=!!o&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(l||!e(30)(o)),"Array",{lastIndexOf:function(u){if(l)return o.apply(this,arguments)||0;var c=n(this),h=s(c.length),p=h-1;for(arguments.length>1&&(p=Math.min(p,a(arguments[1]))),p<0&&(p=h+p);p>=0;p--)if(p in c&&c[p]===u)return p||0;return-1}})},function(i,t,e){var r=e(0);r(r.P,"Array",{copyWithin:e(127)}),e(51)("copyWithin")},function(i,t,e){var r=e(0);r(r.P,"Array",{fill:e(101)}),e(51)("fill")},function(i,t,e){"use strict";var r=e(0),n=e(36)(5),a=!0;"find"in[]&&Array(1).find(function(){a=!1}),r(r.P+r.F*a,"Array",{find:function(s){return n(this,s,arguments.length>1?arguments[1]:void 0)}}),e(51)("find")},function(i,t,e){"use strict";var r=e(0),n=e(36)(6),a="findIndex",s=!0;a in[]&&Array(1)[a](function(){s=!1}),r(r.P+r.F*s,"Array",{findIndex:function(o){return n(this,o,arguments.length>1?arguments[1]:void 0)}}),e(51)(a)},function(i,t,e){e(56)("Array")},function(i,t,e){var r=e(10),n=e(89),a=e(19).f,s=e(49).f,o=e(96),l=e(72),u=r.RegExp,c=u,h=u.prototype,p=/a/g,g=/a/g,b=new u(p)!==p;if(e(18)&&(!b||e(11)(function(){return g[e(14)("match")]=!1,u(p)!=p||u(g)==g||u(p,"i")!="/a/i"}))){u=function(O,d){var _=this instanceof u,m=o(O),y=d===void 0;return!_&&m&&O.constructor===u&&y?O:n(b?new c(m&&!y?O.source:O,d):c((m=O instanceof u)?O.source:O,m&&y?l.call(O):d),_?this:h,u)};for(var v=function(O){O in u||a(u,O,{configurable:!0,get:function(){return c[O]},set:function(d){c[O]=d}})},k=s(c),C=0;k.length>C;)v(k[C++]);h.constructor=u,u.prototype=h,e(23)(r,"RegExp",u)}e(56)("RegExp")},function(i,t,e){"use strict";e(130);var r=e(12),n=e(72),a=e(18),s=/./.toString,o=function(l){e(23)(RegExp.prototype,"toString",l,!0)};e(11)(function(){return s.call({source:"a",flags:"b"})!="/a/b"})?o(function(){var l=r(this);return"/".concat(l.source,"/","flags"in l?l.flags:!a&&l instanceof RegExp?n.call(l):void 0)}):s.name!="toString"&&o(function(){return s.call(this)})},function(i,t,e){"use strict";var r=e(12),n=e(16),a=e(104),s=e(73);e(74)("match",1,function(o,l,u,c){return[function(h){var p=o(this),g=h==null?void 0:h[l];return g!==void 0?g.call(h,p):new RegExp(h)[l](String(p))},function(h){var p=c(u,h,this);if(p.done)return p.value;var g=r(h),b=String(this);if(!g.global)return s(g,b);var v=g.unicode;g.lastIndex=0;for(var k,C=[],O=0;(k=s(g,b))!==null;){var d=String(k[0]);C[O]=d,d===""&&(g.lastIndex=a(b,n(g.lastIndex),v)),O++}return O===0?null:C}]})},function(i,t,e){"use strict";var r=e(12),n=e(20),a=e(16),s=e(33),o=e(104),l=e(73),u=Math.max,c=Math.min,h=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,g=/\$([$&`']|\d\d?)/g;e(74)("replace",2,function(b,v,k,C){return[function(d,_){var m=b(this),y=d==null?void 0:d[v];return y!==void 0?y.call(d,m,_):k.call(String(m),d,_)},function(d,_){var m=C(k,d,this,_);if(m.done)return m.value;var y=r(d),x=String(this),S=typeof _=="function";S||(_=String(_));var w=y.global;if(w){var E=y.unicode;y.lastIndex=0}for(var L=[];;){var I=l(y,x);if(I===null||(L.push(I),!w))break;String(I[0])===""&&(y.lastIndex=o(x,a(y.lastIndex),E))}for(var A,B="",T=0,M=0;M<L.length;M++){I=L[M];for(var j=String(I[0]),J=u(c(s(I.index),x.length),0),U=[],H=1;H<I.length;H++)U.push((A=I[H])===void 0?A:String(A));var te=I.groups;if(S){var se=[j].concat(U,J,x);te!==void 0&&se.push(te);var W=String(_.apply(void 0,se))}else W=O(j,x,J,U,te,_);J>=T&&(B+=x.slice(T,J)+W,T=J+j.length)}return B+x.slice(T)}];function O(d,_,m,y,x,S){var w=m+d.length,E=y.length,L=g;return x!==void 0&&(x=n(x),L=p),k.call(S,L,function(I,A){var B;switch(A.charAt(0)){case"$":return"$";case"&":return d;case"`":return _.slice(0,m);case"'":return _.slice(w);case"<":B=x[A.slice(1,-1)];break;default:var T=+A;if(T===0)return I;if(T>E){var M=h(T/10);return M===0?I:M<=E?y[M-1]===void 0?A.charAt(1):y[M-1]+A.charAt(1):I}B=y[T-1]}return B===void 0?"":B})}})},function(i,t,e){"use strict";var r=e(12),n=e(115),a=e(73);e(74)("search",1,function(s,o,l,u){return[function(c){var h=s(this),p=c==null?void 0:c[o];return p!==void 0?p.call(c,h):new RegExp(c)[o](String(h))},function(c){var h=u(l,c,this);if(h.done)return h.value;var p=r(c),g=String(this),b=p.lastIndex;n(b,0)||(p.lastIndex=0);var v=a(p,g);return n(p.lastIndex,b)||(p.lastIndex=b),v===null?-1:v.index}]})},function(i,t,e){"use strict";var r=e(96),n=e(12),a=e(65),s=e(104),o=e(16),l=e(73),u=e(103),c=e(11),h=Math.min,p=[].push,g="length",b=!c(function(){RegExp(4294967295,"y")});e(74)("split",2,function(v,k,C,O){var d;return d="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1)[g]!=4||"ab".split(/(?:ab)*/)[g]!=2||".".split(/(.?)(.?)/)[g]!=4||".".split(/()()/)[g]>1||"".split(/.?/)[g]?function(_,m){var y=String(this);if(_===void 0&&m===0)return[];if(!r(_))return C.call(y,_,m);for(var x,S,w,E=[],L=(_.ignoreCase?"i":"")+(_.multiline?"m":"")+(_.unicode?"u":"")+(_.sticky?"y":""),I=0,A=m===void 0?4294967295:m>>>0,B=new RegExp(_.source,L+"g");(x=u.call(B,y))&&!((S=B.lastIndex)>I&&(E.push(y.slice(I,x.index)),x[g]>1&&x.index<y[g]&&p.apply(E,x.slice(1)),w=x[0][g],I=S,E[g]>=A));)B.lastIndex===x.index&&B.lastIndex++;return I===y[g]?!w&&B.test("")||E.push(""):E.push(y.slice(I)),E[g]>A?E.slice(0,A):E}:"0".split(void 0,0)[g]?function(_,m){return _===void 0&&m===0?[]:C.call(this,_,m)}:C,[function(_,m){var y=v(this),x=_==null?void 0:_[k];return x!==void 0?x.call(_,y,m):d.call(String(y),_,m)},function(_,m){var y=O(d,_,this,m,d!==C);if(y.done)return y.value;var x=n(_),S=String(this),w=a(x,RegExp),E=x.unicode,L=(x.ignoreCase?"i":"")+(x.multiline?"m":"")+(x.unicode?"u":"")+(b?"y":"g"),I=new w(b?x:"^(?:"+x.source+")",L),A=m===void 0?4294967295:m>>>0;if(A===0)return[];if(S.length===0)return l(I,S)===null?[S]:[];for(var B=0,T=0,M=[];T<S.length;){I.lastIndex=b?T:0;var j,J=l(I,b?S:S.slice(T));if(J===null||(j=h(o(I.lastIndex+(b?0:T)),S.length))===B)T=s(S,T,E);else{if(M.push(S.slice(B,T)),M.length===A)return M;for(var U=1;U<=J.length-1;U++)if(M.push(J[U]),M.length===A)return M;T=B=j}}return M.push(S.slice(B)),M}]})},function(i,t,e){var r=e(10),n=e(105).set,a=r.MutationObserver||r.WebKitMutationObserver,s=r.process,o=r.Promise,l=e(37)(s)=="process";i.exports=function(){var u,c,h,p=function(){var k,C;for(l&&(k=s.domain)&&k.exit();u;){C=u.fn,u=u.next;try{C()}catch(O){throw u?h():c=void 0,O}}c=void 0,k&&k.enter()};if(l)h=function(){s.nextTick(p)};else if(!a||r.navigator&&r.navigator.standalone)if(o&&o.resolve){var g=o.resolve(void 0);h=function(){g.then(p)}}else h=function(){n.call(r,p)};else{var b=!0,v=document.createTextNode("");new a(p).observe(v,{characterData:!0}),h=function(){v.data=b=!b}}return function(k){var C={fn:k,next:void 0};c&&(c.next=C),u||(u=C,h()),c=C}}},function(i,t){i.exports=function(e){try{return{e:!1,v:e()}}catch(r){return{e:!0,v:r}}}},function(i,t,e){"use strict";var r=e(134),n=e(52);i.exports=e(77)("Map",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{get:function(a){var s=r.getEntry(n(this,"Map"),a);return s&&s.v},set:function(a,s){return r.def(n(this,"Map"),a===0?0:a,s)}},r,!0)},function(i,t,e){"use strict";var r=e(134),n=e(52);i.exports=e(77)("Set",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{add:function(a){return r.def(n(this,"Set"),a=a===0?0:a,a)}},r)},function(i,t,e){"use strict";var r,n=e(10),a=e(36)(0),s=e(23),o=e(41),l=e(114),u=e(135),c=e(13),h=e(52),p=e(52),g=!n.ActiveXObject&&"ActiveXObject"in n,b=o.getWeak,v=Object.isExtensible,k=u.ufstore,C=function(_){return function(){return _(this,arguments.length>0?arguments[0]:void 0)}},O={get:function(_){if(c(_)){var m=b(_);return m===!0?k(h(this,"WeakMap")).get(_):m?m[this._i]:void 0}},set:function(_,m){return u.def(h(this,"WeakMap"),_,m)}},d=i.exports=e(77)("WeakMap",C,O,u,!0,!0);p&&g&&(l((r=u.getConstructor(C,"WeakMap")).prototype,O),o.NEED=!0,a(["delete","has","get","set"],function(_){var m=d.prototype,y=m[_];s(m,_,function(x,S){if(c(x)&&!v(x)){this._f||(this._f=new r);var w=this._f[_](x,S);return _=="set"?this:w}return y.call(this,x,S)})}))},function(i,t,e){"use strict";var r=e(135),n=e(52);e(77)("WeakSet",function(a){return function(){return a(this,arguments.length>0?arguments[0]:void 0)}},{add:function(a){return r.def(n(this,"WeakSet"),a,!0)}},r,!1,!0)},function(i,t,e){"use strict";var r=e(0),n=e(78),a=e(106),s=e(12),o=e(47),l=e(16),u=e(13),c=e(10).ArrayBuffer,h=e(65),p=a.ArrayBuffer,g=a.DataView,b=n.ABV&&c.isView,v=p.prototype.slice,k=n.VIEW;r(r.G+r.W+r.F*(c!==p),{ArrayBuffer:p}),r(r.S+r.F*!n.CONSTR,"ArrayBuffer",{isView:function(C){return b&&b(C)||u(C)&&k in C}}),r(r.P+r.U+r.F*e(11)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(C,O){if(v!==void 0&&O===void 0)return v.call(s(this),C);for(var d=s(this).byteLength,_=o(C,d),m=o(O===void 0?d:O,d),y=new(h(this,p))(l(m-_)),x=new g(this),S=new g(y),w=0;_<m;)S.setUint8(w++,x.getUint8(_++));return y}}),e(56)("ArrayBuffer")},function(i,t,e){var r=e(0);r(r.G+r.W+r.F*!e(78).ABV,{DataView:e(106).DataView})},function(i,t,e){e(39)("Int8",1,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Uint8",1,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Uint8",1,function(r){return function(n,a,s){return r(this,n,a,s)}},!0)},function(i,t,e){e(39)("Int16",2,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Uint16",2,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Int32",4,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Uint32",4,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Float32",4,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){e(39)("Float64",8,function(r){return function(n,a,s){return r(this,n,a,s)}})},function(i,t,e){var r=e(0),n=e(32),a=e(12),s=(e(10).Reflect||{}).apply,o=Function.apply;r(r.S+r.F*!e(11)(function(){s(function(){})}),"Reflect",{apply:function(l,u,c){var h=n(l),p=a(c);return s?s(h,u,p):o.call(h,u,p)}})},function(i,t,e){var r=e(0),n=e(48),a=e(32),s=e(12),o=e(13),l=e(11),u=e(116),c=(e(10).Reflect||{}).construct,h=l(function(){function g(){}return!(c(function(){},[],g)instanceof g)}),p=!l(function(){c(function(){})});r(r.S+r.F*(h||p),"Reflect",{construct:function(g,b){a(g),s(b);var v=arguments.length<3?g:a(arguments[2]);if(p&&!h)return c(g,b,v);if(g==v){switch(b.length){case 0:return new g;case 1:return new g(b[0]);case 2:return new g(b[0],b[1]);case 3:return new g(b[0],b[1],b[2]);case 4:return new g(b[0],b[1],b[2],b[3])}var k=[null];return k.push.apply(k,b),new(u.apply(g,k))}var C=v.prototype,O=n(o(C)?C:Object.prototype),d=Function.apply.call(g,O,b);return o(d)?d:O}})},function(i,t,e){var r=e(19),n=e(0),a=e(12),s=e(40);n(n.S+n.F*e(11)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(o,l,u){a(o),l=s(l,!0),a(u);try{return r.f(o,l,u),!0}catch(c){return!1}}})},function(i,t,e){var r=e(0),n=e(34).f,a=e(12);r(r.S,"Reflect",{deleteProperty:function(s,o){var l=n(a(s),o);return!(l&&!l.configurable)&&delete s[o]}})},function(i,t,e){"use strict";var r=e(0),n=e(12),a=function(s){this._t=n(s),this._i=0;var o,l=this._k=[];for(o in s)l.push(o)};e(123)(a,"Object",function(){var s,o=this._k;do if(this._i>=o.length)return{value:void 0,done:!0};while(!((s=o[this._i++])in this._t));return{value:s,done:!1}}),r(r.S,"Reflect",{enumerate:function(s){return new a(s)}})},function(i,t,e){var r=e(34),n=e(50),a=e(26),s=e(0),o=e(13),l=e(12);s(s.S,"Reflect",{get:function u(c,h){var p,g,b=arguments.length<3?c:arguments[2];return l(c)===b?c[h]:(p=r.f(c,h))?a(p,"value")?p.value:p.get!==void 0?p.get.call(b):void 0:o(g=n(c))?u(g,h,b):void 0}})},function(i,t,e){var r=e(34),n=e(0),a=e(12);n(n.S,"Reflect",{getOwnPropertyDescriptor:function(s,o){return r.f(a(s),o)}})},function(i,t,e){var r=e(0),n=e(50),a=e(12);r(r.S,"Reflect",{getPrototypeOf:function(s){return n(a(s))}})},function(i,t,e){var r=e(0);r(r.S,"Reflect",{has:function(n,a){return a in n}})},function(i,t,e){var r=e(0),n=e(12),a=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(s){return n(s),!a||a(s)}})},function(i,t,e){var r=e(0);r(r.S,"Reflect",{ownKeys:e(137)})},function(i,t,e){var r=e(0),n=e(12),a=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(s){n(s);try{return a&&a(s),!0}catch(o){return!1}}})},function(i,t,e){var r=e(19),n=e(34),a=e(50),s=e(26),o=e(0),l=e(43),u=e(12),c=e(13);o(o.S,"Reflect",{set:function h(p,g,b){var v,k,C=arguments.length<4?p:arguments[3],O=n.f(u(p),g);if(!O){if(c(k=a(p)))return h(k,g,b,C);O=l(0)}if(s(O,"value")){if(O.writable===!1||!c(C))return!1;if(v=n.f(C,g)){if(v.get||v.set||v.writable===!1)return!1;v.value=b,r.f(C,g,v)}else r.f(C,g,l(0,b));return!0}return O.set!==void 0&&(O.set.call(C,b),!0)}})},function(i,t,e){var r=e(0),n=e(87);n&&r(r.S,"Reflect",{setPrototypeOf:function(a,s){n.check(a,s);try{return n.set(a,s),!0}catch(o){return!1}}})},function(i,t,e){e(330),i.exports=e(17).Array.includes},function(i,t,e){"use strict";var r=e(0),n=e(68)(!0);r(r.P,"Array",{includes:function(a){return n(this,a,arguments.length>1?arguments[1]:void 0)}}),e(51)("includes")},function(i,t,e){e(332),i.exports=e(17).Array.flatMap},function(i,t,e){"use strict";var r=e(0),n=e(333),a=e(20),s=e(16),o=e(32),l=e(125);r(r.P,"Array",{flatMap:function(u){var c,h,p=a(this);return o(u),c=s(p.length),h=l(p,0),n(h,p,p,c,0,1,u,arguments[1]),h}}),e(51)("flatMap")},function(i,t,e){"use strict";var r=e(70),n=e(13),a=e(16),s=e(31),o=e(14)("isConcatSpreadable");i.exports=function l(u,c,h,p,g,b,v,k){for(var C,O,d=g,_=0,m=!!v&&s(v,k,3);_<p;){if(_ in h){if(C=m?m(h[_],_,c):h[_],O=!1,n(C)&&(O=(O=C[o])!==void 0?!!O:r(C)),O&&b>0)d=l(u,c,C,a(C.length),d,b-1)-1;else{if(d>=9007199254740991)throw TypeError();u[d]=C}d++}_++}return d}},function(i,t,e){e(335),i.exports=e(17).String.padStart},function(i,t,e){"use strict";var r=e(0),n=e(138),a=e(76),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);r(r.P+r.F*s,"String",{padStart:function(o){return n(this,o,arguments.length>1?arguments[1]:void 0,!0)}})},function(i,t,e){e(337),i.exports=e(17).String.padEnd},function(i,t,e){"use strict";var r=e(0),n=e(138),a=e(76),s=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(a);r(r.P+r.F*s,"String",{padEnd:function(o){return n(this,o,arguments.length>1?arguments[1]:void 0,!1)}})},function(i,t,e){e(339),i.exports=e(17).String.trimLeft},function(i,t,e){"use strict";e(54)("trimLeft",function(r){return function(){return r(this,1)}},"trimStart")},function(i,t,e){e(341),i.exports=e(17).String.trimRight},function(i,t,e){"use strict";e(54)("trimRight",function(r){return function(){return r(this,2)}},"trimEnd")},function(i,t,e){e(343),i.exports=e(83).f("asyncIterator")},function(i,t,e){e(110)("asyncIterator")},function(i,t,e){e(345),i.exports=e(17).Object.getOwnPropertyDescriptors},function(i,t,e){var r=e(0),n=e(137),a=e(28),s=e(34),o=e(99);r(r.S,"Object",{getOwnPropertyDescriptors:function(l){for(var u,c,h=a(l),p=s.f,g=n(h),b={},v=0;g.length>v;)(c=p(h,u=g[v++]))!==void 0&&o(b,u,c);return b}})},function(i,t,e){e(347),i.exports=e(17).Object.values},function(i,t,e){var r=e(0),n=e(139)(!1);r(r.S,"Object",{values:function(a){return n(a)}})},function(i,t,e){e(349),i.exports=e(17).Object.entries},function(i,t,e){var r=e(0),n=e(139)(!0);r(r.S,"Object",{entries:function(a){return n(a)}})},function(i,t,e){"use strict";e(131),e(351),i.exports=e(17).Promise.finally},function(i,t,e){"use strict";var r=e(0),n=e(17),a=e(10),s=e(65),o=e(133);r(r.P+r.R,"Promise",{finally:function(l){var u=s(this,n.Promise||a.Promise),c=typeof l=="function";return this.then(c?function(h){return o(u,l()).then(function(){return h})}:l,c?function(h){return o(u,l()).then(function(){throw h})}:l)}})},function(i,t,e){e(353),e(354),e(355),i.exports=e(17)},function(i,t,e){var r=e(10),n=e(0),a=e(76),s=[].slice,o=/MSIE .\./.test(a),l=function(u){return function(c,h){var p=arguments.length>2,g=!!p&&s.call(arguments,2);return u(p?function(){(typeof c=="function"?c:Function(c)).apply(this,g)}:c,h)}};n(n.G+n.B+n.F*o,{setTimeout:l(r.setTimeout),setInterval:l(r.setInterval)})},function(i,t,e){var r=e(0),n=e(105);r(r.G+r.B,{setImmediate:n.set,clearImmediate:n.clear})},function(i,t,e){for(var r=e(102),n=e(46),a=e(23),s=e(10),o=e(27),l=e(55),u=e(14),c=u("iterator"),h=u("toStringTag"),p=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},b=n(g),v=0;v<b.length;v++){var k,C=b[v],O=g[C],d=s[C],_=d&&d.prototype;if(_&&(_[c]||o(_,c,p),_[h]||o(_,h,C),l[C]=p,O))for(k in r)_[k]||a(_,k,r[k],!0)}},function(i,t,e){var r,n,a;n=[t,e(29),e(2),e(3),e(360),e(362),e(363),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=v(o),l=v(l),u=v(u),p=v(p),g=b(g);var k=function(){function C(O){var d=this;(0,l.default)(this,C);var _=function(){};g.isObject(O)&&g.isFunction(O.onReady)&&(_=O.onReady);var m=new p.default(O);this.isReady=m.isReady.then(function(){d.exportAPI(m),_()})}return(0,u.default)(C,[{key:"exportAPI",value:function(O){var d=this;["configuration"].forEach(function(_){d[_]=O[_]}),this.destroy=function(){for(var _ in Object.values(O.moduleInstances).forEach(function(m){g.isFunction(m.destroy)&&m.destroy(),m.listeners.removeAll()}),O=null,d)Object.prototype.hasOwnProperty.call(d,_)&&delete d[_];Object.setPrototypeOf(d,null)},Object.setPrototypeOf(this,O.moduleInstances.API.methods),delete this.exportAPI,Object.entries({blocks:{clear:"clear",render:"render"},caret:{focus:"focus"},events:{on:"on",off:"off",emit:"emit"},saver:{save:"save"}}).forEach(function(_){var m=(0,o.default)(_,2),y=m[0],x=m[1];Object.entries(x).forEach(function(S){var w=(0,o.default)(S,2),E=w[0],L=w[1];d[L]=O.moduleInstances.API.methods[y][E]})})}}],[{key:"version",get:function(){return"2.20.0"}}]),C}();s.default=k,k.displayName="EditorJS",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t){i.exports=function(e){if(Array.isArray(e))return e}},function(i,t){i.exports=function(e,r){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e)){var n=[],a=!0,s=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(a=(l=u.next()).done)&&(n.push(l.value),!r||n.length!==r);a=!0);}catch(c){s=!0,o=c}finally{try{a||u.return==null||u.return()}finally{if(s)throw o}}return n}}},function(i,t){i.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},function(i,t,e){(t=i.exports=function(...a){return n(...a)}).__esModule=!0;let r=e(361),n=r.default;Object.assign(t,r)},function(i,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){},t.revert=function(){}},function(i,t,e){var r,n,a;n=[],(a=typeof(r=function(){"use strict";Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(s){for(var o=(this.document||this.ownerDocument).querySelectorAll(s),l=o.length;--l>=0&&o.item(l)!==this;);return l>-1}),Element.prototype.closest||(Element.prototype.closest=function(s){var o=this;if(!document.documentElement.contains(o))return null;do{if(o.matches(s))return o;o=o.parentElement||o.parentNode}while(o!==null);return null}),Element.prototype.prepend||(Element.prototype.prepend=function(s){var o=document.createDocumentFragment();Array.isArray(s)||(s=[s]),s.forEach(function(l){var u=l instanceof Node;o.appendChild(u?l:document.createTextNode(l))}),this.insertBefore(o,this.firstChild)})})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(21),e(22),e(2),e(3),e(15),e(8),e(59),e(145),e(372)],(a=typeof(r=function(s,o,l,u,c,h,p,g,b,v){"use strict";var k=e(9),C=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=C(o),l=C(l),u=C(u),c=C(c),h=C(h),p=k(p),g=C(g),v=C(v);var O=e(373),d=[];O.keys().forEach(function(m){m.match(/^\.\/[^_][\w/]*\.([tj])s$/)&&d.push(O(m))});var _=function(){function m(S){var w,E,L=this;(0,u.default)(this,m),this.moduleInstances={},this.eventsDispatcher=new v.default,this.isReady=new Promise(function(I,A){w=I,E=A}),Promise.resolve().then((0,l.default)(o.default.mark(function I(){return o.default.wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return L.configuration=S,A.next=3,L.validate();case 3:return A.next=5,L.init();case 5:return A.next=7,L.start();case 7:p.logLabeled("I'm ready! (\uFF89\u25D5\u30EE\u25D5)\uFF89*:\uFF65\uFF9F\u2727","log","","color: #E24A75"),setTimeout((0,l.default)(o.default.mark(function B(){var T,M,j;return o.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return J.next=2,L.render();case 2:L.configuration.autofocus&&(T=L.moduleInstances,M=T.BlockManager,(j=T.Caret).setToBlock(M.blocks[0],j.positions.START),M.highlightCurrentNode()),L.moduleInstances.UI.removeLoader(),w();case 5:case"end":return J.stop()}},B)})),500);case 9:case"end":return A.stop()}},I)}))).catch(function(I){p.log("Editor.js is not ready because of ".concat(I),"error"),E(I)})}var y,x;return(0,c.default)(m,[{key:"validate",value:(x=(0,l.default)(o.default.mark(function S(){var w,E,L;return o.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(w=this.config,E=w.holderId,L=w.holder,!E||!L){I.next=3;break}throw Error("\xABholderId\xBB and \xABholder\xBB param can't assign at the same time.");case 3:if(!p.isString(L)||h.default.get(L)){I.next=5;break}throw Error("element with ID \xAB".concat(L,"\xBB is missing. Pass correct holder's ID."));case 5:if(!L||!p.isObject(L)||h.default.isElement(L)){I.next=7;break}throw Error("\xABholder\xBB value must be an Element node");case 7:case"end":return I.stop()}},S,this)})),function(){return x.apply(this,arguments)})},{key:"init",value:function(){this.constructModules(),this.configureModules()}},{key:"start",value:(y=(0,l.default)(o.default.mark(function S(){var w,E=this;return o.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return w=["Tools","UI","BlockManager","Paste","BlockSelection","RectangleSelection","CrossBlockSelection","ReadOnly"],L.next=3,w.reduce(function(I,A){return I.then((0,l.default)(o.default.mark(function B(){return o.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.prev=0,T.next=3,E.moduleInstances[A].prepare();case 3:T.next=10;break;case 5:if(T.prev=5,T.t0=T.catch(0),!(T.t0 instanceof b.CriticalError)){T.next=9;break}throw new Error(T.t0.message);case 9:p.log("Module ".concat(A," was skipped because of %o"),"warn",T.t0);case 10:case"end":return T.stop()}},B,null,[[0,5]])})))},Promise.resolve());case 3:case"end":return L.stop()}},S)})),function(){return y.apply(this,arguments)})},{key:"render",value:function(){return this.moduleInstances.Renderer.render(this.config.data.blocks)}},{key:"constructModules",value:function(){var S=this;d.forEach(function(w){var E=p.isFunction(w)?w:w.default;try{S.moduleInstances[E.displayName]=new E({config:S.configuration,eventsDispatcher:S.eventsDispatcher})}catch(L){p.log("Module ".concat(E.displayName," skipped because"),"warn",L)}})}},{key:"configureModules",value:function(){for(var S in this.moduleInstances)Object.prototype.hasOwnProperty.call(this.moduleInstances,S)&&(this.moduleInstances[S].state=this.getModulesDiff(S))}},{key:"getModulesDiff",value:function(S){var w={};for(var E in this.moduleInstances)E!==S&&(w[E]=this.moduleInstances[E]);return w}},{key:"configuration",set:function(S){var w,E;p.isObject(S)?this.config=Object.assign({},S):this.config={holder:S},p.deprecationAssert(!!this.config.holderId,"config.holderId","config.holder"),this.config.holderId&&!this.config.holder&&(this.config.holder=this.config.holderId,this.config.holderId=null),this.config.holder==null&&(this.config.holder="editorjs"),this.config.logLevel||(this.config.logLevel=p.LogLevels.VERBOSE),p.setLogLevel(this.config.logLevel),p.deprecationAssert(Boolean(this.config.initialBlock),"config.initialBlock","config.defaultBlock"),this.config.defaultBlock=this.config.defaultBlock||this.config.initialBlock||"paragraph",this.config.minHeight=this.config.minHeight!==void 0?this.config.minHeight:300;var L={type:this.config.defaultBlock,data:{}};this.config.placeholder=this.config.placeholder||!1,this.config.sanitizer=this.config.sanitizer||{p:!0,b:!0,a:!0},this.config.hideToolbar=!!this.config.hideToolbar&&this.config.hideToolbar,this.config.tools=this.config.tools||{},this.config.i18n=this.config.i18n||{},this.config.data=this.config.data||{blocks:[]},this.config.onReady=this.config.onReady||function(){},this.config.onChange=this.config.onChange||function(){},this.config.inlineToolbar=this.config.inlineToolbar===void 0||this.config.inlineToolbar,!p.isEmpty(this.config.data)&&this.config.data.blocks&&this.config.data.blocks.length!==0||(this.config.data={blocks:[L]}),this.config.readOnly=this.config.readOnly||!1,!((w=this.config.i18n)===null||w===void 0)&&w.messages&&g.default.setDictionary(this.config.i18n.messages),this.config.i18n.direction=((E=this.config.i18n)===null||E===void 0?void 0:E.direction)||"ltr"},get:function(){return this.config}}]),m}();s.default=_,_.displayName="Core",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r=e(142);i.exports=function(n){if(Array.isArray(n))return r(n)}},function(i,t){i.exports=function(e){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(e))return Array.from(e)}},function(i,t){i.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}},function(i,t){i.exports=function(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}},function(i,t){i.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(i,t){i.exports=function(e){return Function.toString.call(e).indexOf("[native code]")!==-1}},function(i,t,e){var r=e(107),n=e(371);function a(s,o,l){return n()?i.exports=a=Reflect.construct:i.exports=a=function(u,c,h){var p=[null];p.push.apply(p,c);var g=new(Function.bind.apply(u,p));return h&&r(g,h.prototype),g},a.apply(null,arguments)}i.exports=a},function(i,t){i.exports=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}},function(i,t,e){var r,n,a;n=[t,e(2),e(3)],(a=typeof(r=function(s,o,l){"use strict";var u=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=u(o),l=u(l);var c=function(){function h(){(0,o.default)(this,h),this.subscribers={}}return(0,l.default)(h,[{key:"on",value:function(p,g){p in this.subscribers||(this.subscribers[p]=[]),this.subscribers[p].push(g)}},{key:"once",value:function(p,g){var b=this;p in this.subscribers||(this.subscribers[p]=[]),this.subscribers[p].push(function v(k){var C=g(k),O=b.subscribers[p].indexOf(v);return O!==-1&&b.subscribers[p].splice(O,1),C})}},{key:"emit",value:function(p,g){this.subscribers[p]&&this.subscribers[p].reduce(function(b,v){return v(b)||b},g)}},{key:"off",value:function(p,g){for(var b=0;b<this.subscribers[p].length;b++)if(this.subscribers[p][b]===g){delete this.subscribers[p][b];break}}},{key:"destroy",value:function(){this.subscribers=null}}]),h}();s.default=c,c.displayName="EventsDispatcher",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r={"./api":79,"./api/":79,"./api/blocks":147,"./api/blocks.ts":147,"./api/caret":149,"./api/caret.ts":149,"./api/events":150,"./api/events.ts":150,"./api/i18n":151,"./api/i18n.ts":151,"./api/index":79,"./api/index.ts":79,"./api/inlineToolbar":152,"./api/inlineToolbar.ts":152,"./api/listeners":153,"./api/listeners.ts":153,"./api/notifier":154,"./api/notifier.ts":154,"./api/readonly":155,"./api/readonly.ts":155,"./api/sanitizer":156,"./api/sanitizer.ts":156,"./api/saver":157,"./api/saver.ts":157,"./api/selection":158,"./api/selection.ts":158,"./api/styles":159,"./api/styles.ts":159,"./api/toolbar":160,"./api/toolbar.ts":160,"./api/tooltip":161,"./api/tooltip.ts":161,"./blockEvents":162,"./blockEvents.ts":162,"./blockManager":163,"./blockManager.ts":163,"./blockSelection":164,"./blockSelection.ts":164,"./caret":165,"./caret.ts":165,"./crossBlockSelection":166,"./crossBlockSelection.ts":166,"./dragNDrop":167,"./dragNDrop.ts":167,"./modificationsObserver":168,"./modificationsObserver.ts":168,"./notifier":169,"./notifier.ts":169,"./paste":170,"./paste.ts":170,"./readonly":171,"./readonly.ts":171,"./rectangleSelection":172,"./rectangleSelection.ts":172,"./renderer":173,"./renderer.ts":173,"./sanitizer":174,"./sanitizer.ts":174,"./saver":175,"./saver.ts":175,"./toolbar":80,"./toolbar/":80,"./toolbar/blockSettings":176,"./toolbar/blockSettings.ts":176,"./toolbar/conversion":177,"./toolbar/conversion.ts":177,"./toolbar/index":80,"./toolbar/index.ts":80,"./toolbar/inline":178,"./toolbar/inline.ts":178,"./toolbar/toolbox":179,"./toolbar/toolbox.ts":179,"./tools":180,"./tools.ts":180,"./tooltip":181,"./tooltip.ts":181,"./ui":182,"./ui.ts":182};function n(s){var o=a(s);return e(o)}function a(s){if(!e.o(r,s)){var o=new Error("Cannot find module '"+s+"'");throw o.code="MODULE_NOT_FOUND",o}return r[s]}n.keys=function(){return Object.keys(r)},n.resolve=a,i.exports=n,n.id=373},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(8)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(9),h=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=h(o),l=h(l),u=c(u);var p=function(){function g(){(0,o.default)(this,g),this.allListeners=[]}return(0,l.default)(g,[{key:"on",value:function(b,v,k){var C=arguments.length>3&&arguments[3]!==void 0&&arguments[3],O=u.generateId("l"),d={id:O,element:b,eventType:v,handler:k,options:C},_=this.findOne(b,v,k);if(!_)return this.allListeners.push(d),b.addEventListener(v,k,C),O}},{key:"off",value:function(b,v,k,C){var O=this,d=this.findAll(b,v,k);d.forEach(function(_,m){var y=O.allListeners.indexOf(d[m]);y>-1&&(O.allListeners.splice(y,1),_.element.removeEventListener(_.eventType,_.handler,_.options))})}},{key:"offById",value:function(b){var v=this.findById(b);v&&v.element.removeEventListener(v.eventType,v.handler,v.options)}},{key:"findOne",value:function(b,v,k){var C=this.findAll(b,v,k);return C.length>0?C[0]:null}},{key:"findAll",value:function(b,v,k){var C=b?this.findByEventTarget(b):[];return b&&v&&k?C.filter(function(O){return O.eventType===v&&O.handler===k}):b&&v?C.filter(function(O){return O.eventType===v}):C}},{key:"removeAll",value:function(){this.allListeners.map(function(b){b.element.removeEventListener(b.eventType,b.handler,b.options)}),this.allListeners=[]}},{key:"destroy",value:function(){this.removeAll()}},{key:"findByEventTarget",value:function(b){return this.allListeners.filter(function(v){if(v.element===b)return v})}},{key:"findByType",value:function(b){return this.allListeners.filter(function(v){if(v.eventType===b)return v})}},{key:"findByHandler",value:function(b){return this.allListeners.filter(function(v){if(v.handler===b)return v})}},{key:"findById",value:function(b){return this.allListeners.find(function(v){return v.id===b})}}]),g}();s.default=p,p.displayName="Listeners",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15),e(8),e(25)],(a=typeof(r=function(s,o,l,u,c,h){"use strict";var p=e(9),g=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=p(c),h=g(h);var b=function(){function v(k,C){(0,o.default)(this,v),this.cursor=-1,this.items=[],this.items=k||[],this.focusedCssClass=C}return(0,l.default)(v,[{key:"setItems",value:function(k){this.items=k}},{key:"next",value:function(){this.cursor=this.leafNodesAndReturnIndex(v.directions.RIGHT)}},{key:"previous",value:function(){this.cursor=this.leafNodesAndReturnIndex(v.directions.LEFT)}},{key:"dropCursor",value:function(){this.cursor!==-1&&(this.items[this.cursor].classList.remove(this.focusedCssClass),this.cursor=-1)}},{key:"leafNodesAndReturnIndex",value:function(k){var C=this;if(this.items.length===0)return this.cursor;var O=this.cursor;return O===-1?O=k===v.directions.RIGHT?-1:0:this.items[O].classList.remove(this.focusedCssClass),O=k===v.directions.RIGHT?(O+1)%this.items.length:(this.items.length+O-1)%this.items.length,u.default.canSetCaret(this.items[O])&&c.delay(function(){return h.default.setCursor(C.items[O])},50)(),this.items[O].classList.add(this.focusedCssClass),O}},{key:"currentItem",get:function(){return this.cursor===-1?null:this.items[this.cursor]}}]),v}();s.default=b,b.displayName="DomIterator",b.directions={RIGHT:"right",LEFT:"left"},i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(8),e(15),e(61)],(a=typeof(r=function(s,o,l,u,c,h){"use strict";var p=e(9),g=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=p(u),c=g(c);var b=function(){function v(k){(0,o.default)(this,v),this.blocks=[],this.workingArea=k}return(0,l.default)(v,[{key:"push",value:function(k){this.blocks.push(k),this.insertToDOM(k)}},{key:"swap",value:function(k,C){var O=this.blocks[C];c.default.swap(this.blocks[k].holder,O.holder),this.blocks[C]=this.blocks[k],this.blocks[k]=O}},{key:"move",value:function(k,C){var O=this.blocks.splice(C,1)[0],d=k-1,_=Math.max(0,d),m=this.blocks[_];k>0?this.insertToDOM(O,"afterend",m):this.insertToDOM(O,"beforebegin",m),this.blocks.splice(k,0,O);var y=this.composeBlockEvent("move",{fromIndex:C,toIndex:k});O.call(h.BlockToolAPI.MOVED,y)}},{key:"insert",value:function(k,C){var O=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(this.length){k>this.length&&(k=this.length),O&&(this.blocks[k].holder.remove(),this.blocks[k].call(h.BlockToolAPI.REMOVED));var d=O?1:0;if(this.blocks.splice(k,d,C),k>0){var _=this.blocks[k-1];this.insertToDOM(C,"afterend",_)}else{var m=this.blocks[k+1];m?this.insertToDOM(C,"beforebegin",m):this.insertToDOM(C)}}else this.push(C)}},{key:"remove",value:function(k){isNaN(k)&&(k=this.length-1),this.blocks[k].holder.remove(),this.blocks[k].call(h.BlockToolAPI.REMOVED),this.blocks.splice(k,1)}},{key:"removeAll",value:function(){this.workingArea.innerHTML="",this.blocks.forEach(function(k){return k.call(h.BlockToolAPI.REMOVED)}),this.blocks.length=0}},{key:"insertAfter",value:function(k,C){var O=this.blocks.indexOf(k);this.insert(O+1,C)}},{key:"get",value:function(k){return this.blocks[k]}},{key:"indexOf",value:function(k){return this.blocks.indexOf(k)}},{key:"insertToDOM",value:function(k,C,O){C?O.holder.insertAdjacentElement(C,k.holder):this.workingArea.appendChild(k.holder),k.call(h.BlockToolAPI.RENDERED)}},{key:"composeBlockEvent",value:function(k,C){return new CustomEvent(k,{detail:C})}},{key:"length",get:function(){return this.blocks.length}},{key:"array",get:function(){return this.blocks}},{key:"nodes",get:function(){return u.array(this.workingArea.children)}}],[{key:"set",value:function(k,C,O){return isNaN(Number(C))?(Reflect.set(k,C,O),!0):(k.insert(+C,O),!0)}},{key:"get",value:function(k,C){return isNaN(Number(C))?Reflect.get(k,C):k.get(+C)}}]),v}();s.default=b,b.displayName="Blocks",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){i.exports=function(r){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=r,a.c=n,a.d=function(s,o,l){a.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:l})},a.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},a.t=function(s,o){if(1&o&&(s=a(s)),8&o||4&o&&typeof s=="object"&&s&&s.__esModule)return s;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:s}),2&o&&typeof s!="string")for(var u in s)a.d(l,u,function(c){return s[c]}.bind(null,u));return l},a.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(o,"a",o),o},a.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},a.p="",a(a.s=0)}([function(r,n,a){"use strict";function s(u,c){for(var h=0;h<c.length;h++){var p=c[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}function o(u,c,h){return c&&s(u.prototype,c),h&&s(u,h),u}a.r(n);var l=function(){function u(c){var h=this;(function(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")})(this,u),this.commands={},this.keys={},this.name=c.name,this.parseShortcutName(c.name),this.element=c.on,this.callback=c.callback,this.executeShortcut=function(p){h.execute(p)},this.element.addEventListener("keydown",this.executeShortcut,!1)}return o(u,null,[{key:"supportedCommands",get:function(){return{SHIFT:["SHIFT"],CMD:["CMD","CONTROL","COMMAND","WINDOWS","CTRL"],ALT:["ALT","OPTION"]}}},{key:"keyCodes",get:function(){return{0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,BACKSPACE:8,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46}}}]),o(u,[{key:"parseShortcutName",value:function(c){c=c.split("+");for(var h=0;h<c.length;h++){c[h]=c[h].toUpperCase();var p=!1;for(var g in u.supportedCommands)if(u.supportedCommands[g].includes(c[h])){p=this.commands[g]=!0;break}p||(this.keys[c[h]]=!0)}for(var b in u.supportedCommands)this.commands[b]||(this.commands[b]=!1)}},{key:"execute",value:function(c){var h,p={CMD:c.ctrlKey||c.metaKey,SHIFT:c.shiftKey,ALT:c.altKey},g=!0;for(h in this.commands)this.commands[h]!==p[h]&&(g=!1);var b,v=!0;for(b in this.keys)v=v&&c.keyCode===u.keyCodes[b];g&&v&&this.callback(c)}},{key:"remove",value:function(){this.element.removeEventListener("keydown",this.executeShortcut)}}]),u}();n.default=l}]).default},function(i,t,e){i.exports=function(r){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=r,a.c=n,a.d=function(s,o,l){a.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:l})},a.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},a.t=function(s,o){if(1&o&&(s=a(s)),8&o||4&o&&typeof s=="object"&&s&&s.__esModule)return s;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:s}),2&o&&typeof s!="string")for(var u in s)a.d(l,u,function(c){return s[c]}.bind(null,u));return l},a.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(o,"a",o),o},a.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},a.p="/",a(a.s=0)}([function(r,n,a){"use strict";a(1),r.exports=function(){var s=a(6),o=null;return{show:function(l){if(l.message){(function(){if(o)return!0;o=s.getWrapper(),document.body.appendChild(o)})();var u=null,c=l.time||8e3;switch(l.type){case"confirm":u=s.confirm(l);break;case"prompt":u=s.prompt(l);break;default:u=s.alert(l),window.setTimeout(function(){u.remove()},c)}o.appendChild(u),u.classList.add("cdx-notify--bounce-in")}}}}()},function(r,n,a){var s=a(2);typeof s=="string"&&(s=[[r.i,s,""]]),a(4)(s,{hmr:!0,transform:void 0,insertInto:void 0}),s.locals&&(r.exports=s.locals)},function(r,n,a){(r.exports=a(3)(!1)).push([r.i,`.cdx-notify--error{background:#fffbfb!important}.cdx-notify--error::before{background:#fb5d5d!important}.cdx-notify__input{max-width:130px;padding:5px 10px;background:#f7f7f7;border:0;border-radius:3px;font-size:13px;color:#656b7c;outline:0}.cdx-notify__input:-ms-input-placeholder{color:#656b7c}.cdx-notify__input::placeholder{color:#656b7c}.cdx-notify__input:focus:-ms-input-placeholder{color:rgba(101,107,124,.3)}.cdx-notify__input:focus::placeholder{color:rgba(101,107,124,.3)}.cdx-notify__button{border:none;border-radius:3px;font-size:13px;padding:5px 10px;cursor:pointer}.cdx-notify__button:last-child{margin-left:10px}.cdx-notify__button--cancel{background:#f2f5f7;box-shadow:0 2px 1px 0 rgba(16,19,29,0);color:#656b7c}.cdx-notify__button--cancel:hover{background:#eee}.cdx-notify__button--confirm{background:#34c992;box-shadow:0 1px 1px 0 rgba(18,49,35,.05);color:#fff}.cdx-notify__button--confirm:hover{background:#33b082}.cdx-notify__btns-wrapper{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;margin-top:5px}.cdx-notify__cross{position:absolute;top:5px;right:5px;width:10px;height:10px;padding:5px;opacity:.54;cursor:pointer}.cdx-notify__cross::after,.cdx-notify__cross::before{content:'';position:absolute;left:9px;top:5px;height:12px;width:2px;background:#575d67}.cdx-notify__cross::before{transform:rotate(-45deg)}.cdx-notify__cross::after{transform:rotate(45deg)}.cdx-notify__cross:hover{opacity:1}.cdx-notifies{position:fixed;z-index:2;bottom:20px;left:20px;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",sans-serif}.cdx-notify{position:relative;width:220px;margin-top:15px;padding:13px 16px;background:#fff;box-shadow:0 11px 17px 0 rgba(23,32,61,.13);border-radius:5px;font-size:14px;line-height:1.4em;word-wrap:break-word}.cdx-notify::before{content:'';position:absolute;display:block;top:0;left:0;width:3px;height:calc(100% - 6px);margin:3px;border-radius:5px;background:0 0}@keyframes bounceIn{0%{opacity:0;transform:scale(.3)}50%{opacity:1;transform:scale(1.05)}70%{transform:scale(.9)}100%{transform:scale(1)}}.cdx-notify--bounce-in{animation-name:bounceIn;animation-duration:.6s;animation-iteration-count:1}.cdx-notify--success{background:#fafffe!important}.cdx-notify--success::before{background:#41ffb1!important}`,""])},function(r,n){r.exports=function(a){var s=[];return s.toString=function(){return this.map(function(o){var l=function(u,c){var h,p=u[1]||"",g=u[3];if(!g)return p;if(c&&typeof btoa=="function"){var b=(h=g,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(h))))+" */"),v=g.sources.map(function(k){return"/*# sourceURL="+g.sourceRoot+k+" */"});return[p].concat(v).concat([b]).join(`
`)}return[p].join(`
`)}(o,a);return o[2]?"@media "+o[2]+"{"+l+"}":l}).join("")},s.i=function(o,l){typeof o=="string"&&(o=[[null,o,""]]);for(var u={},c=0;c<this.length;c++){var h=this[c][0];typeof h=="number"&&(u[h]=!0)}for(c=0;c<o.length;c++){var p=o[c];typeof p[0]=="number"&&u[p[0]]||(l&&!p[2]?p[2]=l:l&&(p[2]="("+p[2]+") and ("+l+")"),s.push(p))}},s}},function(r,n,a){var s,o,l={},u=(s=function(){return window&&document&&document.all&&!window.atob},function(){return o===void 0&&(o=s.apply(this,arguments)),o}),c=function(w){var E={};return function(L){if(typeof L=="function")return L();if(E[L]===void 0){var I=function(A){return document.querySelector(A)}.call(this,L);if(window.HTMLIFrameElement&&I instanceof window.HTMLIFrameElement)try{I=I.contentDocument.head}catch(A){I=null}E[L]=I}return E[L]}}(),h=null,p=0,g=[],b=a(5);function v(w,E){for(var L=0;L<w.length;L++){var I=w[L],A=l[I.id];if(A){A.refs++;for(var B=0;B<A.parts.length;B++)A.parts[B](I.parts[B]);for(;B<I.parts.length;B++)A.parts.push(m(I.parts[B],E))}else{var T=[];for(B=0;B<I.parts.length;B++)T.push(m(I.parts[B],E));l[I.id]={id:I.id,refs:1,parts:T}}}}function k(w,E){for(var L=[],I={},A=0;A<w.length;A++){var B=w[A],T=E.base?B[0]+E.base:B[0],M={css:B[1],media:B[2],sourceMap:B[3]};I[T]?I[T].parts.push(M):L.push(I[T]={id:T,parts:[M]})}return L}function C(w,E){var L=c(w.insertInto);if(!L)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var I=g[g.length-1];if(w.insertAt==="top")I?I.nextSibling?L.insertBefore(E,I.nextSibling):L.appendChild(E):L.insertBefore(E,L.firstChild),g.push(E);else if(w.insertAt==="bottom")L.appendChild(E);else{if(typeof w.insertAt!="object"||!w.insertAt.before)throw new Error(`[Style Loader]

 Invalid value for parameter 'insertAt' ('options.insertAt') found.
 Must be 'top', 'bottom', or Object.
 (https://github.com/webpack-contrib/style-loader#insertat)
`);var A=c(w.insertInto+" "+w.insertAt.before);L.insertBefore(E,A)}}function O(w){if(w.parentNode===null)return!1;w.parentNode.removeChild(w);var E=g.indexOf(w);E>=0&&g.splice(E,1)}function d(w){var E=document.createElement("style");return w.attrs.type===void 0&&(w.attrs.type="text/css"),_(E,w.attrs),C(w,E),E}function _(w,E){Object.keys(E).forEach(function(L){w.setAttribute(L,E[L])})}function m(w,E){var L,I,A,B;if(E.transform&&w.css){if(!(B=E.transform(w.css)))return function(){};w.css=B}if(E.singleton){var T=p++;L=h||(h=d(E)),I=S.bind(null,L,T,!1),A=S.bind(null,L,T,!0)}else w.sourceMap&&typeof URL=="function"&&typeof URL.createObjectURL=="function"&&typeof URL.revokeObjectURL=="function"&&typeof Blob=="function"&&typeof btoa=="function"?(L=function(M){var j=document.createElement("link");return M.attrs.type===void 0&&(M.attrs.type="text/css"),M.attrs.rel="stylesheet",_(j,M.attrs),C(M,j),j}(E),I=function(M,j,J){var U=J.css,H=J.sourceMap,te=j.convertToAbsoluteUrls===void 0&&H;(j.convertToAbsoluteUrls||te)&&(U=b(U)),H&&(U+=`
/*# sourceMappingURL=data:application/json;base64,`+btoa(unescape(encodeURIComponent(JSON.stringify(H))))+" */");var se=new Blob([U],{type:"text/css"}),W=M.href;M.href=URL.createObjectURL(se),W&&URL.revokeObjectURL(W)}.bind(null,L,E),A=function(){O(L),L.href&&URL.revokeObjectURL(L.href)}):(L=d(E),I=function(M,j){var J=j.css,U=j.media;if(U&&M.setAttribute("media",U),M.styleSheet)M.styleSheet.cssText=J;else{for(;M.firstChild;)M.removeChild(M.firstChild);M.appendChild(document.createTextNode(J))}}.bind(null,L),A=function(){O(L)});return I(w),function(M){if(M){if(M.css===w.css&&M.media===w.media&&M.sourceMap===w.sourceMap)return;I(w=M)}else A()}}r.exports=function(w,E){if(typeof DEBUG!="undefined"&&DEBUG&&typeof document!="object")throw new Error("The style-loader cannot be used in a non-browser environment");(E=E||{}).attrs=typeof E.attrs=="object"?E.attrs:{},E.singleton||typeof E.singleton=="boolean"||(E.singleton=u()),E.insertInto||(E.insertInto="head"),E.insertAt||(E.insertAt="bottom");var L=k(w,E);return v(L,E),function(I){for(var A=[],B=0;B<L.length;B++){var T=L[B];(M=l[T.id]).refs--,A.push(M)}for(I&&v(k(I,E),E),B=0;B<A.length;B++){var M;if((M=A[B]).refs===0){for(var j=0;j<M.parts.length;j++)M.parts[j]();delete l[M.id]}}}};var y,x=(y=[],function(w,E){return y[w]=E,y.filter(Boolean).join(`
`)});function S(w,E,L,I){var A=L?"":I.css;if(w.styleSheet)w.styleSheet.cssText=x(E,A);else{var B=document.createTextNode(A),T=w.childNodes;T[E]&&w.removeChild(T[E]),T.length?w.insertBefore(B,T[E]):w.appendChild(B)}}},function(r,n){r.exports=function(a){var s=typeof window!="undefined"&&window.location;if(!s)throw new Error("fixUrls requires window.location");if(!a||typeof a!="string")return a;var o=s.protocol+"//"+s.host,l=o+s.pathname.replace(/\/[^\/]*$/,"/");return a.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(u,c){var h,p=c.trim().replace(/^"(.*)"$/,function(g,b){return b}).replace(/^'(.*)'$/,function(g,b){return b});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(p)?u:(h=p.indexOf("//")===0?p:p.indexOf("/")===0?o+p:l+p.replace(/^\.\//,""),"url("+JSON.stringify(h)+")")})}},function(r,n,a){"use strict";var s,o,l,u,c,h;r.exports=(s="cdx-notify",o="cdx-notify__cross",l="cdx-notify__button--confirm",u="cdx-notify__button",c="cdx-notify__btns-wrapper",{alert:h=function(p){var g=document.createElement("DIV"),b=document.createElement("DIV"),v=p.message,k=p.style;return g.classList.add(s),k&&g.classList.add(s+"--"+k),g.innerHTML=v,b.classList.add(o),b.addEventListener("click",g.remove.bind(g)),g.appendChild(b),g},confirm:function(p){var g=h(p),b=document.createElement("div"),v=document.createElement("button"),k=document.createElement("button"),C=g.querySelector("."+o),O=p.cancelHandler,d=p.okHandler;return b.classList.add(c),v.innerHTML=p.okText||"Confirm",k.innerHTML=p.cancelText||"Cancel",v.classList.add(u),k.classList.add(u),v.classList.add(l),k.classList.add("cdx-notify__button--cancel"),O&&typeof O=="function"&&(k.addEventListener("click",O),C.addEventListener("click",O)),d&&typeof d=="function"&&v.addEventListener("click",d),v.addEventListener("click",g.remove.bind(g)),k.addEventListener("click",g.remove.bind(g)),b.appendChild(v),b.appendChild(k),g.appendChild(b),g},prompt:function(p){var g=h(p),b=document.createElement("div"),v=document.createElement("button"),k=document.createElement("input"),C=g.querySelector("."+o),O=p.cancelHandler,d=p.okHandler;return b.classList.add(c),v.innerHTML=p.okText||"Ok",v.classList.add(u),v.classList.add(l),k.classList.add("cdx-notify__input"),p.placeholder&&k.setAttribute("placeholder",p.placeholder),p.default&&(k.value=p.default),p.inputType&&(k.type=p.inputType),O&&typeof O=="function"&&C.addEventListener("click",O),d&&typeof d=="function"&&v.addEventListener("click",function(){d(k.value)}),v.addEventListener("click",g.remove.bind(g)),b.appendChild(k),b.appendChild(v),g.appendChild(b),g},getWrapper:function(){var p=document.createElement("DIV");return p.classList.add("cdx-notifies"),p}})}])},function(i,t,e){var r,n;(n=typeof(r=function(){function a(g){var b=g.tags;if(!Object.keys(b).map(function(v){return typeof b[v]}).every(function(v){return v==="object"||v==="boolean"||v==="function"}))throw new Error("The configuration was invalid");this.config=g}var s=["P","LI","TD","TH","DIV","H1","H2","H3","H4","H5","H6","PRE"];function o(g){return s.indexOf(g.nodeName)!==-1}var l=["A","B","STRONG","I","EM","SUB","SUP","U","STRIKE"];function u(g){return l.indexOf(g.nodeName)!==-1}function c(g,b,v){return typeof g.tags[b]=="function"?g.tags[b](v):g.tags[b]}function h(g,b){return b===void 0||typeof b=="boolean"&&!b}function p(g,b,v){var k=g.name.toLowerCase();return b!==!0&&(typeof b[k]=="function"?!b[k](g.value,v):b[k]===void 0||b[k]===!1||typeof b[k]=="string"&&b[k]!==g.value)}return a.prototype.clean=function(g){let b=document.implementation.createHTMLDocument(),v=b.createElement("div");return v.innerHTML=g,this._sanitize(b,v),v.innerHTML},a.prototype._sanitize=function(g,b){var v=function(w,E){return w.createTreeWalker(E,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,null,!1)}(g,b),k=v.firstChild();if(k)do if(k.nodeType!==Node.TEXT_NODE){if(k.nodeType===Node.COMMENT_NODE){b.removeChild(k),this._sanitize(g,b);break}var C,O=u(k);O&&(C=Array.prototype.some.call(k.childNodes,o));var d=!!b.parentNode,_=o(b)&&o(k)&&d,m=k.nodeName.toLowerCase(),y=c(this.config,m,k);if(O&&C||h(0,y)||!this.config.keepNestedBlockElements&&_){if(k.nodeName!=="SCRIPT"&&k.nodeName!=="STYLE")for(;k.childNodes.length>0;)b.insertBefore(k.childNodes[0],k);b.removeChild(k),this._sanitize(g,b);break}for(var x=0;x<k.attributes.length;x+=1){var S=k.attributes[x];p(S,y,k)&&(k.removeAttribute(S.name),x-=1)}this._sanitize(g,k)}else if(k.data.trim()===""&&(k.previousElementSibling&&o(k.previousElementSibling)||k.nextElementSibling&&o(k.nextElementSibling))){b.removeChild(k),this._sanitize(g,b);break}while(k=v.nextSibling())},a})=="function"?r.call(t,e,t,i):r)===void 0||(i.exports=n)},function(i,t,e){i.exports=function(r){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=r,a.c=n,a.d=function(s,o,l){a.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:l})},a.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},a.t=function(s,o){if(1&o&&(s=a(s)),8&o||4&o&&typeof s=="object"&&s&&s.__esModule)return s;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:s}),2&o&&typeof s!="string")for(var u in s)a.d(l,u,function(c){return s[c]}.bind(null,u));return l},a.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(o,"a",o),o},a.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},a.p="/",a(a.s=0)}([function(r,n,a){function s(u,c){for(var h=0;h<c.length;h++){var p=c[h];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(u,p.key,p)}}function o(u,c,h){return c&&s(u.prototype,c),h&&s(u,h),u}a(1).toString();var l=function(){function u(c){var h=c.data,p=c.config,g=c.api,b=c.readOnly;(function(v,k){if(!(v instanceof k))throw new TypeError("Cannot call a class as a function")})(this,u),this.api=g,this.readOnly=b,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this)),this._placeholder=p.placeholder?p.placeholder:u.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),this._preserveBlank=p.preserveBlank!==void 0&&p.preserveBlank,this.data=h}return o(u,null,[{key:"DEFAULT_PLACEHOLDER",get:function(){return""}}]),o(u,[{key:"onKeyUp",value:function(c){c.code!=="Backspace"&&c.code!=="Delete"||this._element.textContent===""&&(this._element.innerHTML="")}},{key:"drawView",value:function(){var c=document.createElement("DIV");return c.classList.add(this._CSS.wrapper,this._CSS.block),c.contentEditable=!1,c.dataset.placeholder=this.api.i18n.t(this._placeholder),this.readOnly||(c.contentEditable=!0,c.addEventListener("keyup",this.onKeyUp)),c}},{key:"render",value:function(){return this._element}},{key:"merge",value:function(c){var h={text:this.data.text+c.text};this.data=h}},{key:"validate",value:function(c){return!(c.text.trim()===""&&!this._preserveBlank)}},{key:"save",value:function(c){return{text:c.innerHTML}}},{key:"onPaste",value:function(c){var h={text:c.detail.data.innerHTML};this.data=h}},{key:"data",get:function(){var c=this._element.innerHTML;return this._data.text=c,this._data},set:function(c){this._data=c||{},this._element.innerHTML=this._data.text||""}}],[{key:"conversionConfig",get:function(){return{export:"text",import:"text"}}},{key:"sanitize",get:function(){return{text:{br:!0}}}},{key:"isReadOnlySupported",get:function(){return!0}},{key:"pasteConfig",get:function(){return{tags:["P"]}}},{key:"toolbox",get:function(){return{icon:a(5).default,title:"Text"}}}]),u}();r.exports=l},function(r,n,a){var s=a(2),o=a(3);typeof(o=o.__esModule?o.default:o)=="string"&&(o=[[r.i,o,""]]),s(o,{insert:"head",singleton:!1}),r.exports=o.locals||{}},function(r,n,a){"use strict";var s,o=function(){var d={};return function(_){if(d[_]===void 0){var m=document.querySelector(_);if(window.HTMLIFrameElement&&m instanceof window.HTMLIFrameElement)try{m=m.contentDocument.head}catch(y){m=null}d[_]=m}return d[_]}}(),l=[];function u(d){for(var _=-1,m=0;m<l.length;m++)if(l[m].identifier===d){_=m;break}return _}function c(d,_){for(var m={},y=[],x=0;x<d.length;x++){var S=d[x],w=_.base?S[0]+_.base:S[0],E=m[w]||0,L="".concat(w," ").concat(E);m[w]=E+1;var I=u(L),A={css:S[1],media:S[2],sourceMap:S[3]};I!==-1?(l[I].references++,l[I].updater(A)):l.push({identifier:L,updater:O(A,_),references:1}),y.push(L)}return y}function h(d){var _=document.createElement("style"),m=d.attributes||{};if(m.nonce===void 0){var y=a.nc;y&&(m.nonce=y)}if(Object.keys(m).forEach(function(S){_.setAttribute(S,m[S])}),typeof d.insert=="function")d.insert(_);else{var x=o(d.insert||"head");if(!x)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");x.appendChild(_)}return _}var p,g=(p=[],function(d,_){return p[d]=_,p.filter(Boolean).join(`
`)});function b(d,_,m,y){var x=m?"":y.media?"@media ".concat(y.media," {").concat(y.css,"}"):y.css;if(d.styleSheet)d.styleSheet.cssText=g(_,x);else{var S=document.createTextNode(x),w=d.childNodes;w[_]&&d.removeChild(w[_]),w.length?d.insertBefore(S,w[_]):d.appendChild(S)}}function v(d,_,m){var y=m.css,x=m.media,S=m.sourceMap;if(x?d.setAttribute("media",x):d.removeAttribute("media"),S&&btoa&&(y+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(S))))," */")),d.styleSheet)d.styleSheet.cssText=y;else{for(;d.firstChild;)d.removeChild(d.firstChild);d.appendChild(document.createTextNode(y))}}var k=null,C=0;function O(d,_){var m,y,x;if(_.singleton){var S=C++;m=k||(k=h(_)),y=b.bind(null,m,S,!1),x=b.bind(null,m,S,!0)}else m=h(_),y=v.bind(null,m,_),x=function(){(function(w){if(w.parentNode===null)return!1;w.parentNode.removeChild(w)})(m)};return y(d),function(w){if(w){if(w.css===d.css&&w.media===d.media&&w.sourceMap===d.sourceMap)return;y(d=w)}else x()}}r.exports=function(d,_){(_=_||{}).singleton||typeof _.singleton=="boolean"||(_.singleton=(s===void 0&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var m=c(d=d||[],_);return function(y){if(y=y||[],Object.prototype.toString.call(y)==="[object Array]"){for(var x=0;x<m.length;x++){var S=u(m[x]);l[S].references--}for(var w=c(y,_),E=0;E<m.length;E++){var L=u(m[E]);l[L].references===0&&(l[L].updater(),l.splice(L,1))}m=w}}}},function(r,n,a){(n=a(4)(!1)).push([r.i,`.ce-paragraph {
    line-height: 1.6em;
    outline: none;
}

.ce-paragraph[data-placeholder]:empty::before{
  content: attr(data-placeholder);
  color: #707684;
  font-weight: normal;
  opacity: 0;
}

/** Show placeholder at the first paragraph if Editor is empty */
.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty::before {
  opacity: 1;
}

.codex-editor--toolbox-opened .ce-block:first-child .ce-paragraph[data-placeholder]:empty::before,
.codex-editor--empty .ce-block:first-child .ce-paragraph[data-placeholder]:empty:focus::before {
  opacity: 0;
}

.ce-paragraph p:first-of-type{
    margin-top: 0;
}

.ce-paragraph p:last-of-type{
    margin-bottom: 0;
}
`,""]),r.exports=n},function(r,n,a){"use strict";r.exports=function(s){var o=[];return o.toString=function(){return this.map(function(l){var u=function(c,h){var p,g,b,v=c[1]||"",k=c[3];if(!k)return v;if(h&&typeof btoa=="function"){var C=(p=k,g=btoa(unescape(encodeURIComponent(JSON.stringify(p)))),b="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(g),"/*# ".concat(b," */")),O=k.sources.map(function(d){return"/*# sourceURL=".concat(k.sourceRoot||"").concat(d," */")});return[v].concat(O).concat([C]).join(`
`)}return[v].join(`
`)}(l,s);return l[2]?"@media ".concat(l[2]," {").concat(u,"}"):u}).join("")},o.i=function(l,u,c){typeof l=="string"&&(l=[[null,l,""]]);var h={};if(c)for(var p=0;p<this.length;p++){var g=this[p][0];g!=null&&(h[g]=!0)}for(var b=0;b<l.length;b++){var v=[].concat(l[b]);c&&h[v[0]]||(u&&(v[2]?v[2]="".concat(u," and ").concat(v[2]):v[2]=u),o.push(v))}},o}},function(r,n,a){"use strict";a.r(n),n.default=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0.2 -0.3 9 11.4" width="12" height="14">
  <path d="M0 2.77V.92A1 1 0 01.2.28C.35.1.56 0 .83 0h7.66c.28.01.48.1.63.28.14.17.21.38.21.64v1.85c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26a1 1 0 01-.21-.66V1.69H5.6v7.58h.5c.25 0 .45.08.6.23.17.16.25.35.25.6s-.08.45-.24.6a.87.87 0 01-.62.22H3.21a.87.87 0 01-.61-.22.78.78 0 01-.24-.6c0-.25.08-.44.24-.6a.85.85 0 01.61-.23h.5V1.7H1.73v1.08c0 .26-.08.48-.23.66-.15.17-.37.26-.66.26-.28 0-.5-.09-.64-.26A1 1 0 010 2.77z"/>
</svg>
`}])},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(){(0,o.default)(this,p),this.commandName="bold",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--bold"},this.nodes={button:void 0}}return(0,l.default)(p,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(u.default.svg("bold",12,14)),this.nodes.button}},{key:"surround",value:function(g){document.execCommand(this.commandName)}},{key:"checkState",value:function(g){var b=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,b),b}},{key:"shortcut",get:function(){return"CMD+B"}}],[{key:"sanitize",get:function(){return{b:{}}}}]),p}();s.default=h,h.displayName="BoldInlineTool",h.isInline=!0,h.title="Bold",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(){(0,o.default)(this,p),this.commandName="italic",this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--italic"},this.nodes={button:null}}return(0,l.default)(p,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(u.default.svg("italic",4,11)),this.nodes.button}},{key:"surround",value:function(g){document.execCommand(this.commandName)}},{key:"checkState",value:function(g){var b=document.queryCommandState(this.commandName);return this.nodes.button.classList.toggle(this.CSS.buttonActive,b),b}},{key:"shortcut",get:function(){return"CMD+I"}}],[{key:"sanitize",get:function(){return{i:{}}}}]),p}();s.default=h,h.displayName="ItalicInlineTool",h.isInline=!0,h.title="Italic",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(25),e(15),e(8)],(a=typeof(r=function(s,o,l,u,c,h){"use strict";var p=e(9),g=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),u=g(u),c=g(c),h=p(h);var b=function(){function v(k){var C=k.api;(0,o.default)(this,v),this.commandLink="createLink",this.commandUnlink="unlink",this.ENTER_KEY=13,this.CSS={button:"ce-inline-tool",buttonActive:"ce-inline-tool--active",buttonModifier:"ce-inline-tool--link",buttonUnlink:"ce-inline-tool--unlink",input:"ce-inline-tool-input",inputShowed:"ce-inline-tool-input--showed"},this.nodes={button:null,input:null},this.inputOpened=!1,this.toolbar=C.toolbar,this.inlineToolbar=C.inlineToolbar,this.notifier=C.notifier,this.i18n=C.i18n,this.selection=new u.default}return(0,l.default)(v,[{key:"render",value:function(){return this.nodes.button=document.createElement("button"),this.nodes.button.type="button",this.nodes.button.classList.add(this.CSS.button,this.CSS.buttonModifier),this.nodes.button.appendChild(c.default.svg("link",14,10)),this.nodes.button.appendChild(c.default.svg("unlink",15,11)),this.nodes.button}},{key:"renderActions",value:function(){var k=this;return this.nodes.input=document.createElement("input"),this.nodes.input.placeholder=this.i18n.t("Add a link"),this.nodes.input.classList.add(this.CSS.input),this.nodes.input.addEventListener("keydown",function(C){C.keyCode===k.ENTER_KEY&&k.enterPressed(C)}),this.nodes.input}},{key:"surround",value:function(k){if(k){this.inputOpened?(this.selection.restore(),this.selection.removeFakeBackground()):(this.selection.setFakeBackground(),this.selection.save());var C=this.selection.findParentTag("A");if(C)return this.selection.expandToTag(C),this.unlink(),this.closeActions(),this.checkState(),void this.toolbar.close()}this.toggleActions()}},{key:"checkState",value:function(k){var C=this.selection.findParentTag("A");if(C){this.nodes.button.classList.add(this.CSS.buttonUnlink),this.nodes.button.classList.add(this.CSS.buttonActive),this.openActions();var O=C.getAttribute("href");this.nodes.input.value=O!=="null"?O:"",this.selection.save()}else this.nodes.button.classList.remove(this.CSS.buttonUnlink),this.nodes.button.classList.remove(this.CSS.buttonActive);return!!C}},{key:"clear",value:function(){this.closeActions()}},{key:"toggleActions",value:function(){this.inputOpened?this.closeActions(!1):this.openActions(!0)}},{key:"openActions",value:function(){var k=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.nodes.input.classList.add(this.CSS.inputShowed),k&&this.nodes.input.focus(),this.inputOpened=!0}},{key:"closeActions",value:function(){var k=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];if(this.selection.isFakeBackgroundEnabled){var C=new u.default;C.save(),this.selection.restore(),this.selection.removeFakeBackground(),C.restore()}this.nodes.input.classList.remove(this.CSS.inputShowed),this.nodes.input.value="",k&&this.selection.clearSaved(),this.inputOpened=!1}},{key:"enterPressed",value:function(k){var C=this.nodes.input.value||"";return C.trim()?this.validateURL(C)?(C=this.prepareLink(C),this.selection.restore(),this.selection.removeFakeBackground(),this.insertLink(C),k.preventDefault(),k.stopPropagation(),k.stopImmediatePropagation(),this.selection.collapseToEnd(),void this.inlineToolbar.close()):(this.notifier.show({message:"Pasted link is not valid.",style:"error"}),void h.log("Incorrect Link pasted","warn",C)):(this.selection.restore(),this.unlink(),k.preventDefault(),void this.closeActions())}},{key:"validateURL",value:function(k){return!/\s/.test(k)}},{key:"prepareLink",value:function(k){return k=k.trim(),k=this.addProtocol(k)}},{key:"addProtocol",value:function(k){if(/^(\w+):(\/\/)?/.test(k))return k;var C=/^\/[^/\s]/.test(k),O=k.substring(0,1)==="#",d=/^\/\/[^/\s]/.test(k);return C||O||d||(k="http://"+k),k}},{key:"insertLink",value:function(k){var C=this.selection.findParentTag("A");C&&this.selection.expandToTag(C),document.execCommand(this.commandLink,!1,k)}},{key:"unlink",value:function(){document.execCommand(this.commandUnlink)}},{key:"shortcut",get:function(){return"CMD+K"}}],[{key:"sanitize",get:function(){return{a:{href:!0,target:"_blank",rel:"nofollow"}}}}]),v}();s.default=b,b.displayName="LinkInlineTool",b.isInline=!0,b.title="Link",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(g){var b=g.data,v=g.api;(0,o.default)(this,p),this.CSS={wrapper:"ce-stub",info:"ce-stub__info",title:"ce-stub__title",subtitle:"ce-stub__subtitle"},this.api=v,this.title=b.title||this.api.i18n.t("Error"),this.subtitle=this.api.i18n.t("The block can not be displayed correctly."),this.savedData=b.savedData,this.wrapper=this.make()}return(0,l.default)(p,[{key:"render",value:function(){return this.wrapper}},{key:"save",value:function(){return this.savedData}},{key:"make",value:function(){var g=u.default.make("div",this.CSS.wrapper),b=u.default.svg("sad-face",52,52),v=u.default.make("div",this.CSS.info),k=u.default.make("div",this.CSS.title,{textContent:this.title}),C=u.default.make("div",this.CSS.subtitle,{textContent:this.subtitle});return g.appendChild(b),v.appendChild(k),v.appendChild(C),g.appendChild(v),g}}]),p}();s.default=h,h.displayName="Stub",h.isReadOnlySupported=!0,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(66),e(386),e(387),e(388)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=g(o),l=g(l),c=g(c),h=g(h),p=g(p);var b=function(k,C){var O={};for(var d in k)Object.prototype.hasOwnProperty.call(k,d)&&C.indexOf(d)<0&&(O[d]=k[d]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for(d=Object.getOwnPropertySymbols(k);_<d.length;_++)C.indexOf(d[_])<0&&Object.prototype.propertyIsEnumerable.call(k,d[_])&&(O[d[_]]=k[d[_]])}return O},v=function(){function k(C,O,d){(0,o.default)(this,k),this.api=d,this.config=C,this.editorConfig=O}return(0,l.default)(k,[{key:"get",value:function(C){var O=this.config[C],d=O.class,_=O.isInternal,m=_!==void 0&&_,y=b(O,["class","isInternal"]);return new(this.getConstructor(d))({name:C,constructable:d,config:y,api:this.api,isDefault:C===this.editorConfig.defaultBlock,defaultPlaceholder:this.editorConfig.placeholder,isInternal:m})}},{key:"getConstructor",value:function(C){switch(!0){case C[u.InternalInlineToolSettings.IsInline]:return c.default;case C[u.InternalTuneSettings.IsTune]:return h.default;default:return p.default}}}]),k}();s.default=v,v.displayName="ToolsFactory",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(66)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(9),b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=b(o),l=b(l),u=b(u),c=b(c),h=b(h);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){var m;return(0,o.default)(this,_),(m=d.apply(this,arguments)).type=p.ToolType.Inline,m}return(0,l.default)(_,[{key:"create",value:function(){return new this.constructable({api:this.api.getMethodsForTool(this),config:this.settings})}},{key:"title",get:function(){return this.constructable[p.InternalInlineToolSettings.Title]}}]),_}((p=g(p)).default);s.default=k,k.displayName="InlineTool",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(66)],(a=typeof(r=function(s,o,l,u,c,h,p){"use strict";var g=e(9),b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=b(o),l=b(l),u=b(u),c=b(c),h=b(h);var k=function(C){(0,u.default)(_,C);var O,d=(O=_,function(){var m,y=(0,h.default)(O);if(v()){var x=(0,h.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,c.default)(this,m)});function _(){var m;return(0,o.default)(this,_),(m=d.apply(this,arguments)).type=p.ToolType.Tune,m}return(0,l.default)(_,[{key:"create",value:function(m,y){return new this.constructable({api:this.api.getMethodsForTool(this),settings:this.settings,block:y,data:m})}}]),_}((p=g(p)).default);s.default=k,k.displayName="BlockTune",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(5),e(6),e(4),e(66),e(8)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(9),v=e(1);function k(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(O){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=v(o),l=v(l),u=v(u),c=v(c),h=v(h),p=b(p),g=b(g);var C=function(O){(0,u.default)(m,O);var d,_=(d=m,function(){var y,x=(0,h.default)(d);if(k()){var S=(0,h.default)(this).constructor;y=Reflect.construct(x,arguments,S)}else y=x.apply(this,arguments);return(0,c.default)(this,y)});function m(){var y;return(0,o.default)(this,m),(y=_.apply(this,arguments)).type=p.ToolType.Block,y}return(0,l.default)(m,[{key:"create",value:function(y,x,S){return new this.constructable({data:y,block:x,readOnly:S,api:this.api.getMethodsForTool(this),config:this.settings})}},{key:"isReadOnlySupported",get:function(){return this.constructable[p.InternalBlockToolSettings.IsReadOnlySupported]===!0}},{key:"isLineBreaksEnabled",get:function(){return this.constructable[p.InternalBlockToolSettings.IsEnabledLineBreaks]}},{key:"toolbox",get:function(){var y=this.constructable[p.InternalBlockToolSettings.Toolbox],x=this.config[p.UserSettings.Toolbox];if(!g.isEmpty(y)&&(x!=null?x:y)!==!1)return Object.assign({},y,x)}},{key:"conversionConfig",get:function(){return this.constructable[p.InternalBlockToolSettings.ConversionConfig]}},{key:"enabledInlineTools",get:function(){return this.config[p.UserSettings.EnabledInlineTools]}},{key:"enabledBlockTunes",get:function(){return this.config[p.UserSettings.EnabledBlockTunes]}},{key:"pasteConfig",get:function(){return this.constructable[p.InternalBlockToolSettings.PasteConfig]||{}}}]),m}(p.default);s.default=C,C.displayName="BlockTool",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(g){var b=g.api;(0,o.default)(this,p),this.CSS={button:"ce-settings__button",wrapper:"ce-tune-move-down",animation:"wobble"},this.api=b}return(0,l.default)(p,[{key:"render",value:function(){var g=this,b=u.default.make("div",[this.CSS.button,this.CSS.wrapper],{});return b.appendChild(u.default.svg("arrow-down",14,14)),this.api.listeners.on(b,"click",function(v){return g.handleClick(v,b)},!1),this.api.tooltip.onHover(b,this.api.i18n.t("Move down")),b}},{key:"handleClick",value:function(g,b){var v=this,k=this.api.blocks.getCurrentBlockIndex(),C=this.api.blocks.getBlockByIndex(k+1);if(!C)return b.classList.add(this.CSS.animation),void window.setTimeout(function(){b.classList.remove(v.CSS.animation)},500);var O=C.holder,d=O.getBoundingClientRect(),_=Math.abs(window.innerHeight-O.offsetHeight);d.top<window.innerHeight&&(_=window.scrollY+O.offsetHeight),window.scrollTo(0,_),this.api.blocks.move(k+1),this.api.tooltip.hide()}}]),p}();s.default=h,h.displayName="MoveDownTune",h.isTune=!0,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(g){var b=this,v=g.api;(0,o.default)(this,p),this.CSS={button:"ce-settings__button",buttonDelete:"ce-settings__button--delete",buttonConfirm:"ce-settings__button--confirm"},this.nodes={button:null},this.api=v,this.resetConfirmation=function(){b.setConfirmation(!1)}}return(0,l.default)(p,[{key:"render",value:function(){var g=this;return this.nodes.button=u.default.make("div",[this.CSS.button,this.CSS.buttonDelete],{}),this.nodes.button.appendChild(u.default.svg("cross",12,12)),this.api.listeners.on(this.nodes.button,"click",function(b){return g.handleClick(b)},!1),this.api.tooltip.onHover(this.nodes.button,this.api.i18n.t("Delete")),this.nodes.button}},{key:"handleClick",value:function(g){this.needConfirmation?(this.api.events.off("block-settings-closed",this.resetConfirmation),this.api.blocks.delete(),this.api.toolbar.close(),this.api.tooltip.hide(),g.stopPropagation()):(this.setConfirmation(!0),this.api.events.on("block-settings-closed",this.resetConfirmation))}},{key:"setConfirmation",value:function(g){this.needConfirmation=g,this.nodes.button.classList.add(this.CSS.buttonConfirm)}}]),p}();s.default=h,h.displayName="DeleteTune",h.isTune=!0,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(2),e(3),e(15)],(a=typeof(r=function(s,o,l,u){"use strict";var c=e(1);Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=c(o),l=c(l),u=c(u);var h=function(){function p(g){var b=g.api;(0,o.default)(this,p),this.CSS={button:"ce-settings__button",wrapper:"ce-tune-move-up",animation:"wobble"},this.api=b}return(0,l.default)(p,[{key:"render",value:function(){var g=this,b=u.default.make("div",[this.CSS.button,this.CSS.wrapper],{});return b.appendChild(u.default.svg("arrow-up",14,14)),this.api.listeners.on(b,"click",function(v){return g.handleClick(v,b)},!1),this.api.tooltip.onHover(b,this.api.i18n.t("Move up")),b}},{key:"handleClick",value:function(g,b){var v=this,k=this.api.blocks.getCurrentBlockIndex(),C=this.api.blocks.getBlockByIndex(k),O=this.api.blocks.getBlockByIndex(k-1);if(k===0||!C||!O)return b.classList.add(this.CSS.animation),void window.setTimeout(function(){b.classList.remove(v.CSS.animation)},500);var d,_=C.holder,m=O.holder,y=_.getBoundingClientRect(),x=m.getBoundingClientRect();d=x.top>0?Math.abs(y.top)-Math.abs(x.top):window.innerHeight-Math.abs(y.top)+Math.abs(x.top),window.scrollBy(0,-1*d),this.api.blocks.move(k-1),this.api.tooltip.hide()}}]),p}();s.default=h,h.displayName="MoveUpTune",h.isTune=!0,i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){var r,n,a;n=[t,e(29),e(2),e(3),e(5),e(6),e(4),e(146)],(a=typeof(r=function(s,o,l,u,c,h,p,g){"use strict";var b=e(1);function v(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(C){return!1}}Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0,o=b(o),l=b(l),u=b(u),c=b(c),h=b(h),p=b(p);var k=function(C){(0,c.default)(_,C);var O,d=(O=_,function(){var m,y=(0,p.default)(O);if(v()){var x=(0,p.default)(this).constructor;m=Reflect.construct(y,arguments,x)}else m=y.apply(this,arguments);return(0,h.default)(this,m)});function _(){return(0,l.default)(this,_),d.apply(this,arguments)}return(0,u.default)(_,[{key:"blockTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,o.default)(m,2)[1].isBlock()}))}},{key:"inlineTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,o.default)(m,2)[1].isInline()}))}},{key:"blockTunes",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,o.default)(m,2)[1].isTune()}))}},{key:"internalTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return(0,o.default)(m,2)[1].isInternal}))}},{key:"externalTools",get:function(){return new _(Array.from(this.entries()).filter(function(m){return!(0,o.default)(m,2)[1].isInternal}))}}]),_}((0,(g=b(g)).default)(Map));s.default=k,k.displayName="ToolsCollection",i.exports=t.default})=="function"?r.apply(t,n):r)===void 0||(i.exports=a)},function(i,t,e){i.exports=function(r){var n={};function a(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return r[s].call(o.exports,o,o.exports,a),o.l=!0,o.exports}return a.m=r,a.c=n,a.d=function(s,o,l){a.o(s,o)||Object.defineProperty(s,o,{enumerable:!0,get:l})},a.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},a.t=function(s,o){if(1&o&&(s=a(s)),8&o||4&o&&typeof s=="object"&&s&&s.__esModule)return s;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:s}),2&o&&typeof s!="string")for(var u in s)a.d(l,u,function(c){return s[c]}.bind(null,u));return l},a.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return a.d(o,"a",o),o},a.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},a.p="",a(a.s=0)}([function(r,n,a){r.exports=a(1)},function(r,n,a){"use strict";a.r(n),a.d(n,"default",function(){return s});class s{constructor(){this.nodes={wrapper:null,content:null},this.showed=!1,this.offsetTop=10,this.offsetLeft=10,this.offsetRight=10,this.hidingDelay=0,this.loadStyles(),this.prepare(),window.addEventListener("scroll",()=>{this.showed&&this.hide(!0)},{passive:!0})}get CSS(){return{tooltip:"ct",tooltipContent:"ct__content",tooltipShown:"ct--shown",placement:{left:"ct--left",bottom:"ct--bottom",right:"ct--right",top:"ct--top"}}}show(l,u,c){this.nodes.wrapper||this.prepare(),this.hidingTimeout&&clearTimeout(this.hidingTimeout);let h=Object.assign({placement:"bottom",marginTop:0,marginLeft:0,marginRight:0,marginBottom:0,delay:70,hidingDelay:0},c);if(h.hidingDelay&&(this.hidingDelay=h.hidingDelay),this.nodes.content.innerHTML="",typeof u=="string")this.nodes.content.appendChild(document.createTextNode(u));else{if(!(u instanceof Node))throw Error("[CodeX Tooltip] Wrong type of \xABcontent\xBB passed. It should be an instance of Node or String. But "+typeof u+" given.");this.nodes.content.appendChild(u)}switch(this.nodes.wrapper.classList.remove(...Object.values(this.CSS.placement)),h.placement){case"top":this.placeTop(l,h);break;case"left":this.placeLeft(l,h);break;case"right":this.placeRight(l,h);break;case"bottom":default:this.placeBottom(l,h)}h&&h.delay?this.showingTimeout=setTimeout(()=>{this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0},h.delay):(this.nodes.wrapper.classList.add(this.CSS.tooltipShown),this.showed=!0)}hide(l=!1){if(this.hidingDelay&&!l)return this.hidingTimeout&&clearTimeout(this.hidingTimeout),void(this.hidingTimeout=setTimeout(()=>{this.hide(!0)},this.hidingDelay));this.nodes.wrapper.classList.remove(this.CSS.tooltipShown),this.showed=!1,this.showingTimeout&&clearTimeout(this.showingTimeout)}onHover(l,u,c){l.addEventListener("mouseenter",()=>{this.show(l,u,c)}),l.addEventListener("mouseleave",()=>{this.hide()})}prepare(){this.nodes.wrapper=this.make("div",this.CSS.tooltip),this.nodes.content=this.make("div",this.CSS.tooltipContent),this.append(this.nodes.wrapper,this.nodes.content),this.append(document.body,this.nodes.wrapper)}loadStyles(){let l="codex-tooltips-style";if(document.getElementById(l))return;let u=a(2),c=this.make("style",null,{textContent:u.toString(),id:l});this.prepend(document.head,c)}placeBottom(l,u){let c=l.getBoundingClientRect(),h=c.left+l.clientWidth/2-this.nodes.wrapper.offsetWidth/2,p=c.bottom+window.pageYOffset+this.offsetTop+u.marginTop;this.applyPlacement("bottom",h,p)}placeTop(l,u){let c=l.getBoundingClientRect(),h=c.left+l.clientWidth/2-this.nodes.wrapper.offsetWidth/2,p=c.top+window.pageYOffset-this.nodes.wrapper.clientHeight-this.offsetTop;this.applyPlacement("top",h,p)}placeLeft(l,u){let c=l.getBoundingClientRect(),h=c.left-this.nodes.wrapper.offsetWidth-this.offsetLeft-u.marginLeft,p=c.top+window.pageYOffset+l.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("left",h,p)}placeRight(l,u){let c=l.getBoundingClientRect(),h=c.right+this.offsetRight+u.marginRight,p=c.top+window.pageYOffset+l.clientHeight/2-this.nodes.wrapper.offsetHeight/2;this.applyPlacement("right",h,p)}applyPlacement(l,u,c){this.nodes.wrapper.classList.add(this.CSS.placement[l]),this.nodes.wrapper.style.left=u+"px",this.nodes.wrapper.style.top=c+"px"}make(l,u=null,c={}){let h=document.createElement(l);Array.isArray(u)?h.classList.add(...u):u&&h.classList.add(u);for(let p in c)c.hasOwnProperty(p)&&(h[p]=c[p]);return h}append(l,u){Array.isArray(u)?u.forEach(c=>l.appendChild(c)):l.appendChild(u)}prepend(l,u){Array.isArray(u)?(u=u.reverse()).forEach(c=>l.prepend(c)):l.prepend(u)}}},function(r,n){r.exports=`.ct{z-index:999;opacity:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none;-webkit-transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1);transition:opacity 50ms ease-in,transform 70ms cubic-bezier(.215,.61,.355,1),-webkit-transform 70ms cubic-bezier(.215,.61,.355,1);will-change:opacity,top,left;-webkit-box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);box-shadow:0 8px 12px 0 rgba(29,32,43,.17),0 4px 5px -3px rgba(5,6,12,.49);border-radius:9px}.ct,.ct:before{position:absolute;top:0;left:0}.ct:before{content:"";bottom:0;right:0;background-color:#1d202b;z-index:-1;border-radius:4px}@supports(-webkit-mask-box-image:url("")){.ct:before{border-radius:0;-webkit-mask-box-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M10.71 0h2.58c3.02 0 4.64.42 6.1 1.2a8.18 8.18 0 013.4 3.4C23.6 6.07 24 7.7 24 10.71v2.58c0 3.02-.42 4.64-1.2 6.1a8.18 8.18 0 01-3.4 3.4c-1.47.8-3.1 1.21-6.11 1.21H10.7c-3.02 0-4.64-.42-6.1-1.2a8.18 8.18 0 01-3.4-3.4C.4 17.93 0 16.3 0 13.29V10.7c0-3.02.42-4.64 1.2-6.1a8.18 8.18 0 013.4-3.4C6.07.4 7.7 0 10.71 0z"/></svg>') 48% 41% 37.9% 53.3%}}@media (--mobile){.ct{display:none}}.ct__content{padding:6px 10px;color:#cdd1e0;font-size:12px;text-align:center;letter-spacing:.02em;line-height:1em}.ct:after{content:"";width:8px;height:8px;position:absolute;background-color:#1d202b;z-index:-1}.ct--bottom{-webkit-transform:translateY(5px);transform:translateY(5px)}.ct--bottom:after{top:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--top{-webkit-transform:translateY(-5px);transform:translateY(-5px)}.ct--top:after{top:auto;bottom:-3px;left:50%;-webkit-transform:translateX(-50%) rotate(-45deg);transform:translateX(-50%) rotate(-45deg)}.ct--left{-webkit-transform:translateX(-5px);transform:translateX(-5px)}.ct--left:after{top:50%;left:auto;right:0;-webkit-transform:translate(41.6%,-50%) rotate(-45deg);transform:translate(41.6%,-50%) rotate(-45deg)}.ct--right{-webkit-transform:translateX(5px);transform:translateX(5px)}.ct--right:after{top:50%;left:0;-webkit-transform:translate(-41.6%,-50%) rotate(-45deg);transform:translate(-41.6%,-50%) rotate(-45deg)}.ct--shown{opacity:1;-webkit-transform:none;transform:none}`}]).default},function(i,t,e){"use strict";e.r(t),t.default=`<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg">
<symbol id="arrow-down" viewBox="0 0 14 14">
  <path transform="matrix(1 0 0 -1 0 14)" d="M8.024 4.1v8.6a1.125 1.125 0 0 1-2.25 0V4.1L2.18 7.695A1.125 1.125 0 1 1 .59 6.104L6.103.588c.44-.439 1.151-.439 1.59 0l5.516 5.516a1.125 1.125 0 0 1-1.59 1.59L8.023 4.1z"/>

</symbol>
<symbol id="arrow-up" viewBox="0 0 14 14">
    <path d="M8.024 4.1v8.6a1.125 1.125 0 0 1-2.25 0V4.1L2.18 7.695A1.125 1.125 0 1 1 .59 6.104L6.103.588c.44-.439 1.151-.439 1.59 0l5.516 5.516a1.125 1.125 0 0 1-1.59 1.59L8.023 4.1z"/>

</symbol>
<symbol id="bold" viewBox="0 0 12 14"><path d="M5.997 14H1.72c-.618 0-1.058-.138-1.323-.415C.132 13.308 0 12.867 0 12.262V1.738C0 1.121.135.676.406.406.676.136 1.114 0 1.719 0h4.536c.669 0 1.248.041 1.738.124.49.083.93.242 1.318.478a3.458 3.458 0 0 1 1.461 1.752c.134.366.2.753.2 1.16 0 1.401-.7 2.426-2.1 3.075 1.84.586 2.76 1.726 2.76 3.42 0 .782-.2 1.487-.602 2.114a3.61 3.61 0 0 1-1.623 1.39 5.772 5.772 0 0 1-1.471.377c-.554.073-1.2.11-1.939.11zm-.21-6.217h-2.95v4.087h3.046c1.916 0 2.874-.69 2.874-2.072 0-.707-.248-1.22-.745-1.537-.496-.319-1.238-.478-2.225-.478zM2.837 2.13v3.619h2.597c.707 0 1.252-.067 1.638-.2.385-.134.68-.389.883-.765.16-.267.239-.566.239-.897 0-.707-.252-1.176-.755-1.409-.503-.232-1.27-.348-2.301-.348H2.836z"/>
</symbol>
<symbol id="cross" viewBox="0 0 237 237">
  <path transform="rotate(45 280.675 51.325)" d="M191 191V73c0-5.523 4.477-10 10-10h25c5.523 0 10 4.477 10 10v118h118c5.523 0 10 4.477 10 10v25c0 5.523-4.477 10-10 10H236v118c0 5.523-4.477 10-10 10h-25c-5.523 0-10-4.477-10-10V236H73c-5.523 0-10-4.477-10-10v-25c0-5.523 4.477-10 10-10h118z"/>

</symbol>
<symbol id="dots" viewBox="0 0 8 8">
  <circle cx="6.5" cy="1.5" r="1.5"/>
  <circle cx="6.5" cy="6.5" r="1.5"/>
  <circle cx="1.5" cy="1.5" r="1.5"/>
  <circle cx="1.5" cy="6.5" r="1.5"/>

</symbol>
<symbol id="italic" viewBox="0 0 4 11">
    <path d="M3.289 4.17L2.164 9.713c-.078.384-.238.674-.48.87-.243.198-.52.296-.831.296-.312 0-.545-.1-.699-.302-.153-.202-.192-.49-.116-.864L1.15 4.225c.077-.38.232-.665.466-.857a1.25 1.25 0 01.818-.288c.312 0 .55.096.713.288.163.192.21.46.141.801zm-.667-2.09c-.295 0-.53-.09-.706-.273-.176-.181-.233-.439-.173-.77.055-.302.207-.55.457-.745C2.45.097 2.716 0 3 0c.273 0 .5.088.68.265.179.176.238.434.177.771-.06.327-.21.583-.45.767-.24.185-.502.277-.785.277z"/>

</symbol>
<symbol id="link" viewBox="0 0 14 10">
  <path d="M6 0v2H5a3 3 0 000 6h1v2H5A5 5 0 115 0h1zm2 0h1a5 5 0 110 10H8V8h1a3 3 0 000-6H8V0zM5 4h4a1 1 0 110 2H5a1 1 0 110-2z"/>

</symbol>
<symbol id="plus" viewBox="0 0 14 14">
    <path d="M8.05 5.8h4.625a1.125 1.125 0 0 1 0 2.25H8.05v4.625a1.125 1.125 0 0 1-2.25 0V8.05H1.125a1.125 1.125 0 0 1 0-2.25H5.8V1.125a1.125 1.125 0 0 1 2.25 0V5.8z"/>

</symbol>
<symbol id="sad-face" viewBox="0 0 52 52">
    <path fill="#D76B6B" fill-rule="nonzero" d="M26 52C11.64 52 0 40.36 0 26S11.64 0 26 0s26 11.64 26 26-11.64 26-26 26zm0-3.25c12.564 0 22.75-10.186 22.75-22.75S38.564 3.25 26 3.25 3.25 13.436 3.25 26 13.436 48.75 26 48.75zM15.708 33.042a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm23.834 0a2.167 2.167 0 1 1 0-4.334 2.167 2.167 0 0 1 0 4.334zm-15.875 5.452a1.083 1.083 0 1 1-1.834-1.155c1.331-2.114 3.49-3.179 6.334-3.179 2.844 0 5.002 1.065 6.333 3.18a1.083 1.083 0 1 1-1.833 1.154c-.913-1.45-2.366-2.167-4.5-2.167s-3.587.717-4.5 2.167z"/>

</symbol>
<symbol id="toggler-down">
  <path d="M6.5 9.294a.792.792 0 01-.562-.232L2.233 5.356a.794.794 0 011.123-1.123L6.5 7.377l3.144-3.144a.794.794 0 011.123 1.123L7.062 9.062a.792.792 0 01-.562.232z"/>

</symbol>
<symbol id="unlink" viewBox="0 0 15 11">
  <path d="M13.073 2.099l-1.448 1.448A3 3 0 009 2H8V0h1c1.68 0 3.166.828 4.073 2.099zM6.929 4l-.879.879L7.172 6H5a1 1 0 110-2h1.929zM6 0v2H5a3 3 0 100 6h1v2H5A5 5 0 115 0h1zm6.414 7l2.122 2.121-1.415 1.415L11 8.414l-2.121 2.122L7.464 9.12 9.586 7 7.464 4.879 8.88 3.464 11 5.586l2.121-2.122 1.415 1.415L12.414 7z"/>

</symbol></svg>`},function(i,t){i.exports='.codex-editor{position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;z-index:1}.codex-editor .hide,.codex-editor__redactor--hidden{display:none}.codex-editor__redactor [contenteditable]:empty:after{content:"\\feff "}@media (min-width:651px){.codex-editor--narrow .codex-editor__redactor{margin-right:50px}}@media (min-width:651px){.codex-editor--narrow.codex-editor--rtl .codex-editor__redactor{margin-left:50px;margin-right:0}}@media (min-width:651px){.codex-editor--narrow .ce-toolbar__actions{right:-5px}}.codex-editor__loader{position:relative;height:30vh}.codex-editor__loader:before{content:"";position:absolute;left:50%;top:50%;width:30px;height:30px;margin-top:-15px;margin-left:-15px;border-radius:50%;border:2px solid rgba(201,201,204,.48);border-top-color:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-animation:editor-loader-spin .8s linear infinite;animation:editor-loader-spin .8s linear infinite;will-change:transform}.codex-editor-copyable{position:absolute;height:1px;width:1px;top:-400%;opacity:.001}.codex-editor-overlay{position:fixed;top:0;left:0;right:0;bottom:0;z-index:999;pointer-events:none;overflow:hidden}.codex-editor-overlay__container{position:relative;pointer-events:auto;z-index:0}.codex-editor-overlay__rectangle{position:absolute;pointer-events:none;background-color:rgba(46,170,220,.2);border:1px solid transparent}.codex-editor svg{fill:currentColor;vertical-align:middle;max-height:100%}::-moz-selection{background-color:#d4ecff}::selection{background-color:#d4ecff}.codex-editor--toolbox-opened [contentEditable=true][data-placeholder]:focus:before{opacity:0!important}@-webkit-keyframes editor-loader-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes editor-loader-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.ce-toolbar{position:absolute;left:0;right:0;top:0;-webkit-transition:opacity .1s ease;transition:opacity .1s ease;will-change:opacity,transform;display:none}@media (max-width:650px){.ce-toolbar{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}}@media (max-width:650px) and (max-width:650px){.ce-toolbar{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}@media (max-width:650px){.ce-toolbar{padding:3px;margin-top:5px}.ce-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}}.ce-toolbar--opened{display:block}@media (max-width:650px){.ce-toolbar--opened{display:-webkit-box;display:-ms-flexbox;display:flex}}.ce-toolbar__content{max-width:650px;margin:0 auto;position:relative}@media (max-width:650px){.ce-toolbar__content{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-line-pack:center;align-content:center;margin:0;max-width:calc(100% - 35px)}}.ce-toolbar__plus{color:#707684;cursor:pointer;width:34px;height:34px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;left:-34px;-ms-flex-negative:0;flex-shrink:0}.ce-toolbar__plus--active,.ce-toolbar__plus:hover{color:#388ae5}.ce-toolbar__plus--active{-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-toolbar__plus-shortcut{opacity:.6;word-spacing:-2px;margin-top:5px}.ce-toolbar__plus--hidden{display:none}@media (max-width:650px){.ce-toolbar__plus{display:-webkit-inline-box!important;display:-ms-inline-flexbox!important;display:inline-flex!important;position:static;-webkit-transform:none!important;transform:none!important}}.ce-toolbar .ce-toolbox,.ce-toolbar__plus{top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.ce-toolbar__actions{position:absolute;right:-30px;top:5px;opacity:0}@media (max-width:650px){.ce-toolbar__actions{position:absolute;right:-28px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}}.ce-toolbar__actions--opened{opacity:1}.ce-toolbar__actions-buttons{text-align:right}.ce-toolbar__settings-btn{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:18px;height:18px;color:#707684;cursor:pointer;background:#eff2f5;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce-toolbar__settings-btn:hover{color:#1d202b}@media (max-width:650px){.ce-toolbar__settings-btn{background:transparent}}@media (min-width:651px){.codex-editor--narrow .ce-toolbar__plus{left:5px}}.ce-toolbox{position:absolute;visibility:hidden;-webkit-transition:opacity .1s ease;transition:opacity .1s ease;will-change:opacity;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}@media (max-width:650px){.ce-toolbox{position:static;-webkit-transform:none!important;transform:none!important;-webkit-box-align:center;-ms-flex-align:center;align-items:center;overflow-x:auto}}.ce-toolbox--opened{opacity:1;visibility:visible}.ce-toolbox__button{color:#707684;cursor:pointer;width:34px;height:34px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0}.ce-toolbox__button--active,.ce-toolbox__button:hover{color:#388ae5}.ce-toolbox__button--active{-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-toolbox-button-tooltip__shortcut{opacity:.6;word-spacing:-3px;margin-top:3px}@media (min-width:651px){.codex-editor--narrow .ce-toolbox{background:#fff;z-index:2}}.ce-inline-toolbar{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}@media (max-width:650px){.ce-inline-toolbar{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}.ce-inline-toolbar{-webkit-transform:translateX(-50%) translateY(8px) scale(.9);transform:translateX(-50%) translateY(8px) scale(.9);opacity:0;visibility:hidden;-webkit-transition:opacity .25s ease,-webkit-transform .15s ease;transition:opacity .25s ease,-webkit-transform .15s ease;transition:transform .15s ease,opacity .25s ease;transition:transform .15s ease,opacity .25s ease,-webkit-transform .15s ease;will-change:transform,opacity;top:0;left:0}.ce-inline-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-inline-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}.ce-inline-toolbar--showed{opacity:1;visibility:visible;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.ce-inline-toolbar--left-oriented{-webkit-transform:translateX(-23px) translateY(8px) scale(.9);transform:translateX(-23px) translateY(8px) scale(.9)}.ce-inline-toolbar--left-oriented.ce-inline-toolbar--showed{-webkit-transform:translateX(-23px);transform:translateX(-23px)}.ce-inline-toolbar--right-oriented{-webkit-transform:translateX(-100%) translateY(8px) scale(.9);transform:translateX(-100%) translateY(8px) scale(.9);margin-left:23px}.ce-inline-toolbar--right-oriented.ce-inline-toolbar--showed{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.ce-inline-toolbar [hidden]{display:none!important}.ce-inline-toolbar__toggler-and-button-wrapper{width:100%;padding:0 6px}.ce-inline-toolbar__buttons,.ce-inline-toolbar__toggler-and-button-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-inline-toolbar__dropdown{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:34px;padding:0 9px 0 10px;margin:0 6px 0 -6px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:pointer;border-right:1px solid rgba(201,201,204,.48)}.ce-inline-toolbar__dropdown:hover{background:#eff2f5}.ce-inline-toolbar__dropdown--hidden{display:none}.ce-inline-toolbar__dropdown-content{display:-webkit-box;display:-ms-flexbox;display:flex;font-weight:500;font-size:14px}.ce-inline-toolbar__dropdown-content svg{height:12px}.ce-inline-toolbar__dropdown .icon--toggler-down{margin-left:4px}.ce-inline-toolbar__shortcut{opacity:.6;word-spacing:-3px;margin-top:3px}.ce-inline-tool{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:34px;height:34px;line-height:34px;padding:0!important;text-align:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:#000;margin:0}.ce-inline-tool:hover{background-color:#eff2f5}.ce-inline-tool{border-radius:0;line-height:normal;width:auto;padding:0 5px!important;min-width:24px}.ce-inline-tool--active{color:#388ae5}.ce-inline-tool--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.ce-inline-tool--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-inline-tool:not(:last-of-type){margin-right:2px}.ce-inline-tool .icon{height:12px}.ce-inline-tool--link .icon--unlink,.ce-inline-tool--unlink .icon--link{display:none}.ce-inline-tool--unlink .icon--unlink{display:inline-block;margin-bottom:-1px}.ce-inline-tool-input{outline:none;border:0;border-radius:0 0 4px 4px;margin:0;font-size:13px;padding:10px;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;display:none;font-weight:500;border-top:1px solid rgba(201,201,204,.48)}.ce-inline-tool-input::-webkit-input-placeholder{color:#707684}.ce-inline-tool-input::-moz-placeholder{color:#707684}.ce-inline-tool-input:-ms-input-placeholder{color:#707684}.ce-inline-tool-input::-ms-input-placeholder{color:#707684}.ce-inline-tool-input::placeholder{color:#707684}.ce-inline-tool-input--showed{display:block}.ce-conversion-toolbar{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}@media (max-width:650px){.ce-conversion-toolbar{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}.ce-conversion-toolbar{opacity:0;visibility:hidden;will-change:transform,opacity;-webkit-transition:opacity .1s ease,-webkit-transform .1s ease;transition:opacity .1s ease,-webkit-transform .1s ease;transition:transform .1s ease,opacity .1s ease;transition:transform .1s ease,opacity .1s ease,-webkit-transform .1s ease;-webkit-transform:translateY(-8px);transform:translateY(-8px);left:-1px;width:150px;margin-top:5px;-webkit-box-sizing:content-box;box-sizing:content-box}.ce-conversion-toolbar--left-oriented:before{left:15px;margin-left:0}.ce-conversion-toolbar--right-oriented:before{left:auto;right:15px;margin-left:0}.ce-conversion-toolbar--showed{opacity:1;visibility:visible;-webkit-transform:none;transform:none}.ce-conversion-toolbar [hidden]{display:none!important}.ce-conversion-toolbar__buttons{display:-webkit-box;display:-ms-flexbox;display:flex}.ce-conversion-toolbar__label{color:#707684;font-size:11px;font-weight:500;letter-spacing:.33px;padding:10px 10px 5px;text-transform:uppercase}.ce-conversion-tool{display:-webkit-box;display:-ms-flexbox;display:flex;padding:5px 10px;font-size:14px;line-height:20px;font-weight:500;cursor:pointer;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ce-conversion-tool--hidden{display:none}.ce-conversion-tool--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.ce-conversion-tool--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-conversion-tool:hover{background:#eff2f5}.ce-conversion-tool__icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:20px;height:20px;border:1px solid rgba(201,201,204,.48);border-radius:3px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-right:10px;background:#fff}.ce-conversion-tool__icon svg{width:11px;height:11px}.ce-conversion-tool--last{margin-right:0!important}.ce-conversion-tool--active{color:#388ae5!important;-webkit-animation:bounceIn .75s 1;animation:bounceIn .75s 1;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards}.ce-settings{position:absolute;background-color:#fff;border:1px solid #eaeaea;-webkit-box-shadow:0 3px 15px -3px rgba(13,20,33,.13);box-shadow:0 3px 15px -3px rgba(13,20,33,.13);border-radius:4px;z-index:2}@media (max-width:650px){.ce-settings{-webkit-box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);box-shadow:0 13px 7px -5px rgba(26,38,49,.09),6px 15px 34px -6px rgba(33,48,73,.29);border-bottom-color:#d5d7db}}.ce-settings{right:-1px;top:30px;min-width:114px;-webkit-box-sizing:content-box;box-sizing:content-box}.ce-settings--left-oriented:before{left:15px;margin-left:0}.ce-settings--right-oriented:before{left:auto;right:15px;margin-left:0}@media (max-width:650px){.ce-settings{bottom:40px;right:-11px;top:auto}}.ce-settings:before{left:auto;right:12px}@media (max-width:650px){.ce-settings:before{bottom:-5px;top:auto}}.ce-settings{display:none}.ce-settings--opened{display:block;-webkit-animation-duration:.1s;animation-duration:.1s;-webkit-animation-name:panelShowing;animation-name:panelShowing}.ce-settings__plugin-zone:not(:empty){padding:3px 3px 0}.ce-settings__default-zone:not(:empty){padding:3px}.ce-settings__button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:34px;height:34px;line-height:34px;padding:0!important;text-align:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:#000;margin:0}.ce-settings__button:hover{background-color:#eff2f5}.ce-settings__button--active{color:#388ae5}.ce-settings__button--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.ce-settings__button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.ce-settings__button:not(:nth-child(3n+3)){margin-right:3px}.ce-settings__button:nth-child(n+4){margin-top:3px}.ce-settings__button{line-height:32px}.ce-settings__button--disabled{cursor:not-allowed!important;opacity:.3}.ce-settings__button--selected{color:#388ae5}.ce-settings__button--delete{-webkit-transition:background-color .3s ease;transition:background-color .3s ease;will-change:background-color}.ce-settings__button--delete .icon{-webkit-transition:-webkit-transform .2s ease-out;transition:-webkit-transform .2s ease-out;transition:transform .2s ease-out;transition:transform .2s ease-out,-webkit-transform .2s ease-out;will-change:transform}.ce-settings__button--confirm{background-color:#e24a4a!important;color:#fff}.ce-settings__button--confirm:hover{background-color:#d54a4a!important}.ce-settings__button--confirm .icon{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.ce-block:first-of-type{margin-top:0}.ce-block--selected .ce-block__content{background:#e1f2ff}.ce-block--selected .ce-block__content [contenteditable]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ce-block--selected .ce-block__content .ce-stub,.ce-block--selected .ce-block__content img{opacity:.55}.ce-block--stretched .ce-block__content{max-width:none}.ce-block__content{position:relative;max-width:650px;margin:0 auto;-webkit-transition:background-color .15s ease;transition:background-color .15s ease}.ce-block--drop-target .ce-block__content:before{content:"";position:absolute;top:100%;left:-20px;margin-top:-1px;height:8px;width:8px;border:solid #388ae5;border-width:1px 1px 0 0;-webkit-transform-origin:right;transform-origin:right;-webkit-transform:rotate(45deg);transform:rotate(45deg)}.ce-block--drop-target .ce-block__content:after{content:"";position:absolute;top:100%;height:1px;width:100%;color:#388ae5;background:repeating-linear-gradient(90deg,#388ae5,#388ae5 1px,#fff 0,#fff 6px)}.ce-block a{cursor:pointer;text-decoration:underline}.ce-block b{font-weight:700}.ce-block i{font-style:italic}@media (min-width:651px){.codex-editor--narrow .ce-block--focused{margin-right:-50px;padding-right:50px}}.wobble{-webkit-animation-name:wobble;animation-name:wobble;-webkit-animation-duration:.4s;animation-duration:.4s}@-webkit-keyframes wobble{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-5%,0,0) rotate(-5deg);transform:translate3d(-5%,0,0) rotate(-5deg)}30%{-webkit-transform:translate3d(2%,0,0) rotate(3deg);transform:translate3d(2%,0,0) rotate(3deg)}45%{-webkit-transform:translate3d(-3%,0,0) rotate(-3deg);transform:translate3d(-3%,0,0) rotate(-3deg)}60%{-webkit-transform:translate3d(2%,0,0) rotate(2deg);transform:translate3d(2%,0,0) rotate(2deg)}75%{-webkit-transform:translate3d(-1%,0,0) rotate(-1deg);transform:translate3d(-1%,0,0) rotate(-1deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@keyframes wobble{0%{-webkit-transform:translateZ(0);transform:translateZ(0)}15%{-webkit-transform:translate3d(-5%,0,0) rotate(-5deg);transform:translate3d(-5%,0,0) rotate(-5deg)}30%{-webkit-transform:translate3d(2%,0,0) rotate(3deg);transform:translate3d(2%,0,0) rotate(3deg)}45%{-webkit-transform:translate3d(-3%,0,0) rotate(-3deg);transform:translate3d(-3%,0,0) rotate(-3deg)}60%{-webkit-transform:translate3d(2%,0,0) rotate(2deg);transform:translate3d(2%,0,0) rotate(2deg)}75%{-webkit-transform:translate3d(-1%,0,0) rotate(-1deg);transform:translate3d(-1%,0,0) rotate(-1deg)}to{-webkit-transform:translateZ(0);transform:translateZ(0)}}@-webkit-keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes bounceIn{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.9,.9,.9);transform:scale3d(.9,.9,.9)}20%{-webkit-transform:scale3d(1.03,1.03,1.03);transform:scale3d(1.03,1.03,1.03)}60%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes selectionBounce{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}50%{-webkit-transform:scale3d(1.01,1.01,1.01);transform:scale3d(1.01,1.01,1.01)}70%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@keyframes buttonClicked{0%,20%,40%,60%,80%,to{-webkit-animation-timing-function:cubic-bezier(.215,.61,.355,1);animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{-webkit-transform:scale3d(.95,.95,.95);transform:scale3d(.95,.95,.95)}60%{-webkit-transform:scale3d(1.02,1.02,1.02);transform:scale3d(1.02,1.02,1.02)}80%{-webkit-transform:scaleX(1);transform:scaleX(1)}}@-webkit-keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes panelShowing{0%{opacity:0;-webkit-transform:translateY(-8px) scale(.9);transform:translateY(-8px) scale(.9)}70%{opacity:1;-webkit-transform:translateY(2px);transform:translateY(2px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}.cdx-block{padding:.4em 0}.cdx-input{border:1px solid rgba(201,201,204,.48);-webkit-box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);box-shadow:inset 0 1px 2px 0 rgba(35,44,72,.06);border-radius:3px;padding:10px 12px;outline:none;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box}.cdx-input[data-placeholder]:before{position:static!important;display:inline-block;width:0;white-space:nowrap;pointer-events:none}.cdx-settings-button{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:34px;height:34px;line-height:34px;padding:0!important;text-align:center;border-radius:3px;cursor:pointer;border:0;outline:none;background-color:transparent;vertical-align:bottom;color:#000;margin:0}.cdx-settings-button:hover{background-color:#eff2f5}.cdx-settings-button--focused{-webkit-box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);box-shadow:inset 0 0 0 1px rgba(7,161,227,.08);background:rgba(34,186,255,.08)!important}.cdx-settings-button--focused-animated{-webkit-animation-name:buttonClicked;animation-name:buttonClicked;-webkit-animation-duration:.25s;animation-duration:.25s}.cdx-settings-button:not(:nth-child(3n+3)){margin-right:3px}.cdx-settings-button:nth-child(n+4){margin-top:3px}.cdx-settings-button--active{color:#388ae5}.cdx-loader{position:relative;border:1px solid rgba(201,201,204,.48)}.cdx-loader:before{content:"";position:absolute;left:50%;top:50%;width:18px;height:18px;margin:-11px 0 0 -11px;border:2px solid rgba(201,201,204,.48);border-left-color:#388ae5;border-radius:50%;-webkit-animation:cdxRotation 1.2s linear infinite;animation:cdxRotation 1.2s linear infinite}@-webkit-keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes cdxRotation{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.cdx-button{padding:13px;border-radius:3px;border:1px solid rgba(201,201,204,.48);font-size:14.9px;background:#fff;-webkit-box-shadow:0 2px 2px 0 rgba(18,30,57,.04);box-shadow:0 2px 2px 0 rgba(18,30,57,.04);color:#707684;text-align:center;cursor:pointer}.cdx-button:hover{background:#fbfcfe;-webkit-box-shadow:0 1px 3px 0 rgba(18,30,57,.08);box-shadow:0 1px 3px 0 rgba(18,30,57,.08)}.cdx-button svg{height:20px;margin-right:.2em;margin-top:-2px}.ce-stub{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%;padding:3.5em 0;margin:17px 0;border-radius:3px;background:#fcf7f7;color:#b46262}.ce-stub__info{margin-left:20px}.ce-stub__title{margin-bottom:3px;font-weight:600;font-size:18px;text-transform:capitalize}.ce-stub__subtitle{font-size:16px}.codex-editor.codex-editor--rtl{direction:rtl}.codex-editor.codex-editor--rtl .cdx-list{padding-left:0;padding-right:40px}.codex-editor.codex-editor--rtl .ce-toolbar__plus{right:-34px;left:auto}.codex-editor.codex-editor--rtl .ce-toolbar__actions{right:auto;left:-34px}@media (max-width:650px){.codex-editor.codex-editor--rtl .ce-toolbar__actions{margin-left:0;margin-right:auto;padding-right:0;padding-left:10px}}.codex-editor.codex-editor--rtl .ce-settings{left:5px;right:auto}.codex-editor.codex-editor--rtl .ce-settings:before{right:auto;left:25px}.codex-editor.codex-editor--rtl .ce-settings__button:not(:nth-child(3n+3)){margin-left:3px;margin-right:0}.codex-editor.codex-editor--rtl .ce-conversion-tool__icon{margin-right:0;margin-left:10px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown{border-right:0 solid transparent;border-left:1px solid rgba(201,201,204,.48);margin:0 -6px 0 6px}.codex-editor.codex-editor--rtl .ce-inline-toolbar__dropdown .icon--toggler-down{margin-left:0;margin-right:4px}@media (min-width:651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__plus{left:0;right:5px}}@media (min-width:651px){.codex-editor--narrow.codex-editor--rtl .ce-toolbar__actions{left:-5px}}'}])})});var Vd=ye((pn,Ya)=>{(function(i,t){typeof pn=="object"&&typeof Ya=="object"?Ya.exports=t():typeof define=="function"&&define.amd?define([],t):typeof pn=="object"?pn.Undo=t():i.Undo=t()})(window,function(){return function(i){var t={};function e(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return i[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=i,e.c=t,e.d=function(r,n,a){e.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:a})},e.r=function(r){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,n){if(1&n&&(r=e(r)),8&n||4&n&&typeof r=="object"&&r&&r.__esModule)return r;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:r}),2&n&&typeof r!="string")for(var s in r)e.d(a,s,function(o){return r[o]}.bind(null,s));return a},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,"a",n),n},e.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},e.p="/",e(e.s=0)}([function(i,t,e){"use strict";function r(o,l){for(var u=0;u<l.length;u++){var c=l[u];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(o,c.key,c)}}e.r(t),e.d(t,"default",function(){return s});var n=function(){function o(h,p){(function(g,b){if(!(g instanceof b))throw new TypeError("Cannot call a class as a function")})(this,o),this.holder=typeof p=="string"?document.getElementById(p):p,this.observer=null,this.debounceTimer=200,this.mutationDebouncer=this.debounce(function(){h()},this.debounceTimer)}var l,u,c;return l=o,(u=[{key:"setMutationObserver",value:function(){var h=this,p=this.holder;this.observer=new MutationObserver(function(g){h.mutationHandler(g)}),this.observer.observe(p,{childList:!0,attributes:!0,subtree:!0,characterData:!0,characterDataOldValue:!0})}},{key:"mutationHandler",value:function(h){var p=this,g=!1;h.forEach(function(b){switch(b.type){case"childList":b.target===p.holder?p.onDestroy():g=!0;break;case"characterData":g=!0;break;case"attributes":b.target.classList.contains("ce-block")||(g=!0)}}),g&&this.mutationDebouncer()}},{key:"debounce",value:function(h,p){var g,b=this;return function(){for(var v=arguments.length,k=new Array(v),C=0;C<v;C++)k[C]=arguments[C];var O=b;clearTimeout(g),g=setTimeout(function(){return h.apply(O,k)},p)}}},{key:"onDestroy",value:function(){var h=new CustomEvent("destroy");document.dispatchEvent(h),this.observer.disconnect()}}])&&r(l.prototype,u),c&&r(l,c),o}();function a(o,l){for(var u=0;u<l.length;u++){var c=l[u];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(o,c.key,c)}}var s=function(){function o(h){var p=this,g=h.editor,b=h.onUpdate,v=h.maxLength;(function(O,d){if(!(O instanceof d))throw new TypeError("Cannot call a class as a function")})(this,o);var k={maxLength:30,onUpdate:function(){}},C=g.configuration;this.editor=g,this.shouldSaveHistory=!0,this.readOnly=C.readOnly,this.maxLength=v||k.maxLength,this.onUpdate=b||k.onUpdate,new n(function(){return p.registerChange()},C.holder).setMutationObserver(),this.setEventListeners(),this.initialItem=null,this.clear()}var l,u,c;return l=o,c=[{key:"isReadOnlySupported",get:function(){return!0}}],(u=[{key:"truncate",value:function(h,p){for(;h.length>p;)h.shift()}},{key:"initialize",value:function(h){var p="blocks"in h?h.blocks:h,g={index:p.length-1,state:p};this.stack[0]=g,this.initialItem=g}},{key:"clear",value:function(){this.stack=this.initialItem?[this.initialItem]:[{index:0,state:[]}],this.position=0,this.onUpdate()}},{key:"registerChange",value:function(){var h=this;this.readOnly||(this.editor&&this.editor.save&&this.shouldSaveHistory&&this.editor.save().then(function(p){h.editorDidUpdate(p.blocks)&&h.save(p.blocks)}),this.shouldSaveHistory=!0)}},{key:"editorDidUpdate",value:function(h){var p=this.stack[this.position].state;return h.length!==p.length||JSON.stringify(p)!==JSON.stringify(h)}},{key:"save",value:function(h){this.position>=this.maxLength&&this.truncate(this.stack,this.maxLength),this.position=Math.min(this.position,this.stack.length-1),this.stack=this.stack.slice(0,this.position+1);var p=this.editor.blocks.getCurrentBlockIndex();this.stack.push({index:p,state:h}),this.position+=1,this.onUpdate()}},{key:"undo",value:function(){var h=this;if(this.canUndo()){this.shouldSaveHistory=!1;var p=this.stack[this.position-=1],g=p.index,b=p.state;this.onUpdate(),this.editor.blocks.render({blocks:b}).then(function(){return h.editor.caret.setToBlock(g,"end")})}}},{key:"redo",value:function(){var h=this;if(this.canRedo()){this.shouldSaveHistory=!1;var p=this.stack[this.position+=1],g=p.index,b=p.state;this.onUpdate(),this.editor.blocks.render({blocks:b}).then(function(){return h.editor.caret.setToBlock(g,"end")})}}},{key:"canUndo",value:function(){return!this.readOnly&&this.position>0}},{key:"canRedo",value:function(){return!this.readOnly&&this.position<this.count()}},{key:"count",value:function(){return this.stack.length-1}},{key:"setEventListeners",value:function(){var h=this,p=/(Mac)/i.test(navigator.platform)?"metaKey":"ctrlKey",g=function(v){v[p]&&v.key==="z"&&(v.preventDefault(),h.undo())},b=function(v){v[p]&&v.key==="y"&&(v.preventDefault(),h.redo())};document.addEventListener("keydown",g),document.addEventListener("keydown",b),document.addEventListener("destroy",function(){document.removeEventListener("keydown",g),document.removeEventListener("keydown",b)})}}])&&a(l.prototype,u),c&&a(l,c),o}()}]).default})});var nf=ye((exports,module)=>{frappe.dashboard_utils={render_chart_filters:function(i,t,e,r){i.forEach(n=>{let a="",s="";n.icon&&(a=frappe.utils.icon(n.icon)),n.class&&(s=n.class);let o=`<div class="${t} ${s} btn-group dropdown pull-right">
					<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<button class="btn btn-secondary btn-xs">
							${a}
							<span class="filter-label">${__(n.label)}</span>
							${frappe.utils.icon("select","xs")}
						</button>
				</a>`,l;n.fieldnames?l=n.options.map((h,p)=>`<li>
						<a class="dropdown-item" data-fieldname="${n.fieldnames[p]}" data-option="${encodeURIComponent(h)}">${__(h)}</a>
					</li>`).join(""):l=n.options.map(h=>`<li><a class="dropdown-item" data-option="${encodeURIComponent(h)}">${__(h)}</a></li>`).join("");let u=o+`<ul class="dropdown-menu">${l}</ul></div>`,c=$(u);r?c.prependTo(e):c.appendTo(e),c.find(".dropdown-menu").on("click","li a",h=>{let p=$(h.currentTarget),g;p.attr("data-fieldname")&&(g=p.attr("data-fieldname"));let b=decodeURIComponent(p.data("option"));p.parents(`.${t}`).find(".filter-label").html(__(b)),n.action(b,g)})})},get_filters_for_chart_type:function(i){if(i.chart_type==="Custom"&&i.source){let t="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(t,{name:i.source}).then(e=>(frappe.dom.eval(e),frappe.dashboards.chart_sources[i.source].filters))}else return i.chart_type==="Report"&&i.report_name?frappe.report_utils.get_report_filters(i.report_name).then(t=>t):Promise.resolve()},get_dashboard_settings(){return frappe.db.get_list("Dashboard Settings",{filters:{name:frappe.session.user},fields:["*"]}).then(i=>i.length?i[0]:this.create_dashboard_settings().then(t=>t))},create_dashboard_settings(){return frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.create_dashboard_settings",{user:frappe.session.user}).then(i=>i)},get_years_since_creation(i){let t=this.get_year(i),e=this.get_year(frappe.datetime.now_date()),r=[];for(var n=e;n>=t;n--)r.push(n);return r},get_year(i){return i.substring(0,i.indexOf("-"))},remove_common_static_filter_values(i,t){if(t)if($.isArray(i))i=i.filter(e=>{for(let r of t)if(e[0]==r[0]&&e[1]==r[1])return!1;return!0});else for(let e of Object.keys(t))delete i[e];return i},get_fields_for_dynamic_filter_dialog(i,t,e){let r=[{fieldtype:"HTML",fieldname:"description",options:`<div>
						<p>Set dynamic filter values in JavaScript for the required fields here.
						</p>
						<p>Ex:
							<code>frappe.defaults.get_user_default("Company")</code>
						</p>
					</div>`}];if(i)e&&(t=[...t,...e]),t.forEach(n=>{for(let a of r)if(a.fieldname==n[0]+":"+n[1])return;n[2]=="="&&r.push({label:`${n[1]} (${n[0]})`,fieldname:n[0]+":"+n[1],fieldtype:"Data"})});else{t=lt(lt({},e),t);for(let n of Object.keys(t))r.push({label:n,fieldname:n,fieldtype:"Data"})}return r},get_all_filters(doc){let filters=JSON.parse(doc.filters_json||"null"),dynamic_filters=JSON.parse(doc.dynamic_filters_json||"null");if(!dynamic_filters)return filters;if($.isArray(dynamic_filters))dynamic_filters.forEach(f=>{try{f[3]=eval(f[3])}catch(i){frappe.throw(__("Invalid expression set in filter {0} ({1})",[f[1],f[0]]))}}),filters=[...filters,...dynamic_filters];else{for(let key of Object.keys(dynamic_filters))try{let val=eval(dynamic_filters[key]);dynamic_filters[key]=val}catch(i){frappe.throw(__("Invalid expression set in filter {0}",[key]))}Object.assign(filters,dynamic_filters)}return filters},get_dashboard_link_field(){let i={label:__("Select Dashboard"),fieldtype:"Link",fieldname:"dashboard",options:"Dashboard"};return frappe.boot.developer_mode||(i.get_query=()=>({filters:{is_standard:0}})),i},get_add_to_dashboard_dialog(i,t,e){let r=this.get_dashboard_link_field(),n=new frappe.ui.Dialog({title:__("Add to Dashboard"),fields:[r],primary_action:a=>{a.name=i,a.set_standard=frappe.boot.developer_mode,frappe.xcall(e,{args:a}).then(()=>{let s=`<a href = "/app/dashboard/${a.dashboard}">${a.dashboard}</a>`,o=__("{0} {1} added to Dashboard {2}",[t,a.name,s]);frappe.msgprint(o)}),n.hide()}});return n}}});var Lf=ye(($8,In)=>{(function(t){"use strict";typeof define=="function"&&define.amd?define(t):typeof In!="undefined"&&typeof In.exports!="undefined"?In.exports=t():window.Sortable=t()})(function(){"use strict";if(typeof window=="undefined"||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var t,e,r,n,a,s,o,l,u,c,h,p,g,b,v=[],k=!1,C=!1,O=!1,d=[],_,m,y,x,S,w,E,L,I=!1,A=!1,B,T,M,j,J=/\s+/g,U="Sortable"+new Date().getTime(),H=window,te=H.document,se=H.parseInt,W=H.setTimeout,Y=H.jQuery||H.Zepto,ie=H.Polymer,re={capture:!1,passive:!1},Q=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),ee=!!navigator.userAgent.match(/Edge/i),pe=ee||Q?"cssFloat":"float",be="draggable"in te.createElement("div"),we=function(){if(Q)return!1;var z=te.createElement("x");return z.style.cssText="pointer-events:auto",z.style.pointerEvents==="auto"}(),Le=!1,fe=!1,xe=Math.abs,Ne=Math.min,Be=[],Pe=function(z,G){var Z=qe(z),de=se(Z.width),le=It(z,0,G),Ce=It(z,1,G),Se=le&&qe(le),Re=Ce&&qe(Ce),Ae=Se&&se(Se.marginLeft)+se(Se.marginRight)+Te(le).width,$e=Re&&se(Re.marginLeft)+se(Re.marginRight)+Te(Ce).width;if(Z.display==="flex")return Z.flexDirection==="column"||Z.flexDirection==="column-reverse"?"vertical":"horizontal";if(le&&Se.float!=="none"){var We=Se.float==="left"?"left":"right";return Ce&&(Re.clear==="both"||Re.clear===We)?"vertical":"horizontal"}return le&&(Se.display==="block"||Se.display==="flex"||Se.display==="table"||Se.display==="grid"||Ae>=de&&Z[pe]==="none"||Ce&&Z[pe]==="none"&&Ae+$e>de)?"vertical":"horizontal"},Ze=function(z,G){for(var Z=0;Z<d.length;Z++)if(!d[Z].children.length){var de=Te(d[Z]),le=d[Z][U].options.emptyInsertThreshold,Ce=z>=de.left-le&&z<=de.right+le,Se=G>=de.top-le&&G<=de.bottom+le;if(Ce&&Se)return d[Z]}},tt=function(z,G,Z,de,le){var Ce=Te(Z),Se=de==="vertical"?Ce.left:Ce.top,Re=de==="vertical"?Ce.right:Ce.bottom,Ae=de==="vertical"?z:G;return Se<Ae&&Ae<Re},Xe=function(z,G,Z){var de=z===t&&j||Te(z),le=G===t&&j||Te(G),Ce=Z==="vertical"?de.left:de.top,Se=Z==="vertical"?de.right:de.bottom,Re=Z==="vertical"?de.width:de.height,Ae=Z==="vertical"?le.left:le.top,$e=Z==="vertical"?le.right:le.bottom,We=Z==="vertical"?le.width:le.height;return Ce===Ae||Se===$e||Ce+Re/2===Ae+We/2},Ke=function(z,G){if(!z||!z.getBoundingClientRect)return H;var Z=z,de=!1;do if(Z.clientWidth<Z.scrollWidth||Z.clientHeight<Z.scrollHeight){var le=qe(Z);if(Z.clientWidth<Z.scrollWidth&&(le.overflowX=="auto"||le.overflowX=="scroll")||Z.clientHeight<Z.scrollHeight&&(le.overflowY=="auto"||le.overflowY=="scroll")){if(!Z||!Z.getBoundingClientRect||Z===te.body)return H;if(de||G)return Z;de=!0}}while(Z=Z.parentNode);return H},nt=hi(function(z,G,Z,de){if(G.scroll){var le=Z?Z[U]:window,Ce=G.scrollSensitivity,Se=G.scrollSpeed,Re=z.clientX,Ae=z.clientY,$e=window.innerWidth,We=window.innerHeight,Fe=!1;u!==Z&&(at(),l=G.scroll,c=G.scrollFn,l===!0&&(l=Ke(Z,!0),u=l));var it=0,mt=l;do{var Je=mt,Ue=Te(Je),At=Ue.top,$t=Ue.bottom,xt=Ue.left,St=Ue.right,F=Ue.width,ne=Ue.height,V,ae,D,R,P,N,X,q,K;if(Je!==H?(V=Je.scrollWidth,ae=Je.scrollHeight,D=qe(Je),N=F<V&&(D.overflowX==="auto"||D.overflowX==="scroll"),X=ne<ae&&(D.overflowY==="auto"||D.overflowY==="scroll"),q=Je.scrollLeft,K=Je.scrollTop):(V=te.documentElement.scrollWidth,ae=te.documentElement.scrollHeight,D=qe(te.documentElement),N=F<V&&(D.overflowX==="auto"||D.overflowX==="scroll"||D.overflowX==="visible"),X=ne<ae&&(D.overflowY==="auto"||D.overflowY==="scroll"||D.overflowY==="visible"),q=te.documentElement.scrollLeft,K=te.documentElement.scrollTop),R=N&&(xe(St-Re)<=Ce&&q+F<V)-(xe(xt-Re)<=Ce&&!!q),P=X&&(xe($t-Ae)<=Ce&&K+ne<ae)-(xe(At-Ae)<=Ce&&!!K),!v[it])for(var oe=0;oe<=it;oe++)v[oe]||(v[oe]={});(v[it].vx!=R||v[it].vy!=P||v[it].el!==Je)&&(v[it].el=Je,v[it].vx=R,v[it].vy=P,clearInterval(v[it].pid),Je&&(R!=0||P!=0)&&(Fe=!0,v[it].pid=setInterval(function(){de&&this.layer===0&&Me.active._emulateDragOver(!0);var ge=v[this.layer].vy?v[this.layer].vy*Se:0,me=v[this.layer].vx?v[this.layer].vx*Se:0;typeof c=="function"&&c.call(le,me,ge,z,S,v[this.layer].el)!=="continue"||(v[this.layer].el===H?H.scrollTo(H.pageXOffset+me,H.pageYOffset+ge):(v[this.layer].el.scrollTop+=ge,v[this.layer].el.scrollLeft+=me))}.bind({layer:it}),24))),it++}while(G.bubbleScroll&&mt!==H&&(mt=Ke(mt,!1)));k=Fe}},30),at=function(){v.forEach(function(z){clearInterval(z.pid)}),v=[]},ce=function(z){function G(le,Ce){return function(Se,Re,Ae,$e){var We=Se.options.group.name&&Re.options.group.name&&Se.options.group.name===Re.options.group.name;if(le==null&&(Ce||We))return!0;if(le==null||le===!1)return!1;if(Ce&&le==="clone")return le;if(typeof le=="function")return G(le(Se,Re,Ae,$e),Ce)(Se,Re,Ae,$e);var Fe=(Ce?Se:Re).options.group.name;return le===!0||typeof le=="string"&&le===Fe||le.join&&le.indexOf(Fe)>-1}}var Z={},de=z.group;(!de||typeof de!="object")&&(de={name:de}),Z.name=de.name,Z.checkPull=G(de.pull,!0),Z.checkPut=G(de.put),Z.revertClone=de.revertClone,z.group=Z},ve=function(z){!t||!t.parentNode||t.parentNode[U]&&t.parentNode[U]._computeIsAligned(z)},Ie=function(z,G){for(var Z=G;!Z[U];)Z=Z.parentNode;return z===Z},He=function(z,G,Z){for(var de=z.parentNode;de&&!de[U];)de=de.parentNode;de&&de[U][Z](ni(G,{artificialBubble:!0}))},st=function(){!we&&r&&qe(r,"display","none")},vt=function(){!we&&r&&qe(r,"display","")};te.addEventListener("click",function(z){if(O)return z.preventDefault(),z.stopPropagation&&z.stopPropagation(),z.stopImmediatePropagation&&z.stopImmediatePropagation(),O=!1,!1},!0);var bt=function(z){if(z=z.touches?z.touches[0]:z,t){var G=Ze(z.clientX,z.clientY);G&&G[U]._onDragOver({clientX:z.clientX,clientY:z.clientY,target:G,rootEl:G})}};Ye(te,"dragover",bt),Ye(te,"mousemove",bt),Ye(te,"touchmove",bt);function Me(z,G){if(!(z&&z.nodeType&&z.nodeType===1))throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(z);this.el=z,this.options=G=ni({},G),z[U]=this;var Z={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(z.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Pe(z,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(Ce,Se){Ce.setData("Text",Se.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:se(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Me.supportPointer!==!1&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5};for(var de in Z)!(de in G)&&(G[de]=Z[de]);ce(G);for(var le in this)le.charAt(0)==="_"&&typeof this[le]=="function"&&(this[le]=this[le].bind(this));this.nativeDraggable=G.forceFallback?!1:be,G.supportPointer?Ye(z,"pointerdown",this._onTapStart):(Ye(z,"mousedown",this._onTapStart),Ye(z,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ye(z,"dragover",this),Ye(z,"dragenter",this)),d.push(this.el),G.store&&G.store.get&&this.sort(G.store.get(this)||[])}Me.prototype={constructor:Me,_computeIsAligned:function(z){var G;if(r&&!we?(st(),G=te.elementFromPoint(z.clientX,z.clientY),vt()):G=z.target,G=yt(G,this.options.draggable,this.el,!1),!fe&&!(!t||t.parentNode!==this.el)){for(var Z=this.el.children,de=0;de<Z.length;de++)yt(Z[de],this.options.draggable,this.el,!1)&&Z[de]!==G&&(Z[de].sortableMouseAligned=tt(z.clientX,z.clientY,Z[de],this._getDirection(z,null),this.options));yt(G,this.options.draggable,this.el,!0)||(E=null),fe=!0,W(function(){fe=!1},30)}},_getDirection:function(z,G){return typeof this.options.direction=="function"?this.options.direction.call(this,z,G,t):this.options.direction},_onTapStart:function(z){if(!!z.cancelable){var G=this,Z=this.el,de=this.options,le=de.preventOnFilter,Ce=z.type,Se=z.touches&&z.touches[0],Re=(Se||z).target,Ae=z.target.shadowRoot&&(z.path&&z.path[0]||z.composedPath&&z.composedPath()[0])||Re,$e=de.filter,We;if(Et(Z),!(Q&&!z.artificialBubble&&!Ie(Z,Re))&&!t&&!(/mousedown|pointerdown/.test(Ce)&&z.button!==0||de.disabled)&&!Ae.isContentEditable){if(Re=yt(Re,de.draggable,Z,!1),!Re){Q&&He(Z,z,"_onTapStart");return}if(o!==Re){if(We=Nt(Re,de.draggable),typeof $e=="function"){if($e.call(this,z,Re,this)){De(G,Ae,"filter",Re,Z,Z,We),le&&z.cancelable&&z.preventDefault();return}}else if($e&&($e=$e.split(",").some(function(Fe){if(Fe=yt(Ae,Fe.trim(),Z,!1),Fe)return De(G,Fe,"filter",Re,Z,Z,We),!0}),$e)){le&&z.cancelable&&z.preventDefault();return}de.handle&&!yt(Ae,de.handle,Z,!1)||this._prepareDragStart(z,Se,Re,We)}}}},_handleAutoScroll:function(z,G){if(!(!t||!this.options.scroll)){var Z=z.clientX,de=z.clientY,le=te.elementFromPoint(Z,de),Ce=this;if(G||ee||Q){nt(z,Ce.options,le,G);var Se=Ke(le,!0);k&&(!_||Z!==m||de!==y)&&(_&&clearInterval(_),_=setInterval(function(){if(!!t){var Re=Ke(te.elementFromPoint(Z,de),!0);Re!==Se&&(Se=Re,at(),nt(z,Ce.options,Se,G))}},10),m=Z,y=de)}else{if(!Ce.options.bubbleScroll||Ke(le,!0)===window){at();return}nt(z,Ce.options,Ke(le,!1),!1)}}},_prepareDragStart:function(z,G,Z,de){var le=this,Ce=le.el,Se=le.options,Re=Ce.ownerDocument,Ae;Z&&!t&&Z.parentNode===Ce&&(a=Ce,t=Z,e=t.parentNode,s=t.nextSibling,o=Z,g=Se.group,h=de,x={target:t,clientX:(G||z).clientX,clientY:(G||z).clientY},this._lastX=(G||z).clientX,this._lastY=(G||z).clientY,t.style["will-change"]="all",t.style.transition="",t.style.transform="",Ae=function(){le._disableDelayedDrag(),t.draggable=le.nativeDraggable,le._triggerDragStart(z,G),De(le,a,"choose",t,a,a,h),Qe(t,Se.chosenClass,!0)},Se.ignore.split(",").forEach(function($e){dt(t,$e.trim(),et)}),Se.supportPointer?Ye(Re,"pointerup",le._onDrop):(Ye(Re,"mouseup",le._onDrop),Ye(Re,"touchend",le._onDrop),Ye(Re,"touchcancel",le._onDrop)),Se.delay?(Ye(Re,"mouseup",le._disableDelayedDrag),Ye(Re,"touchend",le._disableDelayedDrag),Ye(Re,"touchcancel",le._disableDelayedDrag),Ye(Re,"mousemove",le._delayedDragTouchMoveHandler),Ye(Re,"touchmove",le._delayedDragTouchMoveHandler),Se.supportPointer&&Ye(Re,"pointermove",le._delayedDragTouchMoveHandler),le._dragStartTimer=W(Ae,Se.delay)):Ae())},_delayedDragTouchMoveHandler:function(z){var G=z.touches?z.touches[0]:z;Ne(xe(G.clientX-this._lastX),xe(G.clientY-this._lastY))>=this.options.touchStartThreshold&&this._disableDelayedDrag()},_disableDelayedDrag:function(){var z=this.el.ownerDocument;clearTimeout(this._dragStartTimer),Ge(z,"mouseup",this._disableDelayedDrag),Ge(z,"touchend",this._disableDelayedDrag),Ge(z,"touchcancel",this._disableDelayedDrag),Ge(z,"mousemove",this._delayedDragTouchMoveHandler),Ge(z,"touchmove",this._delayedDragTouchMoveHandler),Ge(z,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(z,G){G=G||(z.pointerType=="touch"?z:null),!this.nativeDraggable||G?this.options.supportPointer?Ye(te,"pointermove",this._onTouchMove):G?Ye(te,"touchmove",this._onTouchMove):Ye(te,"mousemove",this._onTouchMove):(Ye(t,"dragend",this),Ye(a,"dragstart",this._onDragStart));try{te.selection?wt(function(){te.selection.empty()}):window.getSelection().removeAllRanges()}catch(Z){}},_dragStarted:function(z){if(C=!1,a&&t){this.nativeDraggable&&(Ye(te,"dragover",this._handleAutoScroll),Ye(te,"dragover",ve));var G=this.options;!z&&Qe(t,G.dragClass,!1),Qe(t,G.ghostClass,!0),qe(t,"transform",""),Me.active=this,z&&this._appendGhost(),De(this,a,"start",t,a,a,h)}else this._nulling()},_emulateDragOver:function(z){if(S){if(this._lastX===S.clientX&&this._lastY===S.clientY&&!z)return;this._lastX=S.clientX,this._lastY=S.clientY,st();for(var G=te.elementFromPoint(S.clientX,S.clientY),Z=G;G&&G.shadowRoot;)G=G.shadowRoot.elementFromPoint(S.clientX,S.clientY),Z=G;if(Z)do{if(Z[U]){var de;if(de=Z[U]._onDragOver({clientX:S.clientX,clientY:S.clientY,target:G,rootEl:Z}),de&&!this.options.dragoverBubble)break}G=Z}while(Z=Z.parentNode);t.parentNode[U]._computeIsAligned(S),vt()}},_onTouchMove:function(z){if(x){var G=this.options,Z=G.fallbackTolerance,de=G.fallbackOffset,le=z.touches?z.touches[0]:z,Ce=r&&ei(r),Se=r&&Ce&&Ce.a,Re=r&&Ce&&Ce.d,Ae=(le.clientX-x.clientX+de.x)/(Se||1),$e=(le.clientY-x.clientY+de.y)/(Re||1),We=z.touches?"translate3d("+Ae+"px,"+$e+"px,0)":"translate("+Ae+"px,"+$e+"px)";if(!Me.active&&!C){if(Z&&Ne(xe(le.clientX-this._lastX),xe(le.clientY-this._lastY))<Z)return;this._onDragStart(z,!0)}this._handleAutoScroll(le,!0),w=!0,S=le,qe(r,"webkitTransform",We),qe(r,"mozTransform",We),qe(r,"msTransform",We),qe(r,"transform",We),z.cancelable&&z.preventDefault()}},_appendGhost:function(){if(!r){var z=Te(t,this.options.fallbackOnBody?te.body:a,!0),G=qe(t),Z=this.options;r=t.cloneNode(!0),Qe(r,Z.ghostClass,!1),Qe(r,Z.fallbackClass,!0),Qe(r,Z.dragClass,!0),qe(r,"box-sizing","border-box"),qe(r,"margin",0),qe(r,"top",z.top),qe(r,"left",z.left),qe(r,"width",z.width),qe(r,"height",z.height),qe(r,"opacity","0.8"),qe(r,"position","fixed"),qe(r,"zIndex","100000"),qe(r,"pointerEvents","none"),Z.fallbackOnBody&&te.body.appendChild(r)||a.appendChild(r)}},_onDragStart:function(z,G){var Z=this,de=z.dataTransfer,le=Z.options;n=Tt(t),n.draggable=!1,n.style["will-change"]="",this._hideClone(),Qe(n,Z.options.chosenClass,!1),Z._cloneId=wt(function(){Z.options.removeCloneOnHide||a.insertBefore(n,t),De(Z,a,"clone",t)}),!G&&Qe(t,le.dragClass,!0),G?(O=!0,Z._loopId=setInterval(Z._emulateDragOver,50)):(Ge(te,"mouseup",Z._onDrop),Ge(te,"touchend",Z._onDrop),Ge(te,"touchcancel",Z._onDrop),de&&(de.effectAllowed="move",le.setData&&le.setData.call(Z,de,t)),Ye(te,"drop",Z),qe(t,"transform","translateZ(0)")),C=!0,Z._dragStartId=wt(Z._dragStarted.bind(Z,G)),Ye(te,"selectstart",Z)},_onDragOver:function(z){var G=this.el,Z=z.target,de,le,Ce,Se=this.options,Re=Se.group,Ae=Me.active,$e=g===Re,We=Se.sort,Fe=this;if(Le||Q&&!z.rootEl&&!z.artificialBubble&&!Ie(G,Z))return;function it(){return Ae&&(Qe(t,b?b.options.ghostClass:Ae.options.ghostClass,!1),Qe(t,Se.ghostClass,!0)),b!==Fe&&Fe!==Me.active?b=Fe:Fe===Me.active&&(b=null),(Z===t&&!t.animated||Z===G&&!Z.animated)&&(E=null),!Se.dragoverBubble&&!z.rootEl&&Z!==te&&(Fe._handleAutoScroll(z),t.parentNode[U]._computeIsAligned(z)),!Se.dragoverBubble&&z.stopPropagation&&z.stopPropagation(),!0}function mt(){De(Fe,a,"change",Z,G,a,h,Nt(t,Se.draggable),z)}if(z.preventDefault!==void 0&&z.cancelable&&z.preventDefault(),w=!0,Z=yt(Z,Se.draggable,G,!0),!!yt(z.target,null,t,!0)||Z.animated)return it();if(Z!==t&&(O=!1),Ae&&!Se.disabled&&($e?We||(Ce=!a.contains(t)):b===this||(this.lastPutMode=g.checkPull(this,Ae,t,z))&&Re.checkPut(this,Ae,t,z))){var Je=this._getDirection(z,Z);if(de=Te(t),Ce)return this._hideClone(),e=a,s?a.insertBefore(t,s):a.appendChild(t),it();if(G.children.length===0||G.children[0]===r||pt(z,Je,G)&&!t.animated){if(G.children.length!==0&&G.children[0]!==r&&G===z.target&&(Z=di(G)),Z&&(le=Te(Z)),$e?Ae._hideClone():Ae._showClone(this),ti(a,G,t,de,Z,le,z,!!Z)!==!1)return G.appendChild(t),e=G,j=null,mt(),this._animate(de,t),Z&&this._animate(le,Z),it()}else if(Z&&Z!==t&&Z.parentNode===G){var Ue=0,At,$t=Z.sortableMouseAligned,xt=t.parentNode!==G,St=ze(Z,Je==="vertical"?"top":"left");if(E!==Z&&(B=null,At=Te(Z)[Je==="vertical"?"top":"left"],I=!1),Xe(t,Z,Je)&&$t||xt||St||Se.invertSwap||B==="insert"||B==="swap"?(B!=="swap"&&(A=Se.invertSwap||xt||k||St),Ue=Lt(z,Z,Je,Se.swapThreshold,Se.invertedSwapThreshold==null?Se.swapThreshold:Se.invertedSwapThreshold,A,E===Z),B="swap"):(Ue=Xt(Z,Se),B="insert"),Ue===0)return it();j=null,E=Z,L=Ue,le=Te(Z);var F=Z.nextElementSibling,ne=!1;ne=Ue===1;var V=ti(a,G,t,de,Z,le,z,ne);if(V!==!1)return(V===1||V===-1)&&(ne=V===1),Le=!0,W(ii,30),$e?Ae._hideClone():Ae._showClone(this),ne&&!F?G.appendChild(t):Z.parentNode.insertBefore(t,ne?F:Z),e=t.parentNode,At!==void 0&&!A&&(T=xe(At-Te(Z)[Je==="vertical"?"top":"left"])),mt(),!xt&&this._animate(le,Z),this._animate(de,t),it()}if(G.contains(t))return it()}return Q&&!z.rootEl&&He(G,z,"_onDragOver"),!1},_animate:function(z,G){var Z=this.options.animation;if(Z){var de=Te(G);if(G===t&&(j=de),z.nodeType===1&&(z=Te(z)),z.left+z.width/2!==de.left+de.width/2||z.top+z.height/2!==de.top+de.height/2){var le=ei(this.el),Ce=le&&le.a,Se=le&&le.d;qe(G,"transition","none"),qe(G,"transform","translate3d("+(z.left-de.left)/(Ce||1)+"px,"+(z.top-de.top)/(Se||1)+"px,0)"),M=G.offsetWidth,qe(G,"transition","transform "+Z+"ms"+(this.options.easing?" "+this.options.easing:"")),qe(G,"transform","translate3d(0,0,0)")}typeof G.animated=="number"&&clearTimeout(G.animated),G.animated=W(function(){qe(G,"transition",""),qe(G,"transform",""),G.animated=!1},Z)}},_offUpEvents:function(){var z=this.el.ownerDocument;Ge(te,"touchmove",this._onTouchMove),Ge(te,"pointermove",this._onTouchMove),Ge(z,"mouseup",this._onDrop),Ge(z,"touchend",this._onDrop),Ge(z,"pointerup",this._onDrop),Ge(z,"touchcancel",this._onDrop),Ge(te,"selectstart",this)},_onDrop:function(z){var G=this.el,Z=this.options;C=!1,k=!1,A=!1,I=!1,clearInterval(this._loopId),clearInterval(_),at(),Kt(),clearTimeout(this._dragStartTimer),Ee(this._cloneId),Ee(this._dragStartId),Ge(te,"mousemove",this._onTouchMove),this.nativeDraggable&&(Ge(te,"drop",this),Ge(G,"dragstart",this._onDragStart),Ge(te,"dragover",this._handleAutoScroll),Ge(te,"dragover",ve)),this._offUpEvents(),z&&(w&&(z.cancelable&&z.preventDefault(),!Z.dropBubble&&z.stopPropagation()),r&&r.parentNode&&r.parentNode.removeChild(r),(a===e||b&&b.lastPutMode!=="clone")&&n&&n.parentNode&&n.parentNode.removeChild(n),t&&(this.nativeDraggable&&Ge(t,"dragend",this),et(t),t.style["will-change"]="",Qe(t,b?b.options.ghostClass:this.options.ghostClass,!1),Qe(t,this.options.chosenClass,!1),De(this,a,"unchoose",t,e,a,h,null,z),a!==e?(p=Nt(t,Z.draggable),p>=0&&(De(null,e,"add",t,e,a,h,p,z),De(this,a,"remove",t,e,a,h,p,z),De(null,e,"sort",t,e,a,h,p,z),De(this,a,"sort",t,e,a,h,p,z)),b&&b.save()):t.nextSibling!==s&&(p=Nt(t,Z.draggable),p>=0&&(De(this,a,"update",t,e,a,h,p,z),De(this,a,"sort",t,e,a,h,p,z))),Me.active&&((p==null||p===-1)&&(p=h),De(this,a,"end",t,e,a,h,p,z),this.save()))),this._nulling()},_nulling:function(){a=t=e=r=s=n=o=l=u=v.length=_=m=y=x=S=w=p=h=E=L=M=j=b=g=Me.active=null,Be.forEach(function(z){z.checked=!0}),Be.length=0},handleEvent:function(z){switch(z.type){case"drop":case"dragend":this._onDrop(z);break;case"dragenter":case"dragover":t&&(this._onDragOver(z),Ft(z));break;case"selectstart":z.preventDefault();break}},toArray:function(){for(var z=[],G,Z=this.el.children,de=0,le=Z.length,Ce=this.options;de<le;de++)G=Z[de],yt(G,Ce.draggable,this.el,!1)&&z.push(G.getAttribute(Ce.dataIdAttr)||xi(G));return z},sort:function(z){var G={},Z=this.el;this.toArray().forEach(function(de,le){var Ce=Z.children[le];yt(Ce,this.options.draggable,Z,!1)&&(G[de]=Ce)},this),z.forEach(function(de){G[de]&&(Z.removeChild(G[de]),Z.appendChild(G[de]))})},save:function(){var z=this.options.store;z&&z.set&&z.set(this)},closest:function(z,G){return yt(z,G||this.options.draggable,this.el,!1)},option:function(z,G){var Z=this.options;if(G===void 0)return Z[z];Z[z]=G,z==="group"&&ce(Z)},destroy:function(){var z=this.el;z[U]=null,Ge(z,"mousedown",this._onTapStart),Ge(z,"touchstart",this._onTapStart),Ge(z,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ge(z,"dragover",this),Ge(z,"dragenter",this)),Array.prototype.forEach.call(z.querySelectorAll("[draggable]"),function(G){G.removeAttribute("draggable")}),this._onDrop(),d.splice(d.indexOf(this.el),1),this.el=z=null},_hideClone:function(){n.cloneHidden||(qe(n,"display","none"),n.cloneHidden=!0,n.parentNode&&this.options.removeCloneOnHide&&n.parentNode.removeChild(n))},_showClone:function(z){if(z.lastPutMode!=="clone"){this._hideClone();return}n.cloneHidden&&(a.contains(t)&&!this.options.group.revertClone?a.insertBefore(n,t):s?a.insertBefore(n,s):a.appendChild(n),this.options.group.revertClone&&this._animate(t,n),qe(n,"display",""),n.cloneHidden=!1)}};function yt(z,G,Z,de){if(z){Z=Z||te;do{if(G!=null&&(G[0]===">"&&z.parentNode===Z&&ri(z,G.substring(1))||ri(z,G))||de&&z===Z)return z;if(z===Z)break}while(z=Vt(z))}return null}function Vt(z){return z.host&&z!==te&&z.host.nodeType?z.host:z.parentNode}function Ft(z){z.dataTransfer&&(z.dataTransfer.dropEffect="move"),z.cancelable&&z.preventDefault()}function Ye(z,G,Z){z.addEventListener(G,Z,re)}function Ge(z,G,Z){z.removeEventListener(G,Z,re)}function Qe(z,G,Z){if(z&&G)if(z.classList)z.classList[Z?"add":"remove"](G);else{var de=(" "+z.className+" ").replace(J," ").replace(" "+G+" "," ");z.className=(de+(Z?" "+G:"")).replace(J," ")}}function qe(z,G,Z){var de=z&&z.style;if(de){if(Z===void 0)return te.defaultView&&te.defaultView.getComputedStyle?Z=te.defaultView.getComputedStyle(z,""):z.currentStyle&&(Z=z.currentStyle),G===void 0?Z:Z[G];!(G in de)&&G.indexOf("webkit")===-1&&(G="-webkit-"+G),de[G]=Z+(typeof Z=="string"?"":"px")}}function ei(z){var G="";do{var Z=qe(z,"transform");Z&&Z!=="none"&&(G=Z+" "+G)}while(z=z.parentNode);if(window.DOMMatrix)return new DOMMatrix(G);if(window.WebKitCSSMatrix)return new WebKitCSSMatrix(G);if(window.CSSMatrix)return new CSSMatrix(G)}function dt(z,G,Z){if(z){var de=z.getElementsByTagName(G),le=0,Ce=de.length;if(Z)for(;le<Ce;le++)Z(de[le],le);return de}return[]}function De(z,G,Z,de,le,Ce,Se,Re,Ae){z=z||G[U];var $e,We=z.options,Fe="on"+Z.charAt(0).toUpperCase()+Z.substr(1);window.CustomEvent&&!Q&&!ee?$e=new CustomEvent(Z,{bubbles:!0,cancelable:!0}):($e=te.createEvent("Event"),$e.initEvent(Z,!0,!0)),$e.to=le||G,$e.from=Ce||G,$e.item=de||G,$e.clone=n,$e.oldIndex=Se,$e.newIndex=Re,$e.originalEvent=Ae,G&&G.dispatchEvent($e),We[Fe]&&We[Fe].call(z,$e)}function ti(z,G,Z,de,le,Ce,Se,Re){var Ae,$e=z[U],We=$e.options.onMove,Fe;return window.CustomEvent&&!Q&&!ee?Ae=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(Ae=te.createEvent("Event"),Ae.initEvent("move",!0,!0)),Ae.to=G,Ae.from=z,Ae.dragged=Z,Ae.draggedRect=de,Ae.related=le||G,Ae.relatedRect=Ce||Te(G),Ae.willInsertAfter=Re,Ae.originalEvent=Se,z.dispatchEvent(Ae),We&&(Fe=We.call($e,Ae,Se)),Fe}function et(z){z.draggable=!1}function ii(){Le=!1}function It(z,G,Z){for(var de=0,le=0,Ce=z.children;le<Ce.length;){if(Ce[le].style.display!=="none"&&Ce[le]!==r&&Ce[le]!==t&&yt(Ce[le],Z.draggable,z,!1)){if(de===G)return Ce[le];de++}le++}return null}function di(z){for(var G=z.lastElementChild;(G===r||G.style.display==="none")&&(G=G.previousElementSibling,!!G););return G||null}function pt(z,G,Z){var de=Te(di(Z)),le=G==="vertical"?z.clientY:z.clientX,Ce=G==="vertical"?z.clientX:z.clientY,Se=G==="vertical"?de.bottom:de.right,Re=G==="vertical"?de.left:de.top,Ae=G==="vertical"?de.right:de.bottom,$e=10;return G==="vertical"?Ce>Ae+$e||Ce<=Ae&&le>Se&&Ce>=Re:le>Se&&Ce>Re||le<=Se&&Ce>Ae+$e}function Lt(z,G,Z,de,le,Ce,Se){var Re=Te(G),Ae=Z==="vertical"?z.clientY:z.clientX,$e=Z==="vertical"?Re.height:Re.width,We=Z==="vertical"?Re.top:Re.left,Fe=Z==="vertical"?Re.bottom:Re.right,it=Te(t),mt=!1;if(!Ce){if(Se&&T<$e*de)if(!I&&(L===1?Ae>We+$e*le/2:Ae<Fe-$e*le/2)&&(I=!0),I)mt=!0;else{var Je=Z==="vertical"?it.top:it.left,Ue=Z==="vertical"?it.bottom:it.right;if(L===1?Ae<We+T:Ae>Fe-T)return L*-1}else if(Ae>We+$e*(1-de)/2&&Ae<Fe-$e*(1-de)/2)return Ae>We+$e/2?-1:1}return mt=mt||Ce,mt&&(Ae<We+$e*le/2||Ae>Fe-$e*le/2)?Ae>We+$e/2?1:-1:0}function Xt(z,G){var Z=Nt(t,G.draggable),de=Nt(z,G.draggable);return Z<de?1:-1}function xi(z){for(var G=z.tagName+z.className+z.src+z.href+z.textContent,Z=G.length,de=0;Z--;)de+=G.charCodeAt(Z);return de.toString(36)}function Nt(z,G){var Z=0;if(!z||!z.parentNode)return-1;for(;z&&(z=z.previousElementSibling);)z.nodeName.toUpperCase()!=="TEMPLATE"&&z!==n&&Z++;return Z}function ri(z,G){if(z)try{if(z.matches)return z.matches(G);if(z.msMatchesSelector)return z.msMatchesSelector(G);if(z.webkitMatchesSelector)return z.webkitMatchesSelector(G)}catch(Z){return!1}return!1}var Pt;function hi(z,G){return function(){if(!Pt){var Z=arguments,de=this;Pt=W(function(){Z.length===1?z.call(de,Z[0]):z.apply(de,Z),Pt=void 0},G)}}}function Kt(){clearTimeout(Pt),Pt=void 0}function ni(z,G){if(z&&G)for(var Z in G)G.hasOwnProperty(Z)&&(z[Z]=G[Z]);return z}function Tt(z){return ie&&ie.dom?ie.dom(z).cloneNode(!0):Y?Y(z).clone(!0)[0]:z.cloneNode(!0)}function Et(z){Be.length=0;for(var G=z.getElementsByTagName("input"),Z=G.length;Z--;){var de=G[Z];de.checked&&Be.push(de)}}function wt(z){return W(z,0)}function Ee(z){return clearTimeout(z)}function Te(z,G,Z){if(!(!z.getBoundingClientRect&&z!==H)){var de,le,Ce,Se,Re,Ae,$e;if(z!==H?(de=z.getBoundingClientRect(),le=de.top,Ce=de.left,Se=de.bottom,Re=de.right,Ae=de.height,$e=de.width):(le=0,Ce=0,Se=window.innerHeight,Re=window.innerWidth,Ae=window.innerHeight,$e=window.innerWidth),Z&&z!==H){if(G=G||z.parentNode,!Q)do if(G&&G.getBoundingClientRect&&qe(G,"transform")!=="none"){var We=G.getBoundingClientRect();le-=We.top+se(qe(G,"border-top-width")),Ce-=We.left+se(qe(G,"border-left-width")),Se=le+de.height,Re=Ce+de.width;break}while(G=G.parentNode);var Fe=ei(z),it=Fe&&Fe.a,mt=Fe&&Fe.d;Fe&&(le/=mt,Ce/=it,$e/=it,Ae/=mt,Se=le+Ae,Re=Ce+$e)}return{top:le,left:Ce,bottom:Se,right:Re,width:$e,height:Ae}}}function ze(z,G){for(var Z=Ke(Z,!0),de=Te(z)[G];Z;){var le=Te(Z)[G],Ce;if(G==="top"||G==="left"?Ce=de>=le:Ce=de<=le,!Ce)return!0;if(Z===H)break;Z=Ke(Z,!1)}return!1}return Ye(te,"touchmove",function(z){(Me.active||C)&&z.cancelable&&z.preventDefault()}),Me.utils={on:Ye,off:Ge,css:qe,find:dt,is:function(z,G){return!!yt(z,G,z,!1)},extend:ni,throttle:hi,closest:yt,toggleClass:Qe,clone:Tt,index:Nt,nextTick:wt,cancelNextTick:Ee,detectDirection:Pe,getChild:It},Me.create=function(z,G){return new Me(z,G)},Me.version="1.8.3",Me})});var tp=ye((O8,ep)=>{"use strict";function mk(i){return i&&typeof i=="object"&&"default"in i?i.default:i}var gk=mk(Lf());function ue(i,t){return typeof i=="string"?(t||document).querySelector(i):i||null}ue.each=(i,t)=>typeof i=="string"?Array.from((t||document).querySelectorAll(i)):i||null;ue.create=(i,t)=>{let e=document.createElement(i);for(let r in t){let n=t[r];if(r==="inside")ue(n).appendChild(e);else if(r==="around"){let a=ue(n);a.parentNode.insertBefore(e,a),e.appendChild(a)}else r==="styles"?typeof n=="object"&&Object.keys(n).map(a=>{e.style[a]=n[a]}):r in e?e[r]=n:e.setAttribute(r,n)}return e};ue.on=(i,t,e,r)=>{r?ue.delegate(i,t,e,r):(r=e,ue.bind(i,t,r))};ue.off=(i,t,e)=>{i.removeEventListener(t,e)};ue.bind=(i,t,e)=>{t.split(/\s+/).forEach(function(r){i.addEventListener(r,e)})};ue.delegate=(i,t,e,r)=>{i.addEventListener(t,function(n){let a=n.target.closest(e);a&&(n.delegatedTarget=a,r.call(this,n,a))})};ue.unbind=(i,t)=>{if(i)for(let e in t){let r=t[e];e.split(/\s+/).forEach(function(n){i.removeEventListener(n,r)})}};ue.fire=(i,t,e)=>{let r=document.createEvent("HTMLEvents");r.initEvent(t,!0,!0);for(let n in e)r[n]=e[n];return i.dispatchEvent(r)};ue.data=(i,t)=>{if(!t)return i.dataset;for(let e in t)i.dataset[e]=t[e]};ue.style=(i,t)=>{if(typeof t=="string")return ue.getStyle(i,t);Array.isArray(i)||(i=[i]),i.map(e=>{for(let r in t)e.style[r]=t[r]})};ue.removeStyle=(i,t)=>{Array.isArray(i)||(i=[i]),Array.isArray(t)||(t=[t]),i.map(e=>{for(let r of t)e.style[r]=""})};ue.getStyle=(i,t)=>{if(!t)return getComputedStyle(i);let e=getComputedStyle(i)[t];return["width","height"].includes(t)&&(e=parseFloat(e)),e};ue.closest=(i,t)=>t?t.matches(i)?t:ue.closest(i,t.parentNode):null;ue.inViewport=(i,t)=>{let{top:e,left:r,bottom:n,right:a}=i.getBoundingClientRect(),{top:s,left:o,bottom:l,right:u}=t.getBoundingClientRect();return e>=s&&r>=o&&n<=l&&a<=u};ue.scrollTop=function(t,e){requestAnimationFrame(()=>{t.scrollTop=e})};ue.scrollbarSize=function(){return ue.scrollBarSizeValue||(ue.scrollBarSizeValue=vk()),ue.scrollBarSizeValue};function vk(){let i=document.createElement("div");ue.style(i,{width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),document.body.appendChild(i);let t=i.offsetWidth-i.clientWidth;return document.body.removeChild(i),t}ue.hasVerticalOverflow=function(i){return i.scrollHeight>i.offsetHeight+10};ue.hasHorizontalOverflow=function(i){return i.scrollWidth>i.offsetWidth+10};ue.measureTextWidth=function(i){let t=document.createElement("div");return t.style.position="absolute",t.style.visibility="hidden",t.style.height="auto",t.style.width="auto",t.style.whiteSpace="nowrap",t.innerText=i,document.body.appendChild(t),t.clientWidth+1};function bk(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var Ki=bk,Mn=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Nn(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function yk(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function wk(i,t){return t={exports:{}},i(t,t.exports),t.exports}var kk=typeof Mn=="object"&&Mn&&Mn.Object===Object&&Mn,xk=kk,Ck=typeof self=="object"&&self&&self.Object===Object&&self,Sk=xk||Ck||Function("return this")(),Rr=Sk,Tk=function(){return Rr.Date.now()},ls=Tk,Ek=Rr.Symbol,jn=Ek,zf=Object.prototype,Ak=zf.hasOwnProperty,$k=zf.toString,Er=jn?jn.toStringTag:void 0;function Ok(i){var t=Ak.call(i,Er),e=i[Er];try{i[Er]=void 0}catch(n){}var r=$k.call(i);return t?i[Er]=e:delete i[Er],r}var Rk=Ok,Lk=Object.prototype,Bk=Lk.toString;function Ik(i){return Bk.call(i)}var Mk=Ik,Nk="[object Null]",Pk="[object Undefined]",Bf=jn?jn.toStringTag:void 0;function Dk(i){return i==null?i===void 0?Pk:Nk:Bf&&Bf in Object(i)?Rk(i):Mk(i)}var Ff=Dk;function jk(i){return i!=null&&typeof i=="object"}var zk=jk,Fk="[object Symbol]";function Hk(i){return typeof i=="symbol"||zk(i)&&Ff(i)==Fk}var qk=Hk,If=0/0,Uk=/^\s+|\s+$/g,Wk=/^[-+]0x[0-9a-f]+$/i,Vk=/^0b[01]+$/i,Yk=/^0o[0-7]+$/i,Gk=parseInt;function Xk(i){if(typeof i=="number")return i;if(qk(i))return If;if(Ki(i)){var t=typeof i.valueOf=="function"?i.valueOf():i;i=Ki(t)?t+"":t}if(typeof i!="string")return i===0?i:+i;i=i.replace(Uk,"");var e=Vk.test(i);return e||Yk.test(i)?Gk(i.slice(2),e?2:8):Wk.test(i)?If:+i}var Mf=Xk,Kk="Expected a function",Jk=Math.max,Zk=Math.min;function Qk(i,t,e){var r,n,a,s,o,l,u=0,c=!1,h=!1,p=!0;if(typeof i!="function")throw new TypeError(Kk);t=Mf(t)||0,Ki(e)&&(c=!!e.leading,h="maxWait"in e,a=h?Jk(Mf(e.maxWait)||0,t):a,p="trailing"in e?!!e.trailing:p);function g(y){var x=r,S=n;return r=n=void 0,u=y,s=i.apply(S,x),s}function b(y){return u=y,o=setTimeout(C,t),c?g(y):s}function v(y){var x=y-l,S=y-u,w=t-x;return h?Zk(w,a-S):w}function k(y){var x=y-l,S=y-u;return l===void 0||x>=t||x<0||h&&S>=a}function C(){var y=ls();if(k(y))return O(y);o=setTimeout(C,v(y))}function O(y){return o=void 0,p&&r?g(y):(r=n=void 0,s)}function d(){o!==void 0&&clearTimeout(o),u=0,r=l=n=o=void 0}function _(){return o===void 0?s:O(ls())}function m(){var y=ls(),x=k(y);if(r=arguments,n=this,l=y,x){if(o===void 0)return b(l);if(h)return o=setTimeout(C,t),g(l)}return o===void 0&&(o=setTimeout(C,t)),s}return m.cancel=d,m.flush=_,m}var Hf=Qk,e1="Expected a function";function t1(i,t,e){var r=!0,n=!0;if(typeof i!="function")throw new TypeError(e1);return Ki(e)&&(r="leading"in e?!!e.leading:r,n="trailing"in e?!!e.trailing:n),Hf(i,t,{leading:r,maxWait:t,trailing:n})}var i1=t1,r1="[object AsyncFunction]",n1="[object Function]",a1="[object GeneratorFunction]",s1="[object Proxy]";function o1(i){if(!Ki(i))return!1;var t=Ff(i);return t==n1||t==a1||t==r1||t==s1}var l1=o1,c1=Rr["__core-js_shared__"],cs=c1,Nf=function(){var i=/[^.]+$/.exec(cs&&cs.keys&&cs.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function u1(i){return!!Nf&&Nf in i}var d1=u1,f1=Function.prototype,p1=f1.toString;function h1(i){if(i!=null){try{return p1.call(i)}catch(t){}try{return i+""}catch(t){}}return""}var _1=h1,m1=/[\\^$.*+?()[\]{}|]/g,g1=/^\[object .+?Constructor\]$/,v1=Function.prototype,b1=Object.prototype,y1=v1.toString,w1=b1.hasOwnProperty,k1=RegExp("^"+y1.call(w1).replace(m1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function x1(i){if(!Ki(i)||d1(i))return!1;var t=l1(i)?k1:g1;return t.test(_1(i))}var C1=x1;function S1(i,t){return i==null?void 0:i[t]}var T1=S1;function E1(i,t){var e=T1(i,t);return C1(e)?e:void 0}var ps=E1,A1=ps(Object,"create"),Or=A1;function $1(){this.__data__=Or?Or(null):{},this.size=0}var O1=$1;function R1(i){var t=this.has(i)&&delete this.__data__[i];return this.size-=t?1:0,t}var L1=R1,B1="__lodash_hash_undefined__",I1=Object.prototype,M1=I1.hasOwnProperty;function N1(i){var t=this.__data__;if(Or){var e=t[i];return e===B1?void 0:e}return M1.call(t,i)?t[i]:void 0}var P1=N1,D1=Object.prototype,j1=D1.hasOwnProperty;function z1(i){var t=this.__data__;return Or?t[i]!==void 0:j1.call(t,i)}var F1=z1,H1="__lodash_hash_undefined__";function q1(i,t){var e=this.__data__;return this.size+=this.has(i)?0:1,e[i]=Or&&t===void 0?H1:t,this}var U1=q1;function Ji(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var r=i[t];this.set(r[0],r[1])}}Ji.prototype.clear=O1;Ji.prototype.delete=L1;Ji.prototype.get=P1;Ji.prototype.has=F1;Ji.prototype.set=U1;var Pf=Ji;function W1(){this.__data__=[],this.size=0}var V1=W1;function Y1(i,t){return i===t||i!==i&&t!==t}var G1=Y1;function X1(i,t){for(var e=i.length;e--;)if(G1(i[e][0],t))return e;return-1}var Fn=X1,K1=Array.prototype,J1=K1.splice;function Z1(i){var t=this.__data__,e=Fn(t,i);if(e<0)return!1;var r=t.length-1;return e==r?t.pop():J1.call(t,e,1),--this.size,!0}var Q1=Z1;function ex(i){var t=this.__data__,e=Fn(t,i);return e<0?void 0:t[e][1]}var tx=ex;function ix(i){return Fn(this.__data__,i)>-1}var rx=ix;function nx(i,t){var e=this.__data__,r=Fn(e,i);return r<0?(++this.size,e.push([i,t])):e[r][1]=t,this}var ax=nx;function Zi(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var r=i[t];this.set(r[0],r[1])}}Zi.prototype.clear=V1;Zi.prototype.delete=Q1;Zi.prototype.get=tx;Zi.prototype.has=rx;Zi.prototype.set=ax;var sx=Zi,ox=ps(Rr,"Map"),lx=ox;function cx(){this.size=0,this.__data__={hash:new Pf,map:new(lx||sx),string:new Pf}}var ux=cx;function dx(i){var t=typeof i;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?i!=="__proto__":i===null}var fx=dx;function px(i,t){var e=i.__data__;return fx(t)?e[typeof t=="string"?"string":"hash"]:e.map}var Hn=px;function hx(i){var t=Hn(this,i).delete(i);return this.size-=t?1:0,t}var _x=hx;function mx(i){return Hn(this,i).get(i)}var gx=mx;function vx(i){return Hn(this,i).has(i)}var bx=vx;function yx(i,t){var e=Hn(this,i),r=e.size;return e.set(i,t),this.size+=e.size==r?0:1,this}var wx=yx;function Qi(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var r=i[t];this.set(r[0],r[1])}}Qi.prototype.clear=ux;Qi.prototype.delete=_x;Qi.prototype.get=gx;Qi.prototype.has=bx;Qi.prototype.set=wx;var kx=Qi,xx="__lodash_hash_undefined__";function Cx(i){return this.__data__.set(i,xx),this}var Sx=Cx;function Tx(i){return this.__data__.has(i)}var Ex=Tx;function zn(i){var t=-1,e=i==null?0:i.length;for(this.__data__=new kx;++t<e;)this.add(i[t])}zn.prototype.add=zn.prototype.push=Sx;zn.prototype.has=Ex;var Ax=zn;function $x(i,t,e,r){for(var n=i.length,a=e+(r?1:-1);r?a--:++a<n;)if(t(i[a],a,i))return a;return-1}var Ox=$x;function Rx(i){return i!==i}var Lx=Rx;function Bx(i,t,e){for(var r=e-1,n=i.length;++r<n;)if(i[r]===t)return r;return-1}var Ix=Bx;function Mx(i,t,e){return t===t?Ix(i,t,e):Ox(i,Lx,e)}var Nx=Mx;function Px(i,t){var e=i==null?0:i.length;return!!e&&Nx(i,t,0)>-1}var Dx=Px;function jx(i,t,e){for(var r=-1,n=i==null?0:i.length;++r<n;)if(e(t,i[r]))return!0;return!1}var zx=jx;function Fx(i,t){return i.has(t)}var Hx=Fx,qx=ps(Rr,"Set"),us=qx;function Ux(){}var Wx=Ux;function Vx(i){var t=-1,e=Array(i.size);return i.forEach(function(r){e[++t]=r}),e}var qf=Vx,Yx=1/0,Gx=us&&1/qf(new us([,-0]))[1]==Yx?function(i){return new us(i)}:Wx,Xx=Gx,Kx=200;function Jx(i,t,e){var r=-1,n=Dx,a=i.length,s=!0,o=[],l=o;if(e)s=!1,n=zx;else if(a>=Kx){var u=t?null:Xx(i);if(u)return qf(u);s=!1,n=Hx,l=new Ax}else l=t?[]:o;e:for(;++r<a;){var c=i[r],h=t?t(c):c;if(c=e||c!==0?c:0,s&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue e;t&&l.push(h),o.push(c)}else n(l,h,e)||(l!==o&&l.push(h),o.push(c))}return o}var Zx=Jx;function Qx(i){return i&&i.length?Zx(i):[]}var eC=Qx;function Uf(i){return i.replace(/([A-Z])/g,t=>`-${t[0].toLowerCase()}`)}function ds(i){return Object.keys(i).map(e=>{let r=Uf(e),n=i[e];return n===void 0?"":`data-${r}="${n}" `}).join("").trim()}function Df(i){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=i,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){console.log("Oops, unable to copy")}document.body.removeChild(t)}function tC(i){return!isNaN(i)}var Wf=i1,iC=Hf;function $r(i,t=null){return(...e)=>new Promise(r=>{setTimeout(()=>{let a=i.apply(t,e);r(a)})})}function qn(i,t,e){let r=e.reduce((n,a)=>(n[a]={get(){return t[a]}},n),{});Object.defineProperties(i,r)}function rC(i){return i!==void 0||i!==null}function nC(i){return!rC(i)}function Pn(i){return!isNaN(i)}function aC(i){return Array.isArray(i)?i:[i]}function jf(i){return eC(i)}function Ar(i,t){return i-t}function sC(i){return i.replace(/<[^>]*>/g,"")}function oC(i,t){return i&&(Object.keys(t).forEach(e=>{let r=new RegExp(`{(${e})}`,"g");i=i.replace(r,t[e])}),i)}var Vf=class{constructor(t){this.options=t,this.sortRows=$r(this.sortRows,this),this.switchColumn=$r(this.switchColumn,this),this.removeColumn=$r(this.removeColumn,this),this.options.filterRows=$r(this.options.filterRows,this)}init(t,e){t||(t=this.options.data),e&&(this.options.columns=e),this.data=t,this.rowCount=0,this.columns=[],this.rows=[],this.prepareColumns(),this.prepareRows(),this.prepareTreeRows(),this.prepareRowView(),this.prepareNumericColumns()}get currentSort(){return this.columns.find(e=>e.sortOrder!=="none")||{colIndex:-1,sortOrder:"none"}}prepareColumns(){this.columns=[],this.validateColumns(),this.prepareDefaultColumns(),this.prepareHeader()}prepareDefaultColumns(){if(this.options.checkboxColumn&&!this.hasColumnById("_checkbox")){let t={id:"_checkbox",content:this.getCheckboxHTML(),editable:!1,resizable:!1,sortable:!1,focusable:!1,dropdown:!1,width:32};this.columns.push(t)}if(this.options.serialNoColumn&&!this.hasColumnById("_rowIndex")){let t={id:"_rowIndex",content:"",align:"center",editable:!1,resizable:!1,focusable:!1,dropdown:!1};this.columns.push(t)}}prepareHeader(){let t=this.columns.concat(this.options.columns),e={isHeader:1,editable:!0,sortable:!0,resizable:!0,focusable:!0,dropdown:!0,width:null,format:r=>r==null?"":r+""};this.columns=t.map((r,n)=>this.prepareCell(r,n)).map(r=>Object.assign({},e,r)).map(r=>(r.content=r.content||r.name||"",r.id=r.id||r.content,r))}prepareCell(t,e){let r={content:"",sortOrder:"none",colIndex:e,column:this.columns[e]};return t!==null&&typeof t=="object"?Object.assign(r,t):r.content=t,r}prepareNumericColumns(){let t=this.getRow(0);!t||(this.columns=this.columns.map((e,r)=>{let n=t[r].content;return!e.align&&tC(n)&&(e.align="right"),e}))}prepareRows(){this.validateData(this.data),this.rows=this.data.map((t,e)=>{let r=this._getNextRowCount(),n=[],a={rowIndex:r};if(Array.isArray(t))for(this.options.checkboxColumn&&n.push(this.getCheckboxHTML()),this.options.serialNoColumn&&n.push(r+1+""),n=n.concat(t);n.length<this.columns.length;)n.push("");else{for(let s of this.columns)s.id==="_checkbox"?n.push(this.getCheckboxHTML()):s.id==="_rowIndex"?n.push(r+1+""):n.push(t[s.id]);a.indent=t.indent||0}return this.prepareRow(n,a)})}prepareTreeRows(){this.rows.forEach((t,e)=>{if(Pn(t.meta.indent)){let r=this.getRow(e+1);t.meta.isLeaf=!r||nC(r.meta.indent)||r.meta.indent<=t.meta.indent,t.meta.isTreeNodeClose=!1}})}prepareRowView(){this.rowViewOrder=this.rows.map(t=>t.meta.rowIndex)}prepareRow(t,e){let r={rowIndex:e.rowIndex,indent:e.indent};return t=t.map((n,a)=>this.prepareCell(n,a)).map(n=>Object.assign({},r,n)),t.meta=e,t}validateColumns(){let t=this.options.columns;if(!Array.isArray(t))throw new Dn("`columns` must be an array");t.forEach((e,r)=>{if(typeof e!="string"&&typeof e!="object")throw new Dn(`column "${r}" must be a string or an object`)})}validateData(t){if(Array.isArray(t)&&(t.length===0||Array.isArray(t[0])||typeof t[0]=="object"))return!0;throw new Dn("`data` must be an array of arrays or objects")}appendRows(t){this.validateData(t),this.rows.push(...this.prepareRows(t))}sortRows(t,e="none"){t=+t,this.getColumns().map(r=>{r.colIndex===t?r.sortOrder=e:r.sortOrder="none"}),this._sortRows(t,e)}_sortRows(t,e){if(this.currentSort.colIndex===t&&(this.currentSort.sortOrder==="asc"&&e==="desc"||this.currentSort.sortOrder==="desc"&&e==="asc")){this.reverseArray(this.rowViewOrder),this.currentSort.sortOrder=e;return}if(this.rowViewOrder.sort((r,n)=>{let a=r,s=n,o=this.getCell(t,r).content,l=this.getCell(t,n).content;if(o=o==null?"":o,l=l==null?"":l,e==="none")return a-s;if(e==="asc"){if(o<l)return-1;if(o>l)return 1;if(o===l)return 0}else if(e==="desc"){if(o<l)return 1;if(o>l)return-1;if(o===l)return 0}return 0}),this.hasColumnById("_rowIndex")){let r=this.getColumnIndexById("_rowIndex");this.rows.forEach((n,a)=>{let s=this.rowViewOrder.indexOf(a),o=n[r];o.content=s+1+""})}}reverseArray(t){let e=null,r=null,n=t.length;for(e=0,r=n-1;e<r;e+=1,r-=1){let a=t[e];t[e]=t[r],t[r]=a}}switchColumn(t,e){let r=this.columns[t];this.columns[t]=this.columns[e],this.columns[e]=r,this.columns[t].colIndex=t,this.columns[e].colIndex=e,this.rows.forEach(n=>{let a=Object.assign({},n[t],{colIndex:e}),s=Object.assign({},n[e],{colIndex:t});n[e]=a,n[t]=s})}removeColumn(t){t=+t;let e=n=>n.colIndex!==t,r=(n,a)=>Object.assign({},n,{colIndex:a});this.columns=this.columns.filter(e).map(r),this.rows.forEach(n=>{n.splice(t,1),n.forEach((a,s)=>{a.colIndex=s})})}updateRow(t,e){t.length<this.columns.length&&(this.hasColumnById("_rowIndex")&&(t=[e+1+""].concat(t)),this.hasColumnById("_checkbox")&&(t=['<input type="checkbox" />'].concat(t)));let r=this.prepareRow(t,{rowIndex:e}),n=this.rows.findIndex(a=>a[0].rowIndex===e);return this.rows[n]=r,r}updateCell(t,e,r){let n;typeof t=="object"&&(n=t,t=n.colIndex,e=n.rowIndex,r=n),n=this.getCell(t,e);for(let a in r){let s=r[a];s!==void 0&&(n[a]=s)}return n}updateColumn(t,e){let r=this.getColumn(t);for(let n in e){let a=e[n];a!==void 0&&(r[n]=a)}return r}filterRows(t){return this.options.filterRows(this.rows,t).then(e=>(e||(e=this.getAllRowIndices()),e.then||(e=Promise.resolve(e)),e.then(r=>(this._filteredRows=r,{rowsToHide:this.getAllRowIndices().filter(a=>!r.includes(a)),rowsToShow:r}))))}getFilteredRowIndices(){return this._filteredRows||this.getAllRowIndices()}getAllRowIndices(){return this.rows.map(t=>t.meta.rowIndex)}getRowCount(){return this.rowCount}_getNextRowCount(){let t=this.rowCount;return this.rowCount++,t}getRows(t,e){return this.rows.slice(t,e)}getRowsForView(t,e){return this.rowViewOrder.map(n=>this.rows[n]).slice(t,e)}getColumns(t){let e=this.columns;return t&&(e=e.slice(this.getStandardColumnCount())),e}getStandardColumnCount(){return this.options.checkboxColumn&&this.options.serialNoColumn?2:this.options.checkboxColumn||this.options.serialNoColumn?1:0}getColumnCount(t){let e=this.columns.length;return t&&(e=e-this.getStandardColumnCount()),e}getColumn(t){return t=+t,t<0&&(t=this.columns.length+t),this.columns.find(e=>e.colIndex===t)}getColumnById(t){return this.columns.find(e=>e.id===t)}getRow(t){return t=+t,this.rows[t]}getCell(t,e){return e=+e,t=+t,this.getRow(e)[t]}getChildren(t){t=+t;let e=this.getRow(t).meta.indent,r=[];for(let n=t+1;n<this.rowCount;n++){let a=this.getRow(n);if(!isNaN(a.meta.indent)&&(a.meta.indent>e&&r.push(n),a.meta.indent===e))break}return r}getImmediateChildren(t){t=+t;let e=this.getRow(t).meta.indent,r=[],n=e+1;for(let a=t+1;a<this.rowCount;a++){let s=this.getRow(a);if(!(isNaN(s.meta.indent)||s.meta.indent>n)&&(s.meta.indent===n&&r.push(a),s.meta.indent===e))break}return r}get(){return{columns:this.columns,rows:this.rows}}getData(t){return this.data[t]}hasColumn(t){return Boolean(this.columns.find(e=>e.content===t))}hasColumnById(t){return Boolean(this.columns.find(e=>e.id===t))}getColumnIndex(t){return this.columns.findIndex(e=>e.content===t)}getColumnIndexById(t){return this.columns.findIndex(e=>e.id===t)}getCheckboxHTML(){return'<input type="checkbox" />'}},Dn=class extends TypeError{},fs={chevronDown:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',chevronRight:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>'},Yf=class{constructor(t){this.instance=t,qn(this,this.instance,["wrapper","options","style","header","bodyScrollable","columnmanager","rowmanager","datamanager","keyboard"]),this.bindEvents()}bindEvents(){this.bindFocusCell(),this.bindEditCell(),this.bindKeyboardSelection(),this.bindCopyCellContents(),this.bindMouseEvents(),this.bindTreeEvents()}bindFocusCell(){this.bindKeyboardNav()}bindEditCell(){this.$editingCell=null,ue.on(this.bodyScrollable,"dblclick",".dt-cell",(t,e)=>{this.activateEditing(e)}),this.keyboard.on("enter",()=>{this.$focusedCell&&!this.$editingCell?this.activateEditing(this.$focusedCell):this.$editingCell&&this.deactivateEditing()})}bindKeyboardNav(){let t=e=>{if(!this.$focusedCell||this.$editingCell)return!1;let r=this.$focusedCell,{rowIndex:n,colIndex:a}=ue.data(r);return e==="left"?r=this.getLeftMostCell$(n):e==="right"?r=this.getRightMostCell$(n):e==="up"?r=this.getTopMostCell$(a):e==="down"&&(r=this.getBottomMostCell$(a)),this.focusCell(r),!0};["left","right","up","down","tab","shift+tab"].map(e=>this.keyboard.on(e,()=>this.focusCellInDirection(e))),["left","right","up","down"].map(e=>this.keyboard.on(`ctrl+${e}`,()=>t(e))),this.keyboard.on("esc",()=>{this.deactivateEditing(!1),this.columnmanager.toggleFilter(!1)}),this.options.inlineFilters&&(this.keyboard.on("ctrl+f",e=>{let r=ue.closest(".dt-cell",e.target),{colIndex:n}=ue.data(r);return this.activateFilter(n),!0}),ue.on(this.header,"focusin",".dt-filter",()=>{this.unfocusCell(this.$focusedCell)}))}bindKeyboardSelection(){let t=e=>{let r=this.getSelectionCursor();return e==="left"?r=this.getLeftCell$(r):e==="right"?r=this.getRightCell$(r):e==="up"?r=this.getAboveCell$(r):e==="down"&&(r=this.getBelowCell$(r)),r};["left","right","up","down"].map(e=>this.keyboard.on(`shift+${e}`,()=>this.selectArea(t(e))))}bindCopyCellContents(){this.keyboard.on("ctrl+c",()=>{let t=this.copyCellContents(this.$focusedCell,this.$selectionCursor),e=this.instance.translate("{count} cells copied",{count:t});t&&this.instance.showToastMessage(e,2)}),this.options.pasteFromClipboard&&this.keyboard.on("ctrl+v",t=>(this.instance.pasteTarget.focus(),setTimeout(()=>{let e=this.instance.pasteTarget.value;this.instance.pasteTarget.value="",this.pasteContentInCell(e)},10),!1))}bindMouseEvents(){let t=null;ue.on(this.bodyScrollable,"mousedown",".dt-cell",r=>{t=!0,this.focusCell(ue(r.delegatedTarget))}),ue.on(this.bodyScrollable,"mouseup",()=>{t=!1});let e=r=>{!t||this.selectArea(ue(r.delegatedTarget))};ue.on(this.bodyScrollable,"mousemove",".dt-cell",Wf(e,50))}bindTreeEvents(){ue.on(this.bodyScrollable,"click",".dt-tree-node__toggle",(t,e)=>{let r=ue.closest(".dt-cell",e),{rowIndex:n}=ue.data(r);r.classList.contains("dt-cell--tree-close")?this.rowmanager.openSingleNode(n):this.rowmanager.closeSingleNode(n)})}focusCell(t,{skipClearSelection:e=0,skipDOMFocus:r=0,skipScrollToCell:n=0}={}){if(!t||t===this.$editingCell)return;let{colIndex:a,isHeader:s}=ue.data(t);s||this.columnmanager.getColumn(a).focusable===!1||(n||this.scrollToCell(t),this.deactivateEditing(),e||this.clearSelection(),this.$focusedCell&&this.$focusedCell.classList.remove("dt-cell--focus"),this.$focusedCell=t,t.classList.add("dt-cell--focus"),r||t.focus(),this.highlightRowColumnHeader(t))}unfocusCell(t){!t||(t.classList.remove("dt-cell--focus"),this.$focusedCell=null,this.lastHeaders&&this.lastHeaders.forEach(e=>e&&e.classList.remove("dt-cell--highlight")))}highlightRowColumnHeader(t){let{colIndex:e,rowIndex:r}=ue.data(t),n=this.datamanager.getColumnIndexById("_rowIndex"),a=`.dt-cell--header-${e}`,s=`.dt-cell--${n}-${r}`;this.lastHeaders&&this.lastHeaders.forEach(u=>u&&u.classList.remove("dt-cell--highlight"));let o=ue(a,this.wrapper),l=ue(s,this.wrapper);this.lastHeaders=[o,l],this.lastHeaders.forEach(u=>u&&u.classList.add("dt-cell--highlight"))}selectAreaOnClusterChanged(){if(!(this.$focusedCell&&this.$selectionCursor))return;let{colIndex:t,rowIndex:e}=ue.data(this.$selectionCursor),r=this.getCell$(t,e);if(!r||r===this.$selectionCursor)return;let n=ue.data(this.$focusedCell);this.$focusedCell=this.getCell$(n.colIndex,n.rowIndex),this.selectArea(r)}focusCellOnClusterChanged(){if(!this.$focusedCell)return;let{colIndex:t,rowIndex:e}=ue.data(this.$focusedCell),r=this.getCell$(t,e);!r||this.focusCell(r,{skipClearSelection:1,skipDOMFocus:1,skipScrollToCell:1})}selectArea(t){!this.$focusedCell||this._selectArea(this.$focusedCell,t)&&(this.$selectionCursor=t)}_selectArea(t,e){if(t===e)return!1;let r=this.getCellsInRange(t,e);return r?(this.clearSelection(),this._selectedCells=r.map(n=>this.getCell$(...n)),requestAnimationFrame(()=>{this._selectedCells.map(n=>n.classList.add("dt-cell--highlight"))}),!0):!1}getCellsInRange(t,e){let r,n,a,s;if(typeof t=="number")[r,n,a,s]=arguments;else if(typeof t=="object"){if(!(t&&e))return!1;let h=ue.data(t),p=ue.data(e);r=+h.colIndex,n=+h.rowIndex,a=+p.colIndex,s=+p.rowIndex}if(n>s&&([n,s]=[s,n]),r>a&&([r,a]=[a,r]),this.isStandardCell(r)||this.isStandardCell(a))return!1;let o=[],l=r,u=n,c=[];for(;u<=s;)c.push(u),u+=1;return c.map(h=>{for(;l<=a;)o.push([l,h]),l++;l=r}),o}clearSelection(){(this._selectedCells||[]).forEach(t=>t.classList.remove("dt-cell--highlight")),this._selectedCells=[],this.$selectionCursor=null}getSelectionCursor(){return this.$selectionCursor||this.$focusedCell}activateEditing(t){this.focusCell(t);let{rowIndex:e,colIndex:r}=ue.data(t),n=this.columnmanager.getColumn(r);if(n&&(n.editable===!1||n.focusable===!1))return;let a=this.getCell(r,e);if(a&&a.editable===!1)return;if(this.$editingCell){let{_rowIndex:l,_colIndex:u}=ue.data(this.$editingCell);if(e===l&&r===u)return}this.$editingCell=t,t.classList.add("dt-cell--editing");let s=ue(".dt-cell__edit",t);s.innerHTML="";let o=this.getEditor(r,e,a.content,s);o&&(this.currentCellEditor=o,o.initValue(a.content,e,n))}deactivateEditing(t=!0){t&&this.submitEditing(),this.$focusedCell&&this.$focusedCell.focus(),this.$editingCell&&(this.$editingCell.classList.remove("dt-cell--editing"),this.$editingCell=null)}getEditor(t,e,r,n){let a=this.datamanager.getColumn(t),s=this.datamanager.getRow(e),o=this.datamanager.getData(e),l=this.options.getEditor?this.options.getEditor(t,e,r,n,a,s,o):this.getDefaultEditor(n);return l===!1?!1:(l===void 0&&(l=this.getDefaultEditor(n)),l)}getDefaultEditor(t){let e=ue.create("input",{class:"dt-input",type:"text",inside:t});return{initValue(r){e.focus(),e.value=r},getValue(){return e.value},setValue(r){e.value=r}}}submitEditing(){let t=Promise.resolve();if(!this.$editingCell)return t;let e=this.$editingCell,{rowIndex:r,colIndex:n}=ue.data(e),a=this.datamanager.getColumn(n);if(e){let s=this.currentCellEditor;if(s){let o=s.getValue();o.then||(o=Promise.resolve(o)),t=o.then(l=>{let u=this.getCell(n,r).content;if(u===l)return!1;let c=s.setValue(l,r,a);return this.updateCell(n,r,l),e.focus(),c&&c.then&&c.catch(h=>{console.log(h),this.updateCell(n,r,u)}),c})}}return this.currentCellEditor=null,t}copyCellContents(t,e){if(!e&&t){let{colIndex:s,rowIndex:o}=ue.data(t),l=this.getCell(s,o);return Df(l.content),1}let r=this.getCellsInRange(t,e);if(!r)return 0;let n=r.map(s=>this.getCell(...s)).reduce((s,o)=>{let l=o.rowIndex;return s[l]=s[l]||[],s[l].push(o.content),s},[]),a=n.map(s=>s.join("	")).join(`
`);return Df(a),n.reduce((s,o)=>s+o.length,0)}pasteContentInCell(t){if(!this.$focusedCell)return;let e=t.split(`
`).map(s=>s.split("	")).filter(s=>s.length&&s.every(o=>o)),{colIndex:r,rowIndex:n}=ue.data(this.$focusedCell),a={colIndex:+r,rowIndex:+n};e.forEach((s,o)=>{let l=o+a.rowIndex;s.forEach((u,c)=>{let h=c+a.colIndex;this.updateCell(h,l,u)})})}activateFilter(t){this.columnmanager.toggleFilter(),this.columnmanager.focusFilter(t),this.columnmanager.isFilterShown||this.$focusedCell&&this.$focusedCell.focus()}updateCell(t,e,r){let n=this.datamanager.updateCell(t,e,{content:r});this.refreshCell(n)}refreshCell(t){let e=ue(this.selector(t.colIndex,t.rowIndex),this.bodyScrollable);e.innerHTML=this.getCellContent(t)}toggleTreeButton(t,e){let r=this.columnmanager.getFirstColumnIndex(),n=this.getCell$(r,t);n&&n.classList[e?"remove":"add"]("dt-cell--tree-close")}isStandardCell(t){return t<this.columnmanager.getFirstColumnIndex()}focusCellInDirection(t){if(!this.$focusedCell||this.$editingCell&&["left","right","up","down"].includes(t))return!1;this.$editingCell&&["tab","shift+tab"].includes(t)&&this.deactivateEditing();let e=this.$focusedCell;if(t==="left"||t==="shift+tab"?e=this.getLeftCell$(e):t==="right"||t==="tab"?e=this.getRightCell$(e):t==="up"?e=this.getAboveCell$(e):t==="down"&&(e=this.getBelowCell$(e)),!e)return!1;let{colIndex:r}=ue.data(e);if(!this.columnmanager.getColumn(r).focusable){let a=this.$focusedCell;this.unfocusCell(a),this.$focusedCell=e;let s=this.focusCellInDirection(t);return s||this.focusCell(a),s}return this.focusCell(e),!0}getCell$(t,e){return ue(this.selector(t,e),this.bodyScrollable)}getAboveCell$(t){let{colIndex:e}=ue.data(t),r=t.parentElement.previousElementSibling;for(;r&&r.classList.contains("dt-row--hide");)r=r.previousElementSibling;return r?ue(`.dt-cell--col-${e}`,r):t}getBelowCell$(t){let{colIndex:e}=ue.data(t),r=t.parentElement.nextElementSibling;for(;r&&r.classList.contains("dt-row--hide");)r=r.nextElementSibling;return r?ue(`.dt-cell--col-${e}`,r):t}getLeftCell$(t){return t.previousElementSibling}getRightCell$(t){return t.nextElementSibling}getLeftMostCell$(t){return this.getCell$(this.columnmanager.getFirstColumnIndex(),t)}getRightMostCell$(t){return this.getCell$(this.columnmanager.getLastColumnIndex(),t)}getTopMostCell$(t){return this.getCell$(t,this.rowmanager.getFirstRowIndex())}getBottomMostCell$(t){return this.getCell$(t,this.rowmanager.getLastRowIndex())}getCell(t,e){return this.instance.datamanager.getCell(t,e)}getRowHeight(){return ue.style(ue(".dt-row",this.bodyScrollable),"height")}scrollToCell(t){if(ue.inViewport(t,this.bodyScrollable))return!1;let{rowIndex:e}=ue.data(t);return this.rowmanager.scrollToRow(e),!1}getRowCountPerPage(){return Math.ceil(this.instance.getViewportHeight()/this.getRowHeight())}getCellHTML(t){let{rowIndex:e,colIndex:r,isHeader:n,isFilter:a,isTotalRow:s}=t,o=ds({rowIndex:e,colIndex:r,isHeader:n,isFilter:a,isTotalRow:s}),l=this.datamanager.getRow(e),u=!(n||a||s);return`
            <div class="${["dt-cell","dt-cell--col-"+r,u?`dt-cell--${r}-${e}`:"",u?"dt-cell--row-"+e:"",n?"dt-cell--header":"",n?`dt-cell--header-${r}`:"",a?"dt-cell--filter":"",u&&l&&l.meta.isTreeNodeClose?"dt-cell--tree-close":""].join(" ")}" ${o} tabindex="0">
                ${this.getCellContent(t)}
            </div>
        `}getCellContent(t){let{isHeader:e,isFilter:r,colIndex:n}=t,s=!e&&t.editable!==!1?this.getEditCellHTML(n):"",l=e&&t.sortable!==!1?`<span class="sort-indicator">
                ${this.options.sortIndicator[t.sortOrder]}
            </span>`:"",c=e&&t.resizable!==!1?'<span class="dt-cell__resize-handle"></span>':"",p=e&&t.dropdown!==!1?this.columnmanager.getDropdownHTML():"",g=t.format||t.column&&t.column.format||null,b;if(e||r||!g)b=t.content;else{let k=this.datamanager.getRow(t.rowIndex),C=this.datamanager.getData(t.rowIndex);b=g(t.content,k,t.column,C)}if(t.html=b,this.options.treeView&&!(e||r)&&t.indent!==void 0){let k=this.datamanager.getRow(t.rowIndex+1),C=k&&k.meta.indent>t.indent,O=20,d="px";if(this.datamanager.getColumnIndexById("_rowIndex")+1===t.colIndex){let m=(t.indent||0)*O,y=C?`<span class="dt-tree-node__toggle" style="left: ${m-O}${d}">
                        <span class="icon-open">${fs.chevronDown}</span>
                        <span class="icon-close">${fs.chevronRight}</span>
                    </span>`:"";b=`<span class="dt-tree-node" style="padding-left: ${m}${d}">
                    ${y}
                    <span>${b}</span>
                </span>`}}return`
            <div class="${["dt-cell__content",e?`dt-cell__content--header-${n}`:`dt-cell__content--col-${n}`].join(" ")}">
                ${b}
                ${l}
                ${c}
                ${p}
            </div>
            ${s}
        `}getEditCellHTML(t){return`<div class="dt-cell__edit dt-cell__edit--col-${t}"></div>`}selector(t,e){return`.dt-cell--${t}-${e}`}},Gf=class{constructor(t){this.instance=t,qn(this,this.instance,["options","fireEvent","header","datamanager","cellmanager","style","wrapper","rowmanager","bodyScrollable","bodyRenderer"]),this.bindEvents()}renderHeader(){this.header.innerHTML="<div></div>",this.refreshHeader()}refreshHeader(){let t=this.datamanager.getColumns();ue("div",this.header).innerHTML=this.getHeaderHTML(t),this.$filterRow=ue(".dt-row-filter",this.header),this.$filterRow&&ue.style(this.$filterRow,{display:"none"}),this.$columnMap=[],this.bindMoveColumn()}getHeaderHTML(t){let e=this.rowmanager.getRowHTML(t,{isHeader:1});return this.options.inlineFilters&&(e+=this.rowmanager.getRowHTML(t,{isFilter:1})),e}bindEvents(){this.bindDropdown(),this.bindResizeColumn(),this.bindPerfectColumnWidth(),this.bindFilter()}bindDropdown(){let t=".dt-dropdown__toggle",e=".dt-dropdown__list";this.instance.dropdownContainer.innerHTML=this.getDropdownListHTML(),this.$dropdownList=this.instance.dropdownContainer.firstElementChild,ue.on(this.header,"click",t,s=>{this.openDropdown(s)});let r=s=>{let o=[t,t+" *",e,e+" *"].join(",");s.target.matches(o)||a()};ue.on(document.body,"click",r),document.addEventListener("scroll",a,!0),this.instance.on("onDestroy",()=>{ue.off(document.body,"click",r),ue.off(document,"scroll",a)}),ue.on(this.$dropdownList,"click",".dt-dropdown__list-item",(s,o)=>{if(!this._dropdownActiveColIndex)return;let l=this.options.headerDropdown,{index:u}=ue.data(o),c=this._dropdownActiveColIndex,h=l[u].action;h&&h.call(this.instance,this.getColumn(c)),this.hideDropdown()});let n=this;function a(s){n.hideDropdown()}this.hideDropdown()}openDropdown(t){this._dropdownWidth||(ue.style(this.$dropdownList,{display:""}),this._dropdownWidth=ue.style(this.$dropdownList,"width")),ue.style(this.$dropdownList,{display:"",left:t.clientX-this._dropdownWidth+4+"px",top:t.clientY+4+"px"});let e=ue.closest(".dt-cell",t.target),{colIndex:r}=ue.data(e);this._dropdownActiveColIndex=r}hideDropdown(){ue.style(this.$dropdownList,{display:"none"}),this._dropdownActiveColIndex=null}bindResizeColumn(){let t=!1,e,r,n;ue.on(this.header,"mousedown",".dt-cell .dt-cell__resize-handle",(o,l)=>{document.body.classList.add("dt-resize"),e=l.parentNode.parentNode;let{colIndex:c}=ue.data(e),h=this.getColumn(c);h&&h.resizable===!1||(t=!0,r=ue.style(ue(".dt-cell__content",e),"width"),n=o.pageX)});let a=o=>{if(document.body.classList.remove("dt-resize"),!e)return;t=!1;let{colIndex:l}=ue.data(e);this.setColumnWidth(l),this.style.setBodyStyle(),e=null};ue.on(document.body,"mouseup",a),this.instance.on("onDestroy",()=>{ue.off(document.body,"mouseup",a)});let s=o=>{if(!t)return;let l=o.pageX-n;this.options.direction==="rtl"&&(l=-1*l);let u=r+l,{colIndex:c}=ue.data(e);this.options.minimumColumnWidth>u||(this.datamanager.updateColumn(c,{width:u}),this.setColumnHeaderWidth(c))};ue.on(document.body,"mousemove",s),this.instance.on("onDestroy",()=>{ue.off(document.body,"mousemove",s)})}bindPerfectColumnWidth(){ue.on(this.header,"dblclick",".dt-cell .dt-cell__resize-handle",(t,e)=>{let r=e.parentNode.parentNode,{colIndex:n}=ue.data(r),a=this.bodyRenderer.visibleRows.map(v=>v[n]).reduce((v,k)=>v.content.length>k.content.length?v:k),s=this.cellmanager.getCellHTML(a),o=document.createElement("div");o.innerHTML=s;let l=o.querySelector(".dt-cell__content").textContent,{borderLeftWidth:u,borderRightWidth:c,paddingLeft:h,paddingRight:p}=ue.getStyle(this.bodyScrollable.querySelector(".dt-cell__content")),g=[u,c,h,p].map(parseFloat).reduce((v,k)=>v+k),b=ue.measureTextWidth(l)+g;this.datamanager.updateColumn(n,{width:b}),this.setColumnHeaderWidth(n),this.setColumnWidth(n)})}bindMoveColumn(){if(this.options.disableReorderColumn)return;let t=ue(".dt-row",this.header);this.sortable=gk.create(t,{onEnd:e=>{let{oldIndex:r,newIndex:n}=e,a=e.item,{colIndex:s}=ue.data(a);+s!==n&&this.switchColumn(r,n)},preventOnFilter:!1,filter:".dt-cell__resize-handle, .dt-dropdown",chosenClass:"dt-cell--dragging",animation:150})}sortColumn(t,e){this.instance.freeze(),this.sortRows(t,e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onSortColumn",this.getColumn(t))})}removeColumn(t){let e=this.getColumn(t);this.instance.freeze(),this.datamanager.removeColumn(t).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>this.instance.unfreeze()).then(()=>{this.fireEvent("onRemoveColumn",e)})}switchColumn(t,e){this.instance.freeze(),this.datamanager.switchColumn(t,e).then(()=>(this.refreshHeader(),this.rowmanager.refreshRows())).then(()=>{this.setColumnWidth(t),this.setColumnWidth(e),this.instance.unfreeze()}).then(()=>{this.fireEvent("onSwitchColumn",this.getColumn(t),this.getColumn(e))})}toggleFilter(t){if(!this.options.inlineFilters)return;let e;t===void 0?e=!this.isFilterShown:e=t,e?ue.style(this.$filterRow,{display:""}):ue.style(this.$filterRow,{display:"none"}),this.isFilterShown=e,this.style.setBodyStyle()}focusFilter(t){if(!this.isFilterShown)return;ue(`.dt-cell--col-${t} .dt-filter`,this.$filterRow).focus()}bindFilter(){if(!this.options.inlineFilters)return;let t=e=>{this.applyFilter(this.getAppliedFilters())};ue.on(this.header,"keydown",".dt-filter",iC(t,300))}applyFilter(t){this.datamanager.filterRows(t).then(({rowsToShow:e})=>{this.rowmanager.showRows(e)})}getAppliedFilters(){let t={};return ue.each(".dt-filter",this.header).map(e=>{let r=e.value;r&&(t[e.dataset.colIndex]=r)}),t}applyDefaultSortOrder(){let t=this.getColumns().filter(e=>e.sortOrder!=="none");if(t.length===1){let e=t[0];this.sortColumn(e.colIndex,e.sortOrder)}}sortRows(t,e){return this.datamanager.sortRows(t,e)}getColumn(t){return this.datamanager.getColumn(t)}getColumns(){return this.datamanager.getColumns()}setColumnWidth(t,e){t=+t;let r=e||this.getColumn(t).width,n=[`.dt-cell__content--col-${t}`,`.dt-cell__edit--col-${t}`].join(", "),a={width:r+"px"};this.style.setStyle(n,a)}setColumnHeaderWidth(t){t=+t,this.$columnMap=this.$columnMap||[];let e=`.dt-cell__content--header-${t}`,{width:r}=this.getColumn(t),n=this.$columnMap[t];n||(n=this.header.querySelector(e),this.$columnMap[t]=n),n.style.width=r+"px"}getColumnMinWidth(t){return t=+t,this.getColumn(t).minWidth||24}getFirstColumnIndex(){return this.datamanager.getColumnIndexById("_rowIndex")+1}getHeaderCell$(t){return ue(`.dt-cell--header-${t}`,this.header)}getLastColumnIndex(){return this.datamanager.getColumnCount()-1}getDropdownHTML(){let{dropdownButton:t}=this.options;return`
            <div class="dt-dropdown">
                <div class="dt-dropdown__toggle">${t}</div>
            </div>
      `}getDropdownListHTML(){let{headerDropdown:t}=this.options;return`
            <div class="dt-dropdown__list">
            ${t.map((e,r)=>`
                <div class="dt-dropdown__list-item" data-index="${r}">${e.label}</div>
            `).join("")}
            </div>
        `}},Xf=class{constructor(t){this.instance=t,qn(this,this.instance,["options","fireEvent","wrapper","bodyScrollable","bodyRenderer","style"]),this.bindEvents(),this.refreshRows=$r(this.refreshRows,this)}get datamanager(){return this.instance.datamanager}get cellmanager(){return this.instance.cellmanager}bindEvents(){this.bindCheckbox()}bindCheckbox(){!this.options.checkboxColumn||(this.checkMap=[],ue.on(this.wrapper,"click",'.dt-cell--col-0 [type="checkbox"]',(t,e)=>{let r=e.closest(".dt-cell"),{rowIndex:n,isHeader:a}=ue.data(r),s=e.checked;a?this.checkAll(s):this.checkRow(n,s)}))}refreshRows(){this.instance.renderBody(),this.instance.setDimensions()}refreshRow(t,e){this.datamanager.updateRow(t,e).forEach(n=>{this.cellmanager.refreshCell(n)})}getCheckedRows(){if(!this.checkMap)return[];let t=[];for(let e in this.checkMap)this.checkMap[e]===1&&t.push(e);return t}highlightCheckedRows(){this.getCheckedRows().map(t=>this.checkRow(t,!0))}checkRow(t,e){let r=e?1:0,n=a=>`.dt-cell--0-${a} [type="checkbox"]`;this.checkMap[t]=r,ue.each(n(t),this.bodyScrollable).map(a=>{a.checked=e}),this.highlightRow(t,e),this.showCheckStatus(),this.fireEvent("onCheckRow",this.datamanager.getRow(t))}checkAll(t){let e=t?1:0;t?this.checkMap=Array.from(Array(this.getTotalRows())).map(r=>e):this.checkMap=[],ue.each('.dt-cell--col-0 [type="checkbox"]',this.bodyScrollable).map(r=>{r.checked=t}),this.highlightAll(t),this.showCheckStatus(),this.fireEvent("onCheckRow")}showCheckStatus(){if(!this.options.checkedRowStatus)return;let e=this.getCheckedRows().length;if(e>0){let r=this.instance.translate("{count} rows selected",{count:e});this.bodyRenderer.showToastMessage(r)}else this.bodyRenderer.clearToastMessage()}highlightRow(t,e=!0){let r=this.getRow$(t);if(!!r){if(!e&&this.bodyScrollable.classList.contains("dt-scrollable--highlight-all")){r.classList.add("dt-row--unhighlight");return}e&&r.classList.contains("dt-row--unhighlight")&&r.classList.remove("dt-row--unhighlight"),this._highlightedRows=this._highlightedRows||{},e?(r.classList.add("dt-row--highlight"),this._highlightedRows[t]=r):(r.classList.remove("dt-row--highlight"),delete this._highlightedRows[t])}}highlightAll(t=!0){if(t)this.bodyScrollable.classList.add("dt-scrollable--highlight-all");else{this.bodyScrollable.classList.remove("dt-scrollable--highlight-all");for(let e in this._highlightedRows)this._highlightedRows[e].classList.remove("dt-row--highlight");this._highlightedRows={}}}showRows(t){t=aC(t);let e=t.map(r=>this.datamanager.getRow(r));this.bodyRenderer.renderRows(e)}showAllRows(){let t=this.datamanager.getAllRowIndices();this.showRows(t)}getChildrenToShowForNode(t){let e=this.datamanager.getRow(t);return e.meta.isTreeNodeClose=!1,this.datamanager.getImmediateChildren(t)}openSingleNode(t){let e=this.getChildrenToShowForNode(t),r=this.bodyRenderer.visibleRowIndices,n=jf([...e,...r]).sort(Ar);this.showRows(n)}getChildrenToHideForNode(t){let e=this.datamanager.getRow(t);e.meta.isTreeNodeClose=!0;let r=this.datamanager.getChildren(t);return r.forEach(n=>{let a=this.datamanager.getRow(n);a.meta.isLeaf||(a.meta.isTreeNodeClose=!0)}),r}closeSingleNode(t){let e=this.getChildrenToHideForNode(t),n=this.bodyRenderer.visibleRowIndices.filter(a=>!e.includes(a)).sort(Ar);this.showRows(n)}expandAllNodes(){let r=this.datamanager.getRows().filter(s=>!s.meta.isLeaf).map(s=>this.getChildrenToShowForNode(s.meta.rowIndex)).flat(),n=this.bodyRenderer.visibleRowIndices,a=jf([...r,...n]).sort(Ar);this.showRows(a)}collapseAllNodes(){let r=this.datamanager.getRows().filter(s=>s.meta.indent===0).map(s=>this.getChildrenToHideForNode(s.meta.rowIndex)).flat(),a=this.bodyRenderer.visibleRowIndices.filter(s=>!r.includes(s)).sort(Ar);this.showRows(a)}setTreeDepth(t){let e=this.datamanager.getRows(),r=e.filter(o=>o.meta.indent<t),n=e.filter(o=>o.meta.indent>=t),a=n.filter(o=>o.meta.indent>t);n.forEach(o=>{o.meta.isLeaf||(o.meta.isTreeNodeClose=!0)}),r.forEach(o=>{o.meta.isLeaf||(o.meta.isTreeNodeClose=!1)});let s=e.filter(o=>!a.includes(o)).map(o=>o.meta.rowIndex).sort(Ar);this.showRows(s)}getRow$(t){return ue(this.selector(t),this.bodyScrollable)}getTotalRows(){return this.datamanager.getRowCount()}getFirstRowIndex(){return 0}getLastRowIndex(){return this.datamanager.getRowCount()-1}scrollToRow(t){t=+t,this._lastScrollTo=this._lastScrollTo||0;let e=this.getRow$(t);if(ue.inViewport(e,this.bodyScrollable))return;let{height:r}=e.getBoundingClientRect(),{top:n,bottom:a}=this.bodyScrollable.getBoundingClientRect(),s=Math.floor((a-n)/r),o=0;t>this._lastScrollTo?o=r*(t+1-s):o=r*(t+1-1),this._lastScrollTo=t,ue.scrollTop(this.bodyScrollable,o)}getRowHTML(t,e){let r=ds(e),n=e.rowIndex;return e.isFilter&&(t=t.map(a=>Object.assign({},a,{content:this.getFilterInput({colIndex:a.colIndex,name:a.name}),isFilter:1,isHeader:void 0,editable:!1})),n="filter"),e.isHeader&&(n="header"),`
            <div class="dt-row dt-row-${n}" ${r}>
                ${t.map(a=>this.cellmanager.getCellHTML(a)).join("")}
            </div>
        `}getFilterInput(t){let e=`title="Filter based on ${t.name||"Index"}"`;return`<input class="dt-filter dt-input" type="text" ${ds(t)} tabindex="1" 
            ${t.colIndex===0?"disabled":e} />`}selector(t){return`.dt-row-${t}`}},lC=wk(function(i,t){(function(e){i.exports=e()})(function(){return function e(r,n,a){function s(u,c){if(!n[u]){if(!r[u]){var h=typeof Nn=="function"&&Nn;if(!c&&h)return h(u,!0);if(o)return o(u,!0);var p=new Error("Cannot find module '"+u+"'");throw p.code="MODULE_NOT_FOUND",p}var g=n[u]={exports:{}};r[u][0].call(g.exports,function(b){var v=r[u][1][b];return s(v||b)},g,g.exports,e,r,n,a)}return n[u].exports}for(var o=typeof Nn=="function"&&Nn,l=0;l<a.length;l++)s(a[l]);return s}({1:[function(e,r,n){Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function c(h,p){for(var g=0;g<p.length;g++){var b=p[g];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(h,b.key,b)}}return function(h,p,g){return p&&c(h.prototype,p),g&&c(h,g),h}}();function s(c,h){if(!(c instanceof h))throw new TypeError("Cannot call a class as a function")}var o={width:"100%",height:"100%"},l=function(h){return Number(h)===Number(h)},u=function(){a(c,null,[{key:"create",value:function(p,g){return new c(p,g)}},{key:"mergeStyle",value:function(p,g){for(var b in g)p.style[b]!==g[b]&&(p.style[b]=g[b])}},{key:"getMaxBrowserHeight",value:function(){var p=document.createElement("div"),g=document.createElement("div");c.mergeStyle(p,{position:"absolute",height:"1px",opacity:0}),c.mergeStyle(g,{height:"1e7px"}),p.appendChild(g),document.body.appendChild(p);var b=g.offsetHeight;return document.body.removeChild(p),b}}]);function c(h,p){var g=this;s(this,c),this._config={},this._lastRepaint=null,this._maxElementHeight=c.getMaxBrowserHeight(),this.refresh(h,p);var b=this._config,v=function k(){var C=g._getScrollPosition(),O=g._lastRepaint;if(g._renderAnimationFrame=window.requestAnimationFrame(k),C!==O&&(!O||Math.abs(C-O)>g._averageHeight)){var d=g._renderChunk();g._lastRepaint=C,d!==!1&&typeof b.afterRender=="function"&&b.afterRender()}};v()}return a(c,[{key:"destroy",value:function(){window.cancelAnimationFrame(this._renderAnimationFrame)}},{key:"refresh",value:function(p,g){var b=this;if(Object.assign(this._config,o,g),!p||p.nodeType!==1)throw new Error("HyperList requires a valid DOM Node container");this._element=p;var v=this._config,k=this._scroller||v.scroller||document.createElement(v.scrollerTagName||"tr");if(typeof v.useFragment!="boolean"&&(this._config.useFragment=!0),!v.generate)throw new Error("Missing required `generate` function");if(!l(v.total))throw new Error("Invalid required `total` value, expected number");if(!Array.isArray(v.itemHeight)&&!l(v.itemHeight))throw new Error("\n        Invalid required `itemHeight` value, expected number or array\n      ".trim());l(v.itemHeight)?this._itemHeights=Array(v.total).fill(v.itemHeight):this._itemHeights=v.itemHeight,Object.keys(o).filter(function(m){return m in v}).forEach(function(m){var y=v[m],x=l(y),S=x?!1:y.slice(-1)==="%";if(y&&typeof y!="string"&&typeof y!="number"){var w="Invalid optional `"+m+"`, expected string or number";throw new Error(w)}else x&&(v[m]=y+"px");if(m==="height"){var E=x?y:parseInt(y.replace(/px|%/,""),10);S?b._containerHeight=window.innerHeight*E/100:b._containerHeight=l(y)?y:E}});var C={width:""+v.width,height:""+v.height,overflow:"auto",position:"relative"};c.mergeStyle(p,C);var O=v.itemHeight*v.total,d=this._maxElementHeight;O>d&&console.warn(["HyperList: The maximum element height",d+"px has","been exceeded; please reduce your item height."].join(" "));var _={opacity:"0",position:"absolute",width:"1px",height:O+"px"};c.mergeStyle(k,_),this._scroller||p.appendChild(k),this._scroller=k,this._scrollHeight=this._computeScrollHeight(),this._itemPositions=this._itemPositions||Array(v.total).fill(0),this._computePositions(0),this._renderChunk(this._lastRepaint!==null),typeof v.afterRender=="function"&&v.afterRender()}},{key:"_getRow",value:function(p){var g=this._config,b=g.generate(p),v=b.height;if(v!==void 0&&l(v)?(b=b.element,v!==this._itemHeights&&(this._itemHeights[p]=v,this._computePositions(p),this._scrollHeight=this._computeScrollHeight(p))):v=this._itemHeights[p],!b||b.nodeType!==1)throw new Error("Generator did not return a DOM Node for index: "+p);var k=b.getAttribute("class")||"";b.setAttribute("class",k+" "+(g.rowClassName||"vrow"));var C=this._itemPositions[p];return c.mergeStyle(b,{position:"absolute",top:C+"px"}),b}},{key:"_getScrollPosition",value:function(){var p=this._config;return typeof p.overrideScrollPosition=="function"?p.overrideScrollPosition():this._element.scrollTop}},{key:"_renderChunk",value:function(p){var g=this._config,b=this._element,v=this._getScrollPosition(),k=g.total,C=g.reverse?this._getReverseFrom(v):this._getFrom(v)-1;if((C<0||C-this._screenItemsLen<0)&&(C=0),!p&&this._lastFrom===C)return!1;this._lastFrom=C;var O=C+this._cachedItemsLen;(O>k||O+this._cachedItemsLen>k)&&(O=k);var d=g.useFragment?document.createDocumentFragment():[],_=this._scroller;d[g.useFragment?"appendChild":"push"](_);for(var m=C;m<O;m++){var y=this._getRow(m);d[g.useFragment?"appendChild":"push"](y)}if(g.applyPatch)return g.applyPatch(b,d);b.innerHTML="",b.appendChild(d)}},{key:"_computePositions",value:function(){var p=arguments.length<=0||arguments[0]===void 0?1:arguments[0],g=this._config,b=g.total,v=g.reverse;p<1&&!v&&(p=1);for(var k=p;k<b;k++)v?k===0?this._itemPositions[0]=this._scrollHeight-this._itemHeights[0]:this._itemPositions[k]=this._itemPositions[k-1]-this._itemHeights[k]:this._itemPositions[k]=this._itemHeights[k-1]+this._itemPositions[k-1]}},{key:"_computeScrollHeight",value:function(){var p=this,g=this._config,b=g.total,v=this._itemHeights.reduce(function(_,m){return _+m},0);c.mergeStyle(this._scroller,{opacity:0,position:"absolute",width:"1px",height:v+"px"});var k=this._itemHeights.slice(0).sort(function(_,m){return _-m}),C=Math.floor(b/2),O=b%2===0?(k[C]+k[C-1])/2:k[C],d=this._element.clientHeight?this._element.clientHeight:this._containerHeight;return this._screenItemsLen=Math.ceil(d/O),this._containerHeight=d,this._cachedItemsLen=Math.max(this._cachedItemsLen||0,this._screenItemsLen*3),this._averageHeight=O,g.reverse&&window.requestAnimationFrame(function(){p._element.scrollTop=v}),v}},{key:"_getFrom",value:function(p){for(var g=0;this._itemPositions[g]<p;)g++;return g}},{key:"_getReverseFrom",value:function(p){for(var g=this._config.total-1;g>0&&this._itemPositions[g]<p+this._containerHeight;)g--;return g}}]),c}();n.default=u,r.exports=n.default},{}]},{},[1])(1)})}),cC=yk(lC),Kf=class{constructor(t){this.instance=t,this.options=t.options,this.datamanager=t.datamanager,this.rowmanager=t.rowmanager,this.cellmanager=t.cellmanager,this.bodyScrollable=t.bodyScrollable,this.footer=this.instance.footer,this.log=t.log}renderRows(t){if(this.visibleRows=t,this.visibleRowIndices=t.map(a=>a.meta.rowIndex),t.length===0){this.bodyScrollable.innerHTML=this.getNoDataHTML();return}let e=this.datamanager.rowViewOrder.map(a=>this.visibleRowIndices.includes(a)?a:null).filter(a=>a!==null),r=getComputedStyle(this.bodyScrollable),n={width:r.width,height:r.height,itemHeight:this.options.cellHeight,total:t.length,generate:a=>{let s=document.createElement("div"),o=e[a],l=this.datamanager.getRow(o),u=this.rowmanager.getRowHTML(l,l.meta);return s.innerHTML=u,s.children[0]},afterRender:()=>{this.restoreState()}};this.hyperlist?this.hyperlist.refresh(this.bodyScrollable,n):this.hyperlist=new cC(this.bodyScrollable,n),this.renderFooter()}render(){let t=this.datamanager.getRowsForView();this.renderRows(t),this.instance.setDimensions()}renderFooter(){if(!this.options.showTotalRow)return;let t=this.getTotalRow(),e=this.rowmanager.getRowHTML(t,{isTotalRow:1,rowIndex:"totalRow"});this.footer.innerHTML=e}getTotalRow(){return this.datamanager.getColumns().map(n=>{let a=null;return["_rowIndex","_checkbox"].includes(n.id)&&(a=""),{content:a,isTotalRow:1,colIndex:n.colIndex,column:n}}).map((n,a)=>{if(n.content==="")return n;if(this.options.hooks.columnTotal){let s=this.visibleRows.map(l=>l[a].content),o=this.options.hooks.columnTotal.call(this.instance,s,n);if(o!=null)return n.content=o,n}return n.content=this.visibleRows.reduce((s,o)=>{let l=o[a];return typeof l.content=="number"?(s==null&&(s=0),s+l.content):s},n.content),n})}restoreState(){this.rowmanager.highlightCheckedRows(),this.cellmanager.selectAreaOnClusterChanged(),this.cellmanager.focusCellOnClusterChanged()}showToastMessage(t,e){this.instance.toastMessage.innerHTML=this.getToastMessageHTML(t),e&&setTimeout(()=>{this.clearToastMessage()},e*1e3)}clearToastMessage(){this.instance.toastMessage.innerHTML=""}getNoDataHTML(){return`<div class="dt-scrollable__no-data">${this.options.noDataMessage}</div>`}getToastMessageHTML(t){return`<span class="dt-toast__message">${t}</span>`}},Jf=class{constructor(t){this.instance=t,qn(this,this.instance,["options","datamanager","columnmanager","header","footer","bodyScrollable","datatableWrapper","getColumn","bodyRenderer"]),this.scopeClass="dt-instance-"+t.constructor.instances,t.datatableWrapper.classList.add(this.scopeClass);let e=document.createElement("style");t.wrapper.insertBefore(e,t.datatableWrapper),this.styleEl=e,this.bindResizeWindow(),this.bindScrollHeader()}get stylesheet(){return this.styleEl.sheet}bindResizeWindow(){this.onWindowResize=this.onWindowResize.bind(this),this.onWindowResize=Wf(this.onWindowResize,300),this.options.layout==="fluid"&&ue.on(window,"resize",this.onWindowResize)}bindScrollHeader(){this._settingHeaderPosition=!1,ue.on(this.bodyScrollable,"scroll",t=>{this._settingHeaderPosition||(this._settingHeaderPosition=!0,requestAnimationFrame(()=>{let e=-t.target.scrollLeft;ue.style(this.header,{transform:`translateX(${e}px)`}),ue.style(this.footer,{transform:`translateX(${e}px)`}),this._settingHeaderPosition=!1}))})}onWindowResize(){this.distributeRemainingWidth(),this.refreshColumnWidth(),this.setBodyStyle()}destroy(){this.styleEl.remove(),ue.off(window,"resize",this.onWindowResize)}setStyle(t,e){if(t.includes(",")){t.split(",").map(s=>s.trim()).forEach(s=>{this.setStyle(s,e)});return}if(t=t.trim(),!t)return;this._styleRulesMap=this._styleRulesMap||{};let r=this._getPrefixedSelector(t);this._styleRulesMap[r]&&(this.removeStyle(t),e=Object.assign({},this._styleRulesMap[r],e));let n=this._getRuleString(e),a=`${r} { ${n} }`;this._styleRulesMap[r]=e,this.stylesheet.insertRule(a)}removeStyle(t){if(t.includes(",")){t.split(",").map(n=>n.trim()).forEach(n=>{this.removeStyle(n)});return}if(t=t.trim(),!t)return;let e=this._getPrefixedSelector(t),r=Array.from(this.stylesheet.cssRules).findIndex(n=>n.selectorText===e);r!==-1&&this.stylesheet.deleteRule(r)}_getPrefixedSelector(t){return`.${this.scopeClass} ${t}`}_getRuleString(t){return Object.keys(t).map(e=>{let r=e;return e.includes("-")||(r=Uf(e)),`${r}:${t[e]};`}).join("")}setDimensions(){this.setCellHeight(),this.setupMinWidth(),this.setupNaturalColumnWidth(),this.setupColumnWidth(),this.distributeRemainingWidth(),this.setColumnStyle(),this.setBodyStyle()}setCellHeight(){this.setStyle(".dt-cell",{height:this.options.cellHeight+"px"})}setupMinWidth(){ue.each(".dt-cell--header",this.header).map(t=>{let{colIndex:e}=ue.data(t),r=this.getColumn(e);if(!r.minWidth){let n=ue.style(ue(".dt-cell__content",t),"width");r.minWidth=n}})}setupNaturalColumnWidth(){!ue(".dt-row")||(ue.each(".dt-row-header .dt-cell",this.header).map(t=>{let{colIndex:e}=ue.data(t),r=this.datamanager.getColumn(e),n=ue.style(ue(".dt-cell__content",t),"width");typeof n=="number"&&n>=this.options.minimumColumnWidth?r.naturalWidth=n:r.naturalWidth=this.options.minimumColumnWidth}),ue.each(".dt-row-0 .dt-cell",this.bodyScrollable).map(t=>{let{colIndex:e}=ue.data(t),r=this.datamanager.getColumn(e),n=ue.style(ue(".dt-cell__content",t),"width");typeof n=="number"&&n>=r.naturalWidth?r.naturalWidth=n:r.naturalWidth=r.naturalWidth}))}setupColumnWidth(){if(this.options.layout==="ratio"){let t=ue.style(this.datatableWrapper,"width");if(this.options.serialNoColumn){let n=this.datamanager.getColumnById("_rowIndex");t=t-n.width-1}if(this.options.checkboxColumn){let n=this.datamanager.getColumnById("_checkbox");t=t-n.width-1}let e=this.datamanager.getColumns().map(n=>n.id==="_rowIndex"||n.id==="_checkbox"?0:(n.width||(n.width=1),n.ratioWidth=parseInt(n.width,10),n.ratioWidth)).reduce((n,a)=>n+a),r=t/e;this.datamanager.getColumns().map(n=>{n.id==="_rowIndex"||n.id==="_checkbox"||(n.width=Math.floor(r*n.ratioWidth)-1)})}else this.datamanager.getColumns().map(t=>{t.width||(t.width=t.naturalWidth),t.id==="_rowIndex"&&(t.width=this.getRowIndexColumnWidth()),t.width<this.options.minimumColumnWidth&&(t.width=this.options.minimumColumnWidth)})}distributeRemainingWidth(){if(this.options.layout!=="fluid")return;let t=ue.style(this.instance.datatableWrapper,"width"),e=ue(".dt-row",this.bodyScrollable),r=t;if(e)r=ue.style(e,"width");else{let s=ue(".dt-row",this.instance.header);r=Array.from(s.children).map(l=>l.offsetWidth).reduce((l,u)=>l+u,0)}let n=this.datamanager.getColumns().filter(s=>s.resizable),a=(t-r)/n.length;n.map(s=>{let o=ue.style(this.getColumnHeaderElement(s.colIndex),"width"),l=Math.floor(o+a)-2;this.datamanager.updateColumn(s.colIndex,{width:l})})}setColumnStyle(){this.datamanager.getColumns().map(t=>{t.align||(t.align="left"),["left","center","right"].includes(t.align)||(t.align="left"),this.setStyle(`.dt-cell--col-${t.colIndex}`,{"text-align":t.align}),this.columnmanager.setColumnHeaderWidth(t.colIndex),this.columnmanager.setColumnWidth(t.colIndex)})}refreshColumnWidth(){this.datamanager.getColumns().map(t=>{this.columnmanager.setColumnHeaderWidth(t.colIndex),this.columnmanager.setColumnWidth(t.colIndex)})}setBodyStyle(){let t=ue.style(this.datatableWrapper,"width"),e=ue(".dt-row",this.bodyScrollable);if(!e)return;let r=ue.style(e,"width"),n=t>r?r:t;ue.style(this.bodyScrollable,{width:n+"px"}),ue.removeStyle(this.bodyScrollable,"height");let a=ue.getStyle(this.bodyScrollable,"height"),s=(this.bodyRenderer.hyperlist||{})._scrollHeight||1/0,o=ue.hasHorizontalOverflow(this.bodyScrollable),l;s<a&&(l=s,o&&(l+=ue.scrollbarSize()),ue.style(this.bodyScrollable,{height:l+"px"})),this.bodyScrollable.scrollHeight-this.bodyScrollable.offsetHeight<ue.scrollbarSize()&&ue.style(this.bodyScrollable,{overflowY:"hidden"}),this.options.layout==="fluid"&&ue.style(this.bodyScrollable,{overflowX:"hidden"})}getColumnHeaderElement(t){return t=+t,t<0?null:ue(`.dt-cell--col-${t}`,this.header)}getRowIndexColumnWidth(){let t=this.datamanager.getRowCount(),e=22;return ue.measureTextWidth(t+"")+e}},uC={13:"enter",91:"meta",16:"shift",17:"ctrl",18:"alt",37:"left",38:"up",39:"right",40:"down",9:"tab",27:"esc",67:"c",70:"f",86:"v"},Zf=class{constructor(t){this.listeners={},ue.on(t,"keydown",this.handler.bind(this))}handler(t){let e=uC[t.keyCode];t.shiftKey&&e!=="shift"&&(e="shift+"+e),(t.ctrlKey&&e!=="ctrl"||t.metaKey&&e!=="meta")&&(e="ctrl+"+e);let r=this.listeners[e];if(r&&r.length>0)for(let n of r){let a=n(t);(a===void 0||a===!0)&&t.preventDefault()}}on(t,e){t.split(",").map(n=>n.trim()).map(n=>{this.listeners[n]=this.listeners[n]||[],this.listeners[n].push(e)})}},dC={"Sort Ascending":"Sort Ascending","Sort Descending":"Sort Descending","Reset sorting":"Reset sorting","Remove column":"Remove column","No Data":"No Data","{count} cells copied":{"1":"{count} cell copied",default:"{count} cells copied"},"{count} rows selected":{"1":"{count} row selected",default:"{count} rows selected"}},fC={"Sort Ascending":"Aufsteigend sortieren","Sort Descending":"Absteigend sortieren","Reset sorting":"Sortierung zur\xFCcksetzen","Remove column":"Spalte entfernen","No Data":"Keine Daten","{count} cells copied":{"1":"{count} Zelle kopiert",default:"{count} Zellen kopiert"},"{count} rows selected":{"1":"{count} Zeile ausgew\xE4hlt",default:"{count} Zeilen ausgew\xE4hlt"}},pC={"Sort Ascending":"Trier par ordre croissant","Sort Descending":"Trier par ordre d\xE9croissant","Reset sorting":"R\xE9initialiser le tri","Remove column":"Supprimer colonne","No Data":"Pas de donn\xE9es","{count} cells copied":{"1":"{count} cellule copi\xE9e",default:"{count} cellules copi\xE9es"},"{count} rows selected":{"1":"{count} ligne s\xE9lectionn\xE9e",default:"{count} lignes s\xE9lectionn\xE9es"}},hC={"Sort Ascending":"Ordinamento ascendente","Sort Descending":"Ordinamento decrescente","Reset sorting":"Azzeramento ordinamento","Remove column":"Rimuovi colonna","No Data":"Nessun dato","{count} cells copied":{"1":"Copiato {count} cella",default:"{count} celle copiate"},"{count} rows selected":{"1":"{count} linea selezionata",default:"{count} linee selezionate"}};function _C(){return{en:dC,de:fC,fr:pC,it:hC}}var Qf=class{constructor(t){this.language=t,this.translations=_C()}addTranslations(t){this.translations=Object.assign(this.translations,t)}translate(t,e){let r=this.translations[this.language]&&this.translations[this.language][t]||t;return typeof r=="object"&&(r=e&&e.count?this.getPluralizedTranslation(r,e.count):t),oC(r,e||{})}getPluralizedTranslation(t,e){return t[e]||t.default}};function mC(i,t){let e=[];if(Object.keys(t).length===0)return i.map(r=>r.meta.rowIndex);for(let r in t){let n=t[r],s=(e.length?e.map(u=>i[u]):i).map(u=>u[r]),o=vC(n),l=gC(o);l?e=l(o.text,s):e=s.map(u=>u.rowIndex)}return e}function gC(i){let t=a=>String(sC(a.html||"")||a.content||"").toLowerCase(),e=a=>parseFloat(a.content),r=(a,s)=>{if(a.column.compareValue){let l=a.column.compareValue(a,s);if(l&&Array.isArray(l))return l}let o=e(a);return isNaN(o)?[t(a),s]:[o,s]};return{contains(a,s){return s.filter(o=>{let l=t(o),u=(a||"").toLowerCase();return!u||l.includes(u)}).map(o=>o.rowIndex)},greaterThan(a,s){return s.filter(o=>{let[l,u]=r(o,a);return l>u}).map(o=>o.rowIndex)},lessThan(a,s){return s.filter(o=>{let[l,u]=r(o,a);return l<u}).map(o=>o.rowIndex)},equals(a,s){return s.filter(o=>parseFloat(o.content)===a).map(o=>o.rowIndex)},notEquals(a,s){return s.filter(o=>parseFloat(o.content)!==a).map(o=>o.rowIndex)},range(a,s){return s.filter(o=>{let l=r(o,a[0]),u=r(o,a[1]),c=l[0];return c>=l[1]&&c<=u[1]}).map(o=>o.rowIndex)},containsNumber(a,s){return s.filter(o=>{let l=parseFloat(a,10),u=a,c=e(o),h=t(o);return l===c||h.includes(u)}).map(o=>o.rowIndex)}}[i.type]}function vC(i=""){if(i.length===0)return{};let t=i;return[">","<","="].includes(t[0])?t=i.slice(1):t.startsWith("!=")&&(t=i.slice(2)),i.startsWith(">")&&t?{type:"greaterThan",text:t.trim()}:i.startsWith("<")&&t?{type:"lessThan",text:t.trim()}:i.startsWith("=")&&Pn(t)?{type:"equals",text:Number(i.slice(1).trim())}:Pn(t)?{type:"containsNumber",text:t}:i.startsWith("!=")&&Pn(t)?{type:"notEquals",text:Number(i.slice(2).trim())}:i.split(":").length===2?(t=i.split(":"),{type:"range",text:t.map(e=>e.trim())}):{type:"contains",text:t.toLowerCase()}}function bC(i){return{columns:[],data:[],dropdownButton:fs.chevronDown,headerDropdown:[{label:i.translate("Sort Ascending"),action:function(t){this.sortColumn(t.colIndex,"asc")}},{label:i.translate("Sort Descending"),action:function(t){this.sortColumn(t.colIndex,"desc")}},{label:i.translate("Reset sorting"),action:function(t){this.sortColumn(t.colIndex,"none")}},{label:i.translate("Remove column"),action:function(t){this.removeColumn(t.colIndex)}}],events:{onRemoveColumn(t){},onSwitchColumn(t,e){},onSortColumn(t){},onCheckRow(t){},onDestroy(){}},hooks:{columnTotal:null},sortIndicator:{asc:"\u2191",desc:"\u2193",none:""},overrideComponents:{},filterRows:mC,freezeMessage:"",getEditor:null,serialNoColumn:!0,checkboxColumn:!1,clusterize:!0,logs:!1,layout:"fixed",noDataMessage:i.translate("No Data"),cellHeight:40,minimumColumnWidth:30,inlineFilters:!1,treeView:!1,checkedRowStatus:!0,dynamicRowHeight:!1,pasteFromClipboard:!1,showTotalRow:!1,direction:"ltr",disableReorderColumn:!1}}var yC={DataManager:Vf,CellManager:Yf,ColumnManager:Gf,RowManager:Xf,BodyRenderer:Kf,Style:Jf,Keyboard:Zf},er=class{constructor(t,e){if(er.instances++,typeof t=="string"&&(t=document.querySelector(t)),this.wrapper=t,!(this.wrapper instanceof HTMLElement))throw new Error("Invalid argument given for `wrapper`");this.initializeTranslations(e),this.setDefaultOptions(),this.buildOptions(e),this.prepare(),this.initializeComponents(),this.options.data&&(this.refresh(),this.columnmanager.applyDefaultSortOrder())}initializeTranslations(t){this.language=t.language||"en",this.translationManager=new Qf(this.language),t.translations&&this.translationManager.addTranslations(t.translations)}setDefaultOptions(){this.DEFAULT_OPTIONS=bC(this)}buildOptions(t){this.options=this.options||{},this.options=Object.assign({},this.DEFAULT_OPTIONS,this.options||{},t),t.headerDropdown=t.headerDropdown||[],this.options.headerDropdown=[...this.DEFAULT_OPTIONS.headerDropdown,...t.headerDropdown],this.events=Object.assign({},this.DEFAULT_OPTIONS.events,this.options.events||{},t.events||{}),this.fireEvent=this.fireEvent.bind(this)}prepare(){this.prepareDom(),this.unfreeze()}initializeComponents(){let t=Object.assign({},yC,this.options.overrideComponents),{Style:e,Keyboard:r,DataManager:n,RowManager:a,ColumnManager:s,CellManager:o,BodyRenderer:l}=t;this.style=new e(this),this.keyboard=new r(this.wrapper),this.datamanager=new n(this.options),this.rowmanager=new a(this),this.columnmanager=new s(this),this.cellmanager=new o(this),this.bodyRenderer=new l(this)}prepareDom(){this.wrapper.innerHTML=`
            <div class="datatable" dir="${this.options.direction}">
                <div class="dt-header"></div>
                <div class="dt-scrollable"></div>
                <div class="dt-footer"></div>
                <div class="dt-freeze">
                    <span class="dt-freeze__message">
                        ${this.options.freezeMessage}
                    </span>
                </div>
                <div class="dt-toast"></div>
                <div class="dt-dropdown-container"></div>
                <textarea class="dt-paste-target"></textarea>
            </div>
        `,this.datatableWrapper=ue(".datatable",this.wrapper),this.header=ue(".dt-header",this.wrapper),this.footer=ue(".dt-footer",this.wrapper),this.bodyScrollable=ue(".dt-scrollable",this.wrapper),this.freezeContainer=ue(".dt-freeze",this.wrapper),this.toastMessage=ue(".dt-toast",this.wrapper),this.pasteTarget=ue(".dt-paste-target",this.wrapper),this.dropdownContainer=ue(".dt-dropdown-container",this.wrapper)}refresh(t,e){this.datamanager.init(t,e),this.render(),this.setDimensions()}destroy(){this.wrapper.innerHTML="",this.style.destroy(),this.fireEvent("onDestroy")}appendRows(t){this.datamanager.appendRows(t),this.rowmanager.refreshRows()}refreshRow(t,e){this.rowmanager.refreshRow(t,e)}render(){this.renderHeader(),this.renderBody()}renderHeader(){this.columnmanager.renderHeader()}renderBody(){this.bodyRenderer.render()}setDimensions(){this.style.setDimensions()}showToastMessage(t,e){this.bodyRenderer.showToastMessage(t,e)}clearToastMessage(){this.bodyRenderer.clearToastMessage()}getColumn(t){return this.datamanager.getColumn(t)}getColumns(){return this.datamanager.getColumns()}getRows(){return this.datamanager.getRows()}getCell(t,e){return this.datamanager.getCell(t,e)}getColumnHeaderElement(t){return this.columnmanager.getColumnHeaderElement(t)}getViewportHeight(){return this.viewportHeight||(this.viewportHeight=ue.style(this.bodyScrollable,"height")),this.viewportHeight}sortColumn(t,e){this.columnmanager.sortColumn(t,e)}removeColumn(t){this.columnmanager.removeColumn(t)}scrollToLastColumn(){this.datatableWrapper.scrollLeft=9999}freeze(){ue.style(this.freezeContainer,{display:""})}unfreeze(){ue.style(this.freezeContainer,{display:"none"})}updateOptions(t){this.buildOptions(t)}fireEvent(t,...e){let r=[...this._internalEventHandlers[t]||[],this.events[t]].filter(Boolean);for(let n of r)n.apply(this,e)}on(t,e){this._internalEventHandlers=this._internalEventHandlers||{},this._internalEventHandlers[t]=this._internalEventHandlers[t]||[],this._internalEventHandlers[t].push(e)}log(){this.options.logs&&console.log.apply(console,arguments)}translate(t,e){return this.translationManager.translate(t,e)}};er.instances=0;var wC="frappe-datatable",kC="0.0.0-development",xC="A modern datatable library for the web",CC="dist/frappe-datatable.cjs.js",SC="dist/frappe-datatable.min.js",TC="dist/frappe-datatable.min.js",EC={start:"yarn run dev",build:"rollup -c && NODE_ENV=production rollup -c",dev:"rollup -c -w","cy:server":"http-server -p 8989","cy:open":"cypress open","cy:run":"cypress run",test:"start-server-and-test cy:server http://localhost:8989 cy:run","test-local":"start-server-and-test cy:server http://localhost:8989 cy:open","travis-deploy-once":"travis-deploy-once","semantic-release":"semantic-release",lint:"eslint src","lint-and-build":"yarn lint && yarn build",commit:"npx git-cz"},AC=["dist","src"],$C={autoprefixer:"^9.0.0",chai:"3.5.0",cypress:"^9.2.0","cz-conventional-changelog":"^2.1.0",deepmerge:"^2.0.1",eslint:"^5.0.1","eslint-config-airbnb":"^16.1.0","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.11.0","http-server":"^0.11.1",mocha:"3.3.0","postcss-custom-properties":"^7.0.0","postcss-nested":"^3.0.0",rollup:"^0.59.4","rollup-plugin-commonjs":"^8.3.0","rollup-plugin-eslint":"^4.0.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.3","rollup-plugin-postcss":"^1.2.8","rollup-plugin-uglify-es":"^0.0.1","semantic-release":"^17.1.1","start-server-and-test":"^1.4.1","travis-deploy-once":"^5.0.1"},OC={type:"git",url:"https://github.com/frappe/datatable.git"},RC=["datatable","data","grid","table"],LC="Faris Ansari",BC="MIT",IC={url:"https://github.com/frappe/datatable/issues"},MC="https://frappe.io/datatable",NC={hyperlist:"^1.0.0-beta",lodash:"^4.17.5",sortablejs:"^1.7.0"},PC={commitizen:{path:"cz-conventional-changelog"}},DC={name:wC,version:kC,description:xC,main:CC,unpkg:SC,jsdelivr:TC,scripts:EC,files:AC,devDependencies:$C,repository:OC,keywords:RC,author:LC,license:BC,bugs:IC,homepage:MC,dependencies:NC,config:PC};er.__version__=DC.version;ep.exports=er});var rp=ye((Un,hs)=>{(function(i,t){typeof Un=="object"&&typeof hs=="object"?hs.exports=t():typeof define=="function"&&define.amd?define([],t):typeof Un=="object"?Un.Driver=t():i.Driver=t()})(window,function(){return function(i){var t={};function e(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return i[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=i,e.c=t,e.d=function(r,n,a){e.o(r,n)||Object.defineProperty(r,n,{enumerable:!0,get:a})},e.r=function(r){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,n){if(1&n&&(r=e(r)),8&n||4&n&&typeof r=="object"&&r&&r.__esModule)return r;var a=Object.create(null);if(e.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:r}),2&n&&typeof r!="string")for(var s in r)e.d(a,s,function(o){return r[o]}.bind(null,s));return a},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,"a",n),n},e.o=function(r,n){return Object.prototype.hasOwnProperty.call(r,n)},e.p="/dist/",e(e.s=57)}([function(i,t,e){var r=e(2),n=e(11),a=e(4),s=e(13),o=e(22),l=function(u,c,h){var p,g,b,v,k=u&l.F,C=u&l.G,O=u&l.S,d=u&l.P,_=u&l.B,m=C?r:O?r[c]||(r[c]={}):(r[c]||{}).prototype,y=C?n:n[c]||(n[c]={}),x=y.prototype||(y.prototype={});for(p in C&&(h=c),h)b=((g=!k&&m&&m[p]!==void 0)?m:h)[p],v=_&&g?o(b,r):d&&typeof b=="function"?o(Function.call,b):b,m&&s(m,p,b,u&l.U),y[p]!=b&&a(y,p,v),d&&x[p]!=b&&(x[p]=b)};r.core=n,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,i.exports=l},function(i,t,e){var r=e(17)("wks"),n=e(14),a=e(2).Symbol,s=typeof a=="function";(i.exports=function(o){return r[o]||(r[o]=s&&a[o]||(s?a:n)("Symbol."+o))}).store=r},function(i,t){var e=i.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=e)},function(i,t){i.exports=function(e){return typeof e=="object"?e!==null:typeof e=="function"}},function(i,t,e){var r=e(5),n=e(16);i.exports=e(6)?function(a,s,o){return r.f(a,s,n(1,o))}:function(a,s,o){return a[s]=o,a}},function(i,t,e){var r=e(12),n=e(35),a=e(21),s=Object.defineProperty;t.f=e(6)?Object.defineProperty:function(o,l,u){if(r(o),l=a(l,!0),r(u),n)try{return s(o,l,u)}catch(c){}if("get"in u||"set"in u)throw TypeError("Accessors not supported!");return"value"in u&&(o[l]=u.value),o}},function(i,t,e){i.exports=!e(7)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(i,t){i.exports=function(e){try{return!!e()}catch(r){return!0}}},function(i,t){var e={}.hasOwnProperty;i.exports=function(r,n){return e.call(r,n)}},function(i,t,e){var r=e(39),n=e(24);i.exports=function(a){return r(n(a))}},function(i,t,e){var r=e(0);r(r.S+r.F*!e(6),"Object",{defineProperty:e(5).f})},function(i,t){var e=i.exports={version:"2.6.9"};typeof __e=="number"&&(__e=e)},function(i,t,e){var r=e(3);i.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(i,t,e){var r=e(2),n=e(4),a=e(8),s=e(14)("src"),o=e(59),l=(""+o).split("toString");e(11).inspectSource=function(u){return o.call(u)},(i.exports=function(u,c,h,p){var g=typeof h=="function";g&&(a(h,"name")||n(h,"name",c)),u[c]!==h&&(g&&(a(h,s)||n(h,s,u[c]?""+u[c]:l.join(String(c)))),u===r?u[c]=h:p?u[c]?u[c]=h:n(u,c,h):(delete u[c],n(u,c,h)))})(Function.prototype,"toString",function(){return typeof this=="function"&&this[s]||o.call(this)})},function(i,t){var e=0,r=Math.random();i.exports=function(n){return"Symbol(".concat(n===void 0?"":n,")_",(++e+r).toString(36))}},function(i,t,e){var r=e(45),n=e(28);i.exports=Object.keys||function(a){return r(a,n)}},function(i,t){i.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}},function(i,t,e){var r=e(11),n=e(2),a=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(i.exports=function(s,o){return a[s]||(a[s]=o!==void 0?o:{})})("versions",[]).push({version:r.version,mode:e(18)?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})},function(i,t){i.exports=!1},function(i,t,e){var r=e(24);i.exports=function(n){return Object(r(n))}},function(i,t,e){"use strict";var r=e(2),n=e(8),a=e(6),s=e(0),o=e(13),l=e(62).KEY,u=e(7),c=e(17),h=e(26),p=e(14),g=e(1),b=e(43),v=e(44),k=e(63),C=e(42),O=e(12),d=e(3),_=e(19),m=e(9),y=e(21),x=e(16),S=e(30),w=e(67),E=e(49),L=e(47),I=e(5),A=e(15),B=E.f,T=I.f,M=w.f,j=r.Symbol,J=r.JSON,U=J&&J.stringify,H=g("_hidden"),te=g("toPrimitive"),se={}.propertyIsEnumerable,W=c("symbol-registry"),Y=c("symbols"),ie=c("op-symbols"),re=Object.prototype,Q=typeof j=="function"&&!!L.f,ee=r.QObject,pe=!ee||!ee.prototype||!ee.prototype.findChild,be=a&&u(function(){return S(T({},"a",{get:function(){return T(this,"a",{value:7}).a}})).a!=7})?function(ce,ve,Ie){var He=B(re,ve);He&&delete re[ve],T(ce,ve,Ie),He&&ce!==re&&T(re,ve,He)}:T,we=function(ce){var ve=Y[ce]=S(j.prototype);return ve._k=ce,ve},Le=Q&&typeof j.iterator=="symbol"?function(ce){return typeof ce=="symbol"}:function(ce){return ce instanceof j},fe=function(ce,ve,Ie){return ce===re&&fe(ie,ve,Ie),O(ce),ve=y(ve,!0),O(Ie),n(Y,ve)?(Ie.enumerable?(n(ce,H)&&ce[H][ve]&&(ce[H][ve]=!1),Ie=S(Ie,{enumerable:x(0,!1)})):(n(ce,H)||T(ce,H,x(1,{})),ce[H][ve]=!0),be(ce,ve,Ie)):T(ce,ve,Ie)},xe=function(ce,ve){O(ce);for(var Ie,He=k(ve=m(ve)),st=0,vt=He.length;vt>st;)fe(ce,Ie=He[st++],ve[Ie]);return ce},Ne=function(ce){var ve=se.call(this,ce=y(ce,!0));return!(this===re&&n(Y,ce)&&!n(ie,ce))&&(!(ve||!n(this,ce)||!n(Y,ce)||n(this,H)&&this[H][ce])||ve)},Be=function(ce,ve){if(ce=m(ce),ve=y(ve,!0),ce!==re||!n(Y,ve)||n(ie,ve)){var Ie=B(ce,ve);return!Ie||!n(Y,ve)||n(ce,H)&&ce[H][ve]||(Ie.enumerable=!0),Ie}},Pe=function(ce){for(var ve,Ie=M(m(ce)),He=[],st=0;Ie.length>st;)n(Y,ve=Ie[st++])||ve==H||ve==l||He.push(ve);return He},Ze=function(ce){for(var ve,Ie=ce===re,He=M(Ie?ie:m(ce)),st=[],vt=0;He.length>vt;)!n(Y,ve=He[vt++])||Ie&&!n(re,ve)||st.push(Y[ve]);return st};Q||(o((j=function(){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var ce=p(arguments.length>0?arguments[0]:void 0),ve=function(Ie){this===re&&ve.call(ie,Ie),n(this,H)&&n(this[H],ce)&&(this[H][ce]=!1),be(this,ce,x(1,Ie))};return a&&pe&&be(re,ce,{configurable:!0,set:ve}),we(ce)}).prototype,"toString",function(){return this._k}),E.f=Be,I.f=fe,e(48).f=w.f=Pe,e(29).f=Ne,L.f=Ze,a&&!e(18)&&o(re,"propertyIsEnumerable",Ne,!0),b.f=function(ce){return we(g(ce))}),s(s.G+s.W+s.F*!Q,{Symbol:j});for(var tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Xe=0;tt.length>Xe;)g(tt[Xe++]);for(var Ke=A(g.store),nt=0;Ke.length>nt;)v(Ke[nt++]);s(s.S+s.F*!Q,"Symbol",{for:function(ce){return n(W,ce+="")?W[ce]:W[ce]=j(ce)},keyFor:function(ce){if(!Le(ce))throw TypeError(ce+" is not a symbol!");for(var ve in W)if(W[ve]===ce)return ve},useSetter:function(){pe=!0},useSimple:function(){pe=!1}}),s(s.S+s.F*!Q,"Object",{create:function(ce,ve){return ve===void 0?S(ce):xe(S(ce),ve)},defineProperty:fe,defineProperties:xe,getOwnPropertyDescriptor:Be,getOwnPropertyNames:Pe,getOwnPropertySymbols:Ze});var at=u(function(){L.f(1)});s(s.S+s.F*at,"Object",{getOwnPropertySymbols:function(ce){return L.f(_(ce))}}),J&&s(s.S+s.F*(!Q||u(function(){var ce=j();return U([ce])!="[null]"||U({a:ce})!="{}"||U(Object(ce))!="{}"})),"JSON",{stringify:function(ce){for(var ve,Ie,He=[ce],st=1;arguments.length>st;)He.push(arguments[st++]);if(Ie=ve=He[1],(d(ve)||ce!==void 0)&&!Le(ce))return C(ve)||(ve=function(vt,bt){if(typeof Ie=="function"&&(bt=Ie.call(this,vt,bt)),!Le(bt))return bt}),He[1]=ve,U.apply(J,He)}}),j.prototype[te]||e(4)(j.prototype,te,j.prototype.valueOf),h(j,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(i,t,e){var r=e(3);i.exports=function(n,a){if(!r(n))return n;var s,o;if(a&&typeof(s=n.toString)=="function"&&!r(o=s.call(n))||typeof(s=n.valueOf)=="function"&&!r(o=s.call(n))||!a&&typeof(s=n.toString)=="function"&&!r(o=s.call(n)))return o;throw TypeError("Can't convert object to primitive value")}},function(i,t,e){var r=e(37);i.exports=function(n,a,s){if(r(n),a===void 0)return n;switch(s){case 1:return function(o){return n.call(a,o)};case 2:return function(o,l){return n.call(a,o,l)};case 3:return function(o,l,u){return n.call(a,o,l,u)}}return function(){return n.apply(a,arguments)}}},function(i,t){var e={}.toString;i.exports=function(r){return e.call(r).slice(8,-1)}},function(i,t){i.exports=function(e){if(e==null)throw TypeError("Can't call method on  "+e);return e}},function(i,t,e){"use strict";var r=e(7);i.exports=function(n,a){return!!n&&r(function(){a?n.call(null,function(){},1):n.call(null)})}},function(i,t,e){var r=e(5).f,n=e(8),a=e(1)("toStringTag");i.exports=function(s,o,l){s&&!n(s=l?s:s.prototype,a)&&r(s,a,{configurable:!0,value:o})}},function(i,t,e){var r=e(17)("keys"),n=e(14);i.exports=function(a){return r[a]||(r[a]=n(a))}},function(i,t){i.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(i,t){t.f={}.propertyIsEnumerable},function(i,t,e){var r=e(12),n=e(65),a=e(28),s=e(27)("IE_PROTO"),o=function(){},l=function(){var u,c=e(36)("iframe"),h=a.length;for(c.style.display="none",e(66).appendChild(c),c.src="javascript:",(u=c.contentWindow.document).open(),u.write("<script>document.F=Object<\/script>"),u.close(),l=u.F;h--;)delete l.prototype[a[h]];return l()};i.exports=Object.create||function(u,c){var h;return u!==null?(o.prototype=r(u),h=new o,o.prototype=null,h[s]=u):h=l(),c===void 0?h:n(h,c)}},function(i,t,e){"use strict";var r=e(68),n=e(69),a=e(32),s=e(9);i.exports=e(70)(Array,"Array",function(o,l){this._t=s(o),this._i=0,this._k=l},function(){var o=this._t,l=this._k,u=this._i++;return!o||u>=o.length?(this._t=void 0,n(1)):n(0,l=="keys"?u:l=="values"?o[u]:[u,o[u]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(i,t){i.exports={}},function(i,t,e){e(44)("asyncIterator")},function(i,t,e){"use strict";var r=e(0),n=e(38)(0),a=e(25)([].forEach,!0);r(r.P+r.F*!a,"Array",{forEach:function(s){return n(this,s,arguments[1])}})},function(i,t,e){i.exports=!e(6)&&!e(7)(function(){return Object.defineProperty(e(36)("div"),"a",{get:function(){return 7}}).a!=7})},function(i,t,e){var r=e(3),n=e(2).document,a=r(n)&&r(n.createElement);i.exports=function(s){return a?n.createElement(s):{}}},function(i,t){i.exports=function(e){if(typeof e!="function")throw TypeError(e+" is not a function!");return e}},function(i,t,e){var r=e(22),n=e(39),a=e(19),s=e(40),o=e(60);i.exports=function(l,u){var c=l==1,h=l==2,p=l==3,g=l==4,b=l==6,v=l==5||b,k=u||o;return function(C,O,d){for(var _,m,y=a(C),x=n(y),S=r(O,d,3),w=s(x.length),E=0,L=c?k(C,w):h?k(C,0):void 0;w>E;E++)if((v||E in x)&&(m=S(_=x[E],E,y),l)){if(c)L[E]=m;else if(m)switch(l){case 3:return!0;case 5:return _;case 6:return E;case 2:L.push(_)}else if(g)return!1}return b?-1:p||g?g:L}}},function(i,t,e){var r=e(23);i.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return r(n)=="String"?n.split(""):Object(n)}},function(i,t,e){var r=e(41),n=Math.min;i.exports=function(a){return a>0?n(r(a),9007199254740991):0}},function(i,t){var e=Math.ceil,r=Math.floor;i.exports=function(n){return isNaN(n=+n)?0:(n>0?r:e)(n)}},function(i,t,e){var r=e(23);i.exports=Array.isArray||function(n){return r(n)=="Array"}},function(i,t,e){t.f=e(1)},function(i,t,e){var r=e(2),n=e(11),a=e(18),s=e(43),o=e(5).f;i.exports=function(l){var u=n.Symbol||(n.Symbol=a?{}:r.Symbol||{});l.charAt(0)=="_"||l in u||o(u,l,{value:s.f(l)})}},function(i,t,e){var r=e(8),n=e(9),a=e(46)(!1),s=e(27)("IE_PROTO");i.exports=function(o,l){var u,c=n(o),h=0,p=[];for(u in c)u!=s&&r(c,u)&&p.push(u);for(;l.length>h;)r(c,u=l[h++])&&(~a(p,u)||p.push(u));return p}},function(i,t,e){var r=e(9),n=e(40),a=e(64);i.exports=function(s){return function(o,l,u){var c,h=r(o),p=n(h.length),g=a(u,p);if(s&&l!=l){for(;p>g;)if((c=h[g++])!=c)return!0}else for(;p>g;g++)if((s||g in h)&&h[g]===l)return s||g||0;return!s&&-1}}},function(i,t){t.f=Object.getOwnPropertySymbols},function(i,t,e){var r=e(45),n=e(28).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(a){return r(a,n)}},function(i,t,e){var r=e(29),n=e(16),a=e(9),s=e(21),o=e(8),l=e(35),u=Object.getOwnPropertyDescriptor;t.f=e(6)?u:function(c,h){if(c=a(c),h=s(h,!0),l)try{return u(c,h)}catch(p){}if(o(c,h))return n(!r.f.call(c,h),c[h])}},function(i,t,e){for(var r=e(31),n=e(15),a=e(13),s=e(2),o=e(4),l=e(32),u=e(1),c=u("iterator"),h=u("toStringTag"),p=l.Array,g={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},b=n(g),v=0;v<b.length;v++){var k,C=b[v],O=g[C],d=s[C],_=d&&d.prototype;if(_&&(_[c]||o(_,c,p),_[h]||o(_,h,C),l[C]=p,O))for(k in r)_[k]||a(_,k,r[k],!0)}},function(i,t,e){"use strict";var r=e(73),n={};n[e(1)("toStringTag")]="z",n+""!="[object z]"&&e(13)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(i,t,e){var r=e(19),n=e(15);e(74)("keys",function(){return function(a){return n(r(a))}})},function(i,t,e){"use strict";var r=e(0),n=e(38)(2);r(r.P+r.F*!e(25)([].filter,!0),"Array",{filter:function(a){return n(this,a,arguments[1])}})},function(i,t,e){var r=e(0);r(r.P,"Function",{bind:e(75)})},function(i,t,e){var r=e(0);r(r.S,"Object",{create:e(30)})},function(i,t,e){var r=e(0);r(r.S,"Object",{setPrototypeOf:e(81).set})},function(i,t,e){e(58),i.exports=e(82)},function(i,t){},function(i,t,e){i.exports=e(17)("native-function-to-string",Function.toString)},function(i,t,e){var r=e(61);i.exports=function(n,a){return new(r(n))(a)}},function(i,t,e){var r=e(3),n=e(42),a=e(1)("species");i.exports=function(s){var o;return n(s)&&(typeof(o=s.constructor)!="function"||o!==Array&&!n(o.prototype)||(o=void 0),r(o)&&(o=o[a])===null&&(o=void 0)),o===void 0?Array:o}},function(i,t,e){var r=e(14)("meta"),n=e(3),a=e(8),s=e(5).f,o=0,l=Object.isExtensible||function(){return!0},u=!e(7)(function(){return l(Object.preventExtensions({}))}),c=function(p){s(p,r,{value:{i:"O"+ ++o,w:{}}})},h=i.exports={KEY:r,NEED:!1,fastKey:function(p,g){if(!n(p))return typeof p=="symbol"?p:(typeof p=="string"?"S":"P")+p;if(!a(p,r)){if(!l(p))return"F";if(!g)return"E";c(p)}return p[r].i},getWeak:function(p,g){if(!a(p,r)){if(!l(p))return!0;if(!g)return!1;c(p)}return p[r].w},onFreeze:function(p){return u&&h.NEED&&l(p)&&!a(p,r)&&c(p),p}}},function(i,t,e){var r=e(15),n=e(47),a=e(29);i.exports=function(s){var o=r(s),l=n.f;if(l)for(var u,c=l(s),h=a.f,p=0;c.length>p;)h.call(s,u=c[p++])&&o.push(u);return o}},function(i,t,e){var r=e(41),n=Math.max,a=Math.min;i.exports=function(s,o){return(s=r(s))<0?n(s+o,0):a(s,o)}},function(i,t,e){var r=e(5),n=e(12),a=e(15);i.exports=e(6)?Object.defineProperties:function(s,o){n(s);for(var l,u=a(o),c=u.length,h=0;c>h;)r.f(s,l=u[h++],o[l]);return s}},function(i,t,e){var r=e(2).document;i.exports=r&&r.documentElement},function(i,t,e){var r=e(9),n=e(48).f,a={}.toString,s=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];i.exports.f=function(o){return s&&a.call(o)=="[object Window]"?function(l){try{return n(l)}catch(u){return s.slice()}}(o):n(r(o))}},function(i,t,e){var r=e(1)("unscopables"),n=Array.prototype;n[r]==null&&e(4)(n,r,{}),i.exports=function(a){n[r][a]=!0}},function(i,t){i.exports=function(e,r){return{value:r,done:!!e}}},function(i,t,e){"use strict";var r=e(18),n=e(0),a=e(13),s=e(4),o=e(32),l=e(71),u=e(26),c=e(72),h=e(1)("iterator"),p=!([].keys&&"next"in[].keys()),g=function(){return this};i.exports=function(b,v,k,C,O,d,_){l(k,v,C);var m,y,x,S=function(j){if(!p&&j in I)return I[j];switch(j){case"keys":case"values":return function(){return new k(this,j)}}return function(){return new k(this,j)}},w=v+" Iterator",E=O=="values",L=!1,I=b.prototype,A=I[h]||I["@@iterator"]||O&&I[O],B=A||S(O),T=O?E?S("entries"):B:void 0,M=v=="Array"&&I.entries||A;if(M&&(x=c(M.call(new b)))!==Object.prototype&&x.next&&(u(x,w,!0),r||typeof x[h]=="function"||s(x,h,g)),E&&A&&A.name!=="values"&&(L=!0,B=function(){return A.call(this)}),r&&!_||!p&&!L&&I[h]||s(I,h,B),o[v]=B,o[w]=g,O)if(m={values:E?B:S("values"),keys:d?B:S("keys"),entries:T},_)for(y in m)y in I||a(I,y,m[y]);else n(n.P+n.F*(p||L),v,m);return m}},function(i,t,e){"use strict";var r=e(30),n=e(16),a=e(26),s={};e(4)(s,e(1)("iterator"),function(){return this}),i.exports=function(o,l,u){o.prototype=r(s,{next:n(1,u)}),a(o,l+" Iterator")}},function(i,t,e){var r=e(8),n=e(19),a=e(27)("IE_PROTO"),s=Object.prototype;i.exports=Object.getPrototypeOf||function(o){return o=n(o),r(o,a)?o[a]:typeof o.constructor=="function"&&o instanceof o.constructor?o.constructor.prototype:o instanceof Object?s:null}},function(i,t,e){var r=e(23),n=e(1)("toStringTag"),a=r(function(){return arguments}())=="Arguments";i.exports=function(s){var o,l,u;return s===void 0?"Undefined":s===null?"Null":typeof(l=function(c,h){try{return c[h]}catch(p){}}(o=Object(s),n))=="string"?l:a?r(o):(u=r(o))=="Object"&&typeof o.callee=="function"?"Arguments":u}},function(i,t,e){var r=e(0),n=e(11),a=e(7);i.exports=function(s,o){var l=(n.Object||{})[s]||Object[s],u={};u[s]=o(l),r(r.S+r.F*a(function(){l(1)}),"Object",u)}},function(i,t,e){"use strict";var r=e(37),n=e(3),a=e(76),s=[].slice,o={};i.exports=Function.bind||function(l){var u=r(this),c=s.call(arguments,1),h=function(){var p=c.concat(s.call(arguments));return this instanceof h?function(g,b,v){if(!(b in o)){for(var k=[],C=0;C<b;C++)k[C]="a["+C+"]";o[b]=Function("F,a","return new F("+k.join(",")+")")}return o[b](g,v)}(u,p.length,p):a(u,p,l)};return n(u.prototype)&&(h.prototype=u.prototype),h}},function(i,t){i.exports=function(e,r,n){var a=n===void 0;switch(r.length){case 0:return a?e():e.call(n);case 1:return a?e(r[0]):e.call(n,r[0]);case 2:return a?e(r[0],r[1]):e.call(n,r[0],r[1]);case 3:return a?e(r[0],r[1],r[2]):e.call(n,r[0],r[1],r[2]);case 4:return a?e(r[0],r[1],r[2],r[3]):e.call(n,r[0],r[1],r[2],r[3])}return e.apply(n,r)}},function(i,t,e){"use strict";e(78)("trim",function(r){return function(){return r(this,3)}})},function(i,t,e){var r=e(0),n=e(24),a=e(7),s=e(79),o="["+s+"]",l=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),c=function(p,g,b){var v={},k=a(function(){return!!s[p]()||"\u200B\x85"[p]()!="\u200B\x85"}),C=v[p]=k?g(h):s[p];b&&(v[b]=C),r(r.P+r.F*k,"String",v)},h=c.trim=function(p,g){return p=String(n(p)),1&g&&(p=p.replace(l,"")),2&g&&(p=p.replace(u,"")),p};i.exports=c},function(i,t){i.exports=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`},function(i,t,e){"use strict";var r=e(0),n=e(46)(!1),a=[].indexOf,s=!!a&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(s||!e(25)(a)),"Array",{indexOf:function(o){return s?a.apply(this,arguments)||0:n(this,o,arguments[1])}})},function(i,t,e){var r=e(3),n=e(12),a=function(s,o){if(n(s),!r(o)&&o!==null)throw TypeError(o+": can't set as prototype!")};i.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(s,o,l){try{(l=e(22)(Function.call,e(49).f(Object.prototype,"__proto__").set,2))(s,[]),o=!(s instanceof Array)}catch(u){o=!0}return function(u,c){return a(u,c),o?u.__proto__=c:l(u,c),u}}({},!1):void 0),check:a}},function(i,t,e){"use strict";e.r(t),e(34),e(20),e(50),e(31),e(51),e(52),e(10),e(53),e(54);var r=.75,n=10,a=!0,s=!0,o=!0,l=!1,u="driver-highlighted-element-stage",c='<div id="'.concat("driver-page-overlay",'"></div>'),h='<div id="'.concat(u,'"></div>');e(33),e(77);function p(W){return(p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(W)}var g=function(W){var Y=document.createElement("div");return Y.innerHTML=W.trim(),Y.firstChild},b=function W(Y,ie){if(arguments.length>2&&arguments[2]!==void 0&&arguments[2]){for(var re=["","-webkit-","-ms-","moz-","-o-"],Q=0;Q<re.length;Q++){var ee=W(Y,re[Q]+ie);if(ee)return ee}return""}var pe="";return Y.currentStyle?pe=Y.currentStyle[ie]:document.defaultView&&document.defaultView.getComputedStyle&&(pe=document.defaultView.getComputedStyle(Y,null).getPropertyValue(ie)),pe&&pe.toLowerCase?pe.toLowerCase():pe},v=function(W){return W&&p(W)==="object"&&"nodeType"in W};function k(W,Y){for(var ie=0;ie<Y.length;ie++){var re=Y[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}var C=function(){function W(Q,ee,pe){(function(be,we){if(!(be instanceof we))throw new TypeError("Cannot call a class as a function")})(this,W),this.options=Q,this.highlightedElement=null,this.lastHighlightedElement=null,this.hideTimer=null,this.window=ee,this.document=pe,this.removeNode=this.removeNode.bind(this)}var Y,ie,re;return Y=W,(ie=[{key:"attachNode",value:function(){var Q=this.document.getElementById("driver-page-overlay");Q||(Q=g(c),document.body.appendChild(Q)),this.node=Q,this.node.style.opacity="0",this.options.animate||this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"highlight",value:function(Q){Q&&Q.node?Q.isSame(this.highlightedElement)||(this.window.clearTimeout(this.hideTimer),Q.onHighlightStarted(),this.highlightedElement&&!this.highlightedElement.isSame(this.lastHighlightedElement)&&this.highlightedElement.onDeselected(),Q.getCalculatedPosition().canHighlight()&&(this.lastHighlightedElement=this.highlightedElement,this.highlightedElement=Q,this.show(),this.highlightedElement.onHighlighted())):console.warn("Invalid element to highlight. Must be an instance of `Element`")}},{key:"show",value:function(){var Q=this;this.node&&this.node.parentElement||(this.attachNode(),window.setTimeout(function(){Q.node.style.opacity="".concat(Q.options.opacity),Q.node.style.position="fixed",Q.node.style.left="0",Q.node.style.top="0",Q.node.style.bottom="0",Q.node.style.right="0"}))}},{key:"getHighlightedElement",value:function(){return this.highlightedElement}},{key:"getLastHighlightedElement",value:function(){return this.lastHighlightedElement}},{key:"clear",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.options.onReset&&this.options.onReset(this.highlightedElement),this.highlightedElement&&this.highlightedElement.onDeselected(!0),this.highlightedElement=null,this.lastHighlightedElement=null,this.node&&(this.window.clearTimeout(this.hideTimer),this.options.animate&&!Q?(this.node.style.opacity="0",this.hideTimer=this.window.setTimeout(this.removeNode,300)):this.removeNode())}},{key:"removeNode",value:function(){this.node&&this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"refresh",value:function(){this.highlightedElement&&(this.highlightedElement.showPopover(),this.highlightedElement.showStage())}}])&&k(Y.prototype,ie),re&&k(Y,re),W}();e(80);function O(W,Y){for(var ie=0;ie<Y.length;ie++){var re=Y[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}var d=function(){function W(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ee=Q.left,pe=ee===void 0?0:ee,be=Q.top,we=be===void 0?0:be,Le=Q.right,fe=Le===void 0?0:Le,xe=Q.bottom,Ne=xe===void 0?0:xe;(function(Be,Pe){if(!(Be instanceof Pe))throw new TypeError("Cannot call a class as a function")})(this,W),this.left=pe,this.right=fe,this.top=we,this.bottom=Ne}var Y,ie,re;return Y=W,(ie=[{key:"canHighlight",value:function(){return this.left<this.right&&this.top<this.bottom}}])&&O(Y.prototype,ie),re&&O(Y,re),W}();function _(W,Y){for(var ie=0;ie<Y.length;ie++){var re=Y[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}var m=function(){function W(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ee=Q.node,pe=Q.options,be=Q.popover,we=Q.stage,Le=Q.overlay,fe=Q.window,xe=Q.document;(function(Ne,Be){if(!(Ne instanceof Be))throw new TypeError("Cannot call a class as a function")})(this,W),this.node=ee,this.document=xe,this.window=fe,this.options=pe,this.overlay=Le,this.popover=be,this.stage=we,this.animationTimeout=null}var Y,ie,re;return Y=W,(ie=[{key:"isInView",value:function(){for(var Q=this.node.offsetTop,ee=this.node.offsetLeft,pe=this.node.offsetWidth,be=this.node.offsetHeight,we=this.node;we.offsetParent;)Q+=(we=we.offsetParent).offsetTop,ee+=we.offsetLeft;return Q>=this.window.pageYOffset&&ee>=this.window.pageXOffset&&Q+be<=this.window.pageYOffset+this.window.innerHeight&&ee+pe<=this.window.pageXOffset+this.window.innerWidth}},{key:"scrollManually",value:function(){var Q=this.node.getBoundingClientRect().top+this.window.pageYOffset-this.window.innerHeight/2;this.window.scrollTo(0,Q)}},{key:"bringInView",value:function(){if(this.node&&!this.isInView())if(this.node.scrollIntoView)try{this.node.scrollIntoView(this.options.scrollIntoViewOptions||{behavior:"instant",block:"center"})}catch(Q){this.scrollManually()}else this.scrollManually()}},{key:"getCalculatedPosition",value:function(){var Q=this.document.body,ee=this.document.documentElement,pe=this.window,be=this.window.pageYOffset||ee.scrollTop||Q.scrollTop,we=pe.pageXOffset||ee.scrollLeft||Q.scrollLeft,Le=this.node.getBoundingClientRect();return new d({top:Le.top+be,left:Le.left+we,right:Le.left+we+Le.width,bottom:Le.top+be+Le.height})}},{key:"getPopover",value:function(){return this.popover}},{key:"onDeselected",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.hidePopover(),Q&&this.hideStage(),this.removeHighlightClasses(),this.window.clearTimeout(this.animationTimeout),this.options.onDeselected&&this.options.onDeselected(this)}},{key:"isSame",value:function(Q){return!(!Q||!Q.node)&&Q.node===this.node}},{key:"onHighlightStarted",value:function(){this.options.onHighlightStarted&&this.options.onHighlightStarted(this)}},{key:"onHighlighted",value:function(){this.isInView()||this.bringInView(),this.showPopover(),this.showStage(),this.addHighlightClasses(),this.options.onHighlighted&&this.options.onHighlighted(this)}},{key:"removeHighlightClasses",value:function(){this.node.classList.remove("driver-highlighted-element"),this.node.classList.remove("driver-position-relative");for(var Q=this.document.querySelectorAll(".".concat("driver-fix-stacking")),ee=0;ee<Q.length;ee++)Q[ee].classList.remove("driver-fix-stacking")}},{key:"addHighlightClasses",value:function(){this.node.classList.add("driver-highlighted-element"),this.canMakeRelative()&&this.node.classList.add("driver-position-relative"),this.fixStackingContext()}},{key:"fixStackingContext",value:function(){for(var Q=this.node.parentNode;Q&&Q.tagName&&Q.tagName.toLowerCase()!=="body";){var ee=b(Q,"z-index"),pe=parseFloat(b(Q,"opacity")),be=b(Q,"transform",!0),we=b(Q,"transform-style",!0),Le=b(Q,"transform-box",!0),fe=b(Q,"filter",!0),xe=b(Q,"perspective",!0);(/[0-9]+/.test(ee)||pe<1||be&&be!=="none"||we&&we!=="flat"||Le&&Le!=="border-box"||fe&&fe!=="none"||xe&&xe!=="none")&&Q.classList.add("driver-fix-stacking"),Q=Q.parentNode}}},{key:"canMakeRelative",value:function(){var Q=this.getStyleProperty("position");return["absolute","fixed","relative"].indexOf(Q)===-1}},{key:"getStyleProperty",value:function(Q){return b(this.node,Q)}},{key:"showStage",value:function(){this.stage.show(this.getCalculatedPosition())}},{key:"getNode",value:function(){return this.node}},{key:"hideStage",value:function(){this.stage.hide()}},{key:"hidePopover",value:function(){this.popover&&this.popover.hide()}},{key:"showPopover",value:function(){var Q=this;if(this.popover){var ee=this.getCalculatedPosition(),pe=300;this.options.animate&&this.overlay.lastHighlightedElement||(pe=0),this.animationTimeout=this.window.setTimeout(function(){Q.popover.show(ee)},pe)}}},{key:"getFullPageSize",value:function(){var Q=this.document.body,ee=this.document.documentElement;return{height:Math.max(Q.scrollHeight,Q.offsetHeight,ee.scrollHeight,ee.offsetHeight),width:Math.max(Q.scrollWidth,Q.offsetWidth,ee.scrollWidth,ee.offsetWidth)}}},{key:"getSize",value:function(){return{height:Math.max(this.node.scrollHeight,this.node.offsetHeight),width:Math.max(this.node.scrollWidth,this.node.offsetWidth)}}}])&&_(Y.prototype,ie),re&&_(Y,re),W}();e(55),e(56);function y(W){return(y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(W)}function x(W,Y,ie){return Y in W?Object.defineProperty(W,Y,{value:ie,enumerable:!0,configurable:!0,writable:!0}):W[Y]=ie,W}function S(W,Y){for(var ie=0;ie<Y.length;ie++){var re=Y[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}function w(W,Y){return!Y||y(Y)!=="object"&&typeof Y!="function"?function(ie){if(ie===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ie}(W):Y}function E(W){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)})(W)}function L(W,Y){return(L=Object.setPrototypeOf||function(ie,re){return ie.__proto__=re,ie})(W,Y)}var I=function(W){function Y(ee,pe,be){var we;return function(Le,fe){if(!(Le instanceof fe))throw new TypeError("Cannot call a class as a function")}(this,Y),(we=w(this,E(Y).call(this))).options=function(Le){for(var fe=1;fe<arguments.length;fe++){var xe=arguments[fe]!=null?arguments[fe]:{},Ne=Object.keys(xe);typeof Object.getOwnPropertySymbols=="function"&&(Ne=Ne.concat(Object.getOwnPropertySymbols(xe).filter(function(Be){return Object.getOwnPropertyDescriptor(xe,Be).enumerable}))),Ne.forEach(function(Be){x(Le,Be,xe[Be])})}return Le}({isFirst:!0,isLast:!0,totalCount:1,currentIndex:0,offset:0,showButtons:!0,closeBtnText:"Close",doneBtnText:"Done",startBtnText:"Next &rarr;",nextBtnText:"Next &rarr;",prevBtnText:"&larr; Previous"},ee),we.window=pe,we.document=be,we}var ie,re,Q;return function(ee,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),pe&&L(ee,pe)}(Y,m),ie=Y,(re=[{key:"attachNode",value:function(){var ee=this.document.getElementById("driver-popover-item");ee&&ee.parentElement.removeChild(ee),ee=g(function(){var pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return`
  <div id="`.concat("driver-popover-item",'" class="').concat(pe,`">
    <div class="`).concat("driver-popover-tip",`"></div>
    <div class="`).concat("driver-popover-title",`">Popover Title</div>
    <div class="`).concat("driver-popover-description",`">Popover Description</div>
    <div class="driver-clearfix `).concat("driver-popover-footer",`">
      <button class="`).concat("driver-close-btn",`">Close</button>
      <span class="driver-btn-group `).concat("driver-navigation-btns",`">
        <button class="`).concat("driver-prev-btn",`">&larr; Previous</button>
        <button class="`).concat("driver-next-btn",`">Next &rarr;</button>
      </span>
    </div>
  </div>`)}(this.options.className)),document.body.appendChild(ee),this.node=ee,this.tipNode=ee.querySelector(".".concat("driver-popover-tip")),this.titleNode=ee.querySelector(".".concat("driver-popover-title")),this.descriptionNode=ee.querySelector(".".concat("driver-popover-description")),this.footerNode=ee.querySelector(".".concat("driver-popover-footer")),this.nextBtnNode=ee.querySelector(".".concat("driver-next-btn")),this.prevBtnNode=ee.querySelector(".".concat("driver-prev-btn")),this.closeBtnNode=ee.querySelector(".".concat("driver-close-btn"))}},{key:"getTitleNode",value:function(){return this.titleNode}},{key:"getDescriptionNode",value:function(){return this.descriptionNode}},{key:"hide",value:function(){this.node&&(this.node.style.display="none")}},{key:"setInitialState",value:function(){this.node.style.display="block",this.node.style.left="0",this.node.style.top="0",this.node.style.bottom="",this.node.style.right="",this.node.querySelector(".".concat("driver-popover-tip")).className="driver-popover-tip"}},{key:"show",value:function(ee){switch(this.attachNode(),this.setInitialState(),this.titleNode.innerHTML=this.options.title,this.descriptionNode.innerHTML=this.options.description||"",this.renderFooter(),this.options.position){case"left":case"left-top":this.positionOnLeft(ee);break;case"left-center":this.positionOnLeftCenter(ee);break;case"left-bottom":this.positionOnLeftBottom(ee);break;case"right":case"right-top":this.positionOnRight(ee);break;case"right-center":this.positionOnRightCenter(ee);break;case"right-bottom":this.positionOnRightBottom(ee);break;case"top":case"top-left":this.positionOnTop(ee);break;case"top-center":this.positionOnTopCenter(ee);break;case"top-right":this.positionOnTopRight(ee);break;case"bottom":case"bottom-left":this.positionOnBottom(ee);break;case"bottom-center":this.positionOnBottomCenter(ee);break;case"bottom-right":this.positionOnBottomRight(ee);break;case"mid-center":this.positionOnMidCenter(ee);break;case"auto":default:this.autoPosition(ee)}this.bringInView()}},{key:"renderFooter",value:function(){this.nextBtnNode.innerHTML=this.options.nextBtnText,this.prevBtnNode.innerHTML=this.options.prevBtnText,this.closeBtnNode.innerHTML=this.options.closeBtnText;var ee=this.options.totalCount&&this.options.totalCount!==1;this.options.showButtons?(ee?(this.nextBtnNode.style.display="inline-block",this.prevBtnNode.style.display="inline-block",this.closeBtnNode.classList.remove("driver-close-only-btn")):(this.nextBtnNode.style.display="none",this.prevBtnNode.style.display="none",this.closeBtnNode.classList.add("driver-close-only-btn")),this.footerNode.style.display="block",this.options.isFirst?(this.prevBtnNode.classList.add("driver-disabled"),this.nextBtnNode.innerHTML=this.options.startBtnText):this.prevBtnNode.classList.remove("driver-disabled"),this.options.isLast?this.nextBtnNode.innerHTML=this.options.doneBtnText:this.nextBtnNode.innerHTML=this.options.nextBtnText):this.footerNode.style.display="none"}},{key:"positionOnLeft",value:function(ee){var pe=this.getSize().width,be=this.options.padding+10;this.node.style.left="".concat(ee.left-pe-be,"px"),this.node.style.top="".concat(ee.top+this.options.offset-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("right")}},{key:"positionOnLeftBottom",value:function(ee){var pe=this.getSize(),be=pe.width,we=this.options.padding+10;this.node.style.left="".concat(ee.left-be-we,"px"),this.node.style.top="".concat(ee.bottom+this.options.padding+this.options.offset-pe.height,"px"),this.node.style.bottom="",this.node.style.right="",this.tipNode.classList.add("right","position-bottom")}},{key:"positionOnLeftCenter",value:function(ee){var pe=this.getSize(),be=pe.width,we=pe.height/2,Le=this.options.padding+10,fe=(ee.bottom-ee.top)/2,xe=ee.top-we+fe+this.options.offset;this.node.style.left="".concat(ee.left-be-Le,"px"),this.node.style.top="".concat(xe,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("right","position-center")}},{key:"positionOnRight",value:function(ee){var pe=this.options.padding+10;this.node.style.left="".concat(ee.right+pe,"px"),this.node.style.top="".concat(ee.top+this.options.offset-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("left")}},{key:"positionOnRightCenter",value:function(ee){var pe=this.getSize(),be=this.options.padding+10,we=pe.height/2,Le=(ee.bottom-ee.top)/2,fe=ee.top-we+Le+this.options.offset;this.node.style.left="".concat(ee.right+be,"px"),this.node.style.top="".concat(fe,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("left","position-center")}},{key:"positionOnRightBottom",value:function(ee){var pe=this.options.padding+10,be=this.getSize();this.node.style.left="".concat(ee.right+pe,"px"),this.node.style.top="".concat(ee.bottom+this.options.padding+this.options.offset-be.height,"px"),this.node.style.bottom="",this.node.style.right="",this.tipNode.classList.add("left","position-bottom")}},{key:"positionOnTop",value:function(ee){var pe=this.getSize().height,be=this.options.padding+10;this.node.style.top="".concat(ee.top-pe-be,"px"),this.node.style.left="".concat(ee.left-this.options.padding+this.options.offset,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom")}},{key:"positionOnTopCenter",value:function(ee){var pe=this.getSize(),be=pe.height,we=pe.width/2,Le=this.options.padding+10,fe=this.options.offset+ee.left+(ee.right-ee.left)/2;this.node.style.top="".concat(ee.top-be-Le,"px"),this.node.style.left="".concat(fe-we-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom","position-center")}},{key:"positionOnTopRight",value:function(ee){var pe=this.getSize(),be=pe.height,we=this.options.padding+10;this.node.style.top="".concat(ee.top-be-we,"px"),this.node.style.left="".concat(ee.right+this.options.padding+this.options.offset-pe.width,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("bottom","position-right")}},{key:"positionOnBottom",value:function(ee){var pe=this.options.padding+10;this.node.style.top="".concat(ee.bottom+pe,"px"),this.node.style.left="".concat(ee.left-this.options.padding+this.options.offset,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top")}},{key:"positionOnBottomCenter",value:function(ee){var pe=this.getSize().width/2,be=this.options.padding+10,we=this.options.offset+ee.left+(ee.right-ee.left)/2;this.node.style.top="".concat(ee.bottom+be,"px"),this.node.style.left="".concat(we-pe-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top","position-center")}},{key:"positionOnBottomRight",value:function(ee){var pe=this.getSize(),be=this.options.padding+10;this.node.style.top="".concat(ee.bottom+be,"px"),this.node.style.left="".concat(ee.right+this.options.padding+this.options.offset-pe.width,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("top","position-right")}},{key:"positionOnMidCenter",value:function(ee){var pe=this.getSize(),be=pe.height,we=pe.width/2,Le=be/2,fe=(ee.bottom-ee.top)/2,xe=ee.top-Le+fe+this.options.offset,Ne=this.options.offset+ee.left+(ee.right-ee.left)/2;this.node.style.top="".concat(xe,"px"),this.node.style.left="".concat(Ne-we-this.options.padding,"px"),this.node.style.right="",this.node.style.bottom="",this.tipNode.classList.add("mid-center")}},{key:"autoPosition",value:function(ee){var pe=this.getFullPageSize(),be=this.getSize(),we=pe.height,Le=be.height,fe=this.options.padding+10;ee.bottom+Le+fe>=we?this.positionOnTop(ee):this.positionOnBottom(ee)}}])&&S(ie.prototype,re),Q&&S(ie,Q),Y}();function A(W){return(A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y})(W)}function B(W,Y){for(var ie=0;ie<Y.length;ie++){var re=Y[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}function T(W,Y){return!Y||A(Y)!=="object"&&typeof Y!="function"?function(ie){if(ie===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ie}(W):Y}function M(W){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)})(W)}function j(W,Y){return(j=Object.setPrototypeOf||function(ie,re){return ie.__proto__=re,ie})(W,Y)}var J=function(W){function Y(ee,pe,be){var we;return function(Le,fe){if(!(Le instanceof fe))throw new TypeError("Cannot call a class as a function")}(this,Y),(we=T(this,M(Y).call(this))).options=ee,we.window=pe,we.document=be,we}var ie,re,Q;return function(ee,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ee.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ee,writable:!0,configurable:!0}}),pe&&j(ee,pe)}(Y,m),ie=Y,(re=[{key:"attachNode",value:function(){var ee=this.document.getElementById(u);ee||(ee=g(h),document.body.appendChild(ee)),this.node=ee,this.options.animate?this.node.classList.remove("driver-stage-no-animation"):this.node.classList.add("driver-stage-no-animation")}},{key:"hide",value:function(){this.node&&this.node.parentElement&&this.node.parentElement.removeChild(this.node)}},{key:"setInitialStyle",value:function(){this.node.style.display="block",this.node.style.left="0",this.node.style.top="0",this.node.style.bottom="",this.node.style.right=""}},{key:"show",value:function(ee){this.attachNode(),this.setInitialStyle();var pe=2*this.options.padding,be=ee.right-ee.left+pe,we=ee.bottom-ee.top+pe;this.node.style.display="block",this.node.style.position="absolute",this.node.style.width="".concat(be,"px"),this.node.style.height="".concat(we,"px"),this.node.style.top="".concat(ee.top-pe/2,"px"),this.node.style.left="".concat(ee.left-pe/2,"px"),this.node.style.backgroundColor=this.options.stageBackground}}])&&B(ie.prototype,re),Q&&B(ie,Q),Y}();function U(W){for(var Y=1;Y<arguments.length;Y++){var ie=arguments[Y]!=null?arguments[Y]:{},re=Object.keys(ie);typeof Object.getOwnPropertySymbols=="function"&&(re=re.concat(Object.getOwnPropertySymbols(ie).filter(function(Q){return Object.getOwnPropertyDescriptor(ie,Q).enumerable}))),re.forEach(function(Q){H(W,Q,ie[Q])})}return W}function H(W,Y,ie){return Y in W?Object.defineProperty(W,Y,{value:ie,enumerable:!0,configurable:!0,writable:!0}):W[Y]=ie,W}function te(W,Y){for(var ie=0;ie<Y.length;ie++){var re=Y[ie];re.enumerable=re.enumerable||!1,re.configurable=!0,"value"in re&&(re.writable=!0),Object.defineProperty(W,re.key,re)}}e.d(t,"default",function(){return se});var se=function(){function W(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(function(ee,pe){if(!(ee instanceof pe))throw new TypeError("Cannot call a class as a function")})(this,W),this.options=U({animate:a,opacity:r,padding:n,scrollIntoViewOptions:null,allowClose:s,keyboardControl:o,overlayClickNext:l,stageBackground:"#ffffff",onHighlightStarted:function(){return null},onHighlighted:function(){return null},onDeselected:function(){return null},onReset:function(){return null},onNext:function(){return null},onPrevious:function(){return null}},Q),this.document=document,this.window=window,this.isActivated=!1,this.steps=[],this.currentStep=0,this.currentMovePrevented=!1,this.overlay=new C(this.options,window,document),this.onResize=this.onResize.bind(this),this.onKeyUp=this.onKeyUp.bind(this),this.onClick=this.onClick.bind(this),this.moveNext=this.moveNext.bind(this),this.movePrevious=this.movePrevious.bind(this),this.preventMove=this.preventMove.bind(this),this.bind()}var Y,ie,re;return Y=W,(ie=[{key:"getSteps",value:function(){return this.steps}},{key:"setSteps",value:function(Q){this.steps=Q}},{key:"bind",value:function(){this.window.addEventListener("resize",this.onResize,!1),this.window.addEventListener("keyup",this.onKeyUp,!1),"ontouchstart"in document.documentElement?this.window.addEventListener("touchstart",this.onClick,!1):this.window.addEventListener("click",this.onClick,!1)}},{key:"onClick",value:function(Q){if(this.isActivated&&this.hasHighlightedElement()){Q.stopPropagation();var ee=this.overlay.getHighlightedElement(),pe=this.document.getElementById("driver-popover-item"),be=ee.node.contains(Q.target),we=pe&&pe.contains(Q.target);if(be||we||!this.options.overlayClickNext)if(be||we||!this.options.allowClose){var Le=Q.target.classList.contains("driver-next-btn"),fe=Q.target.classList.contains("driver-prev-btn");Q.target.classList.contains("driver-close-btn")?this.reset():Le?this.handleNext():fe&&this.handlePrevious()}else this.reset();else this.handleNext()}}},{key:"onResize",value:function(){this.isActivated&&this.refresh()}},{key:"refresh",value:function(){this.overlay.refresh()}},{key:"onKeyUp",value:function(Q){if(this.isActivated&&this.options.keyboardControl)if(Q.keyCode!==27){var ee=this.getHighlightedElement();ee&&ee.popover&&(Q.keyCode===39?this.handleNext():Q.keyCode===37&&this.handlePrevious())}else this.reset()}},{key:"movePrevious",value:function(){var Q=this.steps[this.currentStep-1];Q?(this.overlay.highlight(Q),this.currentStep-=1):this.reset()}},{key:"preventMove",value:function(){this.currentMovePrevented=!0}},{key:"handleNext",value:function(){this.currentMovePrevented=!1;var Q=this.steps[this.currentStep];Q&&Q.options&&Q.options.onNext&&Q.options.onNext(this.overlay.highlightedElement),this.currentMovePrevented||this.moveNext()}},{key:"handlePrevious",value:function(){this.currentMovePrevented=!1;var Q=this.steps[this.currentStep];Q&&Q.options&&Q.options.onPrevious&&Q.options.onPrevious(this.overlay.highlightedElement),this.currentMovePrevented||this.movePrevious()}},{key:"moveNext",value:function(){var Q=this.steps[this.currentStep+1];Q?(this.overlay.highlight(Q),this.currentStep+=1):this.reset()}},{key:"hasNextStep",value:function(){return!!this.steps[this.currentStep+1]}},{key:"hasPreviousStep",value:function(){return!!this.steps[this.currentStep-1]}},{key:"reset",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.currentStep=0,this.isActivated=!1,this.overlay.clear(Q)}},{key:"hasHighlightedElement",value:function(){var Q=this.overlay.getHighlightedElement();return Q&&Q.node}},{key:"getHighlightedElement",value:function(){return this.overlay.getHighlightedElement()}},{key:"getLastHighlightedElement",value:function(){return this.overlay.getLastHighlightedElement()}},{key:"defineSteps",value:function(Q){this.steps=[];for(var ee=0;ee<Q.length;ee++){var pe=this.prepareElementFromStep(Q[ee],Q,ee);pe&&this.steps.push(pe)}}},{key:"prepareElementFromStep",value:function(Q){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,be=U({},this.options),we=Q,Le=typeof Q!="string"&&!v(Q);if(!Q||Le&&!Q.element)throw new Error("Element is required in step ".concat(pe));Le&&(we=Q.element,be=U({},this.options,Q));var fe=v(we)?we:this.document.querySelector(we);if(!fe)return console.warn("Element to highlight ".concat(we," not found")),null;var xe=null;if(be.popover&&be.popover.title){var Ne=[this.options.className,be.popover.className].filter(function(tt){return tt}).join(" "),Be=U({},be,be.popover,{className:Ne,totalCount:ee.length,currentIndex:pe,isFirst:pe===0,isLast:ee.length===0||pe===ee.length-1});xe=new I(Be,this.window,this.document)}var Pe=U({},be),Ze=new J(Pe,this.window,this.document);return new m({node:fe,options:be,popover:xe,stage:Ze,overlay:this.overlay,window:this.window,document:this.document})}},{key:"start",value:function(){var Q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(!this.steps||this.steps.length===0)throw new Error("There are no steps defined to iterate");this.isActivated=!0,this.currentStep=Q,this.overlay.highlight(this.steps[Q])}},{key:"highlight",value:function(Q){this.isActivated=!0;var ee=this.prepareElementFromStep(Q);ee&&this.overlay.highlight(ee)}}])&&te(Y.prototype,ie),re&&te(Y,re),W}()}]).default})});window.frappe||(window.frappe={});frappe.provide=function(i){for(var t=i.split("."),e=window,r=0;r<t.length;r++){var n=t[r];e[n]||(e[n]={}),e=e[n]}return e};frappe.provide("locals");frappe.provide("frappe.flags");frappe.provide("frappe.settings");frappe.provide("frappe.utils");frappe.provide("frappe.ui.form");frappe.provide("frappe.modules");frappe.provide("frappe.templates");frappe.provide("frappe.test_data");frappe.provide("frappe.utils");frappe.provide("frappe.model");frappe.provide("frappe.user");frappe.provide("frappe.session");frappe.provide("frappe._messages");frappe.provide("locals.DocType");frappe.provide("frappe.listview_settings");frappe.provide("frappe.tour");frappe.provide("frappe.listview_parent_route");window.NEWLINE=`
`;window.TAB=9;window.UP_ARROW=38;window.DOWN_ARROW=40;window.cur_frm=null;frappe._=function(i,t,e=null){if(!i||typeof i!="string")return i;let r="",n=i;return e&&(r=frappe._messages[`${n}:${e}`]),r||(r=frappe._messages[n]||i),t&&typeof t=="object"&&(r=$.format(r,t)),r};window.__=frappe._;frappe.get_languages=function(){return frappe.languages||(frappe.languages=[],$.each(frappe.boot.lang_dict,function(i,t){frappe.languages.push({label:i,value:t})}),frappe.languages=frappe.languages.sort(function(i,t){return i.value<t.value?-1:1})),frappe.languages};(function(i){"use strict";var t=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;function e(){}e.extend=function(r){var n=this.prototype,a=Object.create(n);for(var s in r)a[s]=typeof r[s]=="function"&&typeof n[s]=="function"&&t.test(r[s])?function(l,u){return function(){var c=this._super;this._super=n[l];var h=u.apply(this,arguments);return this._super=c,h}}(s,r[s]):r[s];var o=typeof a.init=="function"?a.hasOwnProperty("init")?a.init:function(){n.init.apply(this,arguments)}:function(){};return o.prototype=a,a.constructor=o,o.extend=e.extend,o},i.Class=e})(window);String.prototype.includes||(String.prototype.includes=function(i,t){"use strict";return typeof t!="number"&&(t=0),t+i.length>this.length?!1:this.indexOf(i,t)!==-1});Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(i,t){if(this==null)throw new TypeError('"this" is null or not defined');var e=Object(this),r=e.length>>>0;if(r===0)return!1;for(var n=t|0,a=Math.max(n>=0?n:r-Math.abs(n),0);a<r;){if(e[a]===i)return!0;a++}return!1}});typeof String.prototype.trimLeft!="function"&&(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")});typeof String.prototype.trimRight!="function"&&(String.prototype.trimRight=function(){return this.replace(/\s+$/,"")});typeof Object.assign!="function"&&Object.defineProperty(Object,"assign",{value:function(t){"use strict";if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(n!=null)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},writable:!0,configurable:!0});frappe.require=function(i,t){return typeof i=="string"&&(i=[i]),i=i.map(e=>frappe.assets.bundled_asset(e)),new Promise(e=>{frappe.assets.execute(i,()=>{e(),t&&t()})})};frappe.assets={check:function(){if(window._version_number!=localStorage.getItem("_version_number")&&(frappe.assets.clear_local_storage(),console.log("Cleared App Cache.")),localStorage._last_load){var i=new Date-new Date(localStorage._last_load);(i<1e4||i>864e5)&&frappe.assets.clear_local_storage()}else frappe.assets.clear_local_storage();frappe.assets.init_local_storage()},init_local_storage:function(){localStorage._last_load=new Date,localStorage._version_number=window._version_number,frappe.boot&&(localStorage.metadata_version=frappe.boot.metadata_version)},clear_local_storage:function(){$.each(["_last_load","_version_number","metadata_version","page_info","last_visited"],function(t,e){localStorage.removeItem(e)});for(var i in localStorage)(i.indexOf("desk_assets:")===0||i.indexOf("_page:")===0||i.indexOf("_doctype:")===0||i.indexOf("preferred_breadcrumbs:")===0)&&localStorage.removeItem(i);console.log("localStorage cleared")},executed_:[],execute:function(i,t){for(var e=[],r=0,n=i.length;r<n;r++)frappe.assets.exists(i[r])||e.push(i[r]);e.length?frappe.assets.fetch(e,function(){frappe.assets.eval_assets(i,t)}):frappe.assets.eval_assets(i,t)},eval_assets:function(i,t){for(var e=0,r=i.length;e<r;e++){var n=i[e];frappe.assets.executed_.indexOf(n)===-1&&(frappe.assets.handler[frappe.assets.extn(n)](frappe.assets.get(n),n),frappe.assets.executed_.push(n))}t&&t()},exists:function(i){return frappe.assets.executed_.indexOf(i)!==-1?!0:frappe.boot.developer_mode?!1:!!frappe.assets.get(i)},fetch:function(i,t){frappe.call({type:"GET",method:"frappe.client.get_js",args:{items:i},callback:function(e){$.each(i,function(r,n){frappe.assets.add(n,e.message[r])}),t()},freeze:!0})},add:function(i,t){if("localStorage"in window)try{frappe.assets.set(i,t)}catch(e){frappe.assets.clear_local_storage(),frappe.assets.set(i,t)}},get:function(i){return localStorage.getItem("desk_assets:"+i)},set:function(i,t){localStorage.setItem("desk_assets:"+i,t)},extn:function(i){return i.indexOf("?")!=-1&&(i=i.split("?").slice(-1)[0]),i.split(".").slice(-1)[0]},handler:{js:function(i,t){frappe.dom.eval(i)},css:function(i,t){frappe.dom.set_style(i)}},bundled_asset(i,t=null){return!i.startsWith("/assets")&&i.includes(".bundle.")&&(i.endsWith(".css")&&t&&(i=`rtl_${i}`),i=frappe.boot.assets_json[i]||i),i}};function bp(i,t){return i==null?i:(this.unkeyed_index=0,i.replace(/\{(\w*)\}/g,function(e,r){if(r===""&&(r=this.unkeyed_index,this.unkeyed_index++),r==+r)return t[r]!==void 0?t[r]:e}.bind(this)))}jQuery&&(jQuery.format=bp);frappe.provide("frappe.form.formatters");frappe.form.link_formatters={};frappe.form.formatters={_right:function(i,t){return t&&(t.inline||t.only_value)?i:"<div style='text-align: right'>"+i+"</div>"},_apply_custom_formatter:function(i,t){if(t){let e=frappe.meta.docfield_map[t.parent]&&frappe.meta.docfield_map[t.parent][t.fieldname];e&&e.formatter&&typeof e.formatter=="function"&&(i=e.formatter(i,t))}return i},Data:function(i,t){return t&&t.options=="URL"?`<a href="${i}" title="Open Link" target="_blank">${i}</a>`:(i=i==null?"":i,frappe.form.formatters._apply_custom_formatter(i,t))},Autocomplete:function(i,t){return __(frappe.form.formatters.Data(i,t))},Select:function(i,t){return __(frappe.form.formatters.Data(i,t))},Float:function(i,t,e,r){var n=t.precision||cint(frappe.boot.sysdefaults&&frappe.boot.sysdefaults.float_precision)||null;if(t.options&&t.options.trim())return t.precision=n,frappe.form.formatters.Currency(i,t,e,r);if(!(e||{}).always_show_decimals&&!is_null(i)){var a=cstr(i).split(".");(a[1]==null||cint(a[1])===0)&&(n=0)}return i=i==null||i===""?"":i,frappe.form.formatters._right(format_number(i,null,n),e)},Int:function(i,t,e){return frappe.form.formatters._right(i==null?"":cint(i),e)},Percent:function(i,t,e){let r=t.precision||cint(frappe.boot.sysdefaults&&frappe.boot.sysdefaults.float_precision)||2;return frappe.form.formatters._right(flt(i,r)+"%",e)},Rating:function(i,t){let e="",r=t.options||5;return i=i*r,i=Math.round(i*2)/2,Array.from({length:cint(r)},(n,a)=>a+1).forEach(n=>{e+=`<svg class="icon icon-md" data-rating=${n} viewBox="0 0 24 24" fill="none">
				<path class="right-half ${n<=(i||0)?"star-click":""}" d="M11.9987 3.00011C12.177 3.00011 12.3554 3.09303 12.4471 3.27888L14.8213 8.09112C14.8941 8.23872 15.0349 8.34102 15.1978 8.3647L20.5069 9.13641C20.917 9.19602 21.0807 9.69992 20.7841 9.9892L16.9421 13.7354C16.8243 13.8503 16.7706 14.0157 16.7984 14.1779L17.7053 19.4674C17.7753 19.8759 17.3466 20.1874 16.9798 19.9945L12.2314 17.4973C12.1586 17.459 12.0786 17.4398 11.9987 17.4398V3.00011Z" fill="var(--star-fill)" stroke="var(--star-fill)"/>
				<path class="left-half ${n<=(i||0)||n-.5==i?"star-click":""}" d="M11.9987 3.00011C11.8207 3.00011 11.6428 3.09261 11.5509 3.27762L9.15562 8.09836C9.08253 8.24546 8.94185 8.34728 8.77927 8.37075L3.42887 9.14298C3.01771 9.20233 2.85405 9.70811 3.1525 9.99707L7.01978 13.7414C7.13858 13.8564 7.19283 14.0228 7.16469 14.1857L6.25116 19.4762C6.18071 19.8842 6.6083 20.1961 6.97531 20.0045L11.7672 17.5022C11.8397 17.4643 11.9192 17.4454 11.9987 17.4454V3.00011Z" fill="var(--star-fill)" stroke="var(--star-fill)"/>
			</svg>`}),`<div class="rating">
			${e}
		</div>`},Currency:function(i,t,e,r){var n=frappe.meta.get_field_currency(t,r),a=t.precision||cint(frappe.boot.sysdefaults.currency_precision)||2;if(a>2){var s=cstr(i).split("."),o=s.length>1?s[1]:"";if(o.length<3||o.length<a){let l=frappe.model.get_value(":Currency",n,"fraction_units")||100;o.length<cstr(l).length&&(a=cstr(l).length-1)}}return i=i==null||i===""?"":i,i=format_currency(i,n,a),e&&e.only_value?i:frappe.form.formatters._right(i,e)},Check:function(i){return`<input type="checkbox" disabled
			class="disabled-${i?"selected":"deselected"}">`},Link:function(i,t,e,r){var n=t._options||t.options,a=i;let s=frappe.utils.get_link_title(n,i);return i&&i.match&&i.match(/^['"].*['"]$/)&&i.replace(/^.(.*).$/,"$1"),e&&(e.for_print||e.only_value)?s||i:(frappe.form.link_formatters[n]&&r&&n!==r.doctype&&(i=frappe.form.link_formatters[n](i,r,t)),i?i[0]=="'"&&i[i.length-1]=="'"?i.substring(1,i.length-1):t&&t.link_onclick?repl('<a onclick="%(onclick)s">%(value)s</a>',{onclick:t.link_onclick.replace(/"/g,"&quot;"),value:i}):t&&n&&frappe.model.can_read(n)?`<a
					href="/app/${encodeURIComponent(frappe.router.slug(n))}/${encodeURIComponent(a)}"
					data-doctype="${n}"
					data-name="${a}"
					data-value="${a}">
					${__(e&&e.label||s||i)}</a>`:s||i:"")},Date:function(i){return frappe.datetime.str_to_user?(i&&(i=frappe.datetime.str_to_user(i),i==="Invalid date"&&(i=null)),i||""):i},DateRange:function(i){return Array.isArray(i)?__("{0} to {1}",[frappe.datetime.str_to_user(i[0]),frappe.datetime.str_to_user(i[1])]):i||""},Datetime:function(i){return i?moment(frappe.datetime.convert_to_user_tz(i)).format(frappe.boot.sysdefaults.date_format.toUpperCase()+" "+(frappe.boot.sysdefaults.time_format||"HH:mm:ss")):""},Text:function(i,t){if(i){for(var e=["<p","<div","<br","<table"],r=!1,n=0;n<e.length;n++)if(i.match(e[n])){r=!0;break}r||(i=frappe.utils.replace_newlines(i))}return frappe.form.formatters.Data(i,t)},Time:function(i){return i&&(i=frappe.datetime.str_to_user(i,!0)),i||""},Duration:function(i,t){if(i){let e=frappe.utils.get_duration_options(t);i=frappe.utils.get_formatted_duration(i,e)}return i||"0s"},LikedBy:function(i){var t="";return $.each(JSON.parse(i||"[]"),function(e,r){r&&(t+=frappe.avatar(r))}),t},Tag:function(i){var t="";return $.each((i||"").split(","),function(e,r){r&&(t+=`
				<span
					class="data-pill btn-xs align-center ellipsis"
					style="background-color: var(--control-bg); box-shadow: none; margin-right: 4px;"
					data-field="_user_tags" data-label="${r}'">
					${r}
				</span>`)}),t},Comment:function(i){return i},Assign:function(i){var t="";return $.each(JSON.parse(i||"[]"),function(e,r){r&&(t+='<span class="label label-warning" 				style="margin-right: 7px;"				data-field="_assign">'+r+"</span>")}),t},SmallText:function(i){return frappe.form.formatters.Text(i)},TextEditor:function(i){let t=frappe.form.formatters.Text(i);try{!$(t).find(".ql-editor").length&&!$(t).hasClass("ql-editor")&&(t=`<div class="ql-editor read-mode">${t}</div>`)}catch(e){t=`<div class="ql-editor read-mode">${t}</div>`}return t},Code:function(i){return"<pre>"+(i==null?"":$("<div>").text(i).html())+"</pre>"},WorkflowState:function(i){var t=frappe.get_doc("Workflow State",i);return t?repl("<span class='label label-%(style)s' 				data-workflow-state='%(value)s'				style='padding-bottom: 4px; cursor: pointer;'>				<i class='fa fa-small fa-white fa-%(icon)s'></i> %(value)s</span>",{value:i,style:t.style.toLowerCase(),icon:t.icon}):"<span class='label'>"+i+"</span>"},Email:function(i){return $("<div></div>").text(i).html()},FileSize:function(i){return i>1048576?i=flt(flt(i)/1048576,1)+"M":i>1024&&(i=flt(flt(i)/1024,1)+"K"),i},TableMultiSelect:function(i,t,e){i=i||[];let n=frappe.get_meta(t.options).fields.find(s=>s.fieldtype==="Link");return i.map(s=>{let o=s[n.fieldname];return frappe.format(o,n,e,s)}).join(", ")},Color:i=>i?`<div>
			<div class="selected-color" style="background-color: ${i}"></div>
			<span class="color-value">${i}</span>
		</div>`:"",Icon:i=>i?`<div>
			<div class="selected-icon">${frappe.utils.icon(i,"md")}</div>
			<span class="icon-value">${i}</span>
		</div>`:""};frappe.form.get_formatter=function(i){return i||(i="Data"),frappe.form.formatters[i.replace(/ /g,"")]||frappe.form.formatters.Data};frappe.format=function(i,t,e,r){t||(t={fieldtype:"Data"}),t.fieldname=="_user_tags"&&(t.fieldtype="Tag");var n=t.fieldtype||"Data";n==="Dynamic Link"&&(n="Link",t._options=r?r[t.options]:null);var a=t.formatter||frappe.form.get_formatter(n),s=a(i,t,e,r);return typeof s=="string"&&(s=frappe.dom.remove_script_and_style(s)),s};frappe.get_format_helper=function(i){var t={get_formatted:function(e){var r=frappe.meta.get_docfield(i.doctype,e);return r||console.log("fieldname not found: "+e),frappe.format(i[e],r,{inline:1},i)}};return $.extend(t,i),t};frappe.form.link_formatters.User=function(i,t,e){return t&&(t.full_name||e&&t[`${e.fieldname}_full_name`])||i};frappe.provide("frappe.dom");frappe.dom={id_count:0,freeze_count:0,by_id:function(i){return document.getElementById(i)},get_unique_id:function(){let i="unique-"+frappe.dom.id_count;return frappe.dom.id_count++,i},set_unique_id:function(i){var t=$(i);if(t.attr("id"))return t.attr("id");var e="unique-"+frappe.dom.id_count;return t.attr("id",e),frappe.dom.id_count++,e},eval:function(i){if(!!i){var t=document.createElement("script");t.appendChild(document.createTextNode(i)),document.getElementsByTagName("head")[0].appendChild(t)}},remove_script_and_style:function(i){let t=["script","style","noscript","title","meta","base","head"];if(!new RegExp(t.map(o=>`<${o}>.*<\\/${o}>`).join("|"),"s").test(i))return i;var r=document.createElement("div");r.innerHTML=i;var n=!1;t.forEach(function(o){var l=r.getElementsByTagName(o);for(s=l.length;s--;)n=!0,l[s].parentNode.removeChild(l[s])});for(var a=r.getElementsByTagName("link"),s=a.length;s--;)a[s].getAttribute("rel")=="stylesheet"&&(n=!0,a[s].parentNode.removeChild(a[s]));return n?r.innerHTML:i},is_element_in_viewport:function(i,t=0){typeof jQuery=="function"&&i instanceof jQuery&&(i=i[0]);var e=i.getBoundingClientRect();return e.top+t>=0&&e.left+t>=0&&e.bottom-t<=$(window).height()&&e.right-t<=$(window).width()},is_element_in_modal(i){return Boolean($(i).parents(".modal").length)},set_style:function(i,t){if(!!i){var e=document.createElement("style");if(e.type="text/css",t){var r=document.getElementById(t);r&&r.parentNode.removeChild(r),e.id=t}return e.styleSheet?e.styleSheet.cssText=i:e.appendChild(document.createTextNode(i)),document.getElementsByTagName("head")[0].appendChild(e),e}},add:function(i,t,e,r,n,a){i&&i.substr&&(i=frappe.dom.by_id(i));var s=document.createElement(t);return i&&i.appendChild(s),e&&(t.toLowerCase()=="img"?s.src=e:s.className=e),r&&frappe.dom.css(s,r),n&&(s.innerHTML=n),a&&(s.onclick=a),s},css:function(i,t){return i&&t&&$.extend(i.style,t),i},activate:function(i,t,e,r="active"){i.find(`.${e}.${r}`).removeClass(r),t.addClass(r)},freeze:function(i,t){if($("#freeze").length)$("#freeze").addClass("in");else{var e=$('<div id="freeze" class="modal-backdrop fade"></div>').on("click",function(){if(cur_frm&&cur_frm.cur_grid)return cur_frm.cur_grid.toggle_view(),!1}).appendTo("#body");e.html(repl('<div class="freeze-message-container"><div class="freeze-message"><p class="lead">%(msg)s</p></div></div>',{msg:i||""})),setTimeout(function(){e.addClass("in")},1)}t&&$("#freeze").addClass(t),frappe.dom.freeze_count++},unfreeze:function(){if(!!frappe.dom.freeze_count&&(frappe.dom.freeze_count--,!frappe.dom.freeze_count))var i=$("#freeze").removeClass("in").remove()},save_selection:function(){if(window.getSelection){var i=window.getSelection();if(i.getRangeAt&&i.rangeCount){for(var t=[],e=0,r=i.rangeCount;e<r;++e)t.push(i.getRangeAt(e));return t}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null},restore_selection:function(i){if(i)if(window.getSelection){var t=window.getSelection();t.removeAllRanges();for(var e=0,r=i.length;e<r;++e)t.addRange(i[e])}else document.selection&&i.select&&i.select()},is_touchscreen:function(){return"ontouchstart"in window},handle_broken_images(i){$(i).find("img").on("error",t=>{$(t.currentTarget).addClass("no-image")})},scroll_to_bottom(i){let t=$(i);t.scrollTop(t[0].scrollHeight)},file_to_base64(i){return new Promise(t=>{let e=new FileReader;e.onload=function(){t(e.result)},e.readAsDataURL(i)})},scroll_to_section(i){setTimeout(()=>{let t=$(`a:contains("${i}")`);t.length&&(t.parent().hasClass("collapsed")&&t.click(),frappe.ui.scroll(t.parent().parent()))},200)},pixel_to_inches(i){let t=$('<div id="dpi" style="height: 1in; width: 1in; left: 100%; position: fixed; top: 100%;"></div>');t.appendTo(document.body);let e=document.getElementById("dpi").offsetWidth,r=i/e;return t.remove(),r}};frappe.ellipsis=function(i,t){return t||(t=20),i=cstr(i),i.length>t&&(i=i.substr(0,t)+"..."),i};frappe.run_serially=function(i){var t=Promise.resolve();return i.forEach(e=>{e&&(t=t.then?t.then(e):Promise.resolve())}),t};frappe.load_image=(i,t,e,r=()=>{})=>{var n=new Image;n.onload=function(){t(this)},n.onerror=e,r(n),n.src=i};frappe.timeout=i=>new Promise(t=>{setTimeout(()=>t(),i*1e3)});frappe.scrub=function(i,t="_"){return i.replace(/ /g,t).toLowerCase()};frappe.unscrub=function(i){return frappe.model.unscrub(i)};frappe.get_data_pill=(i,t=null,e=null,r=null)=>{let n=$(`
		<button class="data-pill btn">
			<div class="flex align-center ellipsis">
				${r||""}
				<span class="pill-label ${r?"ml-2":""}">${i}</span>
			</div>
		</button>
	`);if(e){let a=$(`
			<span class="remove-btn cursor-pointer">
				${frappe.utils.icon("close","sm")}
			</span>
		`).click(()=>{e(t||i,n)});n.append(a)}return n};frappe.get_modal=function(i,t){return $(`<div class="modal fade" style="overflow: auto;" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<div class="fill-width flex title-section">
						<span class="indicator hidden"></span>
						<h4 class="modal-title">${i}</h4>
					</div>
					<div class="modal-actions">
						<button class="btn btn-modal-minimize btn-link hide">
							${frappe.utils.icon("collapse")}
						</button>
						<button class="btn btn-modal-close btn-link" data-dismiss="modal">
							${frappe.utils.icon("close-alt","sm","close-alt")}
						</button>
					</div>
				</div>
				<div class="modal-body ui-front">${t}</div>
				<div class="modal-footer hide">
					<div class="custom-actions"></div>
					<div class="standard-actions">
						<button type="button" class="btn btn-secondary btn-sm hide btn-modal-secondary">
						</button>
						<button type="button" class="btn btn-primary btn-sm hide btn-modal-primary">
							${__("Confirm")}
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>`)};frappe.is_online=function(){return frappe.boot.developer_mode==1?!0:"onLine"in navigator?navigator.onLine:!0};$(window).on("online",function(){frappe.show_alert({indicator:"green",message:__("You are connected to internet.")})});$(window).on("offline",function(){frappe.show_alert({indicator:"orange",message:__("Connection lost. Some features might not work.")})});var Ir=class{constructor(t,e,r,n){this.layout=n,this.card_layout=r,this.parent=t,this.df=e||{},this.fields_list=[],this.fields_dict={},this.make(),this.df.label&&this.df.collapsible&&localStorage.getItem(e.css_class+"-closed")&&this.collapse(),this.row={wrapper:this.wrapper},this.refresh()}make(){let t=this.card_layout;this.wrapper=$(`<div class="row
				${this.df.is_dashboard_section?"form-dashboard-section":"form-section"}
				${t?"card-section":""}">
			`).appendTo(this.parent),this.layout&&this.layout.sections.push(this),this.df&&(this.df.label&&this.make_head(),this.df.description&&(this.description_wrapper=$(`<div class="col-sm-12 form-section-description">
						${__(this.df.description)}
					</div>`),this.wrapper.append(this.description_wrapper)),this.df.css_class&&this.wrapper.addClass(this.df.css_class),this.df.hide_border&&this.wrapper.toggleClass("hide-border",!0)),this.body=$('<div class="section-body">').appendTo(this.wrapper),this.df.body_html&&this.body.append(this.df.body_html)}make_head(){this.head=$(`
			<div class="section-head">
				${__(this.df.label)}
				<span class="ml-2 collapse-indicator mb-1"></span>
			</div>
		`),this.head.appendTo(this.wrapper),this.indicator=this.head.find(".collapse-indicator"),this.indicator.hide(),this.df.collapsible&&(this.collapse_link=this.head.on("click",()=>{this.collapse()}),this.set_icon(),this.indicator.show())}refresh(t){!this.df||(t=t||this.df.hidden||this.df.hidden_due_to_dependency,this.wrapper.toggleClass("hide-control",!!t))}collapse(t){!(this.head&&this.body)||(t===void 0&&(t=!this.body.hasClass("hide")),this.body.toggleClass("hide",t),this.head&&this.head.toggleClass("collapsed",t),this.set_icon(t),this.fields_list.forEach(e=>{e.df.fieldtype=="Signature"&&e.refresh()}),this.df.css_class&&localStorage.setItem(this.df.css_class+"-closed",t?"1":""))}set_icon(t){let e=t?"down":"up-line";this.indicator&&this.indicator.html(frappe.utils.icon(e,"sm","mb-1"))}is_collapsed(){return this.body.hasClass("hide")}has_missing_mandatory(){let t=!1;for(let e=0,r=this.fields_list.length;e<r;e++){let n=this.fields_list[e].df;if(n.reqd&&this.layout.doc[n.fieldname]==null){t=!0;break}}return t}hide(){this.on_section_toggle(!1)}show(){this.on_section_toggle(!0)}on_section_toggle(t){this.wrapper.toggleClass("hide-control",!t)}};var Mr=class{constructor(t,e,r,n,a){this.parent=t,this.df=e||{},this.frm=r,this.doctype=this.frm.doctype,this.label=this.df&&this.df.label,this.tabs_list=n,this.tabs_content=a,this.fields_list=[],this.fields_dict={},this.make(),this.setup_listeners(),this.refresh()}make(){let t=`${frappe.scrub(this.doctype,"-")}-${this.df.fieldname}`;this.parent=$(`
			<li class="nav-item">
				<a class="nav-link ${this.df.active?"active":""}" id="${t}-tab"
					data-toggle="tab"
					href="#${t}"
					role="tab"
					aria-controls="${this.label}">
						${__(this.label)}
				</a>
			</li>
		`).appendTo(this.tabs_list),this.wrapper=$(`<div class="tab-pane fade show ${this.df.active?"active":""}"
			id="${t}" role="tabpanel" aria-labelledby="${t}-tab">`).appendTo(this.tabs_content)}refresh(){if(!this.df)return;let t=this.df.hidden||this.df.hidden_due_to_dependency;!t&&this.df.show_dashboard&&this.frm.is_new()&&!this.fields_list.length&&(t=!0),!t&&this.frm&&!this.frm.get_perm(this.df.permlevel||0,"read")&&(t=!0),!t&&!this.df.show_dashboard&&(t=!0,this.wrapper.find(".form-section:not(.hide-control, .empty-section), .form-dashboard-section:not(.hide-control, .empty-section)").length&&(t=!1)),this.toggle(!t)}toggle(t){this.parent.toggleClass("hide",!t),this.wrapper.toggleClass("hide",!t),this.parent.toggleClass("show",t),this.wrapper.toggleClass("show",t),this.hidden=!t}show(){this.parent.show()}hide(){this.parent.hide()}set_active(){var t,e;this.parent.find(".nav-link").tab("show"),this.wrapper.addClass("active"),(e=(t=this.frm)==null?void 0:t.set_active_tab)==null||e.call(t,this)}is_active(){return this.wrapper.hasClass("active")}is_hidden(){return this.wrapper.hasClass("hide")}setup_listeners(){this.parent.find(".nav-link").on("shown.bs.tab",()=>{var t,e;(e=this==null?void 0:(t=this.frm).set_active_tab)==null||e.call(t,this)})}};var Nr=class{constructor(t,e){e||(e={}),this.df=e,this.section=t,this.make(),this.resize_all_columns()}make(){this.wrapper=$(`
			<div class="form-column">
				<form>
				</form>
			</div>
		`).appendTo(this.section.body).find("form").on("submit",function(){return!1}),this.df.label&&$(`
				<label class="control-label">
					${__(this.df.label)}
				</label>
			`).appendTo(this.wrapper)}resize_all_columns(){let t=cint(12/this.section.wrapper.find(".form-column").length);this.section.wrapper.find(".form-column").removeClass().addClass("form-column").addClass("col-sm-"+t)}refresh(){this.section.refresh()}};frappe.ui.form.Layout=class{constructor(t){this.views={},this.pages=[],this.tabs=[],this.sections=[],this.page_breaks=[],this.fields_list=[],this.fields_dict={},$.extend(this,t)}make(){!this.parent&&this.body&&(this.parent=this.body),this.wrapper=$('<div class="form-layout">').appendTo(this.parent),this.message=$('<div class="form-message hidden"></div>').appendTo(this.wrapper),this.page=$('<div class="form-page"></div>').appendTo(this.wrapper),this.fields||(this.fields=this.get_doctype_fields()),this.is_tabbed_layout()&&this.setup_tabbed_layout(),this.setup_tab_events(),this.render()}setup_tabbed_layout(){$(`
			<div class="form-tabs-list">
				<ul class="nav form-tabs" id="form-tabs" role="tablist"></ul>
			</div>
		`).appendTo(this.page),this.tabs_list=this.page.find(".form-tabs"),this.tabs_content=$('<div class="form-tab-content tab-content"></div>').appendTo(this.page),this.setup_events()}show_empty_form_message(){this.wrapper.find(".frappe-control:visible").length||this.wrapper.find(".section-head.collapsed").length||this.show_message(__("This form does not have any input"))}get_doctype_fields(){let t=[this.get_new_name_field()];return this.doctype_layout?t=t.concat(this.get_fields_from_layout()):t=t.concat(frappe.meta.sort_docfields(frappe.meta.docfield_map[this.doctype])),t}get_new_name_field(){return{parent:this.frm.doctype,fieldtype:"Data",fieldname:"__newname",reqd:1,hidden:1,label:__("Name"),get_status:function(t){return t.frm&&t.frm.is_new()&&t.frm.meta.autoname&&["prompt","name"].includes(t.frm.meta.autoname.toLowerCase())?"Write":"None"}}}get_fields_from_layout(){let t=[];for(let e of this.doctype_layout.fields){let r=copy_dict(frappe.meta.docfield_map[this.doctype][e.fieldname]);r.label=e.label,t.push(r)}return t}show_message(t,e){this.message_color&&this.message.removeClass(this.message_color),this.message_color=e&&["yellow","blue","red","green","orange"].includes(e)?e:"blue",t?(t.substr(0,1)!=="<"&&(t="<div>"+t+"</div>"),this.message.removeClass("hidden").addClass(this.message_color),$(t).appendTo(this.message)):this.message.empty().addClass("hidden")}render(t){let e=t||this.fields;if(this.section=null,this.column=null,this.no_opening_section()&&!this.is_tabbed_layout()&&this.fields.unshift({fieldtype:"Section Break"}),this.is_tabbed_layout()){let r={label:__("Details"),fieldtype:"Tab Break",fieldname:"__details"},n=this.fields.find(s=>s.hidden==!1);if(!((n==null?void 0:n.fieldtype)==="Tab Break"?n:null))this.fields.splice(0,0,r);else{let s=this.fields.find(o=>o.fieldname==="__newname");s&&s.get_status(this)==="Write"&&(this.fields.splice(0,1),this.fields.splice(1,0,s))}}e.forEach(r=>{switch(r.fieldtype){case"Fold":this.make_page(r);break;case"Page Break":this.make_page_break(),this.make_section(r);break;case"Section Break":this.make_section(r);break;case"Column Break":this.make_column(r);break;case"Tab Break":this.make_tab(r);break;default:this.make_field(r)}})}no_opening_section(){return this.fields[0]&&this.fields[0].fieldtype!="Section Break"||!this.fields.length}no_opening_tab(){return this.fields[1]&&this.fields[1].fieldtype!="Tab Break"||!this.fields.length}is_tabbed_layout(){return this.fields.find(t=>t.fieldtype==="Tab Break")}replace_field(t,e,r){if(e.fieldname=t,this.fields_dict[t]&&this.fields_dict[t].df){let n=this.init_field(e,r);this.fields_dict[t].$wrapper.remove(),this.fields_list.splice(this.fields_dict[t],1,n),this.fields_dict[t]=n,this.section.fields_list.splice(this.section.fields_dict[t],1,n),this.section.fields_dict[t]=n,this.refresh_fields([e])}}make_field(t,e,r){!this.section&&this.make_section(),!this.column&&this.make_column();let n=this.init_field(t,r);this.fields_list.push(n),this.fields_dict[t.fieldname]=n,this.section.fields_list.push(n),this.section.fields_dict[t.fieldname]=n,n.section=this.section,this.current_tab&&(n.tab=this.current_tab,this.current_tab.fields_list.push(n),this.current_tab.fields_dict[t.fieldname]=n)}init_field(t,e=!1){let r=frappe.ui.form.make_control({df:t,doctype:this.doctype,parent:this.column.wrapper.get(0),frm:this.frm,render_input:e,doc:this.doc,layout:this});return r.layout=this,r}make_page_break(){this.page=$('<div class="form-page page-break"></div>').appendTo(this.wrapper)}make_page(t){let e=this,r=$(`
			<div class="form-clickable-section text-center">
				<a class="btn-fold h6 text-muted">
					${__("Show more details")}
				</a>
			</div>
		`).appendTo(this.wrapper);this.page=$('<div class="form-page second-page hide"></div>').appendTo(this.wrapper),this.fold_btn=r.find(".btn-fold").on("click",function(){let n=$(this).parent().next();n.hasClass("hide")?($(this).removeClass("btn-fold").html(__("Hide details")),n.removeClass("hide"),frappe.utils.scroll_to($(this),!0,30),e.folded=!1):($(this).addClass("btn-fold").html(__("Show more details")),n.addClass("hide"),e.folded=!0)}),this.section=null,this.folded=!0}unfold(){this.fold_btn.trigger("click")}make_section(t){this.section=new Ir(this.current_tab?this.current_tab.wrapper:this.page,t,this.card_layout,this),t&&(this.fields_dict[t.fieldname]=this.section,this.fields_list.push(this.section)),this.column=null}make_column(t){this.column=new Nr(this.section,t),t&&t.fieldname&&this.fields_list.push(this.column)}make_tab(t){this.section=null;let e=new Mr(this,t,this.frm,this.tabs_list,this.tabs_content);return this.current_tab=e,this.make_section({fieldtype:"Section Break"}),this.tabs.push(e),e}refresh(t){t&&(this.doc=t),this.frm&&this.wrapper.find(".empty-form-alert").remove(),this.attach_doc_and_docfields(!0),this.frm&&this.frm.wrapper&&$(this.frm.wrapper).trigger("refresh-fields"),this.refresh_dependency(),this.refresh_sections(),this.frm&&this.refresh_section_collapse(),document.activeElement&&document.activeElement.tagName=="INPUT"&&this.is_numeric_field_active()&&document.activeElement.select()}is_numeric_field_active(){let e=($(document.activeElement).closest(".frappe-control").data()||{}).fieldtype;return frappe.model.numeric_fieldtypes.includes(e)}refresh_sections(){this.wrapper.find(".form-section:not(.hide-control)").each(function(){let t=$(this).removeClass("empty-section visible-section");t.find(".frappe-control:not(.hide-control)").length?t.addClass("visible-section"):t.addClass("empty-section")}),this.is_tabbed_layout()&&this.refresh_tabs()}refresh_tabs(){for(let e of this.tabs)e.refresh();let t=this.tabs.filter(e=>!e.hidden);t&&t.length==1&&t[0].parent.toggleClass("hide show"),this.set_tab_as_active()}set_tab_as_active(){var e,r;let t=(r=this==null?void 0:(e=this.frm).get_active_tab)==null?void 0:r.call(e);if(t)t.set_active();else if(this.tabs.length){let n=this.tabs.find(a=>!a.is_hidden());n&&n.set_active()}}refresh_fields(t){let e=t.map(r=>{if(r.fieldname)return r.fieldname});this.fields_list.map(r=>{e.includes(r.df.fieldname)&&(r.refresh(),r.df.default&&r.set_input(r.df.default))})}add_fields(t){this.render(t),this.refresh_fields(t)}refresh_section_collapse(){if(!!(this.sections&&this.sections.length))for(let t=0;t<this.sections.length;t++){let e=this.sections[t],r=e.df;if(r&&r.collapsible){let n=!0;r.collapsible_depends_on&&(n=!this.evaluate_depends_on_value(r.collapsible_depends_on)),n&&e.has_missing_mandatory()&&(n=!1),e.collapse(n)}}}attach_doc_and_docfields(t){let e=this;for(let r=0,n=this.fields_list.length;r<n;r++){let a=this.fields_list[r];e.doc&&(a.doc=e.doc,a.doctype=e.doc.doctype,a.docname=e.doc.name,a.df=frappe.meta.get_docfield(e.doc.doctype,a.df.fieldname,e.doc.name)||a.df),t&&a.df&&a.refresh&&a.refresh()}}refresh_section_count(){this.wrapper.find(".section-count-label:visible").each(function(t){$(this).html(t+1)})}setup_events(){this.tabs_list.off("click").on("click",".nav-link",t=>{t.preventDefault(),t.stopImmediatePropagation(),$(t.currentTarget).tab("show")})}setup_tab_events(){this.wrapper.on("keydown",t=>{if(t.which==9){let e=$(t.target),r=e.attr("data-doctype"),n=e.attr("data-fieldname");if(r)return this.handle_tab(r,n,t.shiftKey)}})}handle_tab(t,e,r){let n=null,a=null,s=this.fields_list,o=!1;if(t!=this.doctype){if(n=this.get_open_grid_row(),!n||!n.layout)return;s=n.layout.fields_list}for(let l=0,u=s.length;l<u;l++){if(s[l].df.fieldname==e){if(r){a?this.set_focus(a):$(this.primary_button).focus();break}if(l<u-1&&(o=this.focus_on_next_field(l,s)),o)break}this.is_visible(s[l])&&(a=s[l])}return o||(n?n.doc.idx==n.grid.grid_rows.length?n.toggle_view(!1,function(){n.grid.frm.layout.handle_tab(n.grid.df.parent,n.grid.df.fieldname)}):n.grid.grid_rows[n.doc.idx].toggle_view(!0):r||$(this.primary_button).focus()),!1}focus_on_next_field(t,e){for(let r=t+1,n=e.length;r<n;r++){let a=e[r];if(this.is_visible(a)){if(a.df.fieldtype==="Table")return a.grid.grid_rows&&a.grid.grid_rows.length||a.grid.add_new_row(),a.grid.grid_rows[0].show_form(),!0;if(!in_list(frappe.model.no_value_type,a.df.fieldtype))return this.set_focus(a),!0}}}is_visible(t){return t.disp_status==="Write"&&t.df&&"hidden"in t.df&&!t.df.hidden}set_focus(t){t.tab&&t.tab.set_active(),t.df.fieldtype=="Table"?t.grid.grid_rows.length?t.grid.grid_rows[0].toggle_view(!0):t.grid.add_new_row(1):t.editor?t.editor.set_focus():t.$input&&t.$input.focus()}get_open_grid_row(){return $(".grid-row-open").data("grid_row")}refresh_dependency(){let t=!1,e=this.fields_list.concat(this.tabs);for(let r in e){let n=e[r];if(n.df.depends_on||n.df.mandatory_depends_on||n.df.read_only_depends_on){t=!0;break}}if(!!t){for(let r=e.length-1;r>=0;r--){let n=e[r];n.guardian_has_value=!0,n.df.depends_on&&(n.guardian_has_value=this.evaluate_depends_on_value(n.df.depends_on),n.guardian_has_value?n.df.hidden_due_to_dependency&&(n.df.hidden_due_to_dependency=!1,n.refresh()):n.df.hidden_due_to_dependency||(n.df.hidden_due_to_dependency=!0,n.refresh())),n.df.mandatory_depends_on&&this.set_dependant_property(n.df.mandatory_depends_on,n.df.fieldname,"reqd"),n.df.read_only_depends_on&&this.set_dependant_property(n.df.read_only_depends_on,n.df.fieldname,"read_only")}this.refresh_section_count()}}set_dependant_property(t,e,r){let a=this.evaluate_depends_on_value(t)?1:0,s;this.frm?s=this.frm:(this.is_dialog||this.doctype==="Web Form")&&(s=this),s&&(this.doc&&this.doc.parent&&this.doc.parentfield?(s.setting_dependency=!0,s.set_df_property(this.doc.parentfield,r,a,this.doc.parent,e,this.doc.name),s.setting_dependency=!1,this.fields_dict[e]&&this.fields_dict[e].refresh()):s.set_df_property(e,r,a))}evaluate_depends_on_value(t){let e=null,r=this.doc;if(!r&&this.get_values&&(r=this.get_values(!0)),!r)return;let n=this.frm?this.frm.doc:this.doc||null;if(typeof t=="boolean")e=t;else if(typeof t=="function")e=t(r);else if(t.substr(0,5)=="eval:")try{e=frappe.utils.eval(t.substr(5),{doc:r,parent:n}),n&&n.istable&&t.includes("is_submittable")&&(e=!0)}catch(s){frappe.throw(__('Invalid "depends_on" expression'))}else if(t.substr(0,3)=="fn:"&&this.frm)e=this.frm.script_manager.trigger(t.substr(3),this.doctype,this.docname);else{var a=r[t];$.isArray(a)?e=!!a.length:e=!!a}return e}};frappe.provide("frappe.ui");frappe.ui.FieldGroup=class extends frappe.ui.form.Layout{constructor(t){super(t);this.dirty=!1,$.each(this.fields||[],function(e,r){!r.fieldname&&r.label&&(r.fieldname=r.label.replace(/ /g,"_").toLowerCase())}),this.values&&this.set_values(this.values)}make(){var t=this;this.fields&&(super.make(),this.refresh(),$.each(this.fields_list,function(e,r){if(r.df.default){let n=r.df.default;n=="Today"&&r.df.fieldtype=="Date"&&(n=frappe.datetime.get_today()),r.set_input(n),t.refresh_dependency()}}),this.no_submit_on_enter||this.catch_enter_as_submit(),$(this.wrapper).find("input, select").on("change awesomplete-selectcomplete",()=>{this.dirty=!0,frappe.run_serially([()=>frappe.timeout(.1),()=>t.refresh_dependency()])}))}focus_on_first_input(){this.no_focus||$.each(this.fields_list,function(t,e){if(!in_list(["Date","Datetime","Time","Check"],e.df.fieldtype)&&e.set_focus)return e.set_focus(),!1})}catch_enter_as_submit(){var t=this;$(this.body).find('input[type="text"], input[type="password"], select').keypress(function(e){e.which==13&&t.has_primary_action&&(e.preventDefault(),t.get_primary_btn().trigger("click"))})}get_input(t){var e=this.fields_dict[t];return $(e.txt?e.txt:e.input)}get_field(t){return this.fields_dict[t]}get_values(t){var e={},r=[];for(var n in this.fields_dict){var a=this.fields_dict[n];if(a.get_value){var s=a.get_value();a.df.reqd&&is_null(typeof s=="string"?strip_html(s):s)&&r.push(__(a.df.label)),a.df.reqd&&a.df.fieldtype==="Text Editor"&&is_null(strip_html(cstr(s)))&&r.push(__(a.df.label)),is_null(s)||(e[a.df.fieldname]=s)}this.is_dialog&&a.df.reqd&&!a.value&&a.refresh_input()}return r.length&&!t?(frappe.msgprint({title:__("Missing Values Required"),message:__("Following fields have missing values:")+"<br><br><ul><li>"+r.join("<li>")+"</ul>",indicator:"orange"}),null):e}get_value(t){var e=this.fields_dict[t];return e&&(e.get_value?e.get_value():null)}set_value(t,e){return new Promise(r=>{var n=this.fields_dict[t];n?n.set_value(e).then(()=>{var a;(a=n.set_input)==null||a.call(n,e),this.refresh_dependency(),r()}):r()})}has_field(t){return!!this.fields_dict[t]}set_input(t,e){return this.set_value(t,e)}set_values(t){let e=[];for(var r in t)this.fields_dict[r]&&e.push(this.set_value(r,t[r]));return Promise.all(e)}clear(){for(var t in this.fields_dict){var e=this.fields_dict[t];e&&e.set_input&&e.set_input(e.df.default||"")}}set_df_property(t,e,r){if(!t)return;let n=this.get_field(t);n.df[e]=r,n.refresh()}};frappe.provide("frappe.ui");window.cur_dialog=null;frappe.ui.open_dialogs=[];frappe.ui.Dialog=class extends frappe.ui.FieldGroup{constructor(t){super();this.display=!1,this.is_dialog=!0,$.extend(this,{animate:!0,size:null},t),this.make()}make(){this.$wrapper=frappe.get_modal("",""),this.static&&(this.$wrapper.modal({backdrop:"static",keyboard:!1}),this.get_close_btn().hide()),this.wrapper=this.$wrapper.find(".modal-dialog").get(0),this.size=="small"?$(this.wrapper).addClass("modal-sm"):this.size=="large"?$(this.wrapper).addClass("modal-lg"):this.size=="extra-large"&&$(this.wrapper).addClass("modal-xl"),this.make_head(),this.modal_body=this.$wrapper.find(".modal-body"),this.$body=$("<div></div>").appendTo(this.modal_body),this.body=this.$body.get(0),this.$message=$('<div class="hide modal-message"></div>').appendTo(this.modal_body),this.header=this.$wrapper.find(".modal-header"),this.footer=this.$wrapper.find(".modal-footer"),this.standard_actions=this.footer.find(".standard-actions"),this.custom_actions=this.footer.find(".custom-actions"),this.set_indicator(),super.make(),this.refresh_section_collapse(),this.action=this.action||{primary:{},secondary:{}},(this.primary_action||this.action.primary&&this.action.primary.onsubmit)&&this.set_primary_action(this.primary_action_label||this.action.primary.label||__("Submit",null,"Primary action in dialog"),this.primary_action||this.action.primary.onsubmit),this.secondary_action&&this.set_secondary_action(this.secondary_action),(this.secondary_action_label||this.action.secondary&&this.action.secondary.label)&&this.set_secondary_action_label(this.secondary_action_label||this.action.secondary.label),this.minimizable&&(this.header.find(".title-section").click(()=>this.is_minimized&&this.toggle_minimize()),this.get_minimize_btn().removeClass("hide").on("click",()=>this.toggle_minimize()));var t=this;this.$wrapper.on("hide.bs.modal",function(){t.display=!1,t.is_minimized=!1,t.hide_scrollbar(!1),frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]===t&&(frappe.ui.open_dialogs.pop(),frappe.ui.open_dialogs.length?window.cur_dialog=frappe.ui.open_dialogs[frappe.ui.open_dialogs.length-1]:window.cur_dialog=null),t.onhide&&t.onhide(),t.on_hide&&t.on_hide()}).on("shown.bs.modal",function(){t.display=!0,window.cur_dialog=t,frappe.ui.open_dialogs.push(t),t.focus_on_first_input(),t.hide_scrollbar(!0),t.on_page_show&&t.on_page_show(),$(document).trigger("frappe.ui.Dialog:shown"),$(document).off("focusin.modal")}).on("scroll",function(){var e=$("input:focus");e.length&&["Date","Datetime","Time"].includes(e.attr("data-fieldtype"))&&e.blur()})}get_primary_btn(){return this.standard_actions.find(".btn-primary")}get_minimize_btn(){return this.$wrapper.find(".modal-header .btn-modal-minimize")}set_message(t){this.$message.removeClass("hide"),this.$body.addClass("hide"),this.$message.text(t)}clear_message(){this.$message.addClass("hide"),this.$body.removeClass("hide")}clear(){super.clear(),this.clear_message()}set_primary_action(t,e){this.footer.removeClass("hide"),this.has_primary_action=!0;var r=this;return this.get_primary_btn().removeClass("hide").html(t).off("click").on("click",function(){r.primary_action_fulfilled=!0;var n=r.get_values();!n||e&&e.apply(r,[n])})}set_secondary_action(t){return this.footer.removeClass("hide"),this.get_secondary_btn().removeClass("hide").off("click").on("click",t)}set_secondary_action_label(t){this.get_secondary_btn().removeClass("hide").html(t)}disable_primary_action(){this.get_primary_btn().addClass("disabled")}enable_primary_action(){this.get_primary_btn().removeClass("disabled")}make_head(){this.set_title(this.title)}set_title(t){this.$wrapper.find(".modal-title").html(t)}set_indicator(){this.indicator&&this.header.find(".indicator").removeClass().addClass("indicator "+this.indicator)}show(){return this.animate?this.$wrapper.addClass("fade"):this.$wrapper.removeClass("fade"),this.$wrapper.modal("show"),this.$wrapper.removeClass("modal-minimize"),this.minimizable&&this.is_minimized&&($(".modal-backdrop").toggle(),this.is_minimized=!1),this.clear_message(),this.primary_action_fulfilled=!1,this.is_visible=!0,this}hide(){this.$wrapper.modal("hide"),this.is_visible=!1}get_close_btn(){return this.$wrapper.find(".btn-modal-close")}get_secondary_btn(){return this.standard_actions.find(".btn-modal-secondary")}no_cancel(){this.get_close_btn().toggle(!1)}cancel(){this.get_close_btn().trigger("click")}toggle_minimize(){$(".modal-backdrop").toggle();let t=this.$wrapper.closest(".modal").toggleClass("modal-minimize");t.attr("tabindex")?t.removeAttr("tabindex"):t.attr("tabindex",-1),this.is_minimized=!this.is_minimized;let e=this.is_minimized?"expand":"collapse";this.get_minimize_btn().html(frappe.utils.icon(e)),this.on_minimize_toggle&&this.on_minimize_toggle(this.is_minimized),this.header.find(".modal-title").toggleClass("cursor-pointer"),this.hide_scrollbar(!this.is_minimized)}hide_scrollbar(t){$("body").css("overflow",t?"hidden":"auto")}add_custom_action(t,e,r=null){this.footer.removeClass("hide");let n=$(`
			<button class="btn btn-secondary btn-sm ${r||""}">
				${t}
			</button>
		`);this.custom_actions.append(n),e&&n.click(e)}};frappe.ui.hide_open_dialog=()=>{window.cur_dialog&&(cur_dialog.minimizable?cur_dialog.is_minimized||cur_dialog.toggle_minimize():cur_dialog.hide())};frappe.provide("frappe.messages");frappe.messages.waiting=function(i,t){return $(frappe.messages.get_waiting_message(t)).appendTo(i)};frappe.messages.get_waiting_message=function(i){return repl('<div class="msg-box" style="width: 63%; margin: 30px auto;">		<p class="text-center">%(msg)s</p></div>',{msg:i})};frappe.throw=function(i){throw typeof i=="string"&&(i={message:i,title:__("Error")}),i.indicator||(i.indicator="red"),frappe.msgprint(i),new Error(i.message)};frappe.confirm=function(i,t,e){var r=new frappe.ui.Dialog({title:__("Confirm",null,"Title of confirmation dialog"),primary_action_label:__("Yes",null,"Approve confirmation dialog"),primary_action:()=>{t&&t(),r.hide()},secondary_action_label:__("No",null,"Dismiss confirmation dialog"),secondary_action:()=>r.hide()});return r.$body.append(`<p class="frappe-confirm-message">${i}</p>`),r.show(),r.confirm_dialog=!0,e&&(r.onhide=()=>{r.primary_action_fulfilled||e()}),r};frappe.warn=function(i,t,e,r,n){let a=new frappe.ui.Dialog({title:i,indicator:"red",primary_action_label:r,primary_action:()=>{e&&e(),a.hide()},secondary_action_label:__("Cancel",null,"Secondary button in warning dialog"),secondary_action:()=>a.hide(),minimizable:n});return a.$body.append(`<div class="frappe-confirm-message">${t}</div>`),a.standard_actions.find(".btn-primary").removeClass("btn-primary").addClass("btn-danger"),a.show(),a};frappe.prompt=function(i,t,e,r){typeof i=="string"&&(i=[{label:i,fieldname:"value",fieldtype:"Data",reqd:1}]),$.isArray(i)||(i=[i]);var n=new frappe.ui.Dialog({fields:i,title:e||__("Enter Value",null,"Title of prompt dialog")});return n.set_primary_action(r||__("Submit",null,"Primary action of prompt dialog"),function(){var a=n.get_values();!a||(n.hide(),t(a))}),n.show(),n};frappe.msgprint=function(i,t,e){if(!!i){if($.isPlainObject(i))var r=i;else if(typeof i=="string"&&i.substr(0,1)==="{")var r=JSON.parse(i);else var r={message:i,title:t};if(r.indicator||(r.indicator="blue"),r.as_list){let a=r.message.map(s=>`<li>${s}</li>`).join("");r.message=`<ul style="padding-left: 20px">${a}</ul>`}if(r.as_table){let a=r.message.map(s=>`<tr>${s.map(l=>`<td>${l}</td>`).join("")}</tr>`).join("");r.message=`<table class="table table-bordered" style="margin: 0;">${a}</table>`}if(r.message instanceof Array){let a=r.message,s=a.map(o=>JSON.parse(o)).filter(o=>o.raise_exception);s.length&&(a=s),a.forEach(function(o){frappe.msgprint(o)});return}if(r.alert||r.toast){frappe.show_alert(r);return}if(frappe.msg_dialog||(frappe.msg_dialog=new frappe.ui.Dialog({title:__("Message"),onhide:function(){frappe.msg_dialog.custom_onhide&&frappe.msg_dialog.custom_onhide(),frappe.msg_dialog.msg_area.empty()},minimizable:r.is_minimizable||e}),frappe.msg_dialog.msg_area=$('<div class="msgprint">').appendTo(frappe.msg_dialog.body),frappe.msg_dialog.clear=function(){frappe.msg_dialog.msg_area.empty()},frappe.msg_dialog.indicator=frappe.msg_dialog.header.find(".indicator")),r.primary_action){if(r.primary_action.server_action&&typeof r.primary_action.server_action=="string"&&(r.primary_action.action=()=>{frappe.call({method:r.primary_action.server_action,args:{args:r.primary_action.args},callback(){r.primary_action.hide_on_success&&frappe.hide_msgprint()}})}),r.primary_action.client_action&&typeof r.primary_action.client_action=="string"){let a=r.primary_action.client_action.split("."),s=window;for(let o of a)s=s[o];r.primary_action.action=()=>{typeof s=="function"&&s(r.primary_action.args)}}frappe.msg_dialog.set_primary_action(__(r.primary_action.label||r.primary_action_label||"Done"),r.primary_action.action)}else frappe.msg_dialog.has_primary_action&&(frappe.msg_dialog.get_primary_btn().addClass("hide"),frappe.msg_dialog.has_primary_action=!1);r.secondary_action&&(frappe.msg_dialog.set_secondary_action(r.secondary_action.action),frappe.msg_dialog.set_secondary_action_label(__(r.secondary_action.label||"Close"))),r.message==null&&(r.message=""),r.message.search(/<br>|<p>|<li>/)==-1&&(i=frappe.utils.replace_newlines(r.message));var n=!1;return r.clear?frappe.msg_dialog.msg_area.empty():n=frappe.msg_dialog.msg_area.html(),(r.title||!n)&&frappe.msg_dialog.set_title(r.title||__("Message",null,"Default title of the message dialog")),r.indicator?frappe.msg_dialog.indicator.removeClass().addClass("indicator "+r.indicator):frappe.msg_dialog.indicator.removeClass().addClass("hidden"),r.wide?frappe.msg_dialog.wrapper.classList.contains("msgprint-dialog")&&frappe.msg_dialog.wrapper.classList.remove("msgprint-dialog"):frappe.msg_dialog.wrapper.classList.add("msgprint-dialog"),n&&frappe.msg_dialog.msg_area.append("<hr>"),frappe.msg_dialog.msg_area.append(r.message),frappe.msg_dialog.$wrapper.css("z-index",2e3),frappe.msg_dialog.show(),frappe.msg_dialog}};window.msgprint=frappe.msgprint;frappe.hide_msgprint=function(i){frappe.msg_dialog&&frappe.msg_dialog.msg_area&&frappe.msg_dialog.msg_area.empty(),frappe.msg_dialog&&frappe.msg_dialog.$wrapper.is(":visible")&&(i&&frappe.msg_dialog.$wrapper.removeClass("fade"),frappe.msg_dialog.hide(),i&&frappe.msg_dialog.$wrapper.addClass("fade"))};frappe.update_msgprint=function(i){!frappe.msg_dialog||frappe.msg_dialog&&!frappe.msg_dialog.$wrapper.is(":visible")?frappe.msgprint(i):frappe.msg_dialog.msg_area.html(i)};frappe.verify_password=function(i){frappe.prompt({fieldname:"password",label:__("Enter your password"),fieldtype:"Password",reqd:1},function(t){frappe.call({method:"frappe.core.doctype.user.user.verify_password",args:{password:t.password},callback:function(e){e.exc||i()}})},__("Verify Password"),__("Verify"))};frappe.show_progress=(i,t,e=100,r,n=!1)=>{let a;return frappe.cur_progress&&frappe.cur_progress.title===i&&frappe.cur_progress.is_visible?a=frappe.cur_progress:(a=new frappe.ui.Dialog({title:i}),a.progress=$(`<div>
			<div class="progress">
				<div class="progress-bar"></div>
			</div>
			<p class="description text-muted small"></p>
		</div`).appendTo(a.body),a.progress_bar=a.progress.css({"margin-top":"10px"}).find(".progress-bar"),a.$wrapper.removeClass("fade"),a.show(),frappe.cur_progress=a),r&&a.progress.find(".description").text(r),a.percent=cint(flt(t)*100/e),a.progress_bar.css({width:a.percent+"%"}),n&&a.percent===100&&setTimeout(frappe.hide_progress,500),a};frappe.hide_progress=function(){frappe.cur_progress&&(frappe.cur_progress.hide(),frappe.cur_progress=null)};frappe.show_alert=frappe.toast=function(i,t=7,e={}){let r={orange:"solid-warning",yellow:"solid-warning",blue:"solid-info",green:"solid-success",red:"solid-error"};typeof i=="string"&&(i={message:i}),$("#dialog-container").length||$('<div id="dialog-container"><div id="alert-container"></div></div>').appendTo("body");let n;i.indicator?n=r[i.indicator.toLowerCase()]||"solid-"+i.indicator:n="solid-info";let a=i.indicator||"blue",s=$(`
		<div class="alert desk-alert ${a}" role="alert">
			<div class="alert-message-container">
				<div class="alert-title-container">
					<div>${frappe.utils.icon(n,"lg")}</div>
					<div class="alert-message">${i.message}</div>
				</div>
				<div class="alert-subtitle">${i.subtitle||""}</div>
			</div>
			<div class="alert-body" style="display: none"></div>
			<a class="close">${frappe.utils.icon("close-alt")}</a>
		</div>
	`);return s.hide().appendTo("#alert-container").show(),i.body&&s.find(".alert-body").show().html(i.body),s.find(".close, button").click(function(){return s.addClass("out"),setTimeout(()=>s.remove(),800),!1}),Object.keys(e).map(o=>{s.find(`[data-action=${o}]`).on("click",e[o])}),t>2&&(t=t-.8),setTimeout(()=>(s.addClass("out"),setTimeout(()=>s.remove(),800),!1),t*1e3),s};Object.defineProperty(window,"show_alert",{get:function(){return console.warn("Please use `frappe.show_alert` instead of `show_alert`. It will be deprecated soon."),frappe.show_alert}});frappe.provide("frappe.ui.keys");var Pr=new WeakMap,Cs=[];frappe.ui.keys.shortcut_groups=Pr;frappe.ui.keys.get_shortcut_group=i=>(Pr.has(i)||Pr.set(i,new frappe.ui.keys.AltShortcutGroup),Pr.get(i));var xs=!1,jt=null,Gn=$(document.body);frappe.ui.keys.bind_shortcut_group_event=()=>{if(xs)return;xs=!0;function i(){jt?(jt.addClass("alt-pressed"),Gn.removeClass("alt-pressed")):(Gn.addClass("alt-pressed"),jt&&jt.removeClass("alt-pressed"))}function t(){jt&&jt.removeClass("alt-pressed"),Gn.removeClass("alt-pressed")}$(document).on("keydown",e=>{let r=(frappe.ui.keys.key_map[e.which]||"").toLowerCase();if(r==="alt"&&i(),!(e.shiftKey||e.ctrlKey||e.metaKey)&&r&&e.altKey){let n=yp(r);n&&(e.preventDefault(),n.$target[0].click()),i()}}),$(document).on("keyup",e=>{e.key==="Alt"&&t()}),$(document).on("mousemove",()=>{t()})};function yp(i){let t=Cs.filter(r=>i in r.shortcuts_dict).map(r=>r.shortcuts_dict[i]).filter(r=>r.$target.is(":visible")),e=null;return jt&&jt.is(".open")&&(e=t.find(r=>$.contains(jt[0],r.$target[0]))),e||(e=t.find(r=>$.contains(window.cur_page.page.page.wrapper[0],r.$target[0])),e)}frappe.ui.keys.AltShortcutGroup=class{constructor(){this.shortcuts_dict={},jt=null,this.bind_events(),frappe.ui.keys.bind_shortcut_group_event(),Cs.push(this)}bind_events(){$(document).on("show.bs.dropdown",t=>{jt&&jt.removeClass("alt-pressed");let e=$(t.target);e.is(".dropdown, .btn-group")&&(jt=e)}),$(document).on("hide.bs.dropdown",()=>{jt&&jt.removeClass("alt-pressed"),jt=null})}add(t,e){e||(e=t);let r=e.text().trim(),a=r.split("").find(o=>{o=o.toLowerCase();let l=o>="a"&&o<="z";return!this.is_taken(o)&&l});if(!a){e.attr("data-label",encodeURIComponent(r));return}for(let o in this.shortcuts_dict){let l=this.shortcuts_dict[o];if(l.text===r){l.$target=t,l.$text_el=e,this.underline_text(l);return}}let s={$target:t,$text_el:e,letter:a,text:r};this.shortcuts_dict[a.toLowerCase()]=s,this.underline_text(s)}underline_text(t){t.$text_el.attr("data-label",encodeURIComponent(t.text));let e=!1,r=t.text.split("").map(a=>(a===t.letter&&!e&&(a=`<span class="alt-underline">${a}</span>`,e=!0),a)).join("");r=t.$text_el.html().replace(t.text.trim(),r.trim()),t.$text_el.html(r)}is_taken(t){let e=frappe.ui.keys.standard_shortcuts.filter(r=>!r.page).some(r=>r.shortcut===`alt+${t}`);return t in this.shortcuts_dict||e}};frappe.provide("frappe.ui.keys.handlers");frappe.ui.keys.setup=function(){$(window).on("keydown",function(i){var t=frappe.ui.keys.get_key(i);if(frappe.ui.keys.handlers[t]){for(var e=null,r=0,n=frappe.ui.keys.handlers[t].length;r<n;r++){var a=frappe.ui.keys.handlers[t][r],s=a.apply(this,[i]);s===!1&&(e=s)}return e}})};var Ei=[];frappe.ui.keys.standard_shortcuts=Ei;frappe.ui.keys.add_shortcut=({shortcut:i,action:t,description:e,page:r,target:n,condition:a,ignore_inputs:s=!1}={})=>{if(n instanceof jQuery){let c=n;t=()=>{c[0].click()}}a||(a=()=>!0);let o=c=>{if(!($(document.activeElement).is("input, select, textarea, [contenteditable=true]")&&!s)&&!!a()&&t&&(!r||r.wrapper.is(":visible"))){let g=t(c);(g||g===void 0)&&c.preventDefault()}};o.page=r,frappe.ui.keys.off(i,r),frappe.ui.keys.on(i,o);let l=Ei.findIndex(c=>c.shortcut===i),u={shortcut:i,action:t,description:e,page:r,condition:a};l===-1?Ei.push(u):Ei[l]=u};frappe.ui.keys.show_keyboard_shortcut_dialog=()=>{if(frappe.ui.keys.is_dialog_shown)return;let i=Ei.filter(l=>!l.page),t=Ei.filter(l=>l.page&&l.page===window.cur_page.page.page),e=Ei.filter(l=>l.page&&l.page===window.cur_page.page.frm);function r(l,u){if(!l.length)return"";let c=l.filter(h=>h.condition?h.condition():!0).filter(h=>!!h.description).map(h=>{let p=h.shortcut.split("+").map(frappe.utils.to_title_case).join("+");return frappe.utils.is_mac()&&(p=p.replace("Ctrl","\u2318")),`<tr>
					<td width="40%"><kbd>${p}</kbd></td>
					<td width="60%">${h.description||""}</td>
				</tr>`}).join("");return c?(c=`<h5 style="margin: 0;">${u}</h5>
			<table style="margin-top: 10px;" class="table table-bordered">
				${c}
			</table>`,c):""}let n=r(i,__("Global Shortcuts")),a=r(t,__("Page Shortcuts")),s=r(e,__("Grid Shortcuts")),o=new frappe.ui.Dialog({title:__("Keyboard Shortcuts"),on_hide(){frappe.ui.keys.is_dialog_shown=!1}});o.$body.append(n),o.$body.append(a),o.$body.append(s),o.$body.append(`
		<div class="text-muted">
			${__("Press Alt Key to trigger additional shortcuts in Menu and Sidebar")}
		</div>
	`),o.show(),frappe.ui.keys.is_dialog_shown=!0};frappe.ui.keys.get_key=function(i){var t=i.keyCode||i.which,e=frappe.ui.keys.key_map[t]||String.fromCharCode(t);return(i.ctrlKey||i.metaKey)&&(e="ctrl+"+e),i.shiftKey&&(e="shift+"+e),i.altKey&&(e="alt+"+e),i.altKey&&i.ctrlKey,e.toLowerCase()};frappe.ui.keys.on=function(i,t){frappe.ui.keys.handlers[i]||(frappe.ui.keys.handlers[i]=[]),frappe.ui.keys.handlers[i].push(t)};frappe.ui.keys.off=function(i,t){let e=frappe.ui.keys.handlers[i];!e||e.length===0||(frappe.ui.keys.handlers[i]=e.filter(r=>t?r.page!==t:!1))};frappe.ui.keys.add_shortcut({shortcut:"ctrl+s",action:function(i){return frappe.app.trigger_primary_action(),i.preventDefault(),!1},description:__("Trigger Primary Action"),ignore_inputs:!0});frappe.ui.keys.add_shortcut({shortcut:"ctrl+g",action:function(i){return $("#navbar-search").focus(),i.preventDefault(),!1},description:__("Open Awesomebar")});frappe.ui.keys.add_shortcut({shortcut:"ctrl+h",action:function(i){i.preventDefault(),$(".navbar-home img").click()},description:__("Navigate Home")});frappe.ui.keys.add_shortcut({shortcut:"alt+s",action:function(i){i.preventDefault(),$(".dropdown-navbar-user a").eq(0).click()},description:__("Open Settings")});frappe.ui.keys.add_shortcut({shortcut:"shift+/",action:function(){frappe.ui.keys.show_keyboard_shortcut_dialog()},description:__("Show Keyboard Shortcuts")});frappe.ui.keys.add_shortcut({shortcut:"alt+h",action:function(i){i.preventDefault(),$(".dropdown-help a").eq(0).click()},description:__("Open Help")});frappe.ui.keys.on("escape",function(i){Ss()});frappe.ui.keys.on("esc",function(i){Ss()});frappe.ui.keys.on("enter",function(i){window.cur_dialog&&cur_dialog.confirm_dialog&&cur_dialog.get_primary_btn().trigger("click")});frappe.ui.keys.on("ctrl+down",function(i){var t=frappe.ui.form.get_open_grid_form();t&&t.toggle_view(!1,function(){t.open_next()})});frappe.ui.keys.on("ctrl+up",function(i){var t=frappe.ui.form.get_open_grid_form();t&&t.toggle_view(!1,function(){t.open_prev()})});frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+r",action:function(){frappe.ui.toolbar.clear_cache()},description:__("Clear Cache and Reload")});frappe.ui.keys.key_map={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",91:"meta",18:"alt",27:"escape",37:"left",39:"right",38:"up",40:"down",32:"space",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",191:"/",188:"<",190:">"};"abcdefghijklmnopqrstuvwxyz".split("").forEach((i,t)=>{frappe.ui.keys.key_map[65+t]=i});frappe.ui.keyCode={ESCAPE:27,LEFT:37,RIGHT:39,UP:38,DOWN:40,ENTER:13,TAB:9,SPACE:32,BACKSPACE:8};function Ss(){var i;wp(),(i=document.activeElement)==null||i.blur()}function wp(){var i=$(".grid-row-open");if(i.length){var t=i.data("grid_row");return t.toggle_view(!1),!1}if(cur_dialog&&!cur_dialog.no_cancel_flag&&!cur_dialog.static)return cur_dialog.cancel(),!1}frappe.provide("frappe.ui");frappe.ui.color={get:function(i,t){return i&&t?this.get_color_shade(i,t):i?this.get_color_shade(i,"default"):frappe.ui.color_map},get_color:function(i){let t=Object.keys(frappe.ui.color_map);if(t.includes(i))return frappe.ui.color_map[i];console.warn(`'color_name' can be one of ${t} and not ${i}`)},get_color_map(){let i=["red","green","blue","dark-green","yellow","gray","purple","pink","orange"],t=["100","300","500","700"],e=getComputedStyle(document.body),r={};return i.forEach(n=>{r[n]=t.map(a=>e.getPropertyValue(`--${n}-${a}`).trim())}),r},get_color_shade:function(i,t){let e={default:2,light:1,"extra-light":0,dark:3};if(Object.keys(e).includes(t)){let r=this.get_color(i);return r?r[e[t]]:i}else console.warn(`'shade' can be one of ${Object.keys(e)} and not ${t}`)},all:function(){return Object.values(frappe.ui.color_map).reduce((i,t)=>i.concat(t),[])},names:function(){return Object.keys(frappe.ui.color_map)},is_standard:function(i){return i?i.startsWith("#")?this.all().includes(i):this.names().includes(i):!1},get_color_name:function(i){for(let t in frappe.ui.color_map)if(frappe.ui.color_map[t].includes(i))return t},get_contrast_color:function(i){if(!this.validate_hex(i))return;if(!this.is_standard(i))return this.brightness(i)<128?this.lighten(i,.5):this.lighten(i,-.5);let t=this.get_color_name(i);return this.get_color(t).indexOf(i)<=1?this.get(t,"dark"):this.get(t,"extra-light")},validate_hex:function(i){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(i)},lighten(i,t){var e=parseInt(i.slice(1),16),r=t<0?0:255,n=t<0?t*-1:t,a=e>>16,s=e>>8&255,o=e&255;return"#"+(16777216+(Math.round((r-a)*n)+a)*65536+(Math.round((r-s)*n)+s)*256+(Math.round((r-o)*n)+o)).toString(16).slice(1)},hex_to_rgb(i){i.startsWith("#")&&(i=i.substring(1));let t=parseInt(i.substring(0,2),16),e=parseInt(i.substring(2,4),16),r=parseInt(i.substring(4,6),16);return{r:t,g:e,b:r}},brightness(i){let t=this.hex_to_rgb(i);return(t.r*299+t.g*587+t.b*114)/1e3}};frappe.ui.color_map=frappe.ui.color.get_color_map();frappe.provide("frappe.ui");frappe.ui.Sidebar=class{constructor({wrapper:t,css_class:e}){this.wrapper=t,this.css_class=e,this.items={},this.make_dom()}make_dom(){this.wrapper.html(`
			<div class="${this.css_class} overlay-sidebar hidden-xs hidden-sm">
			</div>
		`),this.$sidebar=this.wrapper.find("."+this.css_class)}add_item(t,e,r=!1){let n,a;if(!e&&this.wrapper.find(".sidebar-menu").length===0?n=this.get_section():n=this.get_section(e),t instanceof jQuery)a=$("<li>"),t.appendTo(a);else{let o=`<li class=${r?"h6":""}>
				<a ${t.href?`href="${t.href}"`:""}>${t.label}</a>
			</li>`;a=$(o).click(()=>t.on_click&&t.on_click())}n.append(a),t.name&&(this.items[t.name]=a)}remove_item(t){this.items[t]&&this.items[t].remove()}get_section(t=""){let e=$(this.wrapper.find(`[data-section-heading="${t}"]`));if(e.length)return e;let r=t?`<li class="h6">${t}</li>`:"";return e=$(`
			<ul class="list-unstyled sidebar-menu" data-section-heading="${t||"default"}">
				${r}
			</ul>
		`),this.$sidebar.append(e),e}};frappe.ui.LinkPreview=class{constructor(){this.popovers_list=[],this.LINK_CLASSES='a[data-doctype], input[data-fieldtype="Link"], .popover',this.popover_timeout=null,this.setup_events()}setup_events(){$(document.body).on("mouseover",this.LINK_CLASSES,i=>{this.link_hovered=!0,this.element=$(i.currentTarget),this.is_link=this.element.get(0).tagName.toLowerCase()==="a",this.element.parents().find(".popover").length||(this.identify_doc(),this.popover=this.element.data("bs.popover"),this.name&&this.doctype&&this.setup_popover_control(i))}),this.handle_popover_hide()}identify_doc(){this.is_link?(this.doctype=this.element.attr("data-doctype"),this.name=this.element.attr("data-name"),this.href=this.element.attr("href")):(this.href=this.element.parents(".control-input-wrapper").find(".control-value a").attr("href"),this.doctype=this.element.attr("data-target"),this.name=this.element.val())}setup_popover_control(i){!(frappe.boot.link_preview_doctypes||[]).includes(this.doctype)||(this.element.on("change",()=>{this.new_popover=!0}),!this.popover||this.new_popover?this.data_timeout=setTimeout(()=>{this.create_popover(i)},100):this.popover_timeout=setTimeout(()=>{this.element.is(":focus")||this.show_popover(i)},1e3))}create_popover(i){this.new_popover=!1,!this.element.is(":focus")&&this.get_preview_data().then(t=>{t&&(this.popover_timeout&&clearTimeout(this.popover_timeout),this.popover_timeout=setTimeout(()=>{if(this.popover&&this.popover.options){let e=this.get_popover_html(t);this.popover.options.content=e}else this.init_preview_popover(t);this.show_popover(i)},1e3))})}show_popover(i){if(this.default_timeout=setTimeout(()=>{this.clear_all_popovers()},1e4),this.is_link)this.element.popover("show");else{var t=i.pageX;this.element.popover("show");var e=$(".popover").width();$(".control-field-popover").css("left",t-e/2+"px")}}handle_popover_hide(){$(document).on("mouseout",this.LINK_CLASSES,()=>{$(".popover:hover").length||(this.link_hovered=!1),this.link_hovered||(this.data_timeout&&clearTimeout(this.data_timeout),this.popover_timeout&&clearTimeout(this.popover_timeout),this.default_timeout&&clearTimeout(this.default_timeout),this.clear_all_popovers())}),frappe.router.on("change",()=>{this.clear_all_popovers()})}clear_all_popovers(){this.popovers_list.forEach(i=>i.hide())}get_preview_data(){return frappe.xcall("frappe.desk.link_preview.get_preview_data",{doctype:this.doctype,docname:this.name})}init_preview_popover(i){let t=this.get_popover_html(i);this.element.popover({container:"body",template:`
				<div class="link-preview-popover popover">
					<div class="arrow"></div>
					<div class="popover-body popover-content">
					</div>
				</div>
			`,html:!0,sanitizeFn:r=>r,content:t,trigger:"manual",placement:"top"}),$(this.element.data("bs.popover").tip).toggleClass("control-field-popover",this.is_link),this.popovers_list.push(this.element.data("bs.popover"))}get_popover_html(i){return this.href||(this.href=window.location.href),this.href&&this.href.includes(" ")&&(this.href=this.href.replace(new RegExp(" ","g"),"%20")),`
			<div class="preview-popover-header">
				<div class="preview-header">
					${this.get_image_html(i)}
					<div class="preview-name">
						<a href=${this.href}>${__(i.preview_title)}</a>
					</div>
					<div class="text-muted preview-title">${this.get_id_html(i)}</div>
				</div>
			</div>
			<hr>
			<div class="popover-body">
				${this.get_content_html(i)}
			</div>
		`}get_id_html(i){let t="";return i.preview_title!==i.name&&(t=`<a class="text-muted" href=${this.href}>${i.name}</a>`),t}get_image_html(i){return`<div class="preview-image">
			${frappe.get_avatar("avatar-medium",i.preview_title,i.preview_image)}
		</div>`}get_content_html(i){let t="";return Object.keys(i).forEach(e=>{if(!["preview_image","preview_title","name"].includes(e)){let r=frappe.ellipsis(i[e],280),n=e;t+=`
					<div class="preview-field">
						<div class="preview-label text-muted">${__(n)}</div>
						<div class="preview-value">${r}</div>
					</div>
				`}}),`<div class="preview-table">${t}</div>`}};frappe.provide("frappe.request");frappe.provide("frappe.request.error_handlers");frappe.request.url="/";frappe.request.ajax_count=0;frappe.request.waiting_for_ajax=[];frappe.request.logs={};frappe.xcall=function(i,t){return new Promise((e,r)=>{frappe.call({method:i,args:t,callback:n=>{e(n.message)},error:n=>{r(n.message)}})})};frappe.call=function(i){if(!frappe.is_online())return frappe.show_alert({indicator:"orange",message:__("Connection Lost"),subtitle:__("You are not connected to Internet. Retry after sometime.")},3),i.always&&i.always(),$.ajax();typeof arguments[0]=="string"&&(i={method:arguments[0],args:arguments[1],callback:arguments[2],headers:arguments[3]}),i.quiet&&(i.no_spinner=!0);var t=$.extend({},i.args);t.freeze&&(i.freeze=i.freeze||t.freeze,i.freeze_message=i.freeze_message||t.freeze_message),i.module&&i.page?t.cmd=i.module+".page."+i.page+"."+i.page+"."+i.method:i.doc?$.extend(t,{cmd:"run_doc_method",docs:frappe.get_doc(i.doc.doctype,i.doc.name),method:i.method,args:i.args}):i.method&&(t.cmd=i.method);var e=function(n,a){if(n.task_id)frappe.socketio.subscribe(n.task_id,i),i.queued&&i.queued(n);else if(i.callback)return i.callback(n,a)};let r=i.url;if(!r){if(r="/api/method/"+t.cmd,window.cordova){let n=frappe.request.url;n=n.slice(0,n.length-1),r=n+r}delete t.cmd}return i.debounce&&frappe.request.is_fresh(t,i.debounce)?Promise.resolve():frappe.request.call({type:i.type||"POST",args:t,success:e,error:i.error,always:i.always,btn:i.btn,freeze:i.freeze,freeze_message:i.freeze_message,headers:i.headers||{},error_handlers:i.error_handlers||{},async:i.async,silent:i.silent,url:r})};frappe.request.call=function(i){frappe.request.prepare(i);var t={200:function(n,a){i.success_callback&&i.success_callback(n,a.responseText)},401:function(n){frappe.app.session_expired_dialog&&frappe.app.session_expired_dialog.display?frappe.app.redirect_to_login():frappe.app.handle_session_expired()},404:function(n){frappe.flags.setting_original_route?frappe.app.redirect_to_login():frappe.msgprint({title:__("Not found"),indicator:"red",message:__("The resource you are looking for is not available")})},403:function(n){if(frappe.session.user==="Guest"&&frappe.session.logged_in_user!=="Guest")frappe.app.handle_session_expired();else if(n.responseJSON&&n.responseJSON._error_message)frappe.msgprint({title:__("Not permitted"),indicator:"red",message:n.responseJSON._error_message}),n.responseJSON._server_messages=null;else if(n.responseJSON&&n.responseJSON._server_messages){var a=JSON.parse(n.responseJSON._server_messages);if(a.indexOf(__("Not permitted"))!==-1)return}else frappe.msgprint({title:__("Not permitted"),indicator:"red",message:__("You do not have enough permissions to access this resource. Please contact your manager to get access.")})},508:function(n){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Please try again"),indicator:"red",message:__("Another transaction is blocking this one. Please try again in a few seconds.")})},413:function(n,a){frappe.msgprint({indicator:"red",title:__("File too big"),message:__("File size exceeded the maximum allowed size of {0} MB",[(frappe.boot.max_file_size||5242880)/1048576])})},417:function(n){var a=n.responseJSON;if(!a)try{a=JSON.parse(n.responseText)}catch(s){a=n.responseText}i.error_callback&&i.error_callback(a)},501:function(n,a){typeof n=="string"&&(n=JSON.parse(n)),i.error_callback&&i.error_callback(n,a.responseText)},500:function(n){frappe.utils.play_sound("error");try{i.error_callback&&i.error_callback(),frappe.request.report_error(n,i)}catch(a){frappe.request.report_error(n,i)}},504:function(n){frappe.msgprint(__("Request Timed Out")),i.error_callback&&i.error_callback()},502:function(n){frappe.msgprint(__("Internal Server Error"))}},e={QueryTimeoutError:function(){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Request Timeout"),indicator:"red",message:__("Server was too busy to process this request. Please try again.")})},QueryDeadlockError:function(){frappe.utils.play_sound("error"),frappe.msgprint({title:__("Deadlock Occurred"),indicator:"red",message:__("Server was too busy to process this request. Please try again.")})}},r={url:i.url||frappe.request.url,data:i.args,type:i.type,dataType:i.dataType||"json",async:i.async,headers:Object.assign({"X-Frappe-CSRF-Token":frappe.csrf_token,Accept:"application/json","X-Frappe-CMD":i.args&&i.args.cmd||""||""},i.headers),cache:!1};return i.args&&i.args.doctype&&(r.headers["X-Frappe-Doctype"]=encodeURIComponent(i.args.doctype)),frappe.last_request=r.data,$.ajax(r).done(function(n,a,s){try{typeof n=="string"&&(n=JSON.parse(n)),(n.docs||n.docinfo)&&frappe.model.sync(n),n.__messages&&$.extend(frappe._messages,n.__messages),n._link_titles&&(frappe._link_titles||(frappe._link_titles={}),$.extend(frappe._link_titles,n._link_titles));var o=t[s.statusCode().status];o&&o(n,s)}catch(l){console.log("Unable to handle success response",n),console.error(l)}}).always(function(n,a,s){try{if(typeof n=="string"&&(n=JSON.parse(n)),n.responseText){var s=n;n=JSON.parse(n.responseText)}}catch(o){n=null}frappe.request.cleanup(i,n),i.always&&i.always(n)}).fail(function(n,a){try{if(n.getResponseHeader("content-type")=="application/json"&&n.responseText){var s;try{s=JSON.parse(n.responseText)}catch(c){console.log("Unable to parse reponse text"),console.log(n.responseText),console.log(c)}if(s&&s.exception){var o=s.exception.split(".").at(-1).split(":").at(0),l=e[o];if(l){l(s);return}}}var u=t[n.statusCode().status];if(u){u(n);return}i.error_callback&&i.error_callback(n)}catch(c){console.log("Unable to handle failed response"),console.error(c)}})};frappe.request.is_fresh=function(i,t){frappe.request.logs[i.cmd]||(frappe.request.logs[i.cmd]=[]);for(let e of frappe.request.logs[i.cmd])if(new Date-e.timestamp<t&&frappe.utils.deep_equal(i,e.args))return console.log("throttled"),!0;return frappe.request.logs[i.cmd].push({args:i,timestamp:new Date}),!1};frappe.request.prepare=function(i){$("body").attr("data-ajax-state","triggered"),i.btn&&$(i.btn).prop("disabled",!0),i.freeze&&frappe.dom.freeze(i.freeze_message);for(var t in i.args)i.args[t]&&($.isPlainObject(i.args[t])||$.isArray(i.args[t]))&&(i.args[t]=JSON.stringify(i.args[t]));if(!i.args.cmd&&!i.url)throw console.log(i),"Incomplete Request";i.success_callback=i.success,i.error_callback=i.error,delete i.success,delete i.error};frappe.request.cleanup=function(i,t){if(i.btn&&$(i.btn).prop("disabled",!1),$("body").attr("data-ajax-state","complete"),i.freeze&&frappe.dom.unfreeze(),t){if(t.session_expired||frappe.session.user==="Guest"&&frappe.session.logged_in_user!=="Guest"){frappe.app.handle_session_expired();return}let e=frappe.request.error_handlers[t.exc_type]||[],r=i.error_handlers?i.error_handlers[t.exc_type]:null,n=[].concat(e,r).filter(Boolean);t.exc_type&&n.forEach(a=>{a(t)}),t._server_messages&&!i.silent&&n.length===0&&(t._server_messages=JSON.parse(t._server_messages),frappe.hide_msgprint(),frappe.msgprint(t._server_messages)),t.exc&&(t.exc=JSON.parse(t.exc),t.exc instanceof Array?t.exc.forEach(a=>{a&&console.error(a)}):console.error(t.exc)),t._debug_messages&&(i.args&&(console.log("======== arguments ========"),console.log(i.args),console.log("========")),$.each(JSON.parse(t._debug_messages),function(a,s){console.log(s)}),console.log("======== response ========"),delete t._debug_messages,console.log(t),console.log("========"))}frappe.last_response=t};frappe.after_server_call=()=>frappe.request.ajax_count?new Promise(i=>{frappe.request.waiting_for_ajax.push(()=>{i()})}):null;frappe.after_ajax=function(i){return new Promise(t=>{if(frappe.request.ajax_count)frappe.request.waiting_for_ajax.push(()=>{if(i)return t(i());t()});else{if(i)return t(i());t()}})};frappe.request.report_error=function(i,t){var e=JSON.parse(i.responseText),r;if(e.exc){try{r=(JSON.parse(e.exc)||[]).join(`
`)}catch(o){r=e.exc}delete e.exc}else r="";let n=()=>{let o=u=>"```\n"+u+"\n```",l=["### App Versions",o(JSON.stringify(frappe.boot.versions,null,"	")),"### Route",o(frappe.get_route_str()),"### Trackeback",o(r),"### Request Data",o(JSON.stringify(t,null,"	")),"### Response Data",o(JSON.stringify(e,null,"	"))].join(`
`);frappe.utils.copy_to_clipboard(l)};var a=function(){var o=["<h5>Please type some additional information that could help us reproduce this issue:</h5>",'<div style="min-height: 100px; border: 1px solid #bbb; 				border-radius: 5px; padding: 15px; margin-bottom: 15px;"></div>',"<hr>","<h5>App Versions</h5>","<pre>"+JSON.stringify(frappe.boot.versions,null,"	")+"</pre>","<h5>Route</h5>","<pre>"+frappe.get_route_str()+"</pre>","<hr>","<h5>Error Report</h5>","<pre>"+r+"</pre>","<hr>","<h5>Request Data</h5>","<pre>"+JSON.stringify(t,null,"	")+"</pre>","<hr>","<h5>Response JSON</h5>","<pre>"+JSON.stringify(e,null,"	")+"</pre>"].join(`
`),l=new frappe.views.CommunicationComposer({subject:"Error Report ["+frappe.datetime.nowdate()+"]",recipients:s,message:o,doc:{doctype:"User",name:frappe.session.user}});l.dialog.$wrapper.css("z-index",cint(frappe.msg_dialog.$wrapper.css("z-index"))+1)};if(r){var s=frappe.boot.error_report_email;t=frappe.request.cleanup_request_opts(t),frappe.error_dialog||(frappe.error_dialog=new frappe.ui.Dialog({title:__("Server Error"),primary_action_label:__("Report"),primary_action:()=>{s?a():frappe.msgprint(__("Support Email Address Not Specified")),frappe.error_dialog.hide()},secondary_action_label:__("Copy error to clipboard"),secondary_action:()=>{n(),frappe.error_dialog.hide()}}),frappe.error_dialog.wrapper.classList.add("msgprint-dialog"));let o=strip(r).split(`
`);frappe.error_dialog.$body.html(o[o.length-1]),frappe.error_dialog.show()}};frappe.request.cleanup_request_opts=function(i){var t=(i.args||{}).doc;return t&&(t=JSON.parse(t),$.each(Object.keys(t),function(e,r){r.indexOf("password")!==-1&&t[r]&&(t[r]="*****")}),i.args.doc=JSON.stringify(t)),i};frappe.request.on_error=function(i,t){frappe.request.error_handlers[i]=frappe.request.error_handlers[i]||[],frappe.request.error_handlers[i].push(t)};$(document).ajaxSend(function(){frappe.request.ajax_count++});$(document).ajaxComplete(function(){frappe.request.ajax_count--,frappe.request.ajax_count||($.each(frappe.request.waiting_for_ajax||[],function(i,t){t()}),frappe.request.waiting_for_ajax=[])});var si=Object.create(null);si.open="0";si.close="1";si.ping="2";si.pong="3";si.message="4";si.upgrade="5";si.noop="6";var ir=Object.create(null);Object.keys(si).forEach(i=>{ir[si[i]]=i});var Ts={type:"error",data:"parser error"};var kp=typeof Blob=="function"||typeof Blob!="undefined"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",xp=typeof ArrayBuffer=="function",Cp=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,Sp=({type:i,data:t},e,r)=>kp&&t instanceof Blob?e?r(t):Es(t,r):xp&&(t instanceof ArrayBuffer||Cp(t))?e?r(t):Es(new Blob([t]),r):r(si[i]+(t||"")),Es=(i,t)=>{let e=new FileReader;return e.onload=function(){let r=e.result.split(",")[1];t("b"+r)},e.readAsDataURL(i)},Dr=Sp;var As="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rr=typeof Uint8Array=="undefined"?[]:new Uint8Array(256);for(let i=0;i<As.length;i++)rr[As.charCodeAt(i)]=i;var $s=i=>{let t=i.length*.75,e=i.length,r,n=0,a,s,o,l;i[i.length-1]==="="&&(t--,i[i.length-2]==="="&&t--);let u=new ArrayBuffer(t),c=new Uint8Array(u);for(r=0;r<e;r+=4)a=rr[i.charCodeAt(r)],s=rr[i.charCodeAt(r+1)],o=rr[i.charCodeAt(r+2)],l=rr[i.charCodeAt(r+3)],c[n++]=a<<2|s>>4,c[n++]=(s&15)<<4|o>>2,c[n++]=(o&3)<<6|l&63;return u};var Tp=typeof ArrayBuffer=="function",Ep=(i,t)=>{if(typeof i!="string")return{type:"message",data:Os(i,t)};let e=i.charAt(0);return e==="b"?{type:"message",data:Ap(i.substring(1),t)}:ir[e]?i.length>1?{type:ir[e],data:i.substring(1)}:{type:ir[e]}:Ts},Ap=(i,t)=>{if(Tp){let e=$s(i);return Os(e,t)}else return{base64:!0,data:i}},Os=(i,t)=>{switch(t){case"blob":return i instanceof ArrayBuffer?new Blob([i]):i;case"arraybuffer":default:return i}},jr=Ep;var Rs=String.fromCharCode(30),Ls=(i,t)=>{let e=i.length,r=new Array(e),n=0;i.forEach((a,s)=>{Dr(a,!1,o=>{r[s]=o,++n===e&&t(r.join(Rs))})})},Bs=(i,t)=>{let e=i.split(Rs),r=[];for(let n=0;n<e.length;n++){let a=jr(e[n],t);if(r.push(a),a.type==="error")break}return r},Xn=4;function ht(i){if(i)return $p(i)}function $p(i){for(var t in ht.prototype)i[t]=ht.prototype[t];return i}ht.prototype.on=ht.prototype.addEventListener=function(i,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(t),this};ht.prototype.once=function(i,t){function e(){this.off(i,e),t.apply(this,arguments)}return e.fn=t,this.on(i,e),this};ht.prototype.off=ht.prototype.removeListener=ht.prototype.removeAllListeners=ht.prototype.removeEventListener=function(i,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+i];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var r,n=0;n<e.length;n++)if(r=e[n],r===t||r.fn===t){e.splice(n,1);break}return e.length===0&&delete this._callbacks["$"+i],this};ht.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+i],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e){e=e.slice(0);for(var r=0,n=e.length;r<n;++r)e[r].apply(this,t)}return this};ht.prototype.emitReserved=ht.prototype.emit;ht.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};ht.prototype.hasListeners=function(i){return!!this.listeners(i).length};var Zt=(()=>typeof self!="undefined"?self:typeof window!="undefined"?window:Function("return this")())();function zr(i,...t){return t.reduce((e,r)=>(i.hasOwnProperty(r)&&(e[r]=i[r]),e),{})}var Op=setTimeout,Rp=clearTimeout;function mi(i,t){t.useNativeTimers?(i.setTimeoutFn=Op.bind(Zt),i.clearTimeoutFn=Rp.bind(Zt)):(i.setTimeoutFn=setTimeout.bind(Zt),i.clearTimeoutFn=clearTimeout.bind(Zt))}var Lp=1.33;function Is(i){return typeof i=="string"?Bp(i):Math.ceil((i.byteLength||i.size)*Lp)}function Bp(i){let t=0,e=0;for(let r=0,n=i.length;r<n;r++)t=i.charCodeAt(r),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(r++,e+=4);return e}var Ms=class extends Error{constructor(t,e,r){super(t);this.description=e,this.context=r,this.type="TransportError"}},Li=class extends ht{constructor(t){super();this.writable=!1,mi(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,r){return super.emitReserved("error",new Ms(t,e,r)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let e=jr(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}};var js="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Kn=64,Ip={},Ns=0,Fr=0,Ps;function Ds(i){let t="";do t=js[i%Kn]+t,i=Math.floor(i/Kn);while(i>0);return t}function Hr(){let i=Ds(+new Date);return i!==Ps?(Ns=0,Ps=i):i+"."+Ds(Ns++)}for(;Fr<Kn;Fr++)Ip[js[Fr]]=Fr;function qr(i){let t="";for(let e in i)i.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(i[e]));return t}function zs(i){let t={},e=i.split("&");for(let r=0,n=e.length;r<n;r++){let a=e[r].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}var Fs=!1;try{Fs=typeof XMLHttpRequest!="undefined"&&"withCredentials"in new XMLHttpRequest}catch(i){}var Hs=Fs;function Jn(i){let t=i.xdomain;try{if(typeof XMLHttpRequest!="undefined"&&(!t||Hs))return new XMLHttpRequest}catch(e){}if(!t)try{return new Zt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(e){}}function Mp(){}var Np=function(){return new Jn({xdomain:!1}).responseType!=null}(),Zn=class extends Li{constructor(t){super(t);if(this.polling=!1,typeof location!="undefined"){let r=location.protocol==="https:",n=location.port;n||(n=r?"443":"80"),this.xd=typeof location!="undefined"&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==r}let e=t&&t.forceBase64;this.supportsBinary=Np&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";let e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||e()})),this.writable||(r++,this.once("drain",function(){--r||e()}))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){let e=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Bs(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Ls(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{},e=this.opts.secure?"https":"http",r="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Hr()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&(e==="https"&&Number(this.opts.port)!==443||e==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);let n=qr(t),a=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(a?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new oi(this.uri(),t)}doWrite(t,e){let r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",(n,a)=>{this.onError("xhr post error",n,a)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,r)=>{this.onError("xhr poll error",e,r)}),this.pollXhr=t}},oi=class extends ht{constructor(t,e){super();mi(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=e.async!==!1,this.data=e.data!==void 0?e.data:null,this.create()}create(){let t=zr(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;let e=this.xhr=new Jn(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&e.setRequestHeader(r,this.opts.extraHeaders[r])}}catch(r){}if(this.method==="POST")try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}try{e.setRequestHeader("Accept","*/*")}catch(r){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{e.readyState===4&&(e.status===200||e.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof e.status=="number"?e.status:0)},0))},e.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document!="undefined"&&(this.index=oi.requestsCount++,oi.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr=="undefined"||this.xhr===null)){if(this.xhr.onreadystatechange=Mp,t)try{this.xhr.abort()}catch(e){}typeof document!="undefined"&&delete oi.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};oi.requestsCount=0;oi.requests={};if(typeof document!="undefined"){if(typeof attachEvent=="function")attachEvent("onunload",qs);else if(typeof addEventListener=="function"){let i="onpagehide"in Zt?"pagehide":"unload";addEventListener(i,qs,!1)}}function qs(){for(let i in oi.requests)oi.requests.hasOwnProperty(i)&&oi.requests[i].abort()}var Us=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0))(),nr=Zt.WebSocket||Zt.MozWebSocket,Ur=!0,Ws="arraybuffer";var Vs=typeof navigator!="undefined"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",Qn=class extends Li{constructor(t){super(t);this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let t=this.uri(),e=this.opts.protocols,r=Vs?{}:zr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=Ur&&!Vs?e?new nr(t,e):new nr(t):new nr(t,e,r)}catch(n){return this.emitReserved("error",n)}this.ws.binaryType=this.socket.binaryType||Ws,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let r=t[e],n=e===t.length-1;Dr(r,this.supportsBinary,a=>{let s={};Ur||(r.options&&(s.compress=r.options.compress),this.opts.perMessageDeflate&&(typeof a=="string"?Buffer.byteLength(a):a.length)<this.opts.perMessageDeflate.threshold&&(s.compress=!1));try{Ur?this.ws.send(a):this.ws.send(a,s)}catch(o){}n&&Us(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws!="undefined"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{},e=this.opts.secure?"wss":"ws",r="";this.opts.port&&(e==="wss"&&Number(this.opts.port)!==443||e==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Hr()),this.supportsBinary||(t.b64=1);let n=qr(t),a=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(a?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(n.length?"?"+n:"")}check(){return!!nr}};var ea={websocket:Qn,polling:Zn};var Pp=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Dp=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Bi(i){let t=i,e=i.indexOf("["),r=i.indexOf("]");e!=-1&&r!=-1&&(i=i.substring(0,e)+i.substring(e,r).replace(/:/g,";")+i.substring(r,i.length));let n=Pp.exec(i||""),a={},s=14;for(;s--;)a[Dp[s]]=n[s]||"";return e!=-1&&r!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=jp(a,a.path),a.queryKey=zp(a,a.query),a}function jp(i,t){let e=/\/{2,9}/g,r=t.replace(e,"/").split("/");return(t.substr(0,1)=="/"||t.length===0)&&r.splice(0,1),t.substr(t.length-1,1)=="/"&&r.splice(r.length-1,1),r}function zp(i,t){let e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,n,a){n&&(e[n]=a)}),e}var Qt=class extends ht{constructor(t,e={}){super();t&&typeof t=="object"&&(e=t,t=null),t?(t=Bi(t),e.hostname=t.host,e.secure=t.protocol==="https"||t.protocol==="wss",e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=Bi(e.host).host),mi(this,e),this.secure=e.secure!=null?e.secure:typeof location!="undefined"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location!="undefined"?location.hostname:"localhost"),this.port=e.port||(typeof location!="undefined"&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=zs(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let e=Object.assign({},this.opts.query);e.EIO=Xn,e.transport=t,this.id&&(e.sid=this.id);let r=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new ea[t](r)}open(){let t;if(this.opts.rememberUpgrade&&Qt.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch(e){this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",e=>this.onClose("transport close",e))}probe(t){let e=this.createTransport(t),r=!1;Qt.priorWebsocketSuccess=!1;let n=()=>{r||(e.send([{type:"ping",data:"probe"}]),e.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Qt.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(c(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{let p=new Error("probe error");p.transport=e.name,this.emitReserved("upgradeError",p)}}))};function a(){r||(r=!0,c(),e.close(),e=null)}let s=h=>{let p=new Error("probe error: "+h);p.transport=e.name,a(),this.emitReserved("upgradeError",p)};function o(){s("transport closed")}function l(){s("socket closed")}function u(h){e&&h.name!==e.name&&a()}let c=()=>{e.removeListener("open",n),e.removeListener("error",s),e.removeListener("close",o),this.off("close",l),this.off("upgrading",u)};e.once("open",n),e.once("error",s),e.once("close",o),this.once("close",l),this.once("upgrading",u),e.open()}onOpen(){if(this.readyState="open",Qt.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let t=0,e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){let n=this.writeBuffer[r].data;if(n&&(e+=Is(n)),r>0&&e>this.maxPayload)return this.writeBuffer.slice(0,r);e+=2}return this.writeBuffer}write(t,e,r){return this.sendPacket("message",t,e,r),this}send(t,e,r){return this.sendPacket("message",t,e,r),this}sendPacket(t,e,r,n){if(typeof e=="function"&&(n=e,e=void 0),typeof r=="function"&&(n=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let a={type:t,data:e,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),n&&this.once("flush",n),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},r=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}onError(t){Qt.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let e=[],r=0,n=t.length;for(;r<n;r++)~this.transports.indexOf(t[r])&&e.push(t[r]);return e}};Qt.protocol=Xn;var r3=Qt.protocol;function Ys(i,t="",e){let r=i;e=e||typeof location!="undefined"&&location,i==null&&(i=e.protocol+"//"+e.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=e.protocol+i:i=e.host+i),/^(https?|wss?):\/\//.test(i)||(typeof e!="undefined"?i=e.protocol+"//"+i:i="https://"+i),r=Bi(i)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let a=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(e&&e.port===r.port?"":":"+r.port),r}var ra={};gp(ra,{Decoder:()=>Wr,Encoder:()=>Zs,PacketType:()=>rt,protocol:()=>Js});var Fp=typeof ArrayBuffer=="function",Hp=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,Gs=Object.prototype.toString,qp=typeof Blob=="function"||typeof Blob!="undefined"&&Gs.call(Blob)==="[object BlobConstructor]",Up=typeof File=="function"||typeof File!="undefined"&&Gs.call(File)==="[object FileConstructor]";function sr(i){return Fp&&(i instanceof ArrayBuffer||Hp(i))||qp&&i instanceof Blob||Up&&i instanceof File}function ar(i,t){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let e=0,r=i.length;e<r;e++)if(ar(i[e]))return!0;return!1}if(sr(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return ar(i.toJSON(),!0);for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&ar(i[e]))return!0;return!1}function Xs(i){let t=[],e=i.data,r=i;return r.data=ta(e,t),r.attachments=t.length,{packet:r,buffers:t}}function ta(i,t){if(!i)return i;if(sr(i)){let e={_placeholder:!0,num:t.length};return t.push(i),e}else if(Array.isArray(i)){let e=new Array(i.length);for(let r=0;r<i.length;r++)e[r]=ta(i[r],t);return e}else if(typeof i=="object"&&!(i instanceof Date)){let e={};for(let r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=ta(i[r],t));return e}return i}function Ks(i,t){return i.data=ia(i.data,t),i.attachments=void 0,i}function ia(i,t){if(!i)return i;if(i&&i._placeholder)return t[i.num];if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=ia(i[e],t);else if(typeof i=="object")for(let e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=ia(i[e],t));return i}var Js=5,rt;(function(i){i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK"})(rt||(rt={}));var Zs=class{constructor(t){this.replacer=t}encode(t){return(t.type===rt.EVENT||t.type===rt.ACK)&&ar(t)?(t.type=t.type===rt.EVENT?rt.BINARY_EVENT:rt.BINARY_ACK,this.encodeAsBinary(t)):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===rt.BINARY_EVENT||t.type===rt.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){let e=Xs(t),r=this.encodeAsString(e.packet),n=e.buffers;return n.unshift(r),n}},Wr=class extends ht{constructor(t){super();this.reviver=t}add(t){let e;if(typeof t=="string")e=this.decodeString(t),e.type===rt.BINARY_EVENT||e.type===rt.BINARY_ACK?(this.reconstructor=new Qs(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e);else if(sr(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0,r={type:Number(t.charAt(0))};if(rt[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===rt.BINARY_EVENT||r.type===rt.BINARY_ACK){let a=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);let s=t.substring(a,e);if(s!=Number(s)||t.charAt(e)!=="-")throw new Error("Illegal attachments");r.attachments=Number(s)}if(t.charAt(e+1)==="/"){let a=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););r.nsp=t.substring(a,e)}else r.nsp="/";let n=t.charAt(e+1);if(n!==""&&Number(n)==n){let a=e+1;for(;++e;){let s=t.charAt(e);if(s==null||Number(s)!=s){--e;break}if(e===t.length)break}r.id=Number(t.substring(a,e+1))}if(t.charAt(++e)){let a=this.tryParse(t.substr(e));if(Wr.isPayloadValid(r.type,a))r.data=a;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(e){return!1}}static isPayloadValid(t,e){switch(t){case rt.CONNECT:return typeof e=="object";case rt.DISCONNECT:return e===void 0;case rt.CONNECT_ERROR:return typeof e=="string"||typeof e=="object";case rt.EVENT:case rt.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case rt.ACK:case rt.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}},Qs=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let e=Ks(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Yt(i,t,e){return i.on(t,e),function(){i.off(t,e)}}var Wp=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),or=class extends ht{constructor(t,e,r){super();this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,r&&r.auth&&(this.auth=r.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[Yt(t,"open",this.onopen.bind(this)),Yt(t,"packet",this.onpacket.bind(this)),Yt(t,"error",this.onerror.bind(this)),Yt(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Wp.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);let r={type:rt.EVENT,data:e};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let s=this.ids++,o=e.pop();this._registerAckCallback(s,o),r.id=s}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!n||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(t,e){let r=this.flags.timeout;if(r===void 0){this.acks[t]=e;return}let n=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);e.call(this,new Error("operation has timed out"))},r);this.acks[t]=(...a)=>{this.io.clearTimeoutFn(n),e.apply(this,[null,...a])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this.packet({type:rt.CONNECT,data:t})}):this.packet({type:rt.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case rt.CONNECT:if(t.data&&t.data.sid){let n=t.data.sid;this.onconnect(n)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case rt.EVENT:case rt.BINARY_EVENT:this.onevent(t);break;case rt.ACK:case rt.BINARY_ACK:this.onack(t);break;case rt.DISCONNECT:this.ondisconnect();break;case rt.CONNECT_ERROR:this.destroy();let r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){let e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let r of e)r.apply(this,t)}super.emit.apply(this,t)}ack(t){let e=this,r=!1;return function(...n){r||(r=!0,e.packet({type:rt.ACK,id:t,data:n}))}}onack(t){let e=this.acks[t.id];typeof e=="function"&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:rt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let e=this._anyListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let e=this._anyOutgoingListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let r of e)r.apply(this,t.data)}}};function Ai(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}Ai.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*i);i=(Math.floor(t*10)&1)==0?i-e:i+e}return Math.min(i,this.max)|0};Ai.prototype.reset=function(){this.attempts=0};Ai.prototype.setMin=function(i){this.ms=i};Ai.prototype.setMax=function(i){this.max=i};Ai.prototype.setJitter=function(i){this.jitter=i};var lr=class extends ht{constructor(t,e){var r;super();this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,mi(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((r=e.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new Ai({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;let n=e.parser||ra;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Qt(this.uri,this.opts);let e=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let n=Yt(e,"open",function(){r.onopen(),t&&t()}),a=Yt(e,"error",s=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",s),t?t(s):r.maybeReconnectOnOpen()});if(this._timeout!==!1){let s=this._timeout;s===0&&n();let o=this.setTimeoutFn(()=>{n(),e.close(),e.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&o.unref(),this.subs.push(function(){clearTimeout(o)})}return this.subs.push(n),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(Yt(t,"ping",this.onping.bind(this)),Yt(t,"data",this.ondata.bind(this)),Yt(t,"error",this.onerror.bind(this)),Yt(t,"close",this.onclose.bind(this)),Yt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let r=this.nsps[t];return r||(r=new or(this,t,e),this.nsps[t]=r),r}_destroy(t){let e=Object.keys(this.nsps);for(let r of e)if(this.nsps[r].active)return;this._close()}_packet(t){let e=this.encoder.encode(t);for(let r=0;r<e.length;r++)this.engine.write(e[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},e);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};var cr={};function Ii(i,t){typeof i=="object"&&(t=i,i=void 0),t=t||{};let e=Ys(i,t.path||"/socket.io"),r=e.source,n=e.id,a=e.path,s=cr[n]&&a in cr[n].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||s,l;return o?l=new lr(r,t):(cr[n]||(cr[n]=new lr(r,t)),l=cr[n]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign(Ii,{Manager:lr,Socket:or,io:Ii,connect:Ii});frappe.socketio={open_tasks:{},open_docs:[],emit_queue:[],init:function(i=3e3){if(!frappe.boot.disable_async&&!frappe.socketio.socket){if(window.location.protocol=="https:"?(console.log(frappe.socketio.get_host(i)),frappe.socketio.socket=Ii.connect(frappe.socketio.get_host(i),{secure:!0,withCredentials:!0,reconnectionAttempts:3})):window.location.protocol=="http:"&&(frappe.socketio.socket=Ii.connect(frappe.socketio.get_host(i),{withCredentials:!0,reconnectionAttempts:3})),!frappe.socketio.socket){console.log("Unable to connect to "+frappe.socketio.get_host(i));return}frappe.socketio.socket.on("msgprint",function(t){frappe.msgprint(t)}),frappe.socketio.socket.on("progress",function(t){t.progress&&(t.percent=flt(t.progress[0])/t.progress[1]*100),t.percent&&frappe.show_progress(t.title||__("Progress"),t.percent,100,t.description,!0)}),frappe.socketio.setup_listeners(),frappe.socketio.setup_reconnect(),$(document).on("form-load form-rename",function(t,e){if(!(!e.doc||e.is_new())){for(var r=0,n=frappe.socketio.open_docs.length;r<n;r++){var a=frappe.socketio.open_docs[r];if(e.doctype==a.doctype&&e.docname==a.name)return!1}frappe.socketio.doc_subscribe(e.doctype,e.docname)}}),$(document).on("form-refresh",function(t,e){!e.doc||e.is_new()||frappe.socketio.doc_open(e.doctype,e.docname)}),$(document).on("form-unload",function(t,e){!e.doc||e.is_new()||frappe.socketio.doc_close(e.doctype,e.docname)}),$(document).on("form-typing",function(t,e){frappe.socketio.form_typing(e.doctype,e.docname)}),$(document).on("form-stopped-typing",function(t,e){frappe.socketio.form_stopped_typing(e.doctype,e.docname)}),window.addEventListener("beforeunload",()=>{!cur_frm||!cur_frm.doc||cur_frm.is_new()||frappe.socketio.doc_close(cur_frm.doctype,cur_frm.docname)})}},get_host:function(i=3e3){var t=window.location.origin;if(window.dev_server){var e=t.split(":");i=frappe.boot.socketio_port||i.toString()||"3000",e.length>2&&(t=e[0]+":"+e[1]),t=t+":"+i}return t},subscribe:function(i,t){frappe.socketio.socket.emit("task_subscribe",i),frappe.socketio.socket.emit("progress_subscribe",i),frappe.socketio.open_tasks[i]=t},task_subscribe:function(i){frappe.socketio.socket.emit("task_subscribe",i)},task_unsubscribe:function(i){frappe.socketio.socket.emit("task_unsubscribe",i)},doctype_subscribe:function(i){frappe.socketio.socket.emit("doctype_subscribe",i)},doc_subscribe:function(i,t){if(frappe.flags.doc_subscribe){console.log("throttled");return}frappe.flags.doc_subscribe=!0,setTimeout(function(){frappe.flags.doc_subscribe=!1},1e3),frappe.socketio.socket.emit("doc_subscribe",i,t),frappe.socketio.open_docs.push({doctype:i,docname:t})},doc_unsubscribe:function(i,t){frappe.socketio.socket.emit("doc_unsubscribe",i,t),frappe.socketio.open_docs=$.filter(frappe.socketio.open_docs,function(e){return e.doctype===i&&e.name===t?null:e})},doc_open:function(i,t){(!frappe.socketio.last_doc||frappe.socketio.last_doc[0]!=i||frappe.socketio.last_doc[1]!=t)&&(frappe.socketio.socket.emit("doc_open",i,t),frappe.socketio.last_doc&&frappe.socketio.doc_close(frappe.socketio.last_doc[0],frappe.socketio.last_doc[1])),frappe.socketio.last_doc=[i,t]},doc_close:function(i,t){frappe.socketio.socket.emit("doc_close",i,t),frappe.socketio.socket.emit("doc_typing_stopped",i,t)},form_typing:function(i,t){frappe.socketio.socket.emit("doc_typing",i,t)},form_stopped_typing:function(i,t){frappe.socketio.socket.emit("doc_typing_stopped",i,t)},setup_listeners:function(){frappe.socketio.socket.on("task_status_change",function(i){frappe.socketio.process_response(i,i.status.toLowerCase())}),frappe.socketio.socket.on("task_progress",function(i){frappe.socketio.process_response(i,"progress")})},setup_reconnect:function(){frappe.socketio.socket.on("connect",function(){setTimeout(function(){$.each(frappe.socketio.open_tasks,function(i,t){frappe.socketio.subscribe(i,t)}),$.each(frappe.socketio.open_docs,function(i){locals[i.doctype]&&locals[i.doctype][i.name]&&frappe.socketio.doc_subscribe(i.doctype,i.name)}),cur_frm&&cur_frm.doc&&frappe.socketio.doc_open(cur_frm.doc.doctype,cur_frm.doc.name)},5e3)})},process_response:function(i,t){if(!!i){var e=frappe.socketio.open_tasks[i.task_id];e[t]&&e[t](i),t==="success"&&e.callback&&e.callback(i),frappe.request.cleanup(e,i),e.always&&e.always(i),i.status_code&&i.status_code>400&&e.error&&e.error(i)}}};frappe.provide("frappe.realtime");frappe.realtime.on=function(i,t){frappe.socketio.socket&&frappe.socketio.socket.on(i,t)};frappe.realtime.off=function(i,t){frappe.socketio.socket&&frappe.socketio.socket.off(i,t)};frappe.realtime.publish=function(i,t){frappe.socketio.socket&&frappe.socketio.socket.emit(i,t)};var nd=Ut(ro());var na={default:[{divisor:1e12,symbol:__("T",null,"Number system")},{divisor:1e9,symbol:__("B",null,"Number system")},{divisor:1e6,symbol:__("M",null,"Number system")},{divisor:1e3,symbol:__("K",null,"Number system")}],indian:[{divisor:1e7,symbol:__("Cr",null,"Number system")},{divisor:1e5,symbol:__("Lakh",null,"Number system")},{divisor:1e3,symbol:__("K",null,"Number system")}]};var ad=Ut(rd());frappe.provide("frappe.utils");Array.prototype.uniqBy||(Object.defineProperty(Array.prototype,"uniqBy",{value:function(i){var t={};return this.filter(function(e){var r=i(e);return r in t?!1:t[r]=!0})}}),Object.defineProperty(Array.prototype,"move",{value:function(i,t){this.splice(t,0,this.splice(i,1)[0])}}));Object.defineProperty(Object.prototype,"setDefault",{value:function(i,t){return i in this||(this[i]=t),this[i]},writable:!0});String.prototype.plural=function(i){let t={"(quiz)$":"$1zes","^(ox)$":"$1en","([m|l])ouse$":"$1ice","(matr|vert|ind)ix|ex$":"$1ices","(x|ch|ss|sh)$":"$1es","([^aeiouy]|qu)y$":"$1ies","(hive)$":"$1s","(?:([^f])fe|([lr])f)$":"$1$2ves","(shea|lea|loa|thie)f$":"$1ves",sis$:"ses","([ti])um$":"$1a","(tomat|potat|ech|her|vet)o$":"$1oes","(bu)s$":"$1ses","(alias)$":"$1es","(octop)us$":"$1i","(ax|test)is$":"$1es","(us)$":"$1es","([^s]+)$":"$1s"},e={"(quiz)zes$":"$1","(matr)ices$":"$1ix","(vert|ind)ices$":"$1ex","^(ox)en$":"$1","(alias)es$":"$1","(octop|vir)i$":"$1us","(cris|ax|test)es$":"$1is","(shoe)s$":"$1","(o)es$":"$1","(bus)es$":"$1","([m|l])ice$":"$1ouse","(x|ch|ss|sh)es$":"$1","(m)ovies$":"$1ovie","(s)eries$":"$1eries","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","(tive)s$":"$1","(hive)s$":"$1","(li|wi|kni)ves$":"$1fe","(shea|loa|lea|thie)ves$":"$1f","(^analy)ses$":"$1sis","((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$":"$1$2sis","([ti])a$":"$1um","(n)ews$":"$1ews","(h|bl)ouses$":"$1ouse","(corpse)s$":"$1","(us)es$":"$1",s$:""},r={move:"moves",foot:"feet",goose:"geese",sex:"sexes",child:"children",man:"men",tooth:"teeth",person:"people"};if(["sheep","fish","deer","moose","series","species","money","rice","information","equipment"].indexOf(this.toLowerCase())>=0)return this;let a,s,o;for(a in r)if(i?(s=new RegExp(r[a]+"$","i"),o=a):(s=new RegExp(a+"$","i"),o=r[a]),s.test(this))return this.replace(s,o);let l;i?l=e:l=t;let u;for(u in l)if(s=new RegExp(u,"i"),s.test(this))return this.replace(s,l[u]);return this};Object.assign(frappe.utils,{get_random:function(i){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",r=0;r<i;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t},get_file_link:function(i){return i=cstr(i),frappe.utils.is_url(i)?i:i.indexOf("/")===-1?"files/"+i:i},replace_newlines(i){return i?i.replace(/\n/g,"<br>"):""},is_html:function(i){return!(!i||i.indexOf("<br>")==-1&&i.indexOf("<p")==-1&&i.indexOf("<img")==-1&&i.indexOf("<div")==-1&&!i.includes("<span"))},is_mac:function(){return window.navigator.platform==="MacIntel"},is_xs:function(){return $(document).width()<768},is_sm:function(){return $(document).width()<991&&$(document).width()>=768},is_md:function(){return $(document).width()<1199&&$(document).width()>=991},is_json:function(i){try{JSON.parse(i)}catch(t){return!1}return!0},parse_json:function(i){let t="";try{t=JSON.parse(i)}catch(e){return i}return t},strip_whitespace:function(i){return(i||"").replace(/<p>\s*<\/p>/g,"").replace(/<br>(\s*<br>\s*)+/g,"<br><br>")},encode_tags:function(i){var t={"&":"&amp;","<":"&lt;",">":"&gt;"};function e(r){return t[r]||r}return i.replace(/[&<>]/g,e)},strip_original_content:function(i){var t=[],e=[],r=i.indexOf("<br>")===-1?`
`:"<br>";return $.each(i.split(r),function(n,a){var s=strip(a);s&&(s.substr(0,1)===">"||s.substr(0,4)==="&gt;")?e.push(a):(t=t.concat(e),t.push(a),e=[])}),t.join(r)},escape_html:function(i){if(!i)return"";let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};return String(i).replace(/[&<>"'`=/]/g,e=>t[e]||e)},unescape_html:function(i){let t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#x2F;":"/","&#x60;":"`","&#x3D;":"="};return String(i).replace(/&amp;|&lt;|&gt;|&quot;|&#39;|&#x2F;|&#x60;|&#x3D;/g,e=>t[e]||e)},html2text:function(i){return new DOMParser().parseFromString(i,"text/html").body.textContent},is_url:function(i){return i.toLowerCase().substr(0,7)=="http://"||i.toLowerCase().substr(0,8)=="https://"},to_title_case:function(i,t=!1){let e=i.toLowerCase().replace(/(?:^|[\s-/])\w/g,function(n){return n.toUpperCase()}),r=t?" ":"";return e.replace(/-|_/g,r)},toggle_blockquote:function(i){if(!i)return i;var t=$("<div></div>").html(i);return t.find("blockquote").parent("blockquote").addClass("hidden").before('<p><a class="text-muted btn btn-default toggle-blockquote" style="padding: 2px 7px 0px; line-height: 1;"> 					\u2022 \u2022 \u2022 				</a></p>'),t.html()},scroll_to:function(i,t=!0,e,r,n,a=!1){if(frappe.flags.disable_auto_scroll)return;r=r||$("html, body");let s=0;i&&(s=typeof i=="number"?i-cint(e):this.get_scroll_position(i,e)),s<0&&(s=0),s!=r.scrollTop()&&(t?r.animate({scrollTop:s}).promise().then(()=>{a&&($(i).addClass("highlight"),document.addEventListener("click",function(){$(i).removeClass("highlight")},{once:!0})),n&&n()}):r.scrollTop(s))},get_scroll_position:function(i,t){let e=$(".navbar").height()+$(".page-head:visible").height()||$(".navbar").height();return $(i).offset().top-e-cint(t)},filter_dict:function(i,t){var e=[];return typeof t=="string"?[i[t]]:($.each(i,function(r,n){for(var a in t)if($.isArray(t[a])){if(t[a][0]=="in"){if(t[a][1].indexOf(n[a])==-1)return}else if(t[a][0]=="not in"){if(t[a][1].indexOf(n[a])!=-1)return}else if(t[a][0]=="<"){if(!(n[a]<t[a]))return}else if(t[a][0]=="<="){if(!(n[a]<=t[a]))return}else if(t[a][0]==">"){if(!(n[a]>t[a]))return}else if(t[a][0]==">="&&!(n[a]>=t[a]))return}else if(n[a]!=t[a])return;e.push(n)}),e)},comma_or:function(i){return frappe.utils.comma_sep(i," "+__("or")+" ")},comma_and:function(i){return frappe.utils.comma_sep(i," "+__("and")+" ")},comma_sep:function(i,t){return i instanceof Array?i.length==0?"":i.length==1?i[0]:i.slice(0,i.length-1).join(", ")+t+i.slice(-1)[0]:i},set_footnote:function(i,t,e){return i||(i=$('<div class="text-muted footnote-area level">').appendTo(t)),e?i.html(e):(i.remove(),i=null),i},get_args_dict_from_url:function(i){var t={};return $.each(decodeURIComponent(i).split("&"),function(e,r){r=r.split("="),t[r[0]]=r[1]}),t},get_url_from_dict:function(i){return $.map(i,function(t,e){return t!==null?encodeURIComponent(e)+"="+encodeURIComponent(t):null}).join("&")||""},validate_type:function(i,t){var e;switch(t){case"phone":e=/^([0-9 +_\-,.*#()]){1,20}$/;break;case"name":e=/^[\w][\w'-]*([ \w][\w'-]+)*$/;break;case"number":e=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;break;case"digits":e=/^\d+$/;break;case"alphanum":e=/^\w+$/;break;case"email":e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;break;case"url":e=/^((([A-Za-z0-9.+-]+:(?:\/\/)?)(?:[-;:&=\+\,\w]@)?[A-Za-z0-9.-]+(:[0-9]+)?|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[\w]*))?)$/i;break;case"dateIso":e=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;break;default:return!1}return i!==""?e.test(i):!1},guess_style:function(i,t,e){var r=t||"default",n="gray";return i&&(has_words(["Pending","Review","Medium","Not Approved"],i)?(r="warning",n="orange"):has_words(["Open","Urgent","High","Failed","Rejected","Error"],i)?(r="danger",n="red"):has_words(["Closed","Finished","Converted","Completed","Complete","Confirmed","Approved","Yes","Active","Available","Paid","Success"],i)?(r="success",n="green"):has_words(["Submitted"],i)&&(r="info",n="blue")),e?n:r},guess_colour:function(i){return frappe.utils.guess_style(i,null,!0)},get_indicator_color:function(i){return frappe.db.get_list("Workflow State",{filters:{name:i},fields:["name","style"]}).then(t=>{let e=t[0];if(!e.style)return frappe.utils.guess_colour(e.name);let r=e.style;return{Success:"green",Warning:"orange",Danger:"red",Primary:"blue"}[r]})},sort:function(i,t,e,r){if(!i||i.length<2)return i||[];var n={string:function(a,s){return cstr(a[t]).localeCompare(cstr(s[t]))},number:function(a,s){return flt(a[t])-flt(s[t])}};return e||(e=typeof i[0][t]=="string"?"string":"number"),i.sort(n[e]),r&&i.reverse(),i},unique:function(i){for(var t={},e=[],r=0,n=i.length;r<n;r++)i[r]in t||(t[i[r]]=null,e.push(i[r]));return e},remove_nulls:function(i){for(var t=[],e=0,r=i.length;e<r;e++)is_null(i[e])||t.push(i[e]);return t},all:function(i){for(var t=0,e=i.length;t<e;t++)if(!i[t])return!1;return!0},dict:function(i,t){var e=[];return $.each(t,function(r,n){var a={};$.each(i,function(s,o){a[o]=n[s]}),e.push(a)}),e},sum:function(i){return i.reduce(function(t,e){return flt(t)+flt(e)},0)},arrays_equal:function(i,t){if(!i||!t||i.length!=t.length)return!1;for(var e=0;e<i.length;e++)if($.isArray(i[e])){if(!frappe.utils.arrays_equal(i[e],t[e]))return!1}else if(i[e]!==t[e])return!1;return!0},intersection:function(i,t){var e=0,r=0,n=new Array;for(i=[].concat(i).sort(),t=[].concat(t).sort();e<i.length&&r<t.length;)i[e]<t[r]?e++:(i[e]>t[r]||(n.push(i[e]),e++),r++);return n},resize_image:function(i,t,e,r){var n=new Image;e||(e=600),r||(r=400),n.src=i.result,n.onload=function(){var a=n.width,s=n.height;a>s?a>e&&(s*=e/a,a=e):s>r&&(a*=r/s,s=r);var o=document.createElement("canvas");o.width=a,o.height=s;var l=o.getContext("2d");l.drawImage(this,0,0,a,s);var u=o.toDataURL("image/jpeg");setTimeout(function(){t(u)},10)}},csv_to_array:function(i,t){t=t||",";for(var e=new RegExp("(\\"+t+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+t+"\\r\\n]*))","gi"),r=[[]],n=null;n=e.exec(i);){var a=n[1];a.length&&a!==t&&r.push([]);var s;n[2]?s=n[2].replace(new RegExp('""',"g"),'"'):s=n[3],r[r.length-1].push(s)}return r},warn_page_name_change:function(){frappe.msgprint(__("Note: Changing the Page Name will break previous URL to this page."))},notify:function(i,t,e,r){console.log("push notifications are evil and deprecated")},set_title:function(i){frappe._original_title=i,frappe._title_prefix&&(i=frappe._title_prefix+" "+i.replace(/<[^>]*>/g,"")),document.title=i;let t=frappe.router.get_sub_path();frappe.route_titles[t]=i},set_title_prefix:function(i){frappe._title_prefix=i,frappe.utils.set_title(frappe._original_title)},is_image_file:function(i){return i?(i=i.split("?")[0],/\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(i)):!1},play_sound:function(i){try{if(frappe.boot.user.mute_sounds)return;var t=$("#sound-"+i)[0];t.volume=t.getAttribute("volume"),t.play()}catch(e){console.log("Cannot play sound",i,e)}},split_emails:function(i){var t=[];return i&&i.split(/[,\n](?=(?:[^"]|"[^"]*")*$)/g).forEach(function(e){e=e.trim(),e&&t.push(e)}),t},supportsES6:function(){try{return new Function("(a = 0) => a"),!0}catch(i){return!1}}(),throttle:function(i,t,e){var r,n,a,s=null,o=0;e||(e={});let l=function(){o=e.leading===!1?0:Date.now(),s=null,a=i.apply(r,n),s||(r=n=null)};return function(){var u=Date.now();!o&&e.leading===!1&&(o=u);let c=t-(u-o);return r=this,n=arguments,c<=0||c>t?(s&&(clearTimeout(s),s=null),o=u,a=i.apply(r,n),s||(r=n=null)):!s&&e.trailing!==!1&&(s=setTimeout(l,c)),a}},debounce:function(i,t,e){var r;return function(){var n=this,a=arguments,s=function(){r=null,e||i.apply(n,a)},o=e&&!r;clearTimeout(r),r=setTimeout(s,t),o&&i.apply(n,a)}},get_form_link:function(i,t,e=!1,r=null,n=null){r=r||t,t=encodeURIComponent(t);let a=`/app/${encodeURIComponent(i.toLowerCase().replace(/ /g,"-"))}/${t}`;return n&&(a+=frappe.utils.make_query_string(n)),e?`<a href="${a}">${r}</a>`:a},get_route_label(i){let t=i.split("/");return t[2]==="Report"||t[0]==="query-report"?__("{0} Report",[t[3]||t[1]]):t[0]==="List"?__("{0} List",[t[1]]):t[0]==="modules"?__("{0} Modules",[t[1]]):t[0]==="dashboard"?__("{0} Dashboard",[t[1]]):__(frappe.utils.to_title_case(t[0],!0))},report_column_total:function(i,t,e){return t.column.disable_total?"":i.length>0?t.column.fieldtype=="Percent"||e==="mean"?i.reduce((r,n)=>r+flt(n))/i.length:t.column.fieldtype=="Int"?i.reduce((r,n)=>r+cint(n)):frappe.model.is_numeric_field(t.column.fieldtype)?i.reduce((r,n)=>r+flt(n)):null:null},setup_search(i,t,e,r){let n=i.find('[data-element="search"]').show();n.focus().val("");let a=i.find(t).show();n.off("keyup").on("keyup",()=>{let s=n.val().toLowerCase();s=s.replace(/^\s+|\s+$/g,"");for(let o=0;o<a.length;o++){let l=a.eq(o).find(e),u=l.text().toLowerCase(),c="";r&&l.attr(r)&&(c=l.attr(r).toLowerCase()),u.includes(s)||c.includes(s)?a.eq(o).css("display",""):a.eq(o).css("display","none")}})},setup_timer(i,t,e){let r=t>i,n=i,a=setInterval(()=>{if(r?n++:n--,r?n>t:n<t){clearInterval(a);return}e.text(n)},1e3)},deep_equal(i,t){return(0,nd.default)(i,t)},deep_clone(i,t){return(0,ad.default)(i,t)},file_name_ellipsis(i,t){let e=t*2/3,r=t-e,n=i.split("."),a=n.pop(),s=n.join(""),o=s.slice(0,e),l=s.slice(-r);return s.length>t?`${o}...${l}.${a}`:i},get_decoded_string(i){let e=i.split(",")[1],r=atob(e);try{let n=escape(r);r=decodeURIComponent(n)}catch(n){}return r},copy_to_clipboard(i){let t=()=>{frappe.show_alert({indicator:"green",message:__("Copied to clipboard.")})};if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(i).then(t);else{let e=$("<textarea>");$("body").append(e),e.val(i).select(),document.execCommand("copy"),t(),e.remove()}},is_rtl(i=null){return["ar","he","fa","ps"].includes(i||frappe.boot.lang)},bind_actions_with_object(i,t){return $(i).off("click.class_actions"),$(i).on("click.class_actions","[data-action]",e=>{let r=$(e.currentTarget),n=r.data("action");t[n]&&t[n](e,r)}),i},eval(i,t={}){let e=Object.keys(t),r=Object.values(t);i=`let out = ${i}; return out`;try{return new Function(...e,i)(...r)}catch(n){throw console.log("Error evaluating the following expression:"),console.error(i),n}},get_browser(){let i=navigator.userAgent,t,e=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(e[1])?(t=/\brv[ :]+(\d+)/g.exec(i)||[],{name:"IE",version:t[1]||""}):e[1]==="Chrome"&&(t=i.match(/\bOPR|Edge\/(\d+)/),t!=null)?{name:"Opera",version:t[1]}:(e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"],(t=i.match(/version\/(\d+)/i))!=null&&e.splice(1,1,t[1]),{name:e[0],version:e[1]})},get_formatted_duration(i,t=null){let e="";if(t||(t={hide_days:0,hide_seconds:0}),i){let r=frappe.utils.seconds_to_duration(i,t);r.days&&(e+=r.days+__("d",null,"Days (Field: Duration)")),r.hours&&(e+=e.length?" ":"",e+=r.hours+__("h",null,"Hours (Field: Duration)")),r.minutes&&(e+=e.length?" ":"",e+=r.minutes+__("m",null,"Minutes (Field: Duration)")),r.seconds&&(e+=e.length?" ":"",e+=r.seconds+__("s",null,"Seconds (Field: Duration)"))}return e},seconds_to_duration(i,t){let e=i>0?Math.floor:Math.ceil,r={days:e(i/86400),hours:e(i%86400/3600),minutes:e(i%3600/60),seconds:e(i%60)};return t&&t.hide_days&&(r.hours=e(i/3600),r.days=0),r},duration_to_seconds(i=0,t=0,e=0,r=0){let n=0;return i&&(n+=i*24*60*60),t&&(n+=t*60*60),e&&(n+=e*60),r&&(n+=r),n},get_duration_options:function(i){return{hide_days:i.hide_days,hide_seconds:i.hide_seconds}},get_number_system:function(i){return["Bangladesh","India","Myanmar","Pakistan"].includes(i)?na.indian:na.default},map_defaults:{center:[19.08,72.8961],zoom:13,tiles:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}},icon(i,t="sm",e="",r="",n=""){let a="";return typeof t=="object"?r+=` width: ${t.width}; height: ${t.height}`:a=`icon-${t}`,`<svg class="icon ${n} ${a}" style="${r}">
			<use class="${e}" href="#icon-${i}"></use>
		</svg>`},flag(i){return`<img
		src="https://flagcdn.com/${i}.svg"
		width="20" height="15">`},make_chart(i,t={}){let e={type:"bar",colors:["light-blue"],axisOptions:{xIsSeries:1,shortenYAxisNumbers:1,xAxisMode:"tick",numberFormatter:frappe.utils.format_chart_axis_number}};for(let r in t)typeof e[r]=="object"&&typeof t[r]=="object"?e[r]=Object.assign(e[r],t[r]):e[r]=t[r];return new frappe.Chart(i,e)},format_chart_axis_number(i,t){let e=frappe.sys_defaults.country;return frappe.utils.shorten_number(i,t||e,3)},generate_route(i){let t=i.type.toLowerCase();t==="doctype"&&(i.doctype=i.name);let e="";if(i.route)e=i.route;else if(i.link)e=strip(i.link,"#");else if(t==="doctype"){let r=frappe.router.slug(i.doctype);if(frappe.model.is_single(i.doctype))e=r;else switch(i.doc_view){case"List":i.filters&&(frappe.route_options=i.filters),e=`${r}/view/list`;break;case"Tree":e=`${r}/view/tree`;break;case"Report Builder":e=`${r}/view/report`;break;case"Dashboard":e=`${r}/view/dashboard`;break;case"New":e=`${r}/new`;break;case"Calendar":e=`${r}/view/calendar/default`;break;case"Kanban":e=`${r}/view/kanban`;break;default:e=r}}else t==="report"?i.is_query_report?e="query-report/"+i.name:i.doctype?e=frappe.router.slug(i.doctype)+"/view/report/"+i.name:e="/report/"+i.name:t==="page"?e=i.name:t==="dashboard"&&(e=`dashboard-view/${i.name}`);return i.route_options&&(e+="?"+$.map(i.route_options,function(r,n){return encodeURIComponent(n)+"="+encodeURIComponent(r)}).join("&")),`/app/${e}`},shorten_number:function(i,t,e=4,r=2){if(String(i).match(/\d/g).length<e)return i.toString();let a=this.get_number_system(t),s=Math.abs(Math.round(i));for(let o of a)if(s>=o.divisor){let l=i/o.divisor;return l=this.get_number_of_decimals(l)>r?l.toFixed(r):l,l+" "+o.symbol}return i.toFixed(r)},get_number_of_decimals:function(i){return Math.floor(i)===i?0:i.toString().split(".")[1].length||0},build_summary_item(i){if(i.type=="separator")return $(`<div class="summary-separator">
				<div class="summary-value ${i.color?i.color.toLowerCase():"text-muted"}">${i.value}</div>
			</div>`);let t={fieldtype:i.datatype},e=null;i.datatype=="Currency"&&(t.options="currency",e={currency:i.currency});let r=frappe.format(i.value,t,{only_value:!0},e),n=i.indicator?i.indicator.toLowerCase():i.color?i.color.toLowerCase():"";return $(`<div class="summary-item">
			<span class="summary-label">${__(i.label)}</span>
			<div class="summary-value ${n}">${r}</div>
		</div>`)},print(i,t,e,r,n){if(!window.open(frappe.urllib.get_full_url("/printview?doctype="+encodeURIComponent(i)+"&name="+encodeURIComponent(t)+"&trigger_print=1&format="+encodeURIComponent(e)+"&no_letterhead="+(r?"0":"1")+"&letterhead="+encodeURIComponent(r)+(n?"&_lang="+n:"")))){frappe.msgprint(__("Please enable pop-ups"));return}},get_clipboard_data(i){let t=i;return(t.clipboardData||window.clipboardData||t.originalEvent.clipboardData).getData("Text")},add_custom_button(i,t,e="",r="",n,a,s){n||(n="btn-secondary");let o=$(`<button class="btn ${n} btn-xs ${e}" title="${r}">${i}</button>`);o.click(l=>{l.stopPropagation(),t&&t(l)}),!s&&o.appendTo(a),s&&a.prepend(o)},sleep(i){return new Promise(t=>setTimeout(t,i))},parse_array(i){if(i&&i.length!==0)return i},range(i,t){t||(t=i,i=0);let e=[];for(let r=i;r<t;r++)e.push(r);return e},get_link_title(i,t){if(!(!i||!t||!frappe._link_titles))return frappe._link_titles[i+"::"+t]},add_link_title(i,t,e){!i||!t||(frappe._link_titles||(frappe._link_titles={}),frappe._link_titles[i+"::"+t]=e)},fetch_link_title(i,t){try{return frappe.xcall("frappe.desk.search.get_link_title",{doctype:i,docname:t}).then(e=>(frappe.utils.add_link_title(i,t,e),e))}catch(e){return console.log("Error while fetching link title."),console.log(e),Promise.resolve(t)}},only_allow_num_decimal(i){i.on("input",t=>{let e=$(t.target);e.val(e.val().replace(/[^0-9.]/g,"")),(t.which!=46||e.val().indexOf(".")!=-1)&&(t.which<48||t.which>57)&&t.preventDefault()})},string_to_boolean(i){switch(i.toLowerCase().trim()){case"t":case"true":case"y":case"yes":case"1":return!0;case"f":case"false":case"n":case"no":case"0":case null:return!1;default:return i}},get_filter_as_json(i){let t=null;return i.length&&(t={},i.forEach(e=>{t[e[1]]=[e[2],e[3]]}),t=JSON.stringify(t)),t},get_filter_from_json(i,t){if(i){if(!i.length)return[];let e=new Function(`return ${i}`)();return t?Object.keys(e).map(r=>{let n=e[r];return[t,r,n[0],n[1],!1]}):e||[]}},load_video_player(){return frappe.require("video_player.bundle.js")},is_current_user(i){return i===frappe.session.user},debug:{watch_property(i,t,e=console.trace){if(!frappe.boot.developer_mode)return;console.warn("Adding property watcher, make sure to remove it after debugging.");let r="$_"+t+"_$";i[r]=i[t],Object.defineProperty(i,t,{get:function(){return i[r]},set:function(n){e(),i[r]=n}})}}});frappe.provide("frappe.utils");var vw={init(){this.jq=jQuery({})},trigger(i,t){!this.jq&&this.init(),this.jq.trigger(i,t)},once(i,t){!this.jq&&this.init(),this.jq.one(i,(e,r)=>t(r))},on(i,t){!this.jq&&this.init(),this.jq.bind(i,(e,r)=>t(r))},off(i,t){!this.jq&&this.init(),this.jq.unbind(i,(e,r)=>t(r))}};frappe.utils.make_event_emitter=function(i){return Object.assign(i,vw),i};frappe.provide("frappe.views");frappe.re_route={"#login":""};frappe.route_titles={};frappe.route_flags={};frappe.route_history=[];frappe.view_factory={};frappe.view_factories=[];frappe.route_options=null;frappe.route_hooks={};$(window).on("hashchange",function(i){if(window.location.hash&&!frappe.router.is_app_route(i.currentTarget.pathname)){let t=frappe.router.get_sub_path(window.location.hash);return frappe.router.push_state(t),!1}});window.addEventListener("popstate",i=>(frappe.router.route(),i.preventDefault(),!1));$("body").on("click","a",function(i){let t=a=>(i.preventDefault(),frappe.set_route(a),!1),e=i.currentTarget,r=e.getAttribute("href"),n=e.hostname===window.location.hostname;if(!(e.getAttribute("onclick")||i.ctrlKey||i.metaKey||r==="#")){if(r==="")return t("/app");if(r&&r.startsWith("#"))return t(e.hash);if(n&&frappe.router.is_app_route(e.pathname)){if(e.search){frappe.route_options={};let a=new URLSearchParams(e.search);for(let[s,o]of a)frappe.route_options[s]=o}return t(e.pathname+e.hash)}}});frappe.router={current_route:null,routes:{},factory_views:["form","list","report","tree","print","dashboard"],list_views:["list","kanban","report","calendar","tree","gantt","dashboard","image","inbox","map"],list_views_route:{list:"List",kanban:"Kanban",report:"Report",calendar:"Calendar",tree:"Tree",gantt:"Gantt",dashboard:"Dashboard",image:"Image",inbox:"Inbox",file:"Home",map:"Map"},layout_mapped:{},is_app_route(i){if(i.substr(0,1)==="/"&&(i=i.substr(1)),i=i.split("/"),i[0])return i[0]==="app"},setup(){for(let i of frappe.boot.user.can_read)this.routes[this.slug(i)]={doctype:i};if(frappe.boot.doctype_layouts)for(let i of frappe.boot.doctype_layouts)this.routes[this.slug(i.name)]={doctype:i.document_type,doctype_layout:i.name}},async route(){if(!frappe.app)return;let i=this.get_sub_path();this.re_route(i)||(this.current_sub_path=i,this.current_route=await this.parse(),this.set_history(i),this.render(),this.set_title(i),this.trigger("change"))},async parse(i){return i=this.get_sub_path_string(i).split("/"),i?(i=$.map(i,this.decode_component),this.set_route_options_from_url(),await this.convert_to_standard_route(i)):[]},async convert_to_standard_route(i){let t=i[1]&&`${i[1]}-${frappe.user.name.toLowerCase()}`;return frappe.workspaces[i[0]]?i=["Workspaces",frappe.workspaces[i[0]].title]:i[0]=="private"&&frappe.workspaces[t]?i=["Workspaces","private",frappe.workspaces[t].title]:this.routes[i[0]]&&(i=await this.set_doctype_route(i)),i},doctype_route_exist(i){return i=this.get_sub_path_string(i).split("/"),this.routes[i[0]]},set_doctype_route(i){let t=this.routes[i[0]];return frappe.model.with_doctype(t.doctype).then(()=>{let e=frappe.get_meta(t.doctype);if(i[1]&&i[1]==="view"&&i[2])i=this.get_standard_route_for_list(i,t,e.force_re_route_to_default_view&&e.default_view?e.default_view:null);else if(i[1]&&i[1]!=="view"&&!i[2]){let r=i[1];i.length>2&&(r=i.slice(1).join("/")),i=["Form",t.doctype,r]}else frappe.model.is_single(t.doctype)?i=["Form",t.doctype,t.doctype]:e.default_view?i=["List",t.doctype,this.list_views_route[e.default_view.toLowerCase()]]:i=["List",t.doctype,"List"];return this.doctype_layout=t.doctype_layout,i})},get_standard_route_for_list(i,t,e){let r,n=e||i[2]||"";if(n.toLowerCase()==="tree")r=["Tree",t.doctype];else{let a=this.list_views_route[n.toLowerCase()];i[2].toLowerCase()!==a.toLowerCase()&&(frappe.route_flags.replace_route=!0,i[2]=n.toLowerCase(),this.set_route(i)),r=["List",t.doctype,this.list_views_route[n.toLowerCase()]],i[3]&&r.push(...i.slice(3,i.length))}return r},set_history(){frappe.route_history.push(this.current_route),frappe.ui.hide_open_dialog()},render(){this.current_route[0]?this.render_page():frappe.views.pageview.show("")},render_page(){let i=this.current_route,t=frappe.utils.to_title_case(i[0]);if(i[1]&&frappe.views[t+"Factory"])i[0]=t,frappe.view_factory[t]||(frappe.view_factory[t]=new frappe.views[t+"Factory"]),frappe.view_factory[t].show();else{let e=frappe.utils.xss_sanitise(i[0]);frappe.views.pageview&&frappe.views.pageview.show(e)}},re_route(i){if(frappe.re_route[i]!==void 0){let t=this.get_sub_path(frappe.re_route[i]);return t===this.current_sub_path?window.history.back():frappe.set_route(t),!0}},set_title(i){frappe.route_titles[i]&&frappe.utils.set_title(frappe.route_titles[i])},set_route(){let i=Array.from(arguments);return new Promise(t=>{i=this.get_route_from_arguments(i),i=this.convert_from_standard_route(i);let e=this.make_url(i);this.push_state(e),setTimeout(()=>{frappe.after_ajax&&frappe.after_ajax(()=>{t()})},100)}).finally(()=>frappe.route_flags={})},get_route_from_arguments(i){return i.length===1&&$.isArray(i[0])&&(i=i[0]),i.length===1&&i[0]&&i[0].includes("/")&&(i=$.map(i[0].split("/"),this.decode_component)),i&&i[0]==""&&i.shift(),i&&["desk","app"].includes(i[0])&&i.shift(),i},convert_from_standard_route(i){let t=i[0]?i[0].toLowerCase():"",e=i;return t==="list"?i[2]&&i[2]!=="list"&&!$.isPlainObject(i[2])?(e=[this.slug(i[1]),"view",i[2].toLowerCase()],i[3]&&e.push(...i.slice(3,i.length))):($.isPlainObject(i[2])&&(frappe.route_options=i[2]),e=[this.slug(i[1])]):t==="form"?(e=[this.slug(i[1])],i[2]&&e.push(i[2])):t==="tree"&&(e=[this.slug(i[1]),"view","tree"]),e},slug_parts(i){return i[0]&&this.factory_views.includes(i[0].toLowerCase())&&(i[0]=i[0].toLowerCase(),i[1]=this.slug(i[1])),i},make_url(i){let t=$.map(i,function(n){return $.isPlainObject(n)?(frappe.route_options=n,null):encodeURIComponent(String(n))}).join("/"),r=frappe.workspaces[`home-${frappe.user.name.toLowerCase()}`]?"private/home":frappe.workspaces.home?"home":Object.keys(frappe.workspaces)[0];return"/app/"+(t||r)},push_state(i){if(window.location.pathname!==i){let t=frappe.route_flags.replace_route?"replaceState":"pushState";history[t](null,null,i),this.route()}},get_sub_path_string(i){return i||(i=window.location.pathname,i.includes("app#")&&(i=window.location.hash)),this.strip_prefix(i)},strip_prefix(i){return i.substr(0,1)=="/"&&(i=i.substr(1)),i.startsWith("app/")&&(i=i.substr(4)),i=="app"&&(i=i.substr(4)),i.substr(0,1)=="/"&&(i=i.substr(1)),i.substr(0,1)=="#"&&(i=i.substr(1)),i.substr(0,1)=="!"&&(i=i.substr(1)),i},get_sub_path(i){var t=this.get_sub_path_string(i);return i=$.map(t.split("/"),this.decode_component).join("/"),i},set_route_options_from_url(){let i=window.location.search;frappe.route_options||(frappe.route_options={});let t=new URLSearchParams(i);for(let[e,r]of t)frappe.route_options[e]=r},decode_component(i){try{return decodeURIComponent(i)}catch(t){if(t instanceof URIError)return i;throw t}},slug(i){return i.toLowerCase().replace(/ /g,"-")}};frappe.get_route=()=>frappe.router.current_route;frappe.get_route_str=()=>frappe.router.current_route.join("/");frappe.set_route=function(){return frappe.router.set_route.apply(frappe.router,arguments)};frappe.get_prev_route=function(){return frappe.route_history&&frappe.route_history.length>1?frappe.route_history[frappe.route_history.length-2]:[]};frappe.set_re_route=function(){var i=frappe.router.get_sub_path();frappe.set_route.apply(null,arguments),frappe.re_route[i]=frappe.router.get_sub_path()};frappe.has_route_options=function(){return Boolean(Object.keys(frappe.route_options||{}).length)};frappe.utils.make_event_emitter(frappe.router);frappe.route_history_queue=[];var bw=["Form","social","setup-wizard","recorder"],yw=frappe.utils.debounce(()=>{if(frappe.session.user==="Guest")return;let i=frappe.route_history_queue;!i.length||(frappe.route_history_queue=[],frappe.xcall("frappe.desk.doctype.route_history.route_history.deferred_insert",{routes:i}).catch(()=>{frappe.route_history_queue.concat(i)}))},1e4);frappe.router.on("change",()=>{let i=frappe.get_route();ww(i)&&(frappe.route_history_queue.push({creation:frappe.datetime.now_datetime(),route:frappe.get_route_str()}),yw())});function ww(i){return i[1]?!(i[0]==="List"&&!i[2]||bw.includes(i[0])):!1}frappe.defaults={get_user_default:function(i){var t=frappe.boot.user.defaults,e=t[i];if(!e&&frappe.defaults.is_a_user_permission_key(i)&&(e=t[frappe.model.scrub(i)]),$.isArray(e)&&(e=e[0]),!!frappe.defaults.in_user_permission(i,e))return e},get_user_defaults:function(i){var t=frappe.boot.user.defaults,e=t[i];return frappe.defaults.is_a_user_permission_key(i)&&(e&&$.isArray(e)&&e.length===1?e=e[0]:e=t[i]||t[frappe.model.scrub(i)]),$.isArray(e)||(e=[e]),e.filter(r=>{if(frappe.defaults.in_user_permission(i,r))return r}),e},get_global_default:function(i){var t=frappe.sys_defaults[i];return $.isArray(t)&&(t=t[0]),t},get_global_defaults:function(i){var t=frappe.sys_defaults[i];return $.isArray(t)||(t=[t]),t},set_user_default_local:function(i,t){frappe.boot.user.defaults[i]=t},get_default:function(i){var t=frappe.boot.user.defaults,e=t[i];if(frappe.defaults.is_a_user_permission_key(i)&&(e&&$.isArray(e)&&e.length===1?e=e[0]:e=t[frappe.model.scrub(i)]),!!frappe.defaults.in_user_permission(i,e)&&e)try{return JSON.parse(e)}catch(r){return e}},is_a_user_permission_key:function(i){return i.indexOf(":")===-1&&i!==frappe.model.scrub(i)},in_user_permission:function(i,t){let e=this.get_user_permissions()[frappe.model.unscrub(i)];return e&&e.length?e.some(n=>n.doc===t):!0},get_user_permissions:function(){return this._user_permissions||{}},update_user_permissions:function(){let i="frappe.core.doctype.user_permission.user_permission.get_user_permissions";frappe.call(i).then(t=>{t.message&&(this._user_permissions=Object.assign({},t.message))})}};frappe.RoleEditor=class{constructor(i,t,e){this.frm=t,this.wrapper=i,this.disable=e;let r=this.frm.doc.roles.map(a=>a.role);this.multicheck=frappe.ui.form.make_control({parent:i,df:{fieldname:"roles",fieldtype:"MultiCheck",select_all:!0,columns:3,get_data:()=>frappe.xcall("frappe.core.doctype.user.user.get_all_roles").then(a=>a.map(s=>({label:__(s),value:s,checked:r.includes(s)}))),on_change:()=>{this.set_roles_in_table(),this.frm.dirty()}},render_input:!0});let n=this.multicheck.make_checkboxes;this.multicheck.make_checkboxes=()=>{n.call(this.multicheck),this.multicheck.$wrapper.find(".label-area").click(a=>{let s=$(a.target).data("unit");s&&this.show_permissions(s),a.preventDefault()})}}set_enable_disable(){$(this.wrapper).find('input[type="checkbox"]').attr("disabled",!!this.disable)}show_permissions(i){return this.perm_dialog||this.make_perm_dialog(),$(this.perm_dialog.body).empty(),frappe.xcall("frappe.core.doctype.user.user.get_perm_info",{role:i}).then(t=>{let e=$(this.perm_dialog.body);t.length?(e.append(`
						<table class="user-perm">
							<thead>
								<tr>
									<th> ${__("Document Type")} </th>
									<th> ${__("Level")} </th>
									${frappe.perm.rights.map(r=>`<th> ${frappe.unscrub(r)}</th>`).join("")}
								</tr>
							</thead>
							<tbody></tbody>
						</table>
					`),t.forEach(r=>{e.find("tbody").append(`
							<tr>
								<td>${r.parent}</td>
								<td>${r.permlevel}</td>
								${frappe.perm.rights.map(n=>`<td class="text-muted bold">${r[n]?frappe.utils.icon("check","xs"):"-"}</td>`).join("")}
							</tr>
						`)})):e.append(`<div class="text-muted text-center padding">
						${__("{0} role does not have permission on any doctype",[i])}
					</div>`),this.perm_dialog.set_title(i),this.perm_dialog.show()})}make_perm_dialog(){this.perm_dialog=new frappe.ui.Dialog({title:__("Role Permissions")}),this.perm_dialog.$wrapper.find(".modal-dialog").css("width","1200px").css("max-width","80vw")}show(){this.reset(),this.set_enable_disable()}reset(){let i=(this.frm.doc.roles||[]).map(t=>t.role);this.multicheck.selected_options=i,this.multicheck.refresh_input()}set_roles_in_table(){let i=this.frm.doc.roles||[],t=this.multicheck.get_checked_options();i.map(e=>{t.includes(e.role)||frappe.model.clear_doc(e.doctype,e.name)}),t.map(e=>{if(!i.find(r=>r.role===e)){let r=frappe.model.add_child(this.frm.doc,"Has Role","roles");r.role=e}})}get_roles(){return{checked_roles:this.multicheck.get_checked_options(),unchecked_roles:this.multicheck.get_unchecked_options()}}};frappe.ModuleEditor=class{constructor(t,e){this.frm=t,this.wrapper=e;let r=this.frm.doc.block_modules.map(n=>n.module);this.multicheck=frappe.ui.form.make_control({parent:e,df:{fieldname:"block_modules",fieldtype:"MultiCheck",select_all:!0,columns:3,get_data:()=>this.frm.doc.__onload.all_modules.map(n=>({label:__(n),value:n,checked:!r.includes(n)})),on_change:()=>{this.set_modules_in_table(),this.frm.dirty()}},render_input:!0})}show(){let t=this.frm.doc.block_modules.map(r=>r.module),e=this.frm.doc.__onload.all_modules;this.multicheck.selected_options=e.filter(r=>!t.includes(r)),this.multicheck.refresh_input()}set_modules_in_table(){let t=this.frm.doc.block_modules||[],e=this.multicheck.get_unchecked_options();t.map(r=>{e.includes(r.module)||frappe.model.clear_doc(r.doctype,r.name)}),e.map(r=>{if(!t.find(n=>n.module===r)){let n=frappe.model.add_child(this.frm.doc,"Block Module","block_modules");n.module=r}})}};frappe.template={compiled:{},debug:{}};frappe.template.compile=function(i,t){var e=t||i;if(!frappe.template.compiled[e]){let a=function(s,o,l,u,c){var h=frappe.utils.get_random(3),p=frappe.utils.get_random(3);return"{% for (var "+h+"=0, "+p+"="+l+".length; "+h+"<"+p+"; "+h+"++) { var "+o+" = "+l+"["+h+"]; "+o+"._index = "+h+"; %}"};var n=a;i.indexOf("'")!==-1&&i.replace(/'/g,"\\'"),i=i.replace(/{{/g,"{%=").replace(/}}/g,"%}"),i=i.replace(/{%\s?if\s?\s?not\s?([^\(][^%{]+)\s?%}/g,"{% if (! $1) { %}"),i=i.replace(/{%\s?if\s?([^\(][^%{]+)\s?%}/g,"{% if ($1) { %}"),i=i.replace(/{%\s?for\s([a-z._]+)\sin\s([a-z._]+)\s?%}/g,a),i=i.replace(/{%\s?endif\s?%}/g,"{% }; %}"),i=i.replace(/{%\s?else\s?%}/g,"{% } else { %}"),i=i.replace(/{%\s?endfor\s?%}/g,"{% }; %}");var r=`var _p=[],print=function(){_p.push.apply(_p,arguments)};with(obj){
_p.push('`+i.replace(/[\r\t\n]/g," ").split("{%").join("	").replace(/((^|%})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%}/g,"',$1,'").split("	").join(`');
`).split("%}").join(`
_p.push('`).split("\r").join("\\'")+"');}return _p.join('');";frappe.template.debug[t]=r;try{frappe.template.compiled[e]=new Function("obj",r)}catch(s){console.log("Error in Template:"),console.log(r),s.lineNumber&&(console.log("Error in Line "+s.lineNumber+", Col "+s.columnNumber+":"),console.log(r.split(`
`)[s.lineNumber-1]))}}return frappe.template.compiled[e]};frappe.render=function(i,t,e){return frappe.template.compile(i,e)(t)};frappe.render_template=function(i,t){if(i.indexOf(" ")!==-1)var e=i;else var e=frappe.templates[i];return t===void 0&&(t={}),e||frappe.throw(`Template <b>${i}</b> not found.`),frappe.render(e,t,i)};frappe.render_grid=function(i){i.grid&&(i.columns=i.grid.getColumns(),i.data=i.grid.getData().getItems()),i.print_settings&&i.print_settings.orientation&&i.print_settings.orientation.toLowerCase()==="landscape"&&(i.landscape=!0),i.landscape==null&&(i.columns&&i.columns.length>10?i.landscape=!0:i.landscape=!1),i.content||(i.content=frappe.render_template(i.template||"print_grid",i)),i.base_url=frappe.urllib.get_base_url(),i.print_css=frappe.boot.print_css,i.lang=i.lang||frappe.boot.lang,i.layout_direction=i.layout_direction||frappe.utils.is_rtl()?"rtl":"ltr";var t=frappe.render_template("print_template",i),e=window.open();e||frappe.msgprint(__("Please enable pop-ups in your browser")),e.document.write(t),e.document.close()},frappe.render_tree=function(i){i.base_url=frappe.urllib.get_base_url(),i.landscape=!1,i.print_css=frappe.boot.print_css,i.print_format_css_path=frappe.assets.bundled_asset("print_format.bundle.css");var t=frappe.render_template("print_tree",i),e=window.open();e||frappe.msgprint(__("Please enable pop-ups in your browser")),e.document.write(t),e.document.close()};frappe.render_pdf=function(i,t={}){var e=new FormData;e.append("html",i),t.orientation&&e.append("orientation",t.orientation);var r=new Blob([],{type:"text/xml"});e.append("blob",r);var n=new XMLHttpRequest;n.open("POST","/api/method/frappe.utils.print_format.report_to_pdf"),n.setRequestHeader("X-Frappe-CSRF-Token",frappe.csrf_token),n.responseType="arraybuffer",n.onload=function(a){if(this.status===200){var s=new Blob([a.currentTarget.response],{type:"application/pdf"}),o=URL.createObjectURL(s);let l=document.createElement("a");document.body.appendChild(l),l.style="display: none",l.href=o,l.download=t.report_name||"report.pdf",l.click(),window.URL.revokeObjectURL(o)}},n.send(e)};frappe.templates.page=`<div class="page-head flex">
	<div class="container">
		<div class="row flex align-center page-head-content justify-between">
			<div class="col-md-4 col-sm-6 col-xs-8 page-title">
				<!-- <div class="title-image hide hidden-md hidden-lg"></div> -->
				<!-- title -->
				<span class="sidebar-toggle-btn">
					<svg class="icon icon-md sidebar-toggle-placeholder">
						<use href="#icon-menu"></use>
					</svg>
					<span class="sidebar-toggle-icon">
						<svg class="icon icon-md">
							<use href="#icon-sidebar-collapse">
							</use>
						</svg>
					</span>
				</span>
				<div class="flex fill-width title-area">
					<div>
						<div class="flex">
							<h3 class="ellipsis title-text"></h3>
							<span class="indicator-pill whitespace-nowrap"></span>
						</div>
						<div class="ellipsis sub-heading hide text-muted"></div>
					</div>
					<button class="btn btn-default more-button hide">
						<svg class="icon icon-sm">
							<use href="#icon-dot-horizontal">
							</use>
						</svg>
					</button>
				</div>
			</div>
			<div class="flex col page-actions justify-content-end">
				<!-- buttons -->
				<div class="custom-actions hide hidden-xs hidden-md"></div>
				<div class="standard-actions flex">
					<span class="page-icon-group hide hidden-xs hidden-sm"></span>
					<div class="menu-btn-group hide">
						<button type="button" class="btn btn-default icon-btn" data-toggle="dropdown" aria-expanded="false">
							<span>
								<span class="menu-btn-group-label">
									<svg class="icon icon-sm">
										<use href="#icon-dot-horizontal">
										</use>
									</svg>
								</span>
							</span>
						</button>
						<ul class="dropdown-menu dropdown-menu-right" role="menu"></ul>
					</div>
					<button class="btn btn-secondary btn-default btn-sm hide"></button>
					<div class="actions-btn-group hide">
						<button type="button" class="btn btn-primary btn-sm" data-toggle="dropdown" aria-expanded="false">
							<span>
								<span class="hidden-xs actions-btn-group-label">{%= __("Actions") %}</span>
								<svg class="icon icon-xs">
									<use href="#icon-select">
									</use>
								</svg>
							</span>
						</button>
						<ul class="dropdown-menu dropdown-menu-right" role="menu">
						</ul>
					</div>
					<button class="btn btn-primary btn-sm hide primary-action"></button>
				</div>
			</div>
		</div>
	</div>
</div>
<div class="container page-body">
	<div class="page-toolbar hide">
		<div class="container">
		</div>
	</div>
	<div class="page-wrapper">
		<div class="page-content">
			<div class="workflow-button-area btn-group pull-right hide"></div>
			<div class="clearfix"></div>
		</div>
	</div>
</div>
`;frappe.ui.make_app_page=function(i){return i.parent.page=new frappe.ui.Page(i),i.parent.page};frappe.ui.pages={};frappe.ui.Page=class{constructor(t){$.extend(this,t),this.set_document_title=!0,this.buttons={},this.fields_dict={},this.views={},this.make(),frappe.ui.pages[frappe.get_route_str()]=this}make(){this.wrapper=$(this.parent),this.add_main_section(),this.setup_scroll_handler(),this.setup_sidebar_toggle()}setup_scroll_handler(){let t=0;window.addEventListener("scroll",frappe.utils.throttle(()=>{$(".page-head").toggleClass("drop-shadow",!!document.documentElement.scrollTop);let e=document.documentElement.scrollTop;e>0&&t<=e?$(".page-head").css("top","-15px"):$(".page-head").css("top","var(--navbar-height)"),t=e}),500)}get_empty_state(t,e,r){return $(`<div class="page-card-container">
			<div class="page-card">
				<div class="page-card-head">
					<span class="indicator blue">
						${t}</span>
				</div>
				<p>${e}</p>
				<div>
					<button class="btn btn-primary btn-sm">${r}</button>
				</div>
			</div>
		</div>`)}load_lib(t){frappe.require(this.required_libs,t)}add_main_section(){$(frappe.render_template("page",{})).appendTo(this.wrapper),this.single_column?this.add_view("main",'<div class="row layout-main">					<div class="col-md-12 layout-main-section-wrapper">						<div class="layout-main-section"></div>						<div class="layout-footer hide"></div>					</div>				</div>'):this.add_view("main",`
				<div class="row layout-main">
					<div class="col-lg-2 layout-side-section"></div>
					<div class="col layout-main-section-wrapper">
						<div class="layout-main-section"></div>
						<div class="layout-footer hide"></div>
					</div>
				</div>
			`),this.setup_page()}setup_page(){this.$title_area=this.wrapper.find(".title-area"),this.$sub_title_area=this.wrapper.find("h6"),this.title&&this.set_title(this.title),this.icon&&this.get_main_icon(this.icon),this.body=this.main=this.wrapper.find(".layout-main-section"),this.container=this.wrapper.find(".page-body"),this.sidebar=this.wrapper.find(".layout-side-section"),this.footer=this.wrapper.find(".layout-footer"),this.indicator=this.wrapper.find(".indicator-pill"),this.page_actions=this.wrapper.find(".page-actions"),this.btn_primary=this.page_actions.find(".primary-action"),this.btn_secondary=this.page_actions.find(".btn-secondary"),this.menu=this.page_actions.find(".menu-btn-group .dropdown-menu"),this.menu_btn_group=this.page_actions.find(".menu-btn-group"),this.actions=this.page_actions.find(".actions-btn-group .dropdown-menu"),this.actions_btn_group=this.page_actions.find(".actions-btn-group"),this.standard_actions=this.page_actions.find(".standard-actions"),this.custom_actions=this.page_actions.find(".custom-actions"),this.page_form=$('<div class="page-form row hide"></div>').prependTo(this.main),this.inner_toolbar=this.custom_actions,this.icon_group=this.page_actions.find(".page-icon-group"),this.make_page&&this.make_page(),this.card_layout&&this.main.addClass("frappe-card");let t=this.menu_btn_group.find("button");t.attr("title",__("Menu")).tooltip({delay:{show:600,hide:100}}),frappe.ui.keys.get_shortcut_group(this.page_actions[0]).add(t,t.find(".menu-btn-group-label"));let e=this.actions_btn_group.find("button");frappe.ui.keys.get_shortcut_group(this.page_actions[0]).add(e,e.find(".actions-btn-group-label"))}setup_sidebar_toggle(){let t=$(".page-head").find(".sidebar-toggle-btn"),e=this.wrapper.find(".layout-side-section");this.disable_sidebar_toggle||!e.length?t.remove():(t.attr("title",__("Toggle Sidebar")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),t.click(()=>{frappe.utils.is_xs()||frappe.utils.is_sm()?this.setup_overlay_sidebar():e.toggle(),$(document.body).trigger("toggleSidebar"),this.update_sidebar_icon()}))}setup_overlay_sidebar(){let t=this.sidebar.find(".overlay-sidebar").addClass("opened");$('<div class="close-sidebar">').hide().appendTo(this.sidebar).fadeIn();let e=$("html").css("overflow-y","hidden");this.sidebar.find(".close-sidebar").on("click",n=>r(n)),this.sidebar.on("click","button:not(.dropdown-toggle)",n=>r(n));let r=()=>{e.css("overflow-y",""),this.sidebar.find("div.close-sidebar").fadeOut(()=>{t.removeClass("opened").find(".dropdown-toggle").removeClass("text-muted")})}}update_sidebar_icon(){let e=$(".page-head").find(".sidebar-toggle-btn").find(".sidebar-toggle-icon"),r=this.wrapper.find(".layout-side-section"),n=$(r).is(":visible");e.html(frappe.utils.icon(n?"sidebar-collapse":"sidebar-expand","md"))}set_indicator(t,e){this.clear_indicator().removeClass("hide").html(`<span>${t}</span>`).addClass(e)}add_action_icon(t,e,r="",n){let a=$(`
			<button class="text-muted btn btn-default ${r} icon-btn">
				${frappe.utils.icon(t)}
			</button>
		`);return a.appendTo(this.icon_group.removeClass("hide")),a.click(e),a.attr("title",__(n||frappe.unscrub(t))).tooltip({delay:{show:600,hide:100},trigger:"hover"}),a}clear_indicator(){return this.indicator.removeClass().addClass("indicator-pill whitespace-nowrap hide")}get_icon_label(t,e){let r=t,n="xs";return typeof t=="object"&&(r=t.icon,n=t.size||"xs"),`${t?frappe.utils.icon(r,n):""} <span class="hidden-xs"> ${__(e)} </span>`}set_action(t,e){let r=this;e.icon&&(e.label=this.get_icon_label(e.icon,e.label)),this.clear_action_of(t),t.removeClass("hide").prop("disabled",!1).html(e.label).on("click",function(){let a=e.click.apply(this,[t]);r.btn_disable_enable(t,a)}),e.working_label&&t.attr("data-working-label",e.working_label);let n=t.find("span");frappe.ui.keys.get_shortcut_group(this).add(t,n.length?n:t)}set_primary_action(t,e,r,n){return this.set_action(this.btn_primary,{label:t,click:e,icon:r,working_label:n}),this.btn_primary}set_secondary_action(t,e,r,n){return this.set_action(this.btn_secondary,{label:t,click:e,icon:r,working_label:n}),this.btn_secondary}clear_action_of(t){t.addClass("hide").unbind("click").removeAttr("data-working-label")}clear_primary_action(){this.clear_action_of(this.btn_primary)}clear_secondary_action(){this.clear_action_of(this.btn_secondary)}clear_actions(){this.clear_primary_action(),this.clear_secondary_action()}clear_custom_actions(){this.custom_actions.addClass("hide").empty()}clear_icons(){this.icon_group.addClass("hide").empty()}add_menu_item(t,e,r,n,a){return this.add_dropdown_item({label:t,click:e,standard:r,parent:this.menu,shortcut:n,show_parent:a})}add_custom_menu_item(t,e,r,n,a,s=null){return this.add_dropdown_item({label:e,click:r,standard:n,parent:t,shortcut:a,icon:s})}clear_menu(){this.clear_btn_group(this.menu)}show_menu(){this.menu_btn_group.removeClass("hide")}hide_menu(){this.menu_btn_group.addClass("hide")}show_icon_group(){this.icon_group.removeClass("hide")}hide_icon_group(){this.icon_group.addClass("hide")}show_actions_menu(){this.actions_btn_group.removeClass("hide")}hide_actions_menu(){this.actions_btn_group.addClass("hide")}add_action_item(t,e,r){return this.add_dropdown_item({label:t,click:e,standard:r,parent:this.actions})}add_actions_menu_item(t,e,r,n){return this.add_dropdown_item({label:t,click:e,standard:r,shortcut:n,parent:this.actions,show_parent:!1})}clear_actions_menu(){this.clear_btn_group(this.actions)}add_dropdown_item({label:t,click:e,standard:r,parent:n,shortcut:a,show_parent:s=!0,icon:o=null}){s&&n.parent().removeClass("hide hidden-xl");let l=this.is_in_group_button_dropdown(n,"li > a.grey-link > span",t);if(l)return l;let u,c="";if(o&&(c=`<span class="menu-item-icon">${frappe.utils.icon(o)}</span>`),a){let h=this.prepare_shortcut_obj(a,e,t);u=$(`
				<li>
					<a class="grey-link dropdown-item" href="#" onClick="return false;">
						${c}
						<span class="menu-item-label">${t}</span>
						<kbd class="pull-right">
							<span>${h.shortcut_label}</span>
						</kbd>
					</a>
				</li>
			`),frappe.ui.keys.add_shortcut(h)}else u=$(`
				<li>
					<a class="grey-link dropdown-item" href="#" onClick="return false;">
						${c}
						<span class="menu-item-label">${t}</span>
					</a>
				</li>
			`);return l=u.find("a").on("click",e),r?u.appendTo(n):(this.divider=n.find(".dropdown-divider"),this.divider.length||(this.divider=$('<li class="dropdown-divider user-action"></li>').prependTo(n)),u.addClass("user-action").insertBefore(this.divider)),frappe.ui.keys.get_shortcut_group(n.get(0)).add(l,l.find(".menu-item-label")),l}prepare_shortcut_obj(t,e,r){let n;return typeof t=="string"?n={shortcut:t}:n=t,frappe.utils.is_mac()?n.shortcut_label=n.shortcut.replace("Ctrl","\u2318"):n.shortcut_label=n.shortcut,n.shortcut=n.shortcut.toLowerCase(),n.action||(n.action=e),n.description||(n.description=r),n.page=this,n}is_in_group_button_dropdown(t,e,r){if(e||(e="li"),!r||!t)return!1;let n=`${e}[data-label="${encodeURIComponent(r)}"]`,a=$(t).find(n);return(a==null?void 0:a.length)>0&&a}clear_btn_group(t){t.empty(),t.parent().addClass("hide")}add_divider(){return $('<li class="dropdown-divider"></li>').appendTo(this.menu)}get_or_add_inner_group_button(t){var e=this.inner_toolbar.find(`.inner-group-button[data-label="${encodeURIComponent(t)}"]`);return e.length||(e=$(`<div class="inner-group-button" data-label="${encodeURIComponent(t)}">
					<button type="button" class="btn btn-default ellipsis" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						${t}
						${frappe.utils.icon("select","xs")}
					</button>
					<div role="menu" class="dropdown-menu"></div>
				</div>`).appendTo(this.inner_toolbar)),e}get_inner_group_button(t){return this.inner_toolbar.find(`.inner-group-button[data-label="${encodeURIComponent(t)}"]`)}set_inner_btn_group_as_primary(t){this.get_or_add_inner_group_button(t).find("button").removeClass("btn-default").addClass("btn-primary")}btn_disable_enable(t,e){e&&e.then?(t.prop("disabled",!0),e.then(()=>{t.prop("disabled",!1)})):e&&e.always&&(t.prop("disabled",!0),e.always(()=>{t.prop("disabled",!1)}))}add_inner_button(t,e,r,n="default"){var a=this;let s=function(){let c=$(this),h=e();a.btn_disable_enable(c,h)},o=r?`${r} > ${t}`:t;if(this.add_menu_item(o,s,!1,!1,!1).parent().addClass("hidden-xl"),this.menu_btn_group.hasClass("hide")&&this.menu_btn_group.removeClass("hide").addClass("hidden-xl"),r){var u=this.get_or_add_inner_group_button(r);if($(this.inner_toolbar).removeClass("hide"),!this.is_in_group_button_dropdown(u.find(".dropdown-menu"),"a",t))return $(`<a class="dropdown-item" href="#" onclick="return false;" data-label="${encodeURIComponent(t)}">${t}</a>`).on("click",s).appendTo(u.find(".dropdown-menu"))}else{let c=this.inner_toolbar.find(`button[data-label="${encodeURIComponent(t)}"]`);return c.length==0&&(c=$(`<button data-label="${encodeURIComponent(t)}" class="btn btn-${n} ellipsis">
					${__(t)}
				</button>`),c.on("click",s),c.appendTo(this.inner_toolbar.removeClass("hide"))),c}}remove_inner_button(t,e){if(typeof t=="string"&&(t=[t]),t=t.map(n=>__(n)),e){var r=this.get_inner_group_button(__(e));r.length&&r.find(`.dropdown-item[data-label="${encodeURIComponent(t)}"]`).remove(),r.find(".dropdown-item").length===0&&r.remove()}else this.inner_toolbar.find(`button[data-label="${encodeURIComponent(t)}"]`).remove()}change_inner_button_type(t,e,r){let n;if(e){var a=this.get_inner_group_button(__(e));a.length&&(n=a.find(`.dropdown-item[data-label="${encodeURIComponent(t)}"]`))}else n=this.inner_toolbar.find(`button[data-label="${encodeURIComponent(t)}"]`);n&&n.removeClass().addClass(`btn btn-${r} ellipsis`)}add_inner_message(t){let e=$(`<span class='inner-page-message text-muted small'>${t}</div>`);return this.inner_toolbar.find(".inner-page-message").remove(),this.inner_toolbar.removeClass("hide").prepend(e),e}clear_inner_toolbar(){this.inner_toolbar.empty().addClass("hide")}add_sidebar_item(t,e,r,n){var a=this.sidebar.find(".sidebar-menu.standard-actions"),s=$("<li>"),o=$("<a>").html(t).on("click",e).appendTo(s);return r?s.insertAfter(a.find(r)):n?s.prependTo(a):s.appendTo(a),o}clear_user_actions(){this.menu.find(".user-action").remove()}get_title_area(){return this.$title_area}set_title(t,e=null,r=!0,n=""){t||(t=""),r&&(t=strip_html(t)),this.title=t,frappe.utils.set_title(n||t),e&&(t=`${frappe.utils.icon(e)} ${t}`);let a=this.$title_area.find(".title-text");a.html(t),a.attr("title",this.title)}set_title_sub(t){this.$sub_title_area.html(t).toggleClass("hide",!t)}get_main_icon(t){return this.$title_area.find(".title-icon").html('<i class="'+t+' fa-fw"></i> ').toggle(!0)}add_help_button(t){}add_button(t,e,r){r||(r={});let n=$(`<button
			class="btn ${r.btn_class||"btn-default"} ${r.btn_size||"btn-sm"} ellipsis">
				${r.icon?frappe.utils.icon(r.icon):""}
				${t}
		</button>`);return this.add_menu_item(t,e,!1).parent().addClass("hidden-xl"),n.appendTo(this.custom_actions),n.on("click",e),this.custom_actions.removeClass("hide"),n}add_custom_button_group(t,e,r){let n=`<span class="hidden-xs">
			<span class="custom-btn-group-label">${__(t)}</span>
			${frappe.utils.icon("select","xs")}
		</span>`;e&&(n=`<span class="hidden-xs">
				${frappe.utils.icon(e)}
				<span class="custom-btn-group-label">${__(t)}</span>
				${frappe.utils.icon("select","xs")}
			</span>
			<span class="visible-xs">
				${frappe.utils.icon(e)}
			</span>`);let a=$(`
			<div class="custom-btn-group">
				<button type="button" class="btn btn-default btn-sm ellipsis" data-toggle="dropdown" aria-expanded="false">
					${n}
				</button>
				<ul class="dropdown-menu" role="menu"></ul>
			</div>
		`);return r||(r=this.custom_actions),r.removeClass("hide").append(a),a.find(".dropdown-menu")}add_dropdown_button(t,e,r,n){frappe.ui.toolbar.add_dropdown_button(t,e,r,n)}add_label(t){return this.show_form(),$("<label class='col-md-1 page-only-label'>"+t+" </label>").appendTo(this.page_form)}add_select(t,e){var r=this.add_field({label:t,fieldtype:"Select"});return r.$wrapper.find("select").empty().add_options(e)}add_data(t){var e=this.add_field({label:t,fieldtype:"Data"});return e.$wrapper.find("input").attr("placeholder",t)}add_date(t,e){var r=this.add_field({label:t,fieldtype:"Date",default:e});return r.$wrapper.find("input").attr("placeholder",t)}add_check(t){return $("<div class='checkbox'><label><input type='checkbox'>"+t+"</label></div>").appendTo(this.page_form).find("input")}add_break(){this.page_form.append('<div class="clearfix invisible-xs"></div>')}add_field(t,e){this.show_form(),t.placeholder||(t.placeholder=t.label),t.input_class="input-xs";var r=frappe.ui.form.make_control({df:t,parent:e||this.page_form,only_input:t.fieldtype!="Check"});if(r.refresh(),$(r.wrapper).addClass("col-md-2").attr("title",__(t.label)).tooltip({delay:{show:600,hide:100},trigger:"hover"}),t.fieldtype!="HTML")return r.$input||r.make_input(),r.$input.attr("placeholder",__(t.label)),t.fieldtype==="Check"&&$(r.wrapper).find(":first-child").removeClass("col-md-offset-4 col-md-8"),t.fieldtype=="Button"&&($(r.wrapper).find(".page-control-label").html("&nbsp;"),r.$input.addClass("btn-xs").css({width:"100%","margin-top":"-1px"})),t.default&&r.set_input(t.default),this.fields_dict[t.fieldname||t.label]=r,r}clear_fields(){this.page_form.empty()}show_form(){this.page_form.removeClass("hide")}hide_form(){this.page_form.addClass("hide")}get_form_values(){var t={};for(let e in this.fields_dict){let r=this.fields_dict[e];t[e]=r.get_value()}return t}add_view(t,e){let r=e;return typeof e=="string"&&(r=$(e)),this.views[t]=r.appendTo($(this.wrapper).find(".page-content")),this.current_view?this.views[t].toggle(!1):this.current_view=this.views[t],this.views[t]}set_view(t){this.current_view_name!==t&&(this.current_view&&this.current_view.toggle(!1),this.current_view=this.views[t],this.previous_view_name=this.current_view_name,this.current_view_name=t,this.views[t].toggle(!0),this.wrapper.trigger("view-change"))}};frappe.provide("frappe.ui");frappe.ui.Slide=class{constructor(t=null){$.extend(this,t),this.setup()}setup(){this.$wrapper=$('<div class="slide-wrapper hidden"></div>').attr({"data-slide-id":this.id,"data-slide-name":this.name}).appendTo(this.parent)}make(){this.before_load&&this.before_load(this),this.$body=$(`<div class="slide-body">
			<div class="content text-center">
				<h1 class="title slide-title">${__(this.title)}</h1>
			</div>
			<div class="form-wrapper">
				<div class="form"></div>
				<div class="add-more text-center" style="margin-top: 5px;">
					<button class="form-more-btn hide btn btn-default btn-xs">
						<span>Add More</span>
					</button>
				</div>
			</div>
		</div>`).appendTo(this.$wrapper),this.$content=this.$body.find(".content"),this.$form=this.$body.find(".form"),this.$primary_btn=this.slides_footer.find(".primary"),this.$form_wrapper=this.$body.find(".form-wrapper"),this.image_src&&this.$content.append($(`<img src="${this.image_src}" style="margin: 20px;">`)),this.help&&this.$content.append($(`<p class="slide-help">${__(this.help)}</p>`)),this.reqd_fields=[],this.refresh(),this.made=!0}refresh(){this.render_parent_dots(),this.done?this.setup_done_state():this.setup_form()}setup_form(){this.form=new frappe.ui.FieldGroup({fields:this.get_atomic_fields(),body:this.$form[0],no_submit_on_enter:!0}),this.form.make(),this.add_more&&this.bind_more_button(),this.set_reqd_fields(),this.onload&&this.onload(this),this.set_reqd_fields()}setup_done_state(){}get_atomic_fields(){var t=JSON.parse(JSON.stringify(this.fields));return this.add_more&&(this.count=1,t=t.map((e,r)=>(e.fieldname&&(e.fieldname+="_1"),r===1&&this.mandatory_entry&&(e.reqd=1),e.static||e.label&&e.label,e))),t}set_reqd_fields(){var t=this.form.fields_dict;this.reqd_fields=[],Object.keys(t).map(e=>{t[e].df.reqd&&this.reqd_fields.push(t[e])})}set_values(t){return this.values=this.form.get_values(t),!(this.values===null||this.validate&&!this.validate())}bind_more_button(){this.$more=this.$body.find(".form-more-btn"),this.$more.removeClass("hide").on("click",()=>{this.count++;var t=JSON.parse(JSON.stringify(this.fields));this.form.add_fields(t.map(e=>(e.fieldname&&(e.fieldname+="_"+this.count),e.static||e.label&&e.label,e.reqd=0,e))),this.count===this.max_count&&this.$more.addClass("hide")})}resetup_primary_button(){this.unbind_primary_action(),this.bind_fields_to_action_btn(),this.reset_action_button_state(),this.bind_primary_action()}bind_fields_to_action_btn(){var t=this;this.reqd_fields.map(e=>{e.$wrapper.on("change input click",()=>{t.reset_action_button_state()}),e.$wrapper.on("keydown","input",r=>{r.key=="Enter"&&t.reset_action_button_state()})})}reset_action_button_state(){var t=this.reqd_fields.filter(e=>!e.get_value());t.length?this.slides_footer.find(".action").addClass("disabled"):this.slides_footer.find(".action").removeClass("disabled")}unbind_primary_action(){this.slides_footer.find(".primary").off()}bind_primary_action(){this.slides_footer.find(".primary").on("click.primary_action",()=>{this.primary_action()})}is_last_slide(){return this.id===this.parent[0].children.length-1}before_show(){}show_slide(){this.$wrapper.removeClass("hidden"),this.before_show(),this.resetup_primary_button(),this.done?this.$primary_btn.hide():(this.$body.find(".form-control").first().focus(),this.$primary_btn.show())}hide_slide(){this.$wrapper.addClass("hidden")}get_input(t){return this.form.get_input(t)}get_field(t){return this.form.get_field(t)}get_value(t){return this.form.get_value(t)}destroy(){this.$body.remove()}primary_action(){}};frappe.ui.Slides=class{constructor({parent:t=null,slides:e=[],slide_class:r=null,unidirectional:n=0,done_state:a=0,before_load:s=null,on_update:o=null}){this.parent=t,this.slides=e,this.slide_class=r,this.unidirectional=n,this.done_state=a,this.before_load=s,this.on_update=o,this.page_name="setup-wizard",this.slide_dict={},this.made_slide_ids=[],this.values={},this.make()}make(){this.$slide_progress=$("<div>").addClass("slides-progress text-center text-extra-muted").appendTo(this.parent),this.container=$("<div>").addClass("slides-wrapper").attr({tabindex:-1}).appendTo(this.parent),this.$body=$("<div>").addClass("slide-container").appendTo(this.container),this.$footer=$("<div>").addClass("slide-footer").appendTo(this.container),this.render_progress_dots(),this.make_prev_next_complete_buttons(),this.before_load&&this.before_load(this.$footer),this.setup(),this.show_slide(0)}setup(){this.slides.map((t,e)=>{this.slide_dict[e]?this.made_slide_ids.includes(e+"")&&(this.slide_dict[e].done=!1,this.slide_dict[e].destroy(),this.slide_dict[e].make()):(this.slide_dict[e]=new this.slide_class($.extend(this.slides[e],{parent:this.$body,slides_footer:this.$footer,render_parent_dots:this.render_progress_dots.bind(this),id:e})),this.unidirectional||this.slide_dict[e].make())})}refresh(t){this.render_progress_dots(),this.make_prev_next_complete_buttons(),this.show_hide_prev_next(t),this.$body.find(".form-control").first().focus()}render_progress_dots(){this.$slide_progress.empty(),!(this.slides.length<=1)&&(this.slides.map((t,e)=>{let r=$(`<div class="slide-step">
				<div class="slide-step-indicator"></div>
				<div class="slide-step-complete">${frappe.utils.icon("tick","xs")}</div>
			</div>`).attr({"data-step-id":e});this.done_state&&(this.slide_dict[e]&&this.slide_dict[e].done||t.done)&&r.addClass("step-success"),this.unidirectional&&e===this.current_id&&r.addClass("active"),this.$slide_progress.append(r)}),this.completed=0,this.slides.map((t,e)=>{this.slide_dict[e]?this.slide_dict[e].done&&this.completed++:t.done&&this.completed++}),this.on_update&&this.on_update(this.completed,this.slides.length),this.unidirectional||this.bind_progress_dots())}make_prev_next_complete_buttons(){this.$footer.empty(),$(`<div class="row">
			<div class="col-sm-4 text-left prev-div">
				<button class="prev-btn btn btn-secondary btn-sm" tabindex="0">${__("Previous",null,"Go to previous slide")}</button>
			</div>
			<div class="col-sm-8 text-right next-div">
				<button class="complete-btn btn btn-sm primary">${__("Complete Setup",null,"Finish the setup wizard")}</button>
				<button class="next-btn btn btn-default btn-sm" tabindex="0">${__("Next",null,"Go to next slide")}</button>
			</div>
		</div>`).appendTo(this.$footer),this.$prev_btn=this.$footer.find(".prev-btn").attr("tabIndex",0).on("click",()=>this.show_slide(this.current_id-1)),this.$next_btn=this.$footer.find(".next-btn").attr("tabIndex",0).on("click",()=>{this.done_state&&(this.slide&&(this.slide.done=!0),this.current_slide&&(this.current_slide.done=!0)),(!this.unidirectional||this.unidirectional&&this.current_slide.set_values())&&this.show_slide(this.current_id+1)}),this.$complete_btn=this.$footer.find(".complete-btn").attr("tabIndex",0)}bind_progress_dots(){var t=this;this.$slide_progress.find(".fa-circle").addClass("link").on("click",function(){let e=$(this).attr("data-step-id");t.show_slide(e)})}before_show_slide(){return!0}show_slide(t){t=cint(t),!(!this.before_show_slide()||this.current_slide&&this.current_id===t)&&(this.update_values(),this.current_slide&&this.current_slide.hide_slide(),this.unidirectional&&!this.slide_dict[t].made&&this.slide_dict[t].make(),this.current_id=t,this.current_slide=this.slide_dict[t],this.current_slide.show_slide(),this.refresh(t))}destroy_slide(t){this.slide_dict[t]&&this.slide_dict[t].destroy(),this.slide_dict[t]=null}on_update(t,e){}show_hide_prev_next(t){t===0?this.$prev_btn.hide():this.$prev_btn.show(),t+1===this.slides.length?this.$next_btn.hide():this.$next_btn.show()}get_values(){var t={};return $.each(this.slide_dict,function(e,r){r.values&&$.extend(t,r.values)}),t}update_values(){this.values=$.extend(this.values,this.get_values())}};frappe.find={page_primary_action:()=>$(".page-actions:visible .btn-primary"),field:(i,t)=>new Promise(e=>{let r=$(`[data-fieldname="${i}"] :input`);t?(r.val(t).trigger("change"),frappe.after_ajax(()=>{e(r)})):e(r)})};frappe.ui.IconBar=class{constructor(t,e){this.parent=t,this.buttons={},this.make(e)}make(t){this.$wrapper=$('<div class="iconbar-wrapper hide"></div>').appendTo(this.parent);for(var e=0;e<t;e++)this.get_group(e+1)}get_group(t){var e=this.$wrapper.find(".iconbar-"+t+" ul");return e.length||(e=$('<div class="iconbar iconbar-'+t+' hide"><ul></ul></div>').appendTo(this.$wrapper).find("ul")),e}add_btn(t,e,r,n){var a=this.get_group(t),s=$('<li><i class="'+e+'"></i></li>').appendTo(a).on("click",function(){return n.apply(this),!1});return s.find("i").attr("title",r).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.$wrapper.find(".iconbar-"+t).removeClass("hide"),this.show(),s}hide(t){t?(this.$wrapper.find(".iconbar-"+t).addClass("hide"),this.check_if_all_hidden()):this.$wrapper.addClass("hide").trigger("hidden")}show(t){t?(this.$wrapper.find(".iconbar-"+t).removeClass("hide"),this.show()):this.$wrapper.hasClass("hide")&&this.$wrapper.removeClass("hide").trigger("shown")}clear(t){var e=this;this.$wrapper.find(".iconbar-"+t).addClass("hide").find("ul").empty(),this.check_if_all_hidden()}check_if_all_hidden(){this.$wrapper.find(".iconbar:visible").length||this.hide()}};frappe.ui.form.LinkSelector=class{constructor(t){$.extend(this,t);var e=this;this.doctype!="[Select]"?frappe.model.with_doctype(this.doctype,function(r){e.make()}):this.make()}make(){var t=this;this.start=0,this.dialog=new frappe.ui.Dialog({title:__("Select {0}",[this.doctype=="[Select]"?__("value"):__(this.doctype)]),fields:[{fieldtype:"Data",fieldname:"txt",label:__("Beginning with"),description:__("You can use wildcard %")},{fieldtype:"HTML",fieldname:"results"},{fieldtype:"Button",fieldname:"more",label:__("More"),click:()=>{t.start+=20,t.search()}}],primary_action_label:__("Search"),primary_action:function(){t.start=0,t.search()}}),this.txt&&this.dialog.fields_dict.txt.set_input(this.txt),this.dialog.get_input("txt").on("keypress",function(e){e.which===13&&(t.start=0,t.search())}),this.dialog.show(),this.search()}search(){var t={txt:this.dialog.fields_dict.txt.get_value(),searchfield:"name",start:this.start},e=this;this.target.set_custom_query&&this.target.set_custom_query(t),this.target.is_grid&&this.target.fieldinfo[this.fieldname]&&this.target.fieldinfo[this.fieldname].get_query&&$.extend(t,this.target.fieldinfo[this.fieldname].get_query(cur_frm.doc)),frappe.link_search(this.doctype,t,function(r){var n=e.dialog.fields_dict.results.$wrapper;if(t.start===0&&n.empty(),r.values.length?$.each(r.values,function(s,o){var l=$(repl('<div class="row link-select-row">						<div class="col-xs-4">							<b><a href="#">%(name)s</a></b></div>						<div class="col-xs-8">							<span class="text-muted">%(values)s</span></div>						</div>',{name:o[0],values:o.splice(1).join(", ")})).appendTo(n);l.find("a").attr("data-value",o[0]).click(function(){var u=$(this).attr("data-value");return e.target.is_grid?e.set_in_grid(u).then(()=>e.search()):(e.target.doctype?e.target.parse_validate_and_set_in_model(u):(e.target.set_input(u),e.target.$input.trigger("change")),e.dialog.hide()),!1})}):$('<p><br><span class="text-muted">'+__("No Results")+"</span>"+(frappe.model.can_create(e.doctype)?'<br><br><a class="new-doc btn btn-default btn-sm">'+__("Create a new {0}",[__(e.doctype)])+"</a>":"")+"</p>").appendTo(n).find(".new-doc").click(function(){frappe.new_doc(e.doctype)}),r.values.length<20){var a=e.dialog.fields_dict.more.$wrapper;a.hide()}},this.dialog.get_primary_btn())}set_in_grid(t){return new Promise(e=>{if(this.qty_fieldname)frappe.prompt({fieldname:"qty",fieldtype:"Float",label:"Qty",default:1,reqd:1},r=>{if(!(this.target.frm.doc[this.target.df.fieldname]||[]).some(a=>{if(a[this.fieldname]===t)return frappe.model.set_value(a.doctype,a.name,this.qty_fieldname,r.qty).then(()=>{frappe.show_alert(__("Added {0} ({1})",[t,a[this.qty_fieldname]])),e()}),!0})){let a=null;frappe.run_serially([()=>a=this.target.add_new_row(),()=>frappe.timeout(.1),()=>{let s={};return s[this.fieldname]=t,s[this.qty_fieldname]=r.qty,frappe.model.set_value(a.doctype,a.name,s)},()=>frappe.show_alert(__("Added {0} ({1})",[t,r.qty])),()=>e()])}},__("Set Quantity"),__("Set Quantity"));else if(this.dynamic_link_field){let r=this.target.add_new_row();frappe.model.set_value(r.doctype,r.name,this.dynamic_link_field,this.dynamic_link_reference),frappe.model.set_value(r.doctype,r.name,this.fieldname,t).then(()=>{frappe.show_alert(__("{0} {1} added",[this.dynamic_link_reference,t])),e()})}else{let r=this.target.add_new_row();frappe.model.set_value(r.doctype,r.name,this.fieldname,t).then(()=>{frappe.show_alert(__("{0} added",[t])),e()})}})}};frappe.link_search=function(i,t,e,r){t||(t={txt:""}),t.doctype=i,t.searchfield||(t.searchfield="name"),frappe.call({method:"frappe.desk.search.search_widget",type:"GET",args:t,callback:function(n){e&&e(n)},btn:r})};frappe.ui.form.MultiSelectDialog=class{constructor(t){Object.assign(this,t),this.for_select=this.doctype=="[Select]",this.for_select?this.init():frappe.model.with_doctype(this.doctype,()=>this.init())}init(){this.page_length=20,this.child_page_length=20,this.fields=this.get_fields(),this.make()}get_fields(){let t=this.get_primary_filters(),e=this.get_result_fields(),r=this.get_data_fields(),n=this.get_child_selection_fields();return[...t,...e,...r,...n]}get_result_fields(){let t=()=>{this.page_length+=20,this.get_results()};return[{fieldtype:"HTML",fieldname:"results_area"},{fieldtype:"Button",fieldname:"more_btn",label:__("More"),click:t.bind(this)}]}get_data_fields(){return this.data_fields&&this.data_fields.length?[{fieldtype:"Section Break"},...this.data_fields]:[]}get_child_selection_fields(){let t=[];if(this.allow_child_item_selection&&this.child_fieldname){let e=()=>{this.child_page_length+=20,this.show_child_results()};t.push({fieldtype:"HTML",fieldname:"child_selection_area"}),t.push({fieldtype:"Button",fieldname:"more_child_btn",hidden:1,label:__("More"),click:e.bind(this)})}return t}make(){let t=this.doctype.plural(),e=__("Select {0}",[this.for_select?__("value"):__(t)]);this.dialog=new frappe.ui.Dialog({title:e,fields:this.fields,size:this.size,primary_action_label:this.primary_action_label||__("Get Items"),secondary_action_label:__("Make {0}",[__(this.doctype)]),primary_action:()=>{let r=this.get_custom_filters(),n=cur_dialog.get_values(),a=this.get_selected_child_names(),s=[...this.get_checked_values(),...this.get_parent_name_of_selected_children()];this.action(s,Ht(lt(lt(lt({},this.args),n),r),{filtered_children:a}))},secondary_action:this.make_new_document.bind(this)}),this.add_filters_group&&this.make_filter_area(),this.args={},this.setup_results(),this.bind_events(),this.get_results(),this.dialog.show()}make_new_document(t){t&&(this.set_route_options(),frappe.new_doc(this.doctype,!0))}set_route_options(){if(frappe.route_options={},Array.isArray(this.setters))for(let t of this.setters)frappe.route_options[t.fieldname]=this.dialog.fields_dict[t.fieldname].get_value()||void 0;else Object.keys(this.setters).forEach(t=>{frappe.route_options[t]=this.dialog.fields_dict[t].get_value()||void 0})}setup_results(){this.$parent=$(this.dialog.body),this.$wrapper=this.dialog.fields_dict.results_area.$wrapper.append(`<div class="results my-3"
			style="border: 1px solid #d1d8dd; border-radius: 3px; height: 300px; overflow: auto;"></div>`),this.$results=this.$wrapper.find(".results"),this.$results.append(this.make_list_row())}show_child_results(){this.get_child_result().then(t=>{this.child_results=t.message||[],this.render_child_datatable(),this.$wrapper.addClass("hidden"),this.$child_wrapper.removeClass("hidden"),this.dialog.fields_dict.more_btn.$wrapper.hide()})}is_child_selection_enabled(){var t;return(t=this.dialog.fields_dict.allow_child_item_selection)==null?void 0:t.get_value()}toggle_child_selection(){this.is_child_selection_enabled()?this.show_child_results():(this.child_results=[],this.get_results(),this.$wrapper.removeClass("hidden"),this.$child_wrapper.addClass("hidden"))}render_child_datatable(){this.child_datatable?setTimeout(()=>{this.child_datatable.rowmanager.checkMap=[],this.child_datatable.refresh(this.get_child_datatable_rows()),this.$child_wrapper.find(".dt-scrollable").css("height","300px"),this.$child_wrapper.find(".dt-scrollable").css("overflow-y","scroll")},500):this.setup_child_datatable()}get_child_datatable_columns(){return[this.doctype,...this.child_columns].map(e=>({name:frappe.unscrub(e),editable:!1}))}get_child_datatable_rows(){return this.child_results.length>this.child_page_length?this.dialog.fields_dict.more_child_btn.toggle(!0):this.dialog.fields_dict.more_child_btn.toggle(!1),this.child_results.slice(0,this.child_page_length).map(t=>Object.values(t).slice(1))}setup_child_datatable(){let t=this.get_child_datatable_columns(),e=this.get_child_datatable_rows();this.$child_wrapper=this.dialog.fields_dict.child_selection_area.$wrapper,this.$child_wrapper.addClass("my-3"),this.child_datatable=new frappe.DataTable(this.$child_wrapper.get(0),{columns:t,data:e,layout:"fluid",inlineFilters:!0,serialNoColumn:!1,checkboxColumn:!0,cellHeight:35,noDataMessage:__("No Data"),disableReorderColumn:!0}),this.$child_wrapper.find(".dt-scrollable").css("height","300px")}get_primary_filters(){let t=[],e=new Array(3);return e[0]=[{fieldtype:"Data",label:__("Name"),fieldname:"search_term"}],e[1]=[],e[2]=[],$.isArray(this.setters)?this.setters.forEach((r,n)=>{e[(n+1)%3].push(r)}):Object.keys(this.setters).forEach((r,n)=>{let a=frappe.meta.docfield_map[this.doctype][r];e[(n+1)%3].push({fieldtype:a.fieldtype,label:a.label,fieldname:r,options:a.options,default:this.setters[r]})}),Object.seal&&Object.seal(e),this.allow_child_item_selection&&(this.child_doctype=frappe.meta.get_docfield(this.doctype,this.child_fieldname).options,e[0].push({fieldtype:"Check",label:__("Select {0}",[this.child_doctype]),fieldname:"allow_child_item_selection",onchange:this.toggle_child_selection.bind(this)})),t=[...e[0],{fieldtype:"Column Break"},...e[1],{fieldtype:"Column Break"},...e[2],{fieldtype:"Section Break",fieldname:"primary_filters_sb"}],this.add_filters_group&&t.push({fieldtype:"HTML",fieldname:"filter_area"}),t}make_filter_area(){this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:this.doctype,on_change:()=>{this.is_child_selection_enabled()?this.show_child_results():this.get_results()}}),this.filter_group.wrapper.find(".apply-filters").hide()}get_custom_filters(){return this.add_filters_group&&this.filter_group?this.filter_group.get_filters().reduce((t,e)=>Object.assign(t,{[e[1]]:[e[2],e[3]]}),{}):{}}bind_events(){let t=this;this.$results.on("click",".list-item-container",function(e){!$(e.target).is(":checkbox")&&!$(e.target).is("a")&&$(this).find(":checkbox").trigger("click")}),this.$results.on("click",".list-item--head :checkbox",e=>{this.$results.find(".list-item-container .list-row-check").prop("checked",$(e.target).is(":checked"))}),this.$parent.find(".input-with-feedback").on("change",()=>{frappe.flags.auto_scroll=!1,this.is_child_selection_enabled()?this.show_child_results():this.get_results()}),this.$parent.find('[data-fieldtype="Data"]').on("input",()=>{var e=$(this);clearTimeout(e.data("timeout")),e.data("timeout",setTimeout(function(){frappe.flags.auto_scroll=!1,t.is_child_selection_enabled()?t.show_child_results():(t.empty_list(),t.get_results())},300))})}get_parent_name_of_selected_children(){return!this.child_datatable||!this.child_datatable.datamanager.rows.length?[]:this.child_datatable.rowmanager.checkMap.reduce((e,r,n)=>{if(r==1){let a=this.child_results[n].parent;e.includes(a)||e.push(a)}return e},[])}get_selected_child_names(){return!this.child_datatable||!this.child_datatable.datamanager.rows.length?[]:this.child_datatable.rowmanager.checkMap.reduce((e,r,n)=>{if(r==1){let a=this.child_results[n].name;e.push(a)}return e},[])}get_checked_values(){return this.$results.find(".list-item-container").map(function(){if($(this).find(".list-row-check:checkbox:checked").length>0)return $(this).attr("data-item-name")}).get()}get_checked_items(){let t=this.get_checked_values();return this.results.filter(e=>t.includes(e.name))}get_datatable_columns(){return this.get_query&&this.get_query().query&&this.columns?this.columns:Array.isArray(this.setters)?["name",...this.setters.map(t=>t.fieldname)]:["name",...Object.keys(this.setters)]}make_list_row(t={}){var e=this;let r=Object.keys(t).length===0,n="";this.get_datatable_columns().forEach(function(s){n+=`<div class="list-item__content ellipsis">
				${r?`<span class="ellipsis text-muted" title="${__(frappe.model.unscrub(s))}">${__(frappe.model.unscrub(s))}</span>`:s!=="name"?`<span class="ellipsis result-row" title="${__(t[s]||"")}">${__(t[s]||"")}</span>`:`<a href="${"/app/"+frappe.router.slug(e.doctype)+"/"+t[s]||""}" class="list-id ellipsis" title="${__(t[s]||"")}">
							${__(t[s]||"")}</a>`}
			</div>`});let a=$(`<div class="list-item">
			<div class="list-item__content" style="flex: 0 0 10px;">
				<input type="checkbox" class="list-row-check" data-item-name="${t.name}" ${t.checked?"checked":""}>
			</div>
			${n}
		</div>`);return r?a.addClass("list-item--head"):a=$(`<div class="list-item-container" data-item-name="${t.name}"></div>`).append(a),a}render_result_list(t,e=0,r=!0){var n=this,a=n.dialog.fields_dict.more_btn.$wrapper;if(!frappe.flags.auto_scroll&&r&&this.empty_list(),a.hide(),$(".modal-dialog .list-item--head").css("z-index",1),t.length===0)return;e&&a.show();let s=this.get_checked_values();t.filter(o=>!s.includes(o.name)).forEach(o=>{n.$results.append(n.make_list_row(o))}),this.$results.find(".list-item--head").css("z-index",1),frappe.flags.auto_scroll&&this.$results.animate({scrollTop:n.$results.prop("scrollHeight")},500)}empty_list(){let t=this.get_checked_items().map(e=>Ht(lt({},e),{checked:!0}));this.$results.find(".list-item-container").remove(),this.render_result_list(t,0,!1)}get_filters_from_setters(){let t=this,e=(this.get_query?this.get_query().filters:{})||{},r=[];if($.isArray(this.setters))for(let n of this.setters)e[n.fieldname]=t.dialog.fields_dict[n.fieldname].get_value()||void 0,t.args[n.fieldname]=e[n.fieldname],r.push(n.fieldname);else Object.keys(this.setters).forEach(function(n){var a=t.dialog.fields_dict[n].get_value();t.dialog.fields_dict[n].df.fieldtype=="Data"&&a?e[n]=["like","%"+a+"%"]:(e[n]=a||void 0,t.args[n]=e[n],r.push(n))});return[e,r]}get_args_for_search(){let[t,e]=this.get_filters_from_setters(),r=this.get_custom_filters();return Object.assign(t,r),{doctype:this.doctype,txt:this.dialog.fields_dict.search_term.get_value(),filters:t,filter_fields:e,page_length:this.page_length+5,query:this.get_query?this.get_query().query:"",as_dict:1}}async perform_search(t){let e=await frappe.call({type:"GET",method:"frappe.desk.search.search_widget",no_spinner:!0,args:t}),r=e.values.length&&e.values.length>this.page_length?1:0;return[e,r]}async get_results(){let t=this.get_args_for_search(),[e,r]=await this.perform_search(t);r&&(e.values=e.values.splice(0,this.page_length)),this.results=[],e.values.length&&e.values.forEach(n=>{n.checked=0,this.results.push(n)}),this.render_result_list(this.results,r)}async get_filtered_parents_for_child_search(){let t=this.get_args_for_search();t.filter_fields=["name"];let[e,r]=await this.perform_search(t),n=[];return e.values.length&&(n=e.values.map(a=>a.name)),n}async add_parent_filters(t){let e=await this.get_filtered_parents_for_child_search();e.length&&t.push(["parent","in",e])}add_custom_child_filters(t){this.add_filters_group&&this.filter_group&&this.filter_group.get_filters().forEach(e=>{e[0]==this.child_doctype&&t.push([e[1],e[2],e[3]])})}async get_child_result(){let t=[["parentfield","=",this.child_fieldname]];return await this.add_parent_filters(t),this.add_custom_child_filters(t),frappe.call({method:"frappe.client.get_list",args:{doctype:this.child_doctype,filters:t,fields:["name","parent",...this.child_columns],parent:this.doctype,limit_page_length:this.child_page_length+5,order_by:"parent"}})}};frappe._.get_data_uri=i=>{let t=i.videoWidth,e=i.videoHeight,r=$("<canvas/>");return r[0].width=t,r[0].height=e,r[0].getContext("2d").drawImage(i,0,0,t,e),r[0].toDataURL("image/png")};function kw(){let i=document.createElement("input");return i.setAttribute("type","file"),i.setAttribute("accept","image/*"),i.setAttribute("multiple",""),i}function xw(i){return new Promise((t,e)=>{let r=new FileReader;r.onload=()=>t(r.result),r.onerror=e,r.readAsDataURL(i)})}frappe.ui.Capture=class{constructor(i={}){this.options=frappe.ui.Capture.OPTIONS,this.set_options(i),this.facing_mode="environment",this.images=[]}set_options(i){return this.options=lt(lt({},frappe.ui.Capture.OPTIONS),i),this}show(){this.build_dialog(),frappe.is_mobile()?this.show_for_mobile():this.show_for_desktop()}build_dialog(){let i=this;i.dialog=new frappe.ui.Dialog({title:this.options.title,animate:this.options.animate,fields:[{fieldtype:"HTML",fieldname:"capture"},{fieldtype:"HTML",fieldname:"total_count"}],on_hide:this.stop_media_stream()}),i.$template=$(frappe.ui.Capture.TEMPLATE);let t=i.dialog.get_field("capture");$(t.wrapper).html(i.$template),i.dialog.get_close_btn().on("click",()=>{i.hide()})}show_for_mobile(){let i=this;i.input||(i.input=kw()),i.input.onchange=async()=>{for(let t of i.input.files){let e=await xw(t);i.images.push(e)}i.render_preview(),i.dialog.show()},i.input.click()}show_for_desktop(){let i=this;this.render_stream().then(()=>{i.dialog.show()}).catch(t=>{throw i.options.error&&frappe.show_alert(frappe.ui.Capture.ERR_MESSAGE,3),t})}render_stream(){let i=this,t={video:{facingMode:this.facing_mode}};return navigator.mediaDevices.getUserMedia(t).then(e=>{i.stream=e,i.dialog.custom_actions.empty(),i.dialog.get_primary_btn().off("click"),i.setup_take_photo_action(),i.setup_preview_action(),i.setup_toggle_camera(),i.$template.find(".fc-stream-container").show(),i.$template.find(".fc-preview-container").hide(),i.video=i.$template.find("video")[0],i.video.srcObject=i.stream,i.video.load(),i.video.play()})}render_preview(){this.stop_media_stream(),this.$template.find(".fc-stream-container").hide(),this.$template.find(".fc-preview-container").show(),this.dialog.get_primary_btn().off("click");let i="";this.images.forEach((t,e)=>{i+=`
				<div class="mt-1 p-1 rounded col-md-3 col-sm-4 col-xs-4" data-idx="${e}">
					<span class="capture-remove-btn" data-idx="${e}">
						${frappe.utils.icon("close","lg")}
					</span>
					<img class="rounded" src="${t}" data-idx="${e}">
				</div>
			`}),this.$template.find(".fc-preview-container").empty(),$(this.$template.find(".fc-preview-container")).html(`<div class="row">
				${i}
			</div>`),this.setup_capture_action(),this.setup_submit_action(),this.setup_remove_action(),this.update_count(),this.dialog.custom_actions.empty()}setup_take_photo_action(){let i=this;this.dialog.set_primary_action(__("Take Photo"),()=>{let t=frappe._.get_data_uri(i.video);i.images.push(t),i.setup_preview_action(),i.update_count()})}setup_preview_action(){let i=this;!this.images.length||(this.dialog.set_secondary_action_label(__("Preview")),this.dialog.set_secondary_action(()=>{i.dialog.get_primary_btn().off("click"),i.render_preview()}))}setup_remove_action(){let i=this;this.$template[0].getElementsByClassName("capture-remove-btn").forEach(e=>{e.onclick=()=>{let r=parseInt(e.getAttribute("data-idx"));i.images.splice(r,1),i.render_preview()}})}update_count(){let i=this.dialog.get_field("total_count"),t=`${__("Total Images")}: <b>${this.images.length}`;this.images.length===0&&(t=__("No Images")),$(i.wrapper).html(`
			<div class="row mt-2">
				<div class="offset-4 col-4 d-flex justify-content-center">${t}</b></div>
			</div>
		`)}setup_toggle_camera(){let i=this;this.dialog.add_custom_action(__("Switch Camera"),()=>{i.facing_mode=i.facing_mode=="environment"?"user":"environment",frappe.show_alert({message:__("Switching Camera")}),i.stop_media_stream(),i.render_stream()},"btn-switch")}setup_capture_action(){let i=this;this.dialog.set_secondary_action_label(__("Capture")),this.dialog.set_secondary_action(()=>{frappe.is_mobile()?i.show_for_mobile():i.render_stream()})}setup_submit_action(){let i=this;this.dialog.set_primary_action(__("Submit"),()=>{i.hide(),i.callback&&i.callback(i.images)})}hide(){this.dialog&&this.dialog.hide(),this.stop_media_stream()}stop_media_stream(){this.stream&&this.stream.getTracks().forEach(i=>{i.stop()})}submit(i){this.callback=i}};frappe.ui.Capture.OPTIONS={title:__("Camera"),animate:!1,error:!1};frappe.ui.Capture.ERR_MESSAGE=__("Unable to load camera.");frappe.ui.Capture.TEMPLATE=`
<div class="frappe-capture">
	<div class="embed-responsive embed-responsive-16by9 fc-stream-container">
		<video class="fc-stream embed-responsive-item">${frappe.ui.Capture.ERR_MESSAGE}</video>
	</div>
	<div class="fc-preview-container px-2" style="display: none;">

	</div>
</div>
`;frappe.provide("frappe.ui");frappe.ui.app_icon={get_html:function(i,t){var e=i.icon,r=i.color;e&&e.match(/([\uE000-\uF8FF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDDFF])/g)&&(i.emoji=i.icon);var n="";return i.reverse&&(n="color: #36414C;"),r||(r="#4aa3df"),!e||i.emoji?e='<span class="inner" '+(i.reverse?'style="'+n+'"':"")+">"+(i.emoji||i._label[0].toUpperCase())+"</span>":e.split(".").slice(-1)[0]==="svg"?($.ajax({url:frappe.urllib.get_full_url(e),dataType:"text",async:!1,success:function(a){e=a}}),e='<object class="app-icon-svg">'+e+"</object>"):e='<i class="'+e+'" title="'+i._label+'" style="'+n+'"></i>','<div class="app-icon'+(t?" app-icon-small":"")+'" style="background-color: '+r+'" title="'+i._label+'">'+e+"</div>"}};frappe.provide("frappe.ui");frappe.ui.ThemeSwitcher=class{constructor(){this.setup_dialog(),this.refresh()}setup_dialog(){this.dialog=new frappe.ui.Dialog({title:__("Switch Theme")}),this.body=$('<div class="theme-grid"></div>').appendTo(this.dialog.$body),this.bind_events()}bind_events(){this.dialog.$wrapper.on("keydown",t=>{if(!this.themes)return;let e=frappe.ui.keys.get_key(t),r;if(e==="right")r=1;else if(e==="left")r=-1;else if(t.keyCode===13)this.hide();else return;let n=this.themes.findIndex(s=>s.name===this.current_theme),a=this.themes[n+r];if(!!a)return a.$html.click(),!1})}refresh(){this.current_theme=document.documentElement.getAttribute("data-theme-mode")||"light",this.fetch_themes().then(()=>{this.render()})}fetch_themes(){return new Promise(t=>{this.themes=[{name:"light",label:__("Frappe Light"),info:__("Light Theme")},{name:"dark",label:__("Timeless Night"),info:__("Dark Theme")},{name:"automatic",label:__("Automatic"),info:__("Uses system's theme to switch between light and dark mode")}],t(this.themes)})}render(){this.themes.forEach(t=>{let e=this.get_preview_html(t);e.appendTo(this.body),t.$html=e})}get_preview_html(t){let e=t.name==="automatic",r=$(`<div class="${this.current_theme==t.name?"selected":""}">
			<div data-theme=${e?"light":t.name}
				data-is-auto-theme="${e}" title="${t.info}">
				<div class="background">
					<div>
						<div class="preview-check" data-theme=${e?"dark":t.name}>
							${frappe.utils.icon("tick","xs")}
						</div>
					</div>
					<div class="navbar"></div>
					<div class="p-2">
						<div class="toolbar">
							<span class="text"></span>
							<span class="primary"></span>
						</div>
						<div class="foreground"></div>
						<div class="foreground"></div>
					</div>
				</div>
			</div>
			<div class="mt-3 text-center">
				<h5 class="theme-title">${t.label}</h5>
			</div>
		</div>`);return r.on("click",()=>{this.current_theme!==t.name&&(this.themes.forEach(n=>{n.$html.removeClass("selected")}),r.addClass("selected"),this.toggle_theme(t.name))}),r}toggle_theme(t){this.current_theme=t.toLowerCase(),document.documentElement.setAttribute("data-theme-mode",this.current_theme),frappe.show_alert(__("Theme Changed"),3),frappe.xcall("frappe.core.doctype.user.user.switch_theme",{theme:toTitle(t)})}show(){this.dialog.show()}hide(){this.dialog.hide()}};frappe.ui.add_system_theme_switch_listener=()=>{frappe.ui.dark_theme_media_query.addEventListener("change",()=>{frappe.ui.set_theme()})};frappe.ui.dark_theme_media_query=window.matchMedia("(prefers-color-scheme: dark)");frappe.ui.set_theme=i=>{let t=document.documentElement,e=t.getAttribute("data-theme-mode");i||e==="automatic"&&(i=frappe.ui.dark_theme_media_query.matches?"dark":"light"),t.setAttribute("data-theme",i||e)};var gA=Ut(sd());frappe.db={get_list:function(i,t){return t||(t={}),t.doctype=i,t.fields||(t.fields=["name"]),"limit"in t||(t.limit=20),new Promise(e=>{frappe.call({method:"frappe.desk.reportview.get_list",args:t,type:"GET",callback:function(r){e(r.message)}})})},exists:function(i,t){return new Promise(e=>{frappe.db.get_value(i,{name:t},"name").then(r=>{r.message&&r.message.name?e(!0):e(!1)})})},get_value:function(i,t,e,r,n){return frappe.call({method:"frappe.client.get_value",type:"GET",args:{doctype:i,fieldname:e,filters:t,parent:n},callback:function(a){r&&r(a.message)}})},get_single_value:(i,t)=>new Promise(e=>{frappe.call({method:"frappe.client.get_single_value",args:{doctype:i,field:t},type:"GET"}).then(r=>e(r?r.message:null))}),set_value:function(i,t,e,r,n){return frappe.call({method:"frappe.client.set_value",args:{doctype:i,name:t,fieldname:e,value:r},callback:function(a){n&&n(a.message)}})},get_doc:function(i,t,e){return new Promise((r,n)=>{frappe.call({method:"frappe.client.get",type:"GET",args:{doctype:i,name:t,filters:e},callback:a=>{frappe.model.sync(a.message),r(a.message)}}).fail(n)})},insert:function(i){return frappe.xcall("frappe.client.insert",{doc:i})},delete_doc:function(i,t){return new Promise(e=>{frappe.call("frappe.client.delete",{doctype:i,name:t},r=>e(r.message))})},count:function(i,t={}){let e=t.filters||{},r=Array.isArray(e)&&e.some(a=>a[0]!==i),n=[];return frappe.xcall("frappe.desk.reportview.get_count",{doctype:i,filters:e,fields:n,distinct:r})},get_link_options(i,t="",e={}){return new Promise(r=>{frappe.call({type:"GET",method:"frappe.desk.search.search_link",args:{doctype:i,txt:t,filters:e},callback(n){r(n.results)}})})}};frappe.provide("frappe.meta.docfield_map");frappe.provide("frappe.meta.docfield_copy");frappe.provide("frappe.meta.docfield_list");frappe.provide("frappe.meta.doctypes");frappe.provide("frappe.meta.precision_map");frappe.get_meta=function(i){return locals.DocType?locals.DocType[i]:null};$.extend(frappe.meta,{sync:function(i){$.each(i.fields,function(t,e){frappe.meta.add_field(e)}),frappe.meta.sync_messages(i),i.__print_formats&&frappe.model.sync(i.__print_formats),i.__workflow_docs&&frappe.model.sync(i.__workflow_docs)},add_field:function(i){frappe.provide("frappe.meta.docfield_map."+i.parent),frappe.meta.docfield_map[i.parent][i.fieldname||i.label]=i,frappe.meta.docfield_list[i.parent]||(frappe.meta.docfield_list[i.parent]=[]);for(var t in frappe.meta.docfield_list[i.parent]){var e=frappe.meta.docfield_list[i.parent][t];if(i.fieldname==e.fieldname)return}frappe.meta.docfield_list[i.parent].push(i)},make_docfield_copy_for:function(i,t,e=null){var r=frappe.meta.docfield_copy;r[i]||(r[i]={}),r[i][t]||(r[i][t]={}),e=e||frappe.meta.docfield_list[i]||[];for(var n=0,a=e.length;n<a;n++){var s=e[n];r[i][t][s.fieldname||s.label]=copy_dict(s)}},get_field:function(i,t,e){var r=frappe.meta.get_docfield(i,t,e);return r||frappe.model.std_fields.every(function(n){return n.fieldname===t?(r=n,!1):!0}),r},get_docfield:function(i,t,e){var r=frappe.meta.get_docfield_copy(i,e);return r?r[t]:null},set_formatter:function(i,t,e,r){frappe.meta.get_docfield(i,t,e).formatter=r},set_indicator_formatter:function(i,t,e,r,n){frappe.meta.get_docfield(i,t,e).formatter=function(a,s,o,l){return repl('<span class="indicator %(color)s">%(name)s</span>',{color:n(),name:r()})}},get_docfields:function(i,t,e){var r=frappe.meta.get_docfield_copy(i,t),n=frappe.meta.sort_docfields(r);return e&&(n=frappe.utils.filter_dict(n,e)),n},get_linked_fields:function(i){return $.map(frappe.get_meta(i).fields,function(t){return t.fieldtype=="Link"?t.options:null})},get_fields_to_check_permissions:function(i){var t=$.map(frappe.meta.get_docfields(i,name),function(e){return e.fieldtype==="Link"&&e.ignore_user_permissions!==1?e:null});return t=t.concat({label:"ID",fieldname:name,options:i}),t},sort_docfields:function(i){return $.map(i,function(t){return t}).sort(function(t,e){return t.idx-e.idx})},get_docfield_copy:function(i,t){return t?(frappe.meta.docfield_copy[i]&&frappe.meta.docfield_copy[i][t]||frappe.meta.make_docfield_copy_for(i,t),frappe.meta.docfield_copy[i][t]):frappe.meta.docfield_map[i]},get_fieldnames:function(i,t,e){return $.map(frappe.utils.filter_dict(frappe.meta.docfield_map[i],e),function(r){return r.fieldname})},has_field:function(i,t){let e=frappe.meta.docfield_map[i];return e&&e[t]},get_table_fields:function(i){return $.map(frappe.meta.docfield_list[i],function(t){return frappe.model.table_fields.includes(t.fieldtype)?t:null})},get_doctype_for_field:function(i,t){var e=null;return in_list(frappe.model.std_fields_list,t)||frappe.meta.has_field(i,t)?e=i:(frappe.meta.get_table_fields(i).every(function(r){return frappe.meta.has_field(r.options,t)||in_list(frappe.model.child_table_field_list,t)?(e=r.options,!1):!0}),e||console.log(__("Warning: Unable to find {0} in any table related to {1}",[t,__(i)]))),e},get_parentfield:function(i,t){var e=(frappe.get_doc("DocType",i).fields||[]).filter(r=>frappe.model.table_fields.includes(r.fieldtype)&&r.options===t);if(!e.length)throw"parentfield not found for "+i+", "+t;return e[0].fieldname},get_label:function(i,t,e){var r={name:__("ID"),creation:__("Created On"),docstatus:__("Document Status"),idx:__("Index"),modified:__("Last Updated On"),modified_by:__("Last Updated By"),owner:__("Created By"),_user_tags:__("Tags"),_liked_by:__("Liked By"),_comments:__("Comments"),_assign:__("Assigned To")};if(r[t])return r[t];var n=this.get_docfield(i,t,e);return(n?n.label:"")||t},get_print_sizes:function(){return["A0","A1","A2","A3","A4","A5","A6","A7","A8","A9","B0","B1","B2","B3","B4","B5","B6","B7","B8","B9","B10","C5E","Comm10E","DLE","Executive","Folio","Ledger","Legal","Letter","Tabloid","Custom"]},get_print_formats:function(i){var t=["Standard"],e=locals.DocType[i].default_print_format;let r=frappe.model.get_doc(":Print Settings","Print Settings").enable_raw_printing;var n=frappe.get_list("Print Format",{doc_type:i}).sort(function(s,o){return s>o?1:-1});if($.each(n,function(s,o){!in_list(t,o.name)&&o.print_format_type!=="JS"&&(cint(r)||!o.raw_printing)&&t.push(o.name)}),e&&e!="Standard"){var a=t.indexOf(e);t.splice(a,1).sort(),t.unshift(e)}return t},sync_messages:function(i){i.__messages&&$.extend(frappe._messages,i.__messages)},get_field_currency:function(i,t){var e=frappe.boot.sysdefaults.currency;if(!t&&cur_frm&&(t=cur_frm.doc),i&&i.options)if(t&&i.options.indexOf(":")!=-1){var r=i.options.split(":");if(r.length==3){var n=t[r[1]];!n&&cur_frm&&(n=cur_frm.doc[r[1]]),e=frappe.model.get_value(r[0],n,r[2])||frappe.model.get_value(":"+r[0],n,r[2])||e}}else t&&t[i.options]?e=t[i.options]:cur_frm&&cur_frm.doc[i.options]&&(e=cur_frm.doc[i.options]);return e},get_field_precision:function(i,t){var e=null;if(i&&i.precision)e=cint(i.precision);else if(i&&i.fieldtype==="Currency"){if(e=cint(frappe.defaults.get_default("currency_precision")),!e){var r=get_number_format(),n=get_number_format_info(r);e=n.precision}}else e=cint(frappe.defaults.get_default("float_precision"))||3;return e}});Object.assign(frappe.model,{docinfo:{},sync:function(i){var t;if(!i.docs&&!i.docinfo&&(i={docs:i}),t=$.isPlainObject(i.docs),t&&(i.docs=[i.docs]),i.docs)for(var e=0,r=i.docs.length;e<r;e++){var n=i.docs[e];locals[n.doctype]&&locals[n.doctype][n.name]?frappe.model.update_in_locals(n):frappe.model.add_to_locals(n),n.__last_sync_on=new Date,n.doctype==="DocType"&&frappe.meta.sync(n),n.localname&&frappe.model.rename_after_save(n,e)}return frappe.model.sync_docinfo(i),i.docs},rename_after_save:(i,t)=>{frappe.model.new_names[i.localname]=i.name,$(document).trigger("rename",[i.doctype,i.localname,i.name]),delete locals[i.doctype][i.localname],t===0&&(frappe.model.docinfo[i.doctype][i.name]=frappe.model.docinfo[i.doctype][i.localname],frappe.model.docinfo[i.doctype][i.localname]=void 0)},sync_docinfo:i=>{if(i.docinfo){let{doctype:t,name:e}=i.docinfo;frappe.model.docinfo[t]||(frappe.model.docinfo[t]={}),frappe.model.docinfo[t][e]=i.docinfo,Object.assign(frappe.boot.user_info,i.docinfo.user_info)}return i.docs},add_to_locals:function(i){locals[i.doctype]||(locals[i.doctype]={}),!i.name&&i.__islocal&&(i.parentfield||frappe.model.clear_doc(i),i.name=frappe.model.get_new_name(i.doctype),i.parentfield||frappe.provide("frappe.model.docinfo."+i.doctype+"."+i.name)),locals[i.doctype][i.name]=i;let t=frappe.get_meta(i.doctype);if(!(t?t.istable:i.parentfield))for(var r in i){var n=i[r];if($.isArray(n))for(var a=0,s=n.length;a<s;a++){var o=n[a];typeof o=="object"&&!o.parent&&(o.parent=i.name),frappe.model.add_to_locals(o)}}},update_in_locals:function(i){let t=locals[i.doctype][i.name],e=function(r,n){Object.keys(n).map(a=>{r[a]==null&&delete n[a]})};for(let r in i){let n=frappe.meta.get_field(i.doctype,r);if(n&&frappe.model.table_fields.includes(n.fieldtype)){i[r]instanceof Array||(i[r]=[]),t[r]instanceof Array||(t[r]=[]);for(let a=0;a<i[r].length;a++){let s=i[r][a],o=t[r][a];o?(locals[s.doctype]||(locals[s.doctype]={}),s.name||(s.name=frappe.model.get_new_name(i.doctype)),locals[s.doctype][s.name]||(delete locals[s.doctype][o.name],locals[s.doctype][s.name]=o),Object.assign(o,s),e(s,o)):(t[r].push(s),s.parent||(s.parent=i.name),frappe.model.add_to_locals(s))}if(t[r].length>i[r].length){for(let a=i[r].length;a<t[r].length;a++){let s=t[r][a];locals[s.doctype]&&locals[s.doctype][s.name]&&delete locals[s.doctype][s.name]}t[r].length=i[r].length}}else t[r]=i[r]}e(i,t)}});frappe.provide("frappe.model");$.extend(frappe.model,{new_names:{},new_name_count:{},get_new_doc:function(i,t,e,r){frappe.provide("locals."+i);var n={docstatus:0,doctype:i,name:frappe.model.get_new_name(i),__islocal:1,__unsaved:1,owner:frappe.session.user};if(frappe.model.set_default_values(n,t),t?($.extend(n,{parent:t.name,parentfield:e,parenttype:t.doctype}),t[e]||(t[e]=[]),n.idx=t[e].length+1,t[e].push(n)):frappe.provide("frappe.model.docinfo."+i+"."+n.name),frappe.model.add_to_locals(n),r&&frappe.model.create_mandatory_children(n),t||(n.__run_link_triggers=1),frappe.route_options&&frappe.route_options.name_field){var a=frappe.get_meta(i);a.autoname&&a.autoname.indexOf("field:")!==-1?n[a.autoname.substr(6)]=frappe.route_options.name_field:a.title_field&&(n[a.title_field]=frappe.route_options.name_field),delete frappe.route_options.name_field}return frappe.route_options&&!n.parent&&($.each(frappe.route_options,function(s,o){var l=frappe.meta.has_field(i,s);l&&in_list(["Link","Data","Select","Dynamic Link"],l.fieldtype)&&!l.no_copy&&(n[s]=o)}),frappe.route_options=null),n},make_new_doc_and_get_name:function(i,t){return frappe.model.get_new_doc(i,null,null,t).name},get_new_name:function(i){var t=frappe.model.new_name_count;return t[i]||(t[i]=0),t[i]++,frappe.router.slug(`new-${i}-${t[i]}`)},set_default_values:function(i,t){for(var e=i.doctype,r=frappe.meta.get_docfields(e),n=[],a=0;a<r.length;a++){var s=r[a];if(!in_list(frappe.model.no_value_type,s.fieldtype)&&i[s.fieldname]==null){if(s.no_default)continue;var o=frappe.model.get_default_value(s,i,t);o?(in_list(["Int","Check"],s.fieldtype)?o=cint(o):in_list(["Currency","Float"],s.fieldtype)&&(o=flt(o)),i[s.fieldname]=o,n.push(s.fieldname)):s.fieldtype=="Select"&&s.options&&typeof s.options=="string"&&!in_list(["[Select]","Loading..."],s.options)&&(i[s.fieldname]=s.options.split(`
`)[0])}}return n},create_mandatory_children:function(i){var t=frappe.get_meta(i.doctype);t&&t.istable||frappe.meta.get_docfields(i.doctype).forEach(function(e){e.fieldtype==="Table"&&e.reqd&&frappe.model.add_child(i,e.fieldname)})},get_default_value:function(i,t,e){var r="",n=frappe.defaults.get_user_permissions();let a=[],s=null,o=null;n&&({allowed_records:a,default_doc:s}=frappe.perm.filter_allowed_docs_for_doctype(n[i.options],t.doctype));var l=frappe.get_meta(t.doctype),u=i.fieldtype==="Link"&&!$.isEmptyObject(n)&&i.ignore_user_permissions!=1&&a.length;if(i.fieldtype==="Link"&&i.options!=="User")if(u&&s)o=s;else{if(!i.ignore_user_permissions){var c=frappe.defaults.get_user_defaults(i.options);c&&c.length===1&&(r=c[0])}r?!r&&i.remember_last_selected_value&&frappe.boot.user.last_selected_values&&(r=frappe.boot.user.last_selected_values[i.options]):r=frappe.defaults.get_user_default(i.fieldname);var h=r&&(!u||a.includes(r));h&&(o=r)}if(!o||i.default){let v=String(i.default);if(v=="__user"||v.toLowerCase()=="user")o=frappe.session.user;else if(v=="user_fullname")o=frappe.session.user_fullname;else if(v=="Today")o=frappe.datetime.get_today();else if((v||"").toLowerCase()==="now")i.fieldtype=="Time"?o=frappe.datetime.now_time():o=frappe.datetime.system_datetime();else if(v[0]===":"){var p=frappe.model.get_default_from_boot_docs(i,t,e),g=!u||a.includes(p);g&&(o=p)}else if(i.fieldname===l.title_field)o="";else{var b=!u||a.includes(i.default);(i.fieldtype!=="Link"||i.options==="User"||b)&&(o=i.default)}}else i.fieldtype=="Time"&&(o=frappe.datetime.now_time());return i.__default_value=o,o},get_default_from_boot_docs:function(i,t,e){if(frappe.get_list(i.default).length>0){var r=i.default.slice(1).toLowerCase().replace(" ","_"),n=e?e[r]:frappe.defaults.get_user_default(r),a=n?frappe.get_doc(i.default,n):null;if(a&&a[i.fieldname])return a[i.fieldname]}},add_child:function(i,t,e,r){arguments.length===2&&(e=t,t=frappe.meta.get_field(i.doctype,e).options),r=r?r-.1:(i[e]||[]).length+1;var n=frappe.model.get_new_doc(t,i,e);if(n.idx=r,r!==cint(r))for(var a=i[e].sort(function(u,c){return u.idx-c.idx}),s=0,o=a.length;s<o;s++){var l=a[s];l.idx=s+1}return cur_frm&&cur_frm.doc==i&&cur_frm.dirty(),n},copy_doc:function(i,t,e,r){var n=["name","amended_from","amendment_date","cancel_reason"],a=frappe.model.get_new_doc(i.doctype,e,r);for(var s in i){var o=frappe.meta.get_docfield(i.doctype,s);if(o&&s.substr(0,2)!="__"&&!in_list(n,s)&&!(o&&!t&&cint(o.no_copy)==1)){var l=i[s]||[];if(frappe.model.table_fields.includes(o.fieldtype))for(var u=0,c=l.length;u<c;u++){var h=l[u];frappe.model.copy_doc(h,t,a,o.fieldname)}else a[s]=i[s]}}var p=frappe.session.user;return a.__islocal=1,a.docstatus=0,a.owner=p,a.creation="",a.modified_by=p,a.modified="",a.lft=null,a.rgt=null,a},open_mapped_doc:function(i){return i.frm&&i.frm.doc.__unsaved?frappe.throw(__("You have unsaved changes in this form. Please save before you continue.")):!i.source_name&&i.frm?i.source_name=i.frm.doc.name:!i.frm&&!i.source_name&&(i.source_name=null),frappe.call({type:"POST",method:"frappe.model.mapper.make_mapped_doc",args:{method:i.method,source_name:i.source_name,args:i.args||null,selected_children:i.frm?i.frm.get_selected():null},freeze:!0,freeze_message:i.freeze_message||"",callback:function(t){t.exc||(frappe.model.sync(t.message),i.run_link_triggers&&(frappe.get_doc(t.message.doctype,t.message.name).__run_link_triggers=!0),frappe.set_route("Form",t.message.doctype,t.message.name))}})}});frappe.create_routes={};frappe.new_doc=function(i,t,e){if(i==="File"){new frappe.ui.FileUploader({folder:t?t.folder:"Home"});return}return new Promise(r=>{t&&$.isPlainObject(t)&&(frappe.route_options=t),frappe.model.with_doctype(i,function(){frappe.create_routes[i]?frappe.set_route(frappe.create_routes[i]).then(()=>r()):frappe.ui.form.make_quick_entry(i,null,e).then(()=>r())})})};frappe.provide("frappe.perm");Object.assign(window,{READ:"read",WRITE:"write",CREATE:"create",DELETE:"delete",SUBMIT:"submit",CANCEL:"cancel",AMEND:"amend"});$.extend(frappe.perm,{rights:["select","read","write","create","delete","submit","cancel","amend","report","import","export","print","email","share","set_user_permissions"],doctype_perm:{},has_perm:(i,t,e,r)=>{var a;t||(t=0);let n=frappe.perm.get_perm(i,r);return!!((a=n==null?void 0:n[t])!=null&&a[e])},get_perm:(i,t)=>{var e,r;return t&&!t.__islocal?frappe.perm._get_perm(i,t):(r=(e=frappe.perm.doctype_perm)[i])!=null?r:e[i]=frappe.perm._get_perm(i)},_get_perm:(i,t)=>{let e=[{read:0,permlevel:0}],r=frappe.get_doc("DocType",i),n=frappe.session.user;if((n==="Administrator"||frappe.user_roles.includes("Administrator"))&&(e[0].read=1),!r)return e;e=frappe.perm.get_role_permissions(r);let a=e[0];if(t){let s=frappe.model.get_docinfo(i,t.name);if(s&&s.permissions&&Object.keys(s.permissions).forEach(o=>{a[o]=s.permissions[o]}),t.owner!==n)for(let o of frappe.perm.rights)a[o]&&!a.rights_without_if_owner.has(o)&&(a[o]=0);if(s&&s.shared){for(let o of s.shared)if(o.user===n){for(let l of["read","write","submit","share"])a[l]||(a[l]=o[l]);o.read&&(a.email=frappe.boot.user.can_email.indexOf(i)!==-1?1:0,a.print=frappe.boot.user.can_print.indexOf(i)!==-1?1:0)}}}return!a.read&&frappe.model.can_read(i)&&(a.read=1),e},get_role_permissions:i=>{let t=[{read:0,permlevel:0}];return(i.permissions||[]).forEach(e=>{var a,s;let r=cint(e.permlevel),n=(a=t[r])!=null?a:t[r]={permlevel:r};r===0&&((s=n.rights_without_if_owner)!=null||(n.rights_without_if_owner=new Set)),frappe.user_roles.includes(e.role)&&frappe.perm.rights.forEach(o=>{!e[o]||(n[o]=1,r===0&&!e.if_owner&&n.rights_without_if_owner.add(o))})}),t=t.map(e=>e||{}),t},get_match_rules:(i,t)=>{let e=[];t||(t="read");let r=frappe.perm.get_perm(i),n=frappe.defaults.get_user_permissions();if(n&&!$.isEmptyObject(n)){let s={},o=frappe.meta.get_fields_to_check_permissions(i);$.each(o,(l,u)=>{let c=n[u.options]||[],h=frappe.perm.get_allowed_docs_for_doctype(c,i);h.length&&(s[u.label]=h)}),$.isEmptyObject(s)||e.push(s)}let a=r[0];return a.read&&!a.rights_without_if_owner.has("read")&&e.push({Owner:frappe.session.user}),e},get_field_display_status:(i,t,e,r)=>{if(!e&&t&&(e=frappe.perm.get_perm(t.doctype,t)),!e)return i&&(cint(i.hidden)||cint(i.hidden_due_to_dependency))?"None":"Write";i.permlevel||(i.permlevel=0);let n=e[i.permlevel],a="None";if(n&&(n.write&&!i.disabled?a="Write":n.read&&(a="Read")),r&&console.log("By Permission:"+a),cint(i.hidden)&&(a="None"),r&&console.log("By Hidden:"+a),cint(i.hidden_due_to_dependency)&&(a="None"),r&&console.log("By Hidden Due To Dependency:"+a),!t)return a;a==="Write"&&cint(t.docstatus)>0&&(a="Read"),r&&console.log("By Submit:"+a);let s=cint(i.allow_on_submit);return a==="Read"&&s&&cint(t.docstatus)===1&&n.write&&(a="Write"),r&&console.log("By Allow on Submit:"+a),a==="Read"&&cur_frm&&cur_frm.state_fieldname&&(cint(cur_frm.read_only)||in_list(cur_frm.states.update_fields,i.fieldname)||i.fieldname==cur_frm.state_fieldname)&&(a="Read"),r&&console.log("By Workflow:"+a),a==="Write"&&(cint(i.read_only)||i.fieldtype==="Read Only")&&(a="Read"),r&&console.log("By Read Only:"+a),a==="Write"&&i.set_only_once&&!t.__islocal&&(a="Read"),r&&console.log("By Set Only Once:"+a),a},is_visible:(i,t,e)=>(typeof i=="string"&&(i=frappe.meta.get_docfield(t.doctype,i,t.parent||t.name)),frappe.perm.get_field_display_status(i,t,e)!=="None"),get_allowed_docs_for_doctype:(i,t)=>frappe.perm.filter_allowed_docs_for_doctype(i,t,!1),filter_allowed_docs_for_doctype:(i,t,e=!0)=>{let r=(i||[]).filter(a=>a.applicable_for===t||!a.applicable_for),n=r.map(a=>a.doc);if(e){let a=n.length===1?n:r.filter(s=>s.is_default).map(s=>s.doc);return{allowed_records:n,default_doc:a[0]}}else return n}});frappe.provide("frappe.workflow");frappe.workflow={state_fields:{},workflows:{},setup:function(i){var t=frappe.get_list("Workflow",{document_type:i});t.length?(frappe.workflow.workflows[i]=t[0],frappe.workflow.state_fields[i]=t[0].workflow_state_field):frappe.workflow.state_fields[i]=null},get_state_fieldname:function(i){return frappe.workflow.state_fields[i]===void 0&&frappe.workflow.setup(i),frappe.workflow.state_fields[i]},get_default_state:function(i,t){frappe.workflow.setup(i);var e=null;return $.each(frappe.workflow.workflows[i].states,function(r,n){if(cint(n.doc_status)===cint(t))return e=n.state,!1}),e},get_transitions:function(i){return frappe.workflow.setup(i.doctype),frappe.xcall("frappe.model.workflow.get_transitions",{doc:i})},get_document_state:function(i,t){return frappe.workflow.setup(i),frappe.get_children(frappe.workflow.workflows[i],"states",{state:t})[0]},is_self_approval_enabled:function(i){return frappe.workflow.workflows[i].allow_self_approval},is_read_only:function(i,t){var e=frappe.workflow.get_state_fieldname(i);if(e){var r=locals[i][t];if(!r||r.__islocal)return!1;var n=r[e]||frappe.workflow.get_default_state(i,r.docstatus),a=n?frappe.workflow.get_document_state(i,n)&&frappe.workflow.get_document_state(i,n).allow_edit:null;if(!frappe.user_roles.includes(a))return!0}return!1},get_update_fields:function(i){var t=$.unique($.map(frappe.workflow.workflows[i].states||[],function(e){return e.update_field}));return t},get_state(i){let t=this.get_state_fieldname(i.doctype),e=i[t];return e||(e=this.get_default_state(i.doctype,i.docstatus)),e},get_all_transitions(i){return frappe.workflow.workflows[i].transitions||[]},get_all_transition_actions(i){return this.get_all_transitions(i).map(e=>e.action)}};frappe.provide("frappe.model.user_settings");$.extend(frappe.model.user_settings,{get:function(i){return frappe.call("frappe.model.utils.user_settings.get",{doctype:i}).then(t=>JSON.parse(t.message||"{}"))},save:function(i,t,e){if(frappe.session.user==="Guest")return Promise.resolve();let r=frappe.model.user_settings[i]||{},n=$.extend(!0,{},r);$.isPlainObject(e)?(n[t]=n[t]||{},$.extend(n[t],e)):n[t]=e;let a=JSON.stringify(r),s=JSON.stringify(n);return a!==s?this.update(i,n):Promise.resolve(n)},remove:function(i,t){var e=frappe.model.user_settings[i]||{};return delete e[t],this.update(i,e)},update:function(i,t){return frappe.session.user==="Guest"?Promise.resolve():frappe.call({method:"frappe.model.utils.user_settings.save",args:{doctype:i,user_settings:t},callback:function(e){frappe.model.user_settings[i]=e.message}})}});frappe.get_user_settings=function(i,t){var e=frappe.model.user_settings[i]||{};return t&&(e=e[t]||{}),e};frappe.user_info=function(i){if(i||(i=frappe.session.user),frappe.boot.user_info&&frappe.boot.user_info[i])var t=frappe.boot.user_info[i];else var t={fullname:i||"Unknown"};return t.abbr=frappe.get_abbr(t.fullname),t.color=frappe.get_palette(t.fullname),t};frappe.update_user_info=function(i){for(let t in i)frappe.boot.user_info[t]?Object.assign(frappe.boot.user_info[t],i[t]):frappe.boot.user_info[t]=i[t]};frappe.provide("frappe.user");$.extend(frappe.user,{name:"Guest",full_name:function(i){return i===frappe.session.user?__("You",null,"Name of the current user. For example: You edited this 5 hours ago."):frappe.user_info(i).fullname},image:function(i){return frappe.user_info(i).image},abbr:function(i){return frappe.user_info(i).abbr},has_role:function(i){typeof i=="string"&&(i=[i]);for(var t in i)if((frappe.boot?frappe.boot.user.roles:["Guest"]).indexOf(i[t])!=-1)return!0},get_desktop_items:function(){var i=$.map(frappe.boot.allowed_modules,function(t){var e=t.module_name,r=frappe.modules[e]&&frappe.modules[e].type;if(frappe.boot.user.allow_modules.indexOf(e)===-1)return null;var n=null;return r==="module"?(frappe.boot.user.allow_modules.indexOf(e)!=-1||frappe.modules[e].is_help)&&(n=e):r==="page"?frappe.boot.allowed_pages.indexOf(frappe.modules[e].link)!=-1&&(n=e):r==="list"?frappe.model.can_read(frappe.modules[e]._doctype)&&(n=e):r==="view"?n=e:r==="setup"?(frappe.user.has_role("System Manager")||frappe.user.has_role("Administrator"))&&(n=e):n=e,n});return i},is_report_manager:function(){return frappe.user.has_role(["Administrator","System Manager","Report Manager"])},get_formatted_email:function(i){var t=frappe.user.full_name(i);if(t){var e="";return t.search(/[\[\]\\()<>@,:;".]/)!==-1&&(e='"'),repl("%(quote)s%(fullname)s%(quote)s <%(email)s>",{fullname:t,email:i,quote:e})}else return i},get_emails:()=>Object.keys(frappe.boot.user_info).map(i=>frappe.boot.user_info[i].email),toString:function(){return this.name}});frappe.session_alive=!0;$(document).bind("mousemove",function(){frappe.session_alive===!1&&$(document).trigger("session_alive"),frappe.session_alive=!0,frappe.session_alive_timeout&&clearTimeout(frappe.session_alive_timeout),frappe.session_alive_timeout=setTimeout("frappe.session_alive=false;",3e4)});var Oa=Ut(hd());frappe.avatar=function(i,t,e,r=null,n=!1,a=!1){let s;if(i)s=frappe.user_info(i);else{let l=e||frappe.get_cookie("full_name");s={image:r===null?frappe.get_cookie("user_image"):r,fullname:l,abbr:frappe.get_abbr(l),color:frappe.get_palette(l)}}e||(e=s.fullname);let o="";return a&&(t+=" filterable",o=`data-filter="_assign,like,%${i}%"`),frappe.get_avatar(t,e,r||s.image,n,o)};frappe.get_avatar=function(i,t,e=null,r,n){if(i||(i="avatar-small"),e){let a=window.cordova&&e.indexOf("http")===-1?frappe.base_url+e:e;return`<span class="avatar ${i}" title="${t}" ${n}>
				<span class="avatar-frame" style='background-image: url("${a}")'
					title="${t}"></span>
			</span>`}else{let a=frappe.get_abbr(t),s="";if(!r){let o=frappe.get_palette(t);s=`background-color: var(${o[0]}); color: var(${o[1]})`}return(i==="avatar-small"||i=="avatar-xs")&&(a=a.substr(0,1)),`<span class="avatar ${i}" title="${t}" ${n}>
			<div class="avatar-frame standard-image"
				style="${s}">
					${a}
			</div>
		</span>`}};frappe.avatar_group=function(i,t=4,e={}){let r="",n=i.slice(0,t),a=i.slice(t),s=e.css_class||"",o=n.map(u=>frappe.avatar(u,"avatar-small "+s,null,null,!1,e.filterable)).join("");a.length===1?o+=frappe.avatar(a[0],"avatar-small "+s,null,null,!1,e.filterable):a.length>1&&(o=`
			${o}
			<span class="avatar avatar-small ${s}">
				<div class="avatar-frame standard-image avatar-extra-count"
					title="${a.map(u=>frappe.user_info(u).fullname).join(", ")}">
					+${a.length}
				</div>
			</span>
		`),e.action_icon&&(r=`
			<span class="avatar avatar-small">
				<div class="avatar-frame avatar-action">
					${frappe.utils.icon(e.action_icon,"sm")}
				</div>
			</span>
		`);let l=$(`<div class="avatar-group ${e.align||"right"} ${e.overlap!=!1?"overlap":""}">
			${o}
			${r}
		</div>`);return l.find(".avatar-action").on("click",e.action),l};frappe.ui.scroll=function(i,t,e){var r=$(".navbar").height()+$(".page-head").height(),n=$(i).offset().top-r-cint(e);t?$("html, body").animate({scrollTop:n}):$(window).scrollTop(n)};frappe.palette=[["--orange-avatar-bg","--orange-avatar-color"],["--pink-avatar-bg","--pink-avatar-color"],["--blue-avatar-bg","--blue-avatar-color"],["--green-avatar-bg","--green-avatar-color"],["--dark-green-avatar-bg","--dark-green-avatar-color"],["--red-avatar-bg","--red-avatar-color"],["--yellow-avatar-bg","--yellow-avatar-color"],["--purple-avatar-bg","--purple-avatar-color"],["--gray-avatar-bg","--gray-avatar-color0"]];frappe.get_palette=function(i){var t=cint((parseInt((0,Oa.default)(i).substr(4,2),16)+1)/5.33);return frappe.palette[t%8]};frappe.get_abbr=function(i,t){if(!i)return"";var e="";return $.each(i.split(" "),function(r,n){if(e.length>=(t||2))return!1;if(!n.trim().length)return!0;e+=n.trim()[0]}),e||"?"};frappe.gravatars={};frappe.get_gravatar=function(i,t=0){var e=t?"s="+t:"d=retro";return frappe.gravatars[i]||(frappe.gravatars[i]="https://secure.gravatar.com/avatar/"+(0,Oa.default)(i)+"?"+e),frappe.gravatars[i]};window.repl=function(t,e){if(t==null)return"";for(var r in e)t=t.split("%("+r+")s").join(e[r]);return t};window.replace_all=function(i,t,e){return i.split(t).join(e)};window.strip_html=function(i){return cstr(i).replace(/<[^>]*>/g,"")};window.strip=function(i,t){if(i)return i=lstrip(i,t),i=rstrip(i,t),i};window.lstrip=function(t,e){e||(e=[`
`,"	"," "]);let r=t.substr(0,1);for(;in_list(e,r);)t=t.substr(1),r=t.substr(0,1);return t};window.rstrip=function(i,t){t||(t=[`
`,"	"," "]);let e=i.substr(i.length-1);for(;in_list(t,e);)i=i.substr(0,i.length-1),e=i.substr(i.length-1);return i};frappe.get_cookie=function(t){return frappe.get_cookies()[t]};frappe.get_cookies=function(){var t=document.cookie,e=0,r={};return document.cookie.match(/^\s*\$Version=(?:"1"|1);\s*(.*)/)&&(t=RegExp.$1,e=1),e===0?t.split(/[,;]/).map(function(n){var a=n.split(/=/,2),s=decodeURIComponent(a[0].trimLeft()),o=a.length>1?decodeURIComponent(a[1].trimRight()):null;o&&o.charAt(0)==='"'&&(o=o.substr(1,o.length-2)),r[s]=o}):t.match(/(?:^|\s+)([!#$%&'*+\-.0-9A-Z^`a-z|~]+)=([!#$%&'*+\-.0-9A-Z^`a-z|~]*|"(?:[\x20-\x7E\x80\xFF]|\\[\x00-\x7F])*")(?=\s*[,;]|$)/g).map(function(n,a){var s=n,o=a.charAt(0)==='"'?a.substr(1,-1).replace(/\\(.)/g,"$1"):a;r[s]=o}),r};frappe.is_mobile=function(){return $(document).width()<768};frappe.utils.xss_sanitise=function(i,t){let e=i,r={strategies:["html","js"]},n={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},a=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,s=/confirm\(.*\)|alert\(.*\)|prompt\(.*\)/gi;if(t=Object.assign({},r,t),t.strategies.includes("js")&&(e=e.replace(a,""),e=e.replace(s,"")),t.strategies.includes("html"))for(let o in n){let l=n[o],u=new RegExp(o,"g");e=e.replace(u,l)}return e};frappe.utils.sanitise_redirect=i=>{let t=(()=>r=>{function n(s){let o=/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:/\n?]+)/gim.exec(s);return o==null?"":o[1]}function a(s){return/^(?:[a-z]+:)?\/\//i.test(s)}return a(r)?n(location.href)!==n(r):!1})(),e=r=>{let n=/j[\s]*(&#x.{1,7})?a[\s]*(&#x.{1,7})?v[\s]*(&#x.{1,7})?a[\s]*(&#x.{1,7})?s[\s]*(&#x.{1,7})?c[\s]*(&#x.{1,7})?r[\s]*(&#x.{1,7})?i[\s]*(&#x.{1,7})?p[\s]*(&#x.{1,7})?t/gi;return r.replace(n,"")};return i=frappe.utils.strip_url(i),t(i)?"":e(frappe.utils.xss_sanitise(i,{strategies:["js"]}))};frappe.utils.strip_url=i=>i.replace(/^[^A-Za-z0-9(//)#]+/g,"");frappe.utils.new_auto_repeat_prompt=function(i){let t=[{fieldname:"frequency",fieldtype:"Select",label:__("Frequency"),reqd:1,options:[{label:__("Daily"),value:"Daily"},{label:__("Weekly"),value:"Weekly"},{label:__("Monthly"),value:"Monthly"},{label:__("Quarterly"),value:"Quarterly"},{label:__("Half-yearly"),value:"Half-yearly"},{label:__("Yearly"),value:"Yearly"}]},{fieldname:"start_date",fieldtype:"Date",label:__("Start Date"),reqd:1,default:frappe.datetime.nowdate()},{fieldname:"end_date",fieldtype:"Date",label:__("End Date")}];frappe.prompt(t,function(e){frappe.call({method:"frappe.automation.doctype.auto_repeat.auto_repeat.make_auto_repeat",args:{doctype:i.doc.doctype,docname:i.doc.name,frequency:e.frequency,start_date:e.start_date,end_date:e.end_date},callback:function(r){r.message&&(frappe.show_alert({message:__("Auto Repeat created for this document"),indicator:"green"}),i.reload_doc())}})},__("Auto Repeat"),__("Save"))};frappe.utils.get_page_view_count=function(i){return frappe.call("frappe.website.doctype.web_page_view.web_page_view.get_page_view_count",{path:i})};frappe.urllib={get_arg:function(i){i=i.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+i+"=([^&#]*)",e=new RegExp(t),r=e.exec(window.location.href);return r==null?"":decodeURIComponent(r[1])},get_dict:function(){var i={},t=window.location.href.split("?")[1];if(!t||(t.indexOf("#")!=-1&&(t=t.split("#")[0]),!t))return i;t=t.split("&");for(var e=0;e<t.length;e++){var r=t[e].split("=");i[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return i},get_base_url:function(){var i=frappe.base_url||window.location.origin;return i.substr(i.length-1,1)=="/"&&(i=i.substr(0,i.length-1)),i},get_full_url:function(i){return i.indexOf("http://")===0||i.indexOf("https://")===0?i:i.substr(0,1)==="/"?frappe.urllib.get_base_url()+i:frappe.urllib.get_base_url()+"/"+i}};window.open_url_post=function(t,e,r){if(window.cordova){let l=t+"api/method/"+e.cmd+frappe.utils.make_query_string(e,!1);window.location.href=l}else{var n=document.createElement("form");n.action=t,n.method="POST",n.style.display="none",r&&(n.target="_blank"),e.csrf_token=frappe.csrf_token;for(var a in e){var s=document.createElement("textarea");s.name=a;var o=e[a];typeof o!="string"&&(o=JSON.stringify(o)),s.value=o,n.appendChild(s)}return document.body.appendChild(n),n.submit(),n}};window.get_url_arg=frappe.urllib.get_arg;window.get_url_dict=frappe.urllib.get_dict;function Ra(i,t){if(!i)return"";typeof i=="string"&&(i=frappe.datetime.convert_to_user_tz(i),i=new Date((i||"").replace(/-/g,"/").replace(/[TZ]/g," ").replace(/\.[0-9]*/,"")));let e=(new Date(frappe.datetime.now_datetime()).getTime()-i.getTime())/1e3,r=Math.floor(e/86400);if(isNaN(r)||r<0)return"";if(t)if(r==0){if(e<60)return __("now");if(e<3600)return __("{0} m",[Math.floor(e/60)]);if(e<86400)return __("{0} h",[Math.floor(e/3600)])}else return r<7?__("{0} d",[r]):r<31?__("{0} w",[Math.floor(r/7)]):r<365?__("{0} M",[Math.floor(r/30)]):__("{0} y",[Math.floor(r/365)]);else if(r==0){if(e<60)return __("just now");if(e<120)return __("1 minute ago");if(e<3600)return __("{0} minutes ago",[Math.floor(e/60)]);if(e<7200)return __("1 hour ago");if(e<86400)return __("{0} hours ago",[Math.floor(e/3600)])}else return r==1?__("yesterday"):r<7?__("{0} days ago",[r]):r<14?__("1 week ago"):r<31?__("{0} weeks ago",[Math.floor(r/7)]):r<62?__("1 month ago"):r<365?__("{0} months ago",[Math.floor(r/30)]):r<730?__("1 year ago"):__("{0} years ago",[Math.floor(r/365)])}frappe.provide("frappe.datetime");window.comment_when=function(i,t){var e=frappe.datetime.str_to_user?frappe.datetime.str_to_user(i):i;return'<span class="frappe-timestamp '+(t?" mini":"")+'" data-timestamp="'+i+'" title="'+e+'">'+Ra(i,t)+"</span>"};frappe.datetime.comment_when=comment_when;frappe.datetime.prettyDate=Ra;frappe.datetime.refresh_when=function(){jQuery&&$(".frappe-timestamp").each(function(){$(this).html(Ra($(this).attr("data-timestamp"),$(this).hasClass("mini")))})};setInterval(function(){frappe.datetime.refresh_when()},6e4);var gd=Ut(md());frappe.provide("frappe.tools");frappe.tools.downloadify=function(i,t,e){if(t&&t.length&&!has_common(t,t)){frappe.msgprint(__("Export not allowed. You need {0} role to export.",[frappe.utils.comma_or(t)]));return}var r=e+".csv",n=frappe.tools.to_csv(i),a=document.createElement("a");if("download"in a){var s=new Blob([n],{type:"text/csv;charset=UTF-8"});a.href=URL.createObjectURL(s),a.download=r}else a.href="data:attachment/csv,"+encodeURIComponent(n),a.download=r,a.target="_blank";document.body.appendChild(a),a.click(),document.body.removeChild(a)};frappe.markdown=function(i){for(frappe.md2html||(frappe.md2html=new gd.default.Converter);i.substr(0,1)===`
`;)i=i.substr(1);for(var t=0,e=i.split(`
`)[0];[`
`,"	"].indexOf(e.substr(0,1))!==-1;)t++,e=e.substr(1);if(t&&t!=e.length){var r=[];$.each(i.split(`
`),function(n,a){r.push(a.substr(t))}),i=r.join(`
`)}return frappe.md2html.makeHtml(i)};frappe.tools.to_csv=function(i){var t=[];return $.each(i,function(e,r){r=$.map(r,function(n){return n==null&&(n=""),typeof n=="string"?'"'+$("<i>").html(n.replace(/"/g,'""')).text()+'"':n}),t.push(r.join(","))}),t.join(`
`)};frappe.provide("frappe.datetime");frappe.defaultDateFormat="YYYY-MM-DD";frappe.defaultTimeFormat="HH:mm:ss";frappe.defaultDatetimeFormat=frappe.defaultDateFormat+" "+frappe.defaultTimeFormat;moment.defaultFormat=frappe.defaultDateFormat;frappe.provide("frappe.datetime");$.extend(frappe.datetime,{convert_to_user_tz:function(i,t){let e=null;return frappe.boot.time_zone&&frappe.boot.time_zone.system&&frappe.boot.time_zone.user?e=moment.tz(i,frappe.boot.time_zone.system).clone().tz(frappe.boot.time_zone.user):e=moment(i),t===!1?e:e.format(frappe.defaultDatetimeFormat)},convert_to_system_tz:function(i,t){let e=null;return frappe.boot.time_zone&&frappe.boot.time_zone.system&&frappe.boot.time_zone.user?e=moment.tz(i,frappe.boot.time_zone.user).clone().tz(frappe.boot.time_zone.system):e=moment(i),t===!1?e:e.format(frappe.defaultDatetimeFormat)},is_system_time_zone:function(){return frappe.boot.time_zone&&frappe.boot.time_zone.system&&frappe.boot.time_zone.user?moment().tz(frappe.boot.time_zone.system).utcOffset()===moment().tz(frappe.boot.time_zone.user).utcOffset():!0},is_timezone_same:function(){return frappe.datetime.is_system_time_zone()},str_to_obj:function(i){return moment(i,frappe.defaultDatetimeFormat)._d},obj_to_str:function(i){return moment(i).locale("en").format()},obj_to_user:function(i){return moment(i).format(frappe.datetime.get_user_date_fmt().toUpperCase())},get_diff:function(i,t){return moment(i).diff(t,"days")},get_hour_diff:function(i,t){return moment(i).diff(t,"hours")},get_day_diff:function(i,t){return moment(i).diff(t,"days")},add_days:function(i,t){return moment(i).add(t,"days").format()},add_months:function(i,t){return moment(i).add(t,"months").format()},week_start:function(){return moment().startOf("week").format()},week_end:function(){return moment().endOf("week").format()},month_start:function(){return moment().startOf("month").format()},month_end:function(){return moment().endOf("month").format()},quarter_start:function(){return moment().startOf("quarter").format()},quarter_end:function(){return moment().endOf("quarter").format()},year_start:function(){return moment().startOf("year").format()},year_end:function(){return moment().endOf("year").format()},get_user_time_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.time_format||"HH:mm:ss"},get_user_date_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.date_format||"yyyy-mm-dd"},get_user_fmt:function(){return frappe.sys_defaults&&frappe.sys_defaults.date_format||"yyyy-mm-dd"},str_to_user:function(i,t=!1,e=!1){if(!i)return"";let r=frappe.datetime.get_user_date_fmt().toUpperCase(),n=frappe.datetime.get_user_time_fmt(),a=n;if(t)return moment(i,frappe.defaultTimeFormat).format(a);if(e)return moment(i,frappe.defaultDateFormat).format(r);{let s=moment.tz(i,frappe.boot.time_zone.system);return typeof i!="string"||i.indexOf(" ")===-1?a=r:a=r+" "+n,s.clone().tz(frappe.boot.time_zone.user).format(a)}},get_datetime_as_string:function(i){return moment(i).format("YYYY-MM-DD HH:mm:ss")},user_to_str:function(i,t=!1){var e=frappe.datetime.get_user_time_fmt();if(t)return moment(i,e).format(frappe.defaultTimeFormat);var r=frappe.datetime.get_user_date_fmt().toUpperCase(),n="YYYY-MM-DD";return i.indexOf(" ")!==-1&&(r+=" "+e,n+=" HH:mm:ss"),moment(i,[r.replace("YYYY","YY"),r]).locale("en").format(n)},user_to_obj:function(i){return frappe.datetime.str_to_obj(frappe.datetime.user_to_str(i))},global_date_format:function(i){var t=moment(i);return t._f&&t._f.indexOf("HH")!==-1?t.format("Do MMMM YYYY, hh:mm A"):t.format("Do MMMM YYYY")},now_date:function(i=!1){return frappe.datetime._date(frappe.defaultDateFormat,i)},now_time:function(i=!1){return frappe.datetime._date(frappe.defaultTimeFormat,i)},now_datetime:function(i=!1){return frappe.datetime._date(frappe.defaultDatetimeFormat,i)},system_datetime:function(i=!1){return frappe.datetime._date(frappe.defaultDatetimeFormat,i,!0)},_date:function(i,t=!1,e=!1){var a,s;let r=((a=frappe.boot.time_zone)==null?void 0:a.system)||frappe.sys_defaults.time_zone;e||(r=((s=frappe.boot.time_zone)==null?void 0:s.user)||r);let n=moment.tz(r);return t?frappe.datetime.moment_to_date_obj(n):n.format(i)},moment_to_date_obj:function(i){let t=new Date,e=i.toArray();return t.setFullYear(e[0]),t.setMonth(e[1]),t.setDate(e[2]),t.setHours(e[3]),t.setMinutes(e[4]),t.setSeconds(e[5]),t.setMilliseconds(e[6]),t},nowdate:function(){return frappe.datetime.now_date()},get_today:function(){return frappe.datetime.now_date()},get_time:i=>moment(i).format("hh:mm A"),validate:function(i){return moment(i,[frappe.defaultDateFormat,frappe.defaultDatetimeFormat,frappe.defaultTimeFormat],!0).isValid()},get_first_day_of_the_week_index(){let i=frappe.sys_defaults.first_day_of_the_week||"Sunday";return moment.weekdays().indexOf(i)}});Object.defineProperties(window,{dateutil:{get:function(){return console.warn("Please use `frappe.datetime` instead of `dateutil`. It will be deprecated soon."),frappe.datetime},configurable:!0},date:{get:function(){return console.warn("Please use `frappe.datetime` instead of `date`. It will be deprecated soon."),frappe.datetime},configurable:!0},get_today:{get:function(){return console.warn("Please use `frappe.datetime.get_today` instead of `get_today`. It will be deprecated soon."),frappe.datetime.get_today},configurable:!0}});window.cstr=function(i){return i==null?"":i+""};window.cint=function(i,t){return i===!0?1:i===!1?0:(i=i+"",i!=="0"&&(i=lstrip(i,["0"])),i=parseInt(i),isNaN(i)&&(i=t===void 0?0:t),i)};window.toTitle=function(i){var t=i.split(" "),e=[];for(var r in t)e[r]=t[r].charAt(0).toUpperCase()+t[r].slice(1);return e.join(" ")};window.is_null=function(i){if(i==null||cstr(i).trim()==="")return!0};window.copy_dict=function(i){var t={};for(var e in i)t[e]=i[e];return t};window.validate_email=function(i){return frappe.utils.validate_type(i,"email")};window.validate_phone=function(i){return frappe.utils.validate_type(i,"phone")};window.validate_name=function(i){return frappe.utils.validate_type(i,"name")};window.validate_url=function(i){return frappe.utils.validate_type(i,"url")};window.nth=function(i){i=cint(i);var t="th";return(i+"").substr(-1)=="1"&&(t="st"),(i+"").substr(-1)=="2"&&(t="nd"),(i+"").substr(-1)=="3"&&(t="rd"),i+t};window.has_words=function(i,t){if(!t)return!0;if(!i)return!1;for(var e=0,r=i.length;e<r;e++)if(t.indexOf(i[e])!=-1)return!0;return!1};window.has_common=function(i,t){if(!i||!t)return!1;for(var e=0,r=i.length;e<r;e++)if(in_list(t,i[e]))return!0;return!1};window.frappe||(window.frappe={});function sn(i,t,e){if(i==null||i=="")return 0;if(!(typeof i=="number"||String(parseFloat(i))==i)){if(i=i+"",i.indexOf(" ")!=-1){var r=i.split(" ");i=isNaN(parseFloat(r[0]))?r.slice(r.length-1).join(" "):i}i=vd(i,e),i=parseFloat(i),isNaN(i)&&(i=0)}return i=parseFloat(i),t!=null?ln(i,t):i}function vd(i,t){t||(t=on());var e=La(t),r=new RegExp(e.group_sep==="."?"\\.":e.group_sep,"g");if(i=i.replace(r,""),e.decimal_str!=="."&&e.decimal_str!==""){var n=new RegExp(e.decimal_str,"g");i=i.replace(n,".")}return i}frappe.number_format_info={"#,###.##":{decimal_str:".",group_sep:","},"#.###,##":{decimal_str:",",group_sep:"."},"# ###.##":{decimal_str:".",group_sep:" "},"# ###,##":{decimal_str:",",group_sep:" "},"#'###.##":{decimal_str:".",group_sep:"'"},"#, ###.##":{decimal_str:".",group_sep:", "},"#,##,###.##":{decimal_str:".",group_sep:","},"#,###.###":{decimal_str:".",group_sep:","},"#.###":{decimal_str:"",group_sep:"."},"#,###":{decimal_str:"",group_sep:","}};window.format_number=function(i,t,e){t||(t=on(),e==null&&(e=cint(frappe.defaults.get_default("float_precision"))||3));var r=La(t);e==null&&(e=r.precision),i=sn(i,e,t);let n=!1;i<0&&(n=!0),i=Math.abs(i),i=i.toFixed(e);var a=i.split("."),s=r.group_sep?3:0;if(s){for(var o=a[0],l="",u=o.length%s,c=o.length;c>=0;c--){var h=replace_all(l,r.group_sep,"").length;t=="#,##,###.##"&&l.indexOf(",")!=-1&&(s=2,h+=1),l+=o.charAt(c),h&&!((h+1)%s)&&c!=0&&(l+=r.group_sep)}a[0]=l.split("").reverse().join("")}return a[0]+""==""&&(a[0]="0"),a[1]=a[1]&&r.decimal_str?r.decimal_str+a[1]:"",(n?"-":"")+a[0]+a[1]};function bd(i,t,e){var s;let r=on(t),n=yd(t),a=(s=frappe.model.get_value(":Currency",t,"symbol_on_right"))!=null?s:!1;return e===void 0&&(e=frappe.boot.sysdefaults.currency_precision||null),n?a?format_number(i,r,e)+" "+__(n):__(n)+" "+format_number(i,r,e):format_number(i,r,e)}function yd(i){return frappe.boot?frappe.boot.sysdefaults&&frappe.boot.sysdefaults.hide_currency_symbol=="Yes"?null:(i||(i=frappe.boot.sysdefaults.currency),frappe.model.get_value(":Currency",i,"symbol")||i):frappe.currency_symbols[i]}function on(i){return frappe.boot&&frappe.boot.sysdefaults&&frappe.boot.sysdefaults.number_format||"#,###.##"}function La(i){var t=frappe.number_format_info[i];return t||(t={decimal_str:".",group_sep:","}),t.precision=i.split(t.decimal_str).slice(1)[0].length,t}function ln(i,t){var e=i<0,r=cint(t),n=Math.pow(10,r),a=+(r?Math.abs(i)*n:Math.abs(i)).toFixed(8),s=Math.floor(a),o=a-s,l=!t&&o==.5?s%2==0?s:s+1:Math.round(a);return l=r?l/n:l,e?-l:l}function Sw(i,t){return ln(i,t)}function Tw(i,t){if(cur_frm){t||(t=cur_frm.doc);var e=frappe.meta.get_docfield(t.doctype,i,t.parent||t.name);return e||console.log(i+": could not find docfield in method precision()"),frappe.meta.get_field_precision(e,t)}else return frappe.boot.sysdefaults.float_precision}function Ew(i,t){return i.includes(t)}function wd(i,t,e){e=cint(e);var r=Math.pow(10,e);if(e)var n=i*r%(t*r)/r;else var n=i%t;return sn(n,e)}function Aw(i,t,e){var r=sn(frappe.model.get_value(":Currency",t,"smallest_currency_fraction_value"));if(r){var n=wd(i,r,e);n>r/2?i+=r-n:i-=n}else i=ln(i);return i}function $w(i,t){return bd(i,t)}Object.assign(window,{flt:sn,cint,strip_number_groups:vd,format_currency:bd,fmt_money:$w,get_currency_symbol:yd,get_number_format:on,get_number_format_info:La,_round:ln,roundNumber:Sw,precision:Tw,remainder:wd,round_based_on_smallest_currency_fraction:Aw,in_list:Ew});frappe.provide("frappe.help");frappe.help.youtube_id={};frappe.help.has_help=function(i){return frappe.help.youtube_id[i]};frappe.help.show=function(i){frappe.help.youtube_id[i]&&frappe.help.show_video(frappe.help.youtube_id[i])};frappe.help.show_video=function(i,t){if(frappe.utils.is_url(i)){let a='(?:youtube.com/(?:[^/]+/.+/|(?:v|e(?:mbed)?)/|.*[?&]v=)|youtu.be/)([^"&?\\s]{11})';i=i.match(a)[1]}let e=new frappe.ui.Dialog({title:t||__("Help"),size:"large"}),r=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${i}"></div>`);r.appendTo(e.body),e.show(),e.$wrapper.addClass("video-modal");let n;frappe.utils.load_video_player().then(()=>{n=new frappe.Plyr(r[0],{hideControls:!0,resetOnEnd:!0})}),e.onhide=()=>{n==null||n.destroy()}};$("body").on("click","a.help-link",function(){var i=$(this).attr("data-doctype");i&&frappe.help.show(i)});frappe.provide("frappe.help.help_links");frappe.help.help_links["data-import-tool"]=[{label:"Importing and Exporting Data",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/data/data-import-tool.html"}];frappe.help.help_links["modules/Setup"]=[{label:"Users and Permissions",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/"},{label:"Settings",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/settings/"},{label:"Data Management",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/data/"},{label:"Email",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/email/"},{label:"Printing",url:"http://frappe.github.io/erpnext/user/manual/en/setting-up/print/"}];frappe.help.help_links["List/User"]=[{label:"Adding Users",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/adding-users"},{label:"Rename User",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/articles/rename-user"}];frappe.help.help_links["permission-manager"]=[{label:"Role Permissions Manager",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/role-based-permissions"}];frappe.help.help_links["user-permissions"]=[{label:"User Permissions",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/users-and-permissions/user-permissions"}];frappe.help.help_links["Form/System Settings"]=[{label:"System Settings",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/settings/system-settings"}];frappe.help.help_links["List/Email Account"]=[{label:"Email Account",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/email/email-account"}];frappe.help.help_links["List/Notification"]=[{label:"Notification",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/email/email-alerts"}];frappe.help.help_links["Form/Print Settings"]=[{label:"Print Settings",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/print/print-settings"}];frappe.help.help_links["print-format-builder"]=[{label:"Print Format Builder",url:"https://frappe.github.io/erpnext/user/manual/en/setting-up/print/print-format-builder"}];frappe.provide("frappe.contacts");$.extend(frappe.contacts,{clear_address_and_contact:function(i){$(i.fields_dict.address_html.wrapper).html(""),i.fields_dict.contact_html&&$(i.fields_dict.contact_html.wrapper).html("")},render_address_and_contact:function(i){i.fields_dict.address_html&&"addr_list"in i.doc.__onload&&$(i.fields_dict.address_html.wrapper).html(frappe.render_template("address_list",i.doc.__onload)).find(".btn-address").on("click",function(){frappe.new_doc("Address")}),i.fields_dict.contact_html&&"contact_list"in i.doc.__onload&&$(i.fields_dict.contact_html.wrapper).html(frappe.render_template("contact_list",i.doc.__onload)).find(".btn-contact").on("click",function(){frappe.new_doc("Contact")})},get_last_doc:function(i){let e=frappe.route_history.slice().reverse().find(a=>a[0]==="Form"&&a[1]!==i.doctype),r=e&&e[1],n=e&&e[2];return e&&e.length>3&&(n=e.slice(2).join("/")),{doctype:r,docname:n}}});frappe.preview_email=function(i,t,e,r=!1,n=!1){return frappe.call({method:"frappe.email.email_body.get_email_html",args:{subject:"Test",template:i,args:t,header:e,with_container:r}}).then(a=>{var s=a.message;if(s=s.replace(/embed=/,"src="),n)return s;var o=frappe.msgprint({message:'<iframe width="100%" height="600px" style="border: none;"></iframe>',wide:!0});setTimeout(()=>{o.$wrapper.find("iframe").contents().find("html").html(s),o.$wrapper.find(".modal-dialog").css("width","70%")},1e3)})};frappe.provide("frappe.file_manager");frappe.file_manager=function(){let i=[],t=null,e=null;function r(s,o){i=s,t=o}function n(s){return new Promise((o,l)=>{if(i.length===0||!t){a(),o();return}e=s,frappe.call({method:"frappe.core.api.file.move_file",args:{file_list:i,new_parent:e,old_parent:t},callback:u=>{a(),o(u)}}).fail(l)})}function a(){i=[],t=null,e=null}return{cut:r,paste:n,get can_paste(){return Boolean(i.length>0&&t)},get old_folder(){return t},get files_to_move(){return i}}}();frappe.provide("frappe.ui");frappe.ui.DiffView=class{constructor(t,e,r){this.dialog=null,this.handler=null,this.doctype=t,this.fieldname=e,this.docname=r,this.dialog=this.make_dialog(),this.set_empty_state(),this.dialog.show()}make_dialog(){let t=()=>({query:"frappe.utils.diff.version_query",filters:{docname:this.docname,ref_doctype:this.doctype}}),e=()=>this.compute_diff();return new frappe.ui.Dialog({title:__("Compare Versions"),fields:[{label:__("From version"),fieldtype:"Link",fieldname:"from_version",options:"Version",reqd:1,get_query:t,onchange:e},{fieldtype:"Column Break",fieldname:"cb"},{label:__("To version"),fieldtype:"Link",fieldname:"to_version",options:"Version",reqd:1,get_query:t,onchange:e},{fieldtype:"Section Break",fieldname:"sb"},{label:__("Diff"),fieldtype:"HTML",fieldname:"diff"}],size:"extra-large"})}compute_diff(){let t=this.dialog.get_value("from_version"),e=this.dialog.get_value("to_version"),r=this.fieldname;t&&e?frappe.xcall("frappe.utils.diff.get_version_diff",{from_version:t,to_version:e,fieldname:r}).then(n=>{this.dialog.set_value("diff",this.prettify_diff(n))}):this.set_empty_state()}prettify_diff(t){let e="";return t.forEach(r=>{let n="";r.startsWith("+")?n="insert":r.startsWith("-")&&(n="delete"),e+=`<div class="${n} text-wrap">${r}</div>`}),`<div class='diffview'>${e}</div>`}set_empty_state(){this.dialog.set_value("diff",__("Select two versions to view the diff."))}};frappe.provide("frappe.utils.datatable");frappe.utils.datatable.get_translations=function(){let i={};return i[frappe.boot.lang]={"Sort Ascending":__("Sort Ascending"),"Sort Descending":__("Sort Descending"),"Reset sorting":__("Reset sorting"),"Remove column":__("Remove column"),"No Data":__("No Data"),"{count} cells copied":{1:__("{count} cell copied"),default:__("{count} cells copied")},"{count} rows selected":{1:__("{count} row selected"),default:__("{count} rows selected")}},i};var Ow={name:"ProgressRing",props:{primary:String,secondary:String,radius:Number,progress:Number,stroke:Number},data(){let i=this.radius-this.stroke*2,t=i*2*Math.PI;return{normalizedRadius:i,circumference:t}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},kd=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("svg",{attrs:{height:i.radius*2,width:i.radius*2}},[e("circle",{style:{stroke:i.secondary,strokeDashoffset:0},attrs:{"stroke-dasharray":i.circumference+" "+i.circumference,"stroke-width":i.stroke,fill:"transparent",r:i.normalizedRadius,cx:i.radius,cy:i.radius}}),i._v(" "),e("circle",{style:{stroke:i.primary,strokeDashoffset:i.strokeDashoffset},attrs:{"stroke-dasharray":i.circumference+" "+i.circumference,"stroke-width":i.stroke,fill:"transparent",r:i.normalizedRadius,cx:i.radius,cy:i.radius}}),i._v(" "),e("text",{style:{color:"var(--text-color)",fontSize:"var(--text-xs)",fontWeight:"var(--text-bold)"},attrs:{"dominant-baseline":"middle","text-anchor":"middle",x:i.radius,y:i.radius}},[i._v(`
		`+i._s(i.progress)+`%
	`)])])},Rw=[];kd._withStripped=!0;var Lw=function(i){!i||i("data-v-0f538d8f_0",{source:`
circle[data-v-0f538d8f] {
	transition: stroke-dashoffset 0.35s;
	transform: rotate(-90deg);
	transform-origin: 50% 50%;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/ProgressRing.vue"],names:[],mappings:";AAsEA;CACA,mCAAA;CACA,yBAAA;CACA,yBAAA;AACA",file:"ProgressRing.vue",sourcesContent:[`<template>
	<svg :height="radius * 2" :width="radius * 2">
		<circle
			:stroke-dasharray="circumference + ' ' + circumference"
			:style="{
				stroke: secondary,
				strokeDashoffset: 0
			}"
			:stroke-width="stroke"
			fill="transparent"
			:r="normalizedRadius"
			:cx="radius"
			:cy="radius"
		/>
		<circle
			:stroke-dasharray="circumference + ' ' + circumference"
			:style="{
				stroke: primary,
				strokeDashoffset: strokeDashoffset
			}"
			:stroke-width="stroke"
			fill="transparent"
			:r="normalizedRadius"
			:cx="radius"
			:cy="radius"
		/>
		<text
			dominant-baseline="middle"
			text-anchor="middle"
			:x="radius"
			:y="radius"
			:style="{
				color: 'var(--text-color)',
				fontSize: 'var(--text-xs)',
				fontWeight: 'var(--text-bold)'
			}"
		>
			{{ progress }}%
		</text>
	</svg>
</template>
<script>
export default {
	name: "ProgressRing",
	props: {
		primary: String,
		secondary: String,
		radius: Number,
		progress: Number,
		stroke: Number
	},
	data() {
		const normalizedRadius = this.radius - this.stroke * 2;
		const circumference = normalizedRadius * 2 * Math.PI;

		return {
			normalizedRadius,
			circumference
		};
	},
	computed: {
		strokeDashoffset() {
			return (
				this.circumference - (this.progress / 100) * this.circumference
			);
		}
	}
};
<\/script>
<style scoped>
circle {
	transition: stroke-dashoffset 0.35s;
	transform: rotate(-90deg);
	transform-origin: 50% 50%;
}
</style>
`]},media:void 0})},Bw="data-v-0f538d8f",Iw=void 0,Mw=!1;function Nw(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/ProgressRing.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Ba(){let i=Ba.styles||(Ba.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var Pw=Nw({render:kd,staticRenderFns:Rw},Lw,Ow,Bw,Mw,Iw,!1,Ba,void 0,void 0),xd=Pw;var Dw={name:"FilePreview",props:["file"],components:{ProgressRing:xd},data(){return{src:null,optimize:this.file.optimize}},mounted(){if(this.is_image&&window.FileReader){let i=new FileReader;i.onload=()=>this.src=i.result,i.readAsDataURL(this.file.file_obj)}},filters:{file_size(i){return frappe.form.formatters.FileSize(i)},file_name(i){return i}},computed:{is_private(){return this.file.doc?this.file.doc.is_private:this.file.private},uploaded(){return this.file.request_succeeded},is_image(){return this.file.file_obj.type.startsWith("image")},is_optimizable(){let i=this.file.file_obj.type=="image/svg+xml";return this.is_image&&!i&&!this.uploaded&&!this.file.failed},is_cropable(){let i=["image/jpeg","image/png"];return!this.uploaded&&!this.file.uploading&&!this.file.failed&&i.includes(this.file.file_obj.type)},progress(){let i=Math.round(this.file.progress*100/this.file.total);return isNaN(i)&&(i=0),i}}},Cd=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",{staticClass:"file-preview"},[e("div",{staticClass:"file-icon"},[i.is_image?e("img",{attrs:{src:i.src,alt:i.file.name}}):e("div",{staticClass:"fallback",domProps:{innerHTML:i._s(i.frappe.utils.icon("file","md"))}})]),i._v(" "),e("div",[e("div",[i.file.doc?e("a",{staticClass:"flex",attrs:{href:i.file.doc.file_url,target:"_blank"}},[e("span",{staticClass:"file-name"},[i._v(i._s(i._f("file_name")(i.file.name)))])]):e("span",{staticClass:"file-name"},[i._v(i._s(i._f("file_name")(i.file.name)))])]),i._v(" "),e("div",[e("span",{staticClass:"file-size"},[i._v(`
				`+i._s(i._f("file_size")(i.file.file_obj.size))+`
			`)])]),i._v(" "),e("div",{staticClass:"flex config-area"},[i.is_optimizable?e("label",{staticClass:"frappe-checkbox"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:i.optimize},on:{change:function(r){return i.$emit("toggle_optimize")}}}),i._v("Optimize")]):i._e(),i._v(" "),e("label",{staticClass:"frappe-checkbox"},[e("input",{attrs:{type:"checkbox"},domProps:{checked:i.file.private},on:{change:function(r){return i.$emit("toggle_private")}}}),i._v("Private")])]),i._v(" "),e("div",[i.file.error_message?e("span",{staticClass:"file-error text-danger"},[i._v(`
				`+i._s(i.file.error_message)+`
			`)]):i._e()])]),i._v(" "),e("div",{staticClass:"file-actions"},[e("ProgressRing",{directives:[{name:"show",rawName:"v-show",value:i.file.uploading&&!i.uploaded&&!i.file.failed,expression:"file.uploading && !uploaded && !file.failed"}],attrs:{primary:"var(--primary-color)",secondary:"var(--gray-200)",radius:24,progress:i.progress,stroke:3}}),i._v(" "),i.uploaded?e("div",{domProps:{innerHTML:i._s(i.frappe.utils.icon("solid-success","lg"))}}):i._e(),i._v(" "),i.file.failed?e("div",{domProps:{innerHTML:i._s(i.frappe.utils.icon("solid-error","lg"))}}):i._e(),i._v(" "),e("div",{staticClass:"file-action-buttons"},[i.is_cropable?e("button",{staticClass:"btn btn-crop muted",domProps:{innerHTML:i._s(i.frappe.utils.icon("crop","md"))},on:{click:function(r){return i.$emit("toggle_image_cropper")}}}):i._e(),i._v(" "),!i.uploaded&&!i.file.uploading&&!i.file.failed?e("button",{staticClass:"btn muted",domProps:{innerHTML:i._s(i.frappe.utils.icon("delete","md"))},on:{click:function(r){return i.$emit("remove")}}}):i._e()])],1)])},jw=[];Cd._withStripped=!0;var zw=function(i){!i||i("data-v-78fcc692_0",{source:`
.file-preview {
	display: flex;
	align-items: center;
	padding: 0.75rem;
	border: 1px solid transparent;
}
.file-preview + .file-preview {
	border-top-color: var(--border-color);
}
.file-preview:hover {
	background-color: var(--bg-color);
	border-color: var(--dark-border-color);
	border-radius: var(--border-radius);
}
.file-preview:hover + .file-preview {
	border-top-color: transparent;
}
.file-icon {
	border-radius: var(--border-radius);
	width: 2.625rem;
	height: 2.625rem;
	overflow: hidden;
	margin-right: var(--margin-md);
	flex-shrink: 0;
}
.file-icon img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}
.file-icon .fallback {
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius);
}
.file-name {
	font-size: var(--text-base);
	font-weight: var(--text-bold);
	color: var(--text-color);
	display: -webkit-box;
	-webkit-line-clamp: 1;
	-webkit-box-orient: vertical;
	overflow: hidden;
}
.file-size {
	font-size: var(--text-sm);
	color: var(--text-light);
}
.file-actions {
	width: 3rem;
	flex-shrink: 0;
	margin-left: auto;
	text-align: center;
}
.file-actions .btn {
	padding: var(--padding-xs);
	box-shadow: none;
}
.file-action-buttons {
	display: flex;
	justify-content: flex-end;
}
.muted {
	opacity: 0.5;
	transition: 0.3s;
}
.muted:hover {
	opacity: 1;
}
.frappe-checkbox {
	font-size: var(--text-sm);
	color: var(--text-light);
	display: flex;
	align-items: center;
	padding-top: 0.25rem;
}
.config-area {
	gap: 0.5rem;
}
.file-error {
	font-size: var(--text-sm);
	font-weight: var(--text-bold);
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/FilePreview.vue"],names:[],mappings:";AAoHA;CACA,aAAA;CACA,mBAAA;CACA,gBAAA;CACA,6BAAA;AACA;AAEA;CACA,qCAAA;AACA;AAEA;CACA,iCAAA;CACA,sCAAA;CACA,mCAAA;AACA;AAEA;CACA,6BAAA;AACA;AAEA;CACA,mCAAA;CACA,eAAA;CACA,gBAAA;CACA,gBAAA;CACA,8BAAA;CACA,cAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,iBAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,qCAAA;CACA,mCAAA;AACA;AAEA;CACA,2BAAA;CACA,6BAAA;CACA,wBAAA;CACA,oBAAA;CACA,qBAAA;CACA,4BAAA;CACA,gBAAA;AACA;AAEA;CACA,yBAAA;CACA,wBAAA;AACA;AAEA;CACA,WAAA;CACA,cAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,0BAAA;CACA,gBAAA;AACA;AAEA;CACA,aAAA;CACA,yBAAA;AACA;AAEA;CACA,YAAA;CACA,gBAAA;AACA;AAEA;CACA,UAAA;AACA;AAEA;CACA,yBAAA;CACA,wBAAA;CACA,aAAA;CACA,mBAAA;CACA,oBAAA;AACA;AAEA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,6BAAA;AACA",file:"FilePreview.vue",sourcesContent:[`<template>
	<div class="file-preview">
		<div class="file-icon">
			<img
				v-if="is_image"
				:src="src"
				:alt="file.name"
			>
			<div class="fallback" v-else v-html="frappe.utils.icon('file', 'md')">
			</div>
		</div>
		<div>
			<div>
				<a class="flex" :href="file.doc.file_url" v-if="file.doc" target="_blank">
					<span class="file-name">{{ file.name | file_name }}</span>
				</a>
				<span class="file-name" v-else>{{ file.name | file_name }}</span>
			</div>

			<div>
				<span class="file-size">
					{{ file.file_obj.size | file_size }}
				</span>
			</div>

			<div class="flex config-area">
				<label v-if="is_optimizable" class="frappe-checkbox"><input type="checkbox" :checked="optimize" @change="$emit('toggle_optimize')">Optimize</label>
				<label class="frappe-checkbox"><input type="checkbox" :checked="file.private" @change="$emit('toggle_private')">Private</label>
			</div>
			<div>
				<span v-if="file.error_message" class="file-error text-danger">
					{{ file.error_message }}
				</span>
			</div>
		</div>
		<div class="file-actions">
			<ProgressRing
				v-show="file.uploading && !uploaded && !file.failed"
				primary="var(--primary-color)"
				secondary="var(--gray-200)"
				:radius="24"
				:progress="progress"
				:stroke="3"
			/>
			<div v-if="uploaded" v-html="frappe.utils.icon('solid-success', 'lg')"></div>
			<div v-if="file.failed" v-html="frappe.utils.icon('solid-error', 'lg')"></div>
			<div class="file-action-buttons">
				<button v-if="is_cropable" class="btn btn-crop muted" @click="$emit('toggle_image_cropper')" v-html="frappe.utils.icon('crop', 'md')"></button>
				<button v-if="!uploaded && !file.uploading && !file.failed" class="btn muted" @click="$emit('remove')" v-html="frappe.utils.icon('delete', 'md')"></button>
			</div>
		</div>
	</div>
</template>

<script>
import ProgressRing from './ProgressRing.vue';
export default {
	name: 'FilePreview',
	props: ['file'],
	components: {
		ProgressRing
	},
	data() {
		return {
			src: null,
			optimize: this.file.optimize
		}
	},
	mounted() {
		if (this.is_image) {
			if (window.FileReader) {
				let fr = new FileReader();
				fr.onload = () => this.src = fr.result;
				fr.readAsDataURL(this.file.file_obj);
			}
		}
	},
	filters: {
		file_size(value) {
			return frappe.form.formatters.FileSize(value);
		},
		file_name(value) {
			return value;
			// return frappe.utils.file_name_ellipsis(value, 9);
		}
	},
	computed: {
		is_private() {
			return this.file.doc ? this.file.doc.is_private : this.file.private;
		},
		uploaded() {
			return this.file.request_succeeded;
		},
		is_image() {
			return this.file.file_obj.type.startsWith('image');
		},
		is_optimizable() {
			let is_svg = this.file.file_obj.type == 'image/svg+xml';
			return this.is_image && !is_svg && !this.uploaded && !this.file.failed;
		},
		is_cropable() {
			let croppable_types = ['image/jpeg', 'image/png'];
			return !this.uploaded && !this.file.uploading && !this.file.failed && croppable_types.includes(this.file.file_obj.type);
		},
		progress() {
			let value = Math.round((this.file.progress * 100) / this.file.total);
			if (isNaN(value)) {
				value = 0;
			}
			return value;
		}
	}
}
<\/script>

<style>
.file-preview {
	display: flex;
	align-items: center;
	padding: 0.75rem;
	border: 1px solid transparent;
}

.file-preview + .file-preview {
	border-top-color: var(--border-color);
}

.file-preview:hover {
	background-color: var(--bg-color);
	border-color: var(--dark-border-color);
	border-radius: var(--border-radius);
}

.file-preview:hover + .file-preview {
	border-top-color: transparent;
}

.file-icon {
	border-radius: var(--border-radius);
	width: 2.625rem;
	height: 2.625rem;
	overflow: hidden;
	margin-right: var(--margin-md);
	flex-shrink: 0;
}

.file-icon img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.file-icon .fallback {
	width: 100%;
	height: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px solid var(--border-color);
	border-radius: var(--border-radius);
}

.file-name {
	font-size: var(--text-base);
	font-weight: var(--text-bold);
	color: var(--text-color);
	display: -webkit-box;
	-webkit-line-clamp: 1;
	-webkit-box-orient: vertical;
	overflow: hidden;
}

.file-size {
	font-size: var(--text-sm);
	color: var(--text-light);
}

.file-actions {
	width: 3rem;
	flex-shrink: 0;
	margin-left: auto;
	text-align: center;
}

.file-actions .btn {
	padding: var(--padding-xs);
	box-shadow: none;
}

.file-action-buttons {
	display: flex;
	justify-content: flex-end;
}

.muted {
	opacity: 0.5;
	transition: 0.3s;
}

.muted:hover {
	opacity: 1;
}

.frappe-checkbox {
	font-size: var(--text-sm);
	color: var(--text-light);
	display: flex;
	align-items: center;
	padding-top: 0.25rem;
}

.config-area {
	gap: 0.5rem;
}

.file-error {
	font-size: var(--text-sm);
	font-weight: var(--text-bold);
}
</style>
`]},media:void 0})},Fw=void 0,Hw=void 0,qw=!1;function Uw(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/FilePreview.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Ia(){let i=Ia.styles||(Ia.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var Ww=Uw({render:Cd,staticRenderFns:jw},zw,Dw,Fw,qw,Hw,!1,Ia,void 0,void 0),Sd=Ww;var Vw={name:"TreeNode",props:["node","selected_node"],components:{TreeNode:()=>frappe.ui.components.TreeNode},computed:{icon(){let i={open:frappe.utils.icon("folder-open","md"),closed:frappe.utils.icon("folder-normal","md"),leaf:frappe.utils.icon("primitive-dot","xs"),search:frappe.utils.icon("search")};return this.node.by_search?i.search:this.node.is_leaf?i.leaf:this.node.open?i.open:i.closed}}},Td=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",{staticClass:"tree-node",class:{opened:i.node.open}},[e("span",{staticClass:"tree-link",class:{active:i.node.value===i.selected_node.value},attrs:{disabled:i.node.fetching},on:{click:function(r){return i.$emit("node-click",i.node)}}},[e("div",{domProps:{innerHTML:i._s(i.icon)}}),i._v(" "),e("a",{staticClass:"tree-label"},[i._v(i._s(i.node.label))])]),i._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:i.node.open,expression:"node.open"}],staticClass:"tree-children"},[i._l(i.node.children,function(r){return e("TreeNode",{key:r.value,attrs:{node:r,selected_node:i.selected_node},on:{"node-click":function(n){return i.$emit("node-click",n)},"load-more":function(n){return i.$emit("load-more",n)}}})}),i._v(" "),i.node.has_more_children?e("button",{staticClass:"btn btn-xs btn-load-more",attrs:{disabled:i.node.children_loading},on:{click:function(r){return i.$emit("load-more",i.node)}}},[i._v(`
			`+i._s(i.node.children_loading?i.__("Loading..."):i.__("Load more"))+`
		`)]):i._e()],2)])},Yw=[];Td._withStripped=!0;var Gw=function(i){!i||i("data-v-23974a16_0",{source:`
.btn-load-more[data-v-23974a16] {
	margin-left: 1.6rem;
	margin-top: 0.5rem;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/TreeNode.vue"],names:[],mappings:";AAwDA;CACA,mBAAA;CACA,kBAAA;AACA",file:"TreeNode.vue",sourcesContent:[`<template>
	<div class="tree-node" :class="{ opened: node.open }">
		<span
			class="tree-link"
			@click="$emit('node-click', node)"
			:class="{ active: node.value === selected_node.value }"
			:disabled="node.fetching"
		>
			<div v-html="icon"></div>
			<a class="tree-label">{{ node.label }}</a>
		</span>
		<ul class="tree-children" v-show="node.open">
			<TreeNode
				v-for="n in node.children"
				:key="n.value"
				:node="n"
				:selected_node="selected_node"
				@node-click="n => $emit('node-click', n)"
				@load-more="n => $emit('load-more', n)"
			/>
			<button
				class="btn btn-xs btn-load-more"
				v-if="node.has_more_children"
				@click="$emit('load-more', node)"
				:disabled="node.children_loading"
			>
				{{ node.children_loading ? __("Loading...") : __("Load more") }}
			</button>
		</ul>
	</div>
</template>
<script>
export default {
	name: "TreeNode",
	props: ["node", "selected_node"],
	components: {
		TreeNode: () => frappe.ui.components.TreeNode
	},
	computed: {
		icon() {
			let icons = {
				open: frappe.utils.icon("folder-open", "md"),
				closed: frappe.utils.icon("folder-normal", "md"),
				leaf: frappe.utils.icon("primitive-dot", "xs"),
				search: frappe.utils.icon("search")
			};

			if (this.node.by_search) return icons.search;
			if (this.node.is_leaf) return icons.leaf;
			if (this.node.open) return icons.open;
			return icons.closed;
		}
	}
};
<\/script>
<style scoped>
.btn-load-more {
	margin-left: 1.6rem;
	margin-top: 0.5rem;
}
</style>
`]},media:void 0})},Xw="data-v-23974a16",Kw=void 0,Jw=!1;function Zw(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/TreeNode.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Ma(){let i=Ma.styles||(Ma.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var Qw=Zw({render:Td,staticRenderFns:Yw},Gw,Vw,Xw,Jw,Kw,!1,Ma,void 0,void 0),Ed=Qw;var e0={name:"FileBrowser",components:{TreeNode:Ed},data(){return{node:{label:__("Home"),value:"Home",children:[],children_start:0,children_loading:!1,is_leaf:!1,fetching:!1,fetched:!1,open:!1,filtered:!0},selected_node:{},search_text:"",page_length:10}},mounted(){this.toggle_node(this.node)},methods:{toggle_node(i){!i.fetched&&!i.is_leaf?(i.fetching=!0,i.children_start=0,i.children_loading=!1,this.get_files_in_folder(i.value,0).then(({files:t,has_more:e})=>{i.open=!0,i.children=t,i.fetched=!0,i.fetching=!1,i.children_start+=this.page_length,i.has_more_children=e})):(i.open=!i.open,this.select_node(i))},load_more(i){if(i.has_more_children){let t=i.children_start;i.children_loading=!0,this.get_files_in_folder(i.value,t).then(({files:e,has_more:r})=>{i.children=i.children.concat(e),i.children_start+=this.page_length,i.has_more_children=r,i.children_loading=!1})}},select_node(i){i.is_leaf&&(this.selected_node=i)},get_files_in_folder(i,t){return frappe.call("frappe.core.api.file.get_files_in_folder",{folder:i,start:t,page_length:this.page_length}).then(e=>{let{files:r=[],has_more:n=!1}=e.message||{};return r.sort((a,s)=>a.is_folder&&s.is_folder?a.modified<s.modified?-1:1:a.is_folder?-1:s.is_folder?1:0),r=r.map(a=>this.make_file_node(a)),{files:r,has_more:n}})},search_by_name:frappe.utils.debounce(function(){if(this.search_text===""){this.node=this.folder_node;return}this.search_text.length<3||frappe.call("frappe.core.api.file.get_files_by_search_text",{text:this.search_text}).then(i=>{let t=i.message||[];t=t.map(e=>this.make_file_node(e)),this.folder_node||(this.folder_node=this.node),this.node={label:__("Search Results"),value:"",children:t,by_search:!0,open:!0,filtered:!0}})},300),make_file_node(i){let t=i.file_name||i.name;return{label:frappe.utils.file_name_ellipsis(t,40),filename:t,file_url:i.file_url,value:i.name,is_leaf:!i.is_folder,fetched:!i.is_folder,children:[],children_loading:!1,children_start:0,open:!1,fetching:!1,filtered:!0}}}},Ad=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",{staticClass:"file-browser"},[e("div",[e("a",{staticClass:"text-muted text-medium",attrs:{href:""},on:{click:function(r){return r.preventDefault(),i.$emit("hide-browser")}}},[i._v(`
			`+i._s(i.__("\u2190 Back to upload files"))+`
		`)])]),i._v(" "),e("div",{staticClass:"file-browser-list"},[e("div",{staticClass:"file-filter"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.search_text,expression:"search_text"}],staticClass:"form-control input-xs",attrs:{type:"search",placeholder:i.__("Search by filename or extension")},domProps:{value:i.search_text},on:{input:[function(r){r.target.composing||(i.search_text=r.target.value)},i.search_by_name]}})]),i._v(" "),e("TreeNode",{staticClass:"tree with-skeleton",attrs:{node:i.node,selected_node:i.selected_node},on:{"node-click":function(r){return i.toggle_node(r)},"load-more":function(r){return i.load_more(r)}}})],1)])},t0=[];Ad._withStripped=!0;var i0=function(i){!i||i("data-v-1c4eadd2_0",{source:`
.file-browser-list {
	height: 300px;
	overflow: hidden;
	margin-top: 10px;
}
.file-filter {
	padding: 3px;
}
.tree {
	overflow: auto;
	height: 100%;
	padding-left: 0;
	padding-right: 0;
	padding-bottom: 4rem;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/FileBrowser.vue"],names:[],mappings:";AAkLA;CACA,aAAA;CACA,gBAAA;CACA,gBAAA;AACA;AAEA;CACA,YAAA;AACA;AAEA;CACA,cAAA;CACA,YAAA;CACA,eAAA;CACA,gBAAA;CACA,oBAAA;AACA",file:"FileBrowser.vue",sourcesContent:[`<template>
	<div class="file-browser">
		<div>
			<a
				href=""
				class="text-muted text-medium"
				@click.prevent="$emit('hide-browser')"
			>
				{{ __("\u2190 Back to upload files") }}
			</a>
		</div>
		<div class="file-browser-list">
			<div class="file-filter">
				<input
					type="search"
					class="form-control input-xs"
					:placeholder="__('Search by filename or extension')"
					v-model="search_text"
					@input="search_by_name"
				/>
			</div>
			<TreeNode
				class="tree with-skeleton"
				:node="node"
				:selected_node="selected_node"
				@node-click="n => toggle_node(n)"
				@load-more="n => load_more(n)"
			/>
		</div>
	</div>
</template>
<script>
import TreeNode from "./TreeNode.vue";

export default {
	name: "FileBrowser",
	components: {
		TreeNode
	},
	data() {
		return {
			node: {
				label: __("Home"),
				value: "Home",
				children: [],
				children_start: 0,
				children_loading: false,
				is_leaf: false,
				fetching: false,
				fetched: false,
				open: false,
				filtered: true
			},
			selected_node: {},
			search_text: "",
			page_length: 10
		};
	},
	mounted() {
		this.toggle_node(this.node);
	},
	methods: {
		toggle_node(node) {
			if (!node.fetched && !node.is_leaf) {
				node.fetching = true;
				node.children_start = 0;
				node.children_loading = false;
				this.get_files_in_folder(node.value, 0).then(
					({ files, has_more }) => {
						node.open = true;
						node.children = files;
						node.fetched = true;
						node.fetching = false;
						node.children_start += this.page_length;
						node.has_more_children = has_more;
					}
				);
			} else {
				node.open = !node.open;
				this.select_node(node);
			}
		},
		load_more(node) {
			if (node.has_more_children) {
				let start = node.children_start;
				node.children_loading = true;
				this.get_files_in_folder(node.value, start).then(
					({ files, has_more }) => {
						node.children = node.children.concat(files);
						node.children_start += this.page_length;
						node.has_more_children = has_more;
						node.children_loading = false;
					}
				);
			}
		},
		select_node(node) {
			if (node.is_leaf) {
				this.selected_node = node;
			}
		},
		get_files_in_folder(folder, start) {
			return frappe
				.call("frappe.core.api.file.get_files_in_folder", {
					folder,
					start,
					page_length: this.page_length
				})
				.then(r => {
					let { files = [], has_more = false } = r.message || {};
					files.sort((a, b) => {
						if (a.is_folder && b.is_folder) {
							return a.modified < b.modified ? -1 : 1;
						}
						if (a.is_folder) {
							return -1;
						}
						if (b.is_folder) {
							return 1;
						}
						return 0;
					});
					files = files.map(file => this.make_file_node(file));
					return { files, has_more };
				});
		},
		search_by_name: frappe.utils.debounce(function() {
			if (this.search_text === "") {
				this.node = this.folder_node;
				return;
			}
			if (this.search_text.length < 3) return;
			frappe
				.call(
					"frappe.core.api.file.get_files_by_search_text",
					{
						text: this.search_text
					}
				)
				.then(r => {
					let files = r.message || [];
					files = files.map(file => this.make_file_node(file));
					if (!this.folder_node) {
						this.folder_node = this.node;
					}
					this.node = {
						label: __("Search Results"),
						value: "",
						children: files,
						by_search: true,
						open: true,
						filtered: true
					};
				});
		}, 300),
		make_file_node(file) {
			let filename = file.file_name || file.name;
			let label = frappe.utils.file_name_ellipsis(filename, 40);
			return {
				label: label,
				filename: filename,
				file_url: file.file_url,
				value: file.name,
				is_leaf: !file.is_folder,
				fetched: !file.is_folder, // fetched if node is leaf
				children: [],
				children_loading: false,
				children_start: 0,
				open: false,
				fetching: false,
				filtered: true
			};
		}
	}
};
<\/script>

<style>
.file-browser-list {
	height: 300px;
	overflow: hidden;
	margin-top: 10px;
}

.file-filter {
	padding: 3px;
}

.tree {
	overflow: auto;
	height: 100%;
	padding-left: 0;
	padding-right: 0;
	padding-bottom: 4rem;
}
</style>
`]},media:void 0})},r0=void 0,n0=void 0,a0=!1;function s0(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/FileBrowser.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Na(){let i=Na.styles||(Na.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var o0=s0({render:Ad,staticRenderFns:t0},i0,e0,r0,a0,n0,!1,Na,void 0,void 0),$d=o0;var l0={name:"WebLink",data(){return{url:""}}},Od=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",{staticClass:"file-web-link margin-bottom"},[e("a",{staticClass:"text-muted text-medium",attrs:{href:""},on:{click:function(r){return r.preventDefault(),i.$emit("hide-web-link")}}},[i._v(`
		`+i._s(i.__("\u2190 Back to upload files"))+`
	`)]),i._v(" "),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:i.url,expression:"url"}],staticClass:"form-control",attrs:{type:"text",placeholder:i.__("Attach a web link")},domProps:{value:i.url},on:{input:function(r){r.target.composing||(i.url=r.target.value)}}})])])},c0=[];Od._withStripped=!0;var u0=function(i){!i||i("data-v-3d6cb693_0",{source:`
.file-web-link .input-group {
	margin-top: 10px;
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/WebLink.vue"],names:[],mappings:";AA6BA;CACA,gBAAA;AACA",file:"WebLink.vue",sourcesContent:[`<template>
	<div class="file-web-link margin-bottom">
		<a href class="text-muted text-medium"
			@click.prevent="$emit('hide-web-link')"
		>
			{{ __('\u2190 Back to upload files') }}
		</a>
		<div class="input-group">
			<input
				type="text"
				class="form-control"
				:placeholder="__('Attach a web link')"
				v-model="url"
			>
		</div>
	</div>
</template>
<script>
export default {
	name: 'WebLink',
	data() {
		return {
			url: '',
		}
	}
}
<\/script>

<style>
.file-web-link .input-group {
	margin-top: 10px;
}
</style>
`]},media:void 0})},d0=void 0,f0=void 0,p0=!1;function h0(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/WebLink.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Pa(){let i=Pa.styles||(Pa.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var _0=h0({render:Od,staticRenderFns:c0},u0,l0,d0,p0,f0,!1,Pa,void 0,void 0),Rd=_0;var cn=class{constructor({pickerCallback:t,enabled:e,appId:r,developerKey:n,clientId:a}={}){this.scope=["https://www.googleapis.com/auth/drive.readonly"],this.pickerApiLoaded=!1,this.enabled=e,this.appId=r,this.pickerCallback=t,this.developerKey=n,this.clientId=a}loadPicker(){$.ajax({method:"GET",url:"https://apis.google.com/js/api.js",dataType:"script",cache:!0}).done(this.loadGapi.bind(this))}loadGapi(){frappe.boot.user.google_drive_token||gapi.load("auth",this.onAuthApiLoad.bind(this)),gapi.load("picker",this.onPickerApiLoad.bind(this))}onAuthApiLoad(){gapi.auth.authorize({client_id:this.clientId,scope:this.scope,immediate:!1},this.handleAuthResult.bind(this))}handleAuthResult(t){let e={popup_closed_by_user:__("Google Authentication was closed abruptly by the user")};if(t&&!t.error)frappe.boot.user.google_drive_token=t.access_token,this.createPicker();else{let r=e[t.error]||__("Google Authentication Error");frappe.throw(r)}}onPickerApiLoad(){this.pickerApiLoaded=!0,this.createPicker()}createPicker(){this.pickerApiLoaded&&frappe.boot.user.google_drive_token&&(this.view=new google.picker.DocsView(google.picker.ViewId.DOCS).setParent("root").setIncludeFolders(!0),this.picker=new google.picker.PickerBuilder().setAppId(this.appId).setDeveloperKey(this.developerKey).setOAuthToken(frappe.boot.user.google_drive_token).addView(this.view).setLocale(frappe.boot.lang).setCallback(this.pickerCallback).build(),this.picker.setVisible(!0),this.setupHide())}setupHide(){let t=$(".picker-dialog-bg");for(let e of t)e.onclick=()=>{this.picker.setVisible(!1),this.picker.Ob({action:google.picker.Action.CANCEL})}}};var Bd=Ut(Ld()),m0={name:"ImageCropper",props:["file","fixed_aspect_ratio"],data(){let i=this.fixed_aspect_ratio!=null?this.fixed_aspect_ratio:NaN;return{src:null,cropper:null,image:null,aspect_ratio:i}},watch:{aspect_ratio(i){this.cropper&&this.cropper.setAspectRatio(i)}},mounted(){if(window.FileReader){let t=new FileReader;t.onload=()=>this.src=t.result,t.readAsDataURL(this.file.cropper_file)}let i=this.file.crop_box_data;this.image=this.$refs.image,this.image.onload=()=>{this.cropper=new Bd.default(this.image,{zoomable:!1,scalable:!1,viewMode:1,data:i,aspectRatio:this.aspect_ratio}),window.cropper=this.cropper}},computed:{aspect_ratio_buttons(){return[{label:__("1:1"),value:1},{label:__("4:3"),value:4/3},{label:__("16:9"),value:16/9},{label:__("Free"),value:NaN}]}},methods:{crop_image(){this.file.crop_box_data=this.cropper.getData();let i=this.cropper.getCroppedCanvas(),t=this.file.file_obj.type;i.toBlob(e=>{var r=new File([e],this.file.name,{type:e.type});this.file.file_obj=r,this.$emit("toggle_image_cropper")},t)}}},Id=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",[e("div",[e("img",{ref:"image",attrs:{src:i.src,alt:i.file.name}})]),i._v(" "),e("div",{staticClass:"image-cropper-actions"},[e("div",[i.fixed_aspect_ratio==null?e("div",{staticClass:"btn-group"},i._l(i.aspect_ratio_buttons,function(r){return e("button",{key:r.label,staticClass:"btn btn-default btn-sm",class:{active:isNaN(i.aspect_ratio)?isNaN(r.value):r.value===i.aspect_ratio},attrs:{type:"button"},on:{click:function(n){i.aspect_ratio=r.value}}},[i._v(`
					`+i._s(r.label)+`
				`)])}),0):i._e()]),i._v(" "),e("div",[i.fixed_aspect_ratio==null?e("button",{staticClass:"btn btn-sm margin-right",on:{click:function(r){return i.$emit("toggle_image_cropper")}}},[i._v(`
				`+i._s(i.__("Back"))+`
			`)]):i._e(),i._v(" "),e("button",{staticClass:"btn btn-primary btn-sm",on:{click:i.crop_image}},[i._v(`
				`+i._s(i.__("Crop"))+`
			`)])])])])},g0=[];Id._withStripped=!0;var v0=function(i){!i||i("data-v-07cb5b9d_0",{source:`
img {
	display: block;
	max-width: 100%;
	max-height: 600px;
}
.image-cropper-actions {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-top: var(--margin-md);
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/ImageCropper.vue"],names:[],mappings:";AAwHA;CACA,cAAA;CACA,eAAA;CACA,iBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,4BAAA;AACA",file:"ImageCropper.vue",sourcesContent:[`<template>
	<div>
		<div>
			<img ref="image" :src="src" :alt="file.name" />
		</div>
		<div class="image-cropper-actions">
			<div>
				<div class="btn-group" v-if="fixed_aspect_ratio == null">
					<button
						v-for="button in aspect_ratio_buttons"
						type="button"
						class="btn btn-default btn-sm"
						:class="{
							active: isNaN(aspect_ratio)
								? isNaN(button.value)
								: button.value === aspect_ratio
						}"
						:key="button.label"
						@click="aspect_ratio = button.value"
					>
						{{ button.label }}
					</button>
				</div>
			</div>
			<div>
				<button
					class="btn btn-sm margin-right"
					@click="$emit('toggle_image_cropper')"
					v-if="fixed_aspect_ratio == null"
				>
					{{ __("Back") }}
				</button>
				<button class="btn btn-primary btn-sm" @click="crop_image">
					{{ __("Crop") }}
				</button>
			</div>
		</div>
	</div>
</template>

<script>
import Cropper from "cropperjs";
export default {
	name: "ImageCropper",
	props: ["file", "fixed_aspect_ratio"],
	data() {
		let aspect_ratio =
			this.fixed_aspect_ratio != null ? this.fixed_aspect_ratio : NaN;
		return {
			src: null,
			cropper: null,
			image: null,
			aspect_ratio
		};
	},
	watch: {
		aspect_ratio(value) {
			if (this.cropper) {
				this.cropper.setAspectRatio(value);
			}
		}
	},
	mounted() {
		if (window.FileReader) {
			let fr = new FileReader();
			fr.onload = () => (this.src = fr.result);
			fr.readAsDataURL(this.file.cropper_file);
		}
		let crop_box = this.file.crop_box_data;
		this.image = this.$refs.image;
		this.image.onload = () => {
			this.cropper = new Cropper(this.image, {
				zoomable: false,
				scalable: false,
				viewMode: 1,
				data: crop_box,
				aspectRatio: this.aspect_ratio
			});
			window.cropper = this.cropper;
		};
	},
	computed: {
		aspect_ratio_buttons() {
			return [
				{
					label: __("1:1"),
					value: 1
				},
				{
					label: __("4:3"),
					value: 4 / 3
				},
				{
					label: __("16:9"),
					value: 16 / 9
				},
				{
					label: __("Free"),
					value: NaN
				}
			];
		}
	},
	methods: {
		crop_image() {
			this.file.crop_box_data = this.cropper.getData();
			const canvas = this.cropper.getCroppedCanvas();
			const file_type = this.file.file_obj.type;
			canvas.toBlob(blob => {
				var cropped_file_obj = new File([blob], this.file.name, {
					type: blob.type
				});
				this.file.file_obj = cropped_file_obj;
				this.$emit("toggle_image_cropper");
			}, file_type);
		}
	}
};
<\/script>
<style>
img {
	display: block;
	max-width: 100%;
	max-height: 600px;
}

.image-cropper-actions {
	display: flex;
	align-items: center;
	justify-content: space-between;
	margin-top: var(--margin-md);
}
</style>
`]},media:void 0})},b0=void 0,y0=void 0,w0=!1;function k0(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/ImageCropper.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function za(){let i=za.styles||(za.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var x0=k0({render:Id,staticRenderFns:g0},v0,m0,b0,w0,y0,!1,za,void 0,void 0),Md=x0;var C0={name:"FileUploader",props:{show_upload_button:{default:!0},disable_file_browser:{default:!1},allow_multiple:{default:!0},as_dataurl:{default:!1},doctype:{default:null},docname:{default:null},fieldname:{default:null},folder:{default:"Home"},method:{default:null},on_success:{default:null},make_attachments_public:{default:null},restrictions:{default:()=>({max_file_size:null,max_number_of_files:null,allowed_file_types:[],crop_image_aspect_ratio:null})},attach_doc_image:{default:!1},upload_notes:{default:null}},components:{FilePreview:Sd,FileBrowser:$d,WebLink:Rd,ImageCropper:Md},data(){return{files:[],is_dragging:!1,currently_uploading:-1,show_file_browser:!1,show_web_link:!1,show_image_cropper:!1,crop_image_with_index:-1,trigger_upload:!1,close_dialog:!1,hide_dialog_footer:!1,allow_take_photo:!1,allow_web_link:!0,google_drive_settings:{enabled:!1},wrapper_ready:!1}},created(){var i;this.allow_take_photo=window.navigator.mediaDevices,frappe.user_id!=="Guest"&&frappe.call({method:"frappe.integrations.doctype.google_settings.google_settings.get_file_picker_settings",callback:t=>{t.exc||(this.google_drive_settings=t.message)}}),this.restrictions.max_file_size==null&&frappe.call("frappe.core.api.file.get_max_file_size").then(t=>{this.restrictions.max_file_size=Number(t.message)}),this.restrictions.max_number_of_files==null&&this.doctype&&(this.restrictions.max_number_of_files=(i=frappe.get_meta(this.doctype))==null?void 0:i.max_attachments)},watch:{files(i,t){!this.allow_multiple&&i.length>1&&(this.files=[i[i.length-1]])}},computed:{upload_complete(){return this.files.length>0&&this.files.every(i=>i.total!==0&&i.progress===i.total)}},methods:{dragover(){this.is_dragging=!0},dragleave(){this.is_dragging=!1},dropfiles(i){this.is_dragging=!1,this.add_files(i.dataTransfer.files)},browse_files(){this.$refs.file_input.click()},on_file_input(i){this.add_files(this.$refs.file_input.files)},remove_file(i){this.files=this.files.filter(t=>t!==i)},toggle_image_cropper(i){this.crop_image_with_index=this.show_image_cropper?-1:i,this.hide_dialog_footer=!this.show_image_cropper,this.show_image_cropper=!this.show_image_cropper},toggle_all_private(){let i;this.files.filter(e=>e.private).length<this.files.length?i=!0:i=!1,this.files=this.files.map(e=>(e.private=i,e))},show_max_files_number_warning(i){console.warn(`File skipped because it exceeds the allowed specified limit of ${max_number_of_files} uploads`,i),this.doctype?MSG=__('File "{0}" was skipped because only {1} uploads are allowed for DocType "{2}"',[i.name,max_number_of_files,this.doctype]):MSG=__('File "{0}" was skipped because only {1} uploads are allowed',[i.name,max_number_of_files]),frappe.show_alert({message:MSG,indicator:"orange"})},add_files(i){let t=Array.from(i).filter(this.check_restrictions).map(e=>{let r=e.type.startsWith("image"),n=e.size/1024;return{file_obj:e,cropper_file:e,crop_box_data:null,optimize:n>200&&r&&!e.type.includes("svg"),name:e.name,doc:null,progress:0,total:0,failed:!1,request_succeeded:!1,error_message:null,uploading:!1,private:!this.make_attachments_public}});max_number_of_files=this.restrictions.max_number_of_files,max_number_of_files&&t.length>max_number_of_files&&(t.slice(max_number_of_files).forEach(e=>{this.show_max_files_number_warning(e,this.doctype)}),t=t.slice(0,max_number_of_files)),this.files=this.files.concat(t),this.files.length===1&&!this.allow_multiple&&this.restrictions.crop_image_aspect_ratio!=null&&(this.files[0].file_obj.type.includes("svg")||this.toggle_image_cropper(0))},check_restrictions(i){let{max_file_size:t,allowed_file_types:e=[]}=this.restrictions,r=!0,n=!0;return e&&e.length&&(r=e.some(a=>a.includes("/")?i.type?i.type.match(a):!1:a[0]==="."?i.name.endsWith(a):!1)),t&&i.size!=null&&(n=i.size<t),r||(console.warn("File skipped because of invalid file type",i),frappe.show_alert({message:__('File "{0}" was skipped because of invalid file type',[i.name]),indicator:"orange"})),n||(console.warn("File skipped because of invalid file size",i.size,i),frappe.show_alert({message:__('File "{0}" was skipped because size exceeds {1} MB',[i.name,t/(1024*1024)]),indicator:"orange"})),r&&n},upload_files(){return this.show_file_browser?this.upload_via_file_browser():this.show_web_link?this.upload_via_web_link():this.as_dataurl?this.return_as_dataurl():frappe.run_serially(this.files.map((i,t)=>()=>this.upload_file(i,t)))},upload_via_file_browser(){let i=this.$refs.file_browser.selected_node;return i.value?(this.close_dialog=!0,this.upload_file({file_url:i.file_url})):(frappe.msgprint(__("Click on a file to select it.")),this.close_dialog=!0,Promise.reject())},upload_via_web_link(){let i=this.$refs.web_link.url;return i?(i=decodeURI(i),this.close_dialog=!0,this.upload_file({file_url:i})):(frappe.msgprint(__("Invalid URL")),this.close_dialog=!0,Promise.reject())},return_as_dataurl(){let i=this.files.map(t=>frappe.dom.file_to_base64(t.file_obj).then(e=>{t.dataurl=e,this.on_success&&this.on_success(t)}));return this.close_dialog=!0,Promise.all(i)},upload_file(i,t){return this.currently_uploading=t,new Promise((e,r)=>{let n=new XMLHttpRequest;n.upload.addEventListener("loadstart",s=>{i.uploading=!0}),n.upload.addEventListener("progress",s=>{s.lengthComputable&&(i.progress=s.loaded,i.total=s.total)}),n.upload.addEventListener("load",s=>{i.uploading=!1,e()}),n.addEventListener("error",s=>{i.failed=!0,r()}),n.onreadystatechange=()=>{if(n.readyState==XMLHttpRequest.DONE)if(n.status===200){i.request_succeeded=!0;let s=null,o=null;try{s=JSON.parse(n.responseText),s.message.doctype==="File"&&(o=s.message)}catch(l){s=n.responseText}i.doc=o,this.on_success&&this.on_success(o,s),t==this.files.length-1&&this.files.every(l=>l.request_succeeded)&&(this.close_dialog=!0)}else if(n.status===403){i.failed=!0;let s=JSON.parse(n.responseText);i.error_message=`Not permitted. ${s._error_message||""}`}else if(n.status===413)i.failed=!0,i.error_message="Size exceeds the maximum allowed file size.";else{i.failed=!0,i.error_message=n.status===0?"XMLHttpRequest Error":`${n.status} : ${n.statusText}`;let s=null;try{s=JSON.parse(n.responseText)}catch(o){}frappe.request.cleanup({},s)}},n.open("POST","/api/method/upload_file",!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("X-Frappe-CSRF-Token",frappe.csrf_token);let a=new FormData;i.file_obj&&a.append("file",i.file_obj,i.name),a.append("is_private",+i.private),a.append("folder",this.folder),i.file_url&&a.append("file_url",i.file_url),i.file_name&&a.append("file_name",i.file_name),this.doctype&&this.docname&&(a.append("doctype",this.doctype),a.append("docname",this.docname)),this.fieldname&&a.append("fieldname",this.fieldname),this.method&&a.append("method",this.method),i.optimize&&a.append("optimize",!0),this.attach_doc_image&&(a.append("max_width",200),a.append("max_height",200)),n.send(a)})},capture_image(){let i=new frappe.ui.Capture({animate:!1,error:!0});i.show(),i.submit(t=>{t.forEach(e=>{let r=`capture_${frappe.datetime.now_datetime().replaceAll(/[: -]/g,"_")}.png`;this.url_to_file(e,r,"image/png").then(n=>this.add_files([n]))})})},show_google_drive_picker(){this.close_dialog=!0,new cn(lt({pickerCallback:t=>this.google_drive_callback(t)},this.google_drive_settings)).loadPicker()},google_drive_callback(i){i.action==google.picker.Action.PICKED?this.upload_file({file_url:i.docs[0].url,file_name:i.docs[0].name}):i.action==google.picker.Action.CANCEL&&cur_frm.attachments.new_attachment()},url_to_file(i,t,e){return fetch(i).then(r=>r.arrayBuffer()).then(r=>new File([r],t,{type:e}))}}},Nd=function(){var i=this,t=i.$createElement,e=i._self._c||t;return e("div",{staticClass:"file-uploader",on:{dragover:function(r){return r.preventDefault(),i.dragover.apply(null,arguments)},dragleave:function(r){return r.preventDefault(),i.dragleave.apply(null,arguments)},drop:function(r){return r.preventDefault(),i.dropfiles.apply(null,arguments)}}},[e("div",{directives:[{name:"show",rawName:"v-show",value:i.files.length===0&&!i.show_file_browser&&!i.show_web_link,expression:"files.length === 0 && !show_file_browser && !show_web_link"}],staticClass:"file-upload-area"},[i.is_dragging?e("div",[i._v(`
			`+i._s(i.__("Drop files here"))+`
		`)]):e("div",[e("div",{staticClass:"text-center"},[i._v(`
				`+i._s(i.__("Drag and drop files here or upload from"))+`
			`)]),i._v(" "),e("div",{staticClass:"mt-2 text-center"},[e("button",{staticClass:"btn btn-file-upload",on:{click:i.browse_files}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"url(#paint0_linear)"}}),i._v(" "),e("path",{attrs:{d:"M13.5 22V19",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("path",{attrs:{d:"M16.5 22V19",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("path",{attrs:{d:"M10.5 22H19.5",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("path",{attrs:{d:"M7.5 16H22.5",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("path",{attrs:{d:"M21 8H9C8.17157 8 7.5 8.67157 7.5 9.5V17.5C7.5 18.3284 8.17157 19 9 19H21C21.8284 19 22.5 18.3284 22.5 17.5V9.5C22.5 8.67157 21.8284 8 21 8Z",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("defs",[e("linearGradient",{attrs:{id:"paint0_linear",x1:"0",y1:"0",x2:"0",y2:"30",gradientUnits:"userSpaceOnUse"}},[e("stop",{attrs:{"stop-color":"#2C9AF1"}}),i._v(" "),e("stop",{attrs:{offset:"1","stop-color":"#2490EF"}})],1)],1)]),i._v(" "),e("div",{staticClass:"mt-1"},[i._v(i._s(i.__("My Device")))])]),i._v(" "),e("input",{ref:"file_input",staticClass:"hidden",attrs:{type:"file",multiple:i.allow_multiple,accept:(i.restrictions.allowed_file_types||[]).join(", ")},on:{change:i.on_file_input}}),i._v(" "),i.disable_file_browser?i._e():e("button",{staticClass:"btn btn-file-upload",on:{click:function(r){i.show_file_browser=!0}}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#48BB74"}}),i._v(" "),e("path",{attrs:{d:"M13.0245 11.5H8C7.72386 11.5 7.5 11.7239 7.5 12V20C7.5 21.1046 8.39543 22 9.5 22H20.5C21.6046 22 22.5 21.1046 22.5 20V14.5C22.5 14.2239 22.2761 14 22 14H15.2169C15.0492 14 14.8926 13.9159 14.8 13.776L13.4414 11.724C13.3488 11.5841 13.1922 11.5 13.0245 11.5Z",stroke:"white","stroke-miterlimit":"10","stroke-linecap":"square"}}),i._v(" "),e("path",{attrs:{d:"M8.87939 9.5V8.5C8.87939 8.22386 9.10325 8 9.37939 8H20.6208C20.8969 8 21.1208 8.22386 21.1208 8.5V12",stroke:"white","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}})]),i._v(" "),e("div",{staticClass:"mt-1"},[i._v(i._s(i.__("Library")))])]),i._v(" "),i.allow_web_link?e("button",{staticClass:"btn btn-file-upload",on:{click:function(r){i.show_web_link=!0}}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#ECAC4B"}}),i._v(" "),e("path",{attrs:{d:"M12.0469 17.9543L17.9558 12.0454",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("path",{attrs:{d:"M13.8184 11.4547L15.7943 9.47873C16.4212 8.85205 17.2714 8.5 18.1578 8.5C19.0443 8.5 19.8945 8.85205 20.5214 9.47873V9.47873C21.1481 10.1057 21.5001 10.9558 21.5001 11.8423C21.5001 12.7287 21.1481 13.5789 20.5214 14.2058L18.5455 16.1818",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}}),i._v(" "),e("path",{attrs:{d:"M11.4547 13.8184L9.47873 15.7943C8.85205 16.4212 8.5 17.2714 8.5 18.1578C8.5 19.0443 8.85205 19.8945 9.47873 20.5214V20.5214C10.1057 21.1481 10.9558 21.5001 11.8423 21.5001C12.7287 21.5001 13.5789 21.1481 14.2058 20.5214L16.1818 18.5455",stroke:"white","stroke-linecap":"round","stroke-linejoin":"round"}})]),i._v(" "),e("div",{staticClass:"mt-1"},[i._v(i._s(i.__("Link")))])]):i._e(),i._v(" "),i.allow_take_photo?e("button",{staticClass:"btn btn-file-upload",on:{click:i.capture_image}},[e("svg",{attrs:{width:"30",height:"30",viewBox:"0 0 30 30",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{attrs:{cx:"15",cy:"15",r:"15",fill:"#CE315B"}}),i._v(" "),e("path",{attrs:{d:"M11.5 10.5H9.5C8.67157 10.5 8 11.1716 8 12V20C8 20.8284 8.67157 21.5 9.5 21.5H20.5C21.3284 21.5 22 20.8284 22 20V12C22 11.1716 21.3284 10.5 20.5 10.5H18.5L17.3 8.9C17.1111 8.64819 16.8148 8.5 16.5 8.5H13.5C13.1852 8.5 12.8889 8.64819 12.7 8.9L11.5 10.5Z",stroke:"white","stroke-linejoin":"round"}}),i._v(" "),e("circle",{attrs:{cx:"15",cy:"16",r:"2.5",stroke:"white"}})]),i._v(" "),e("div",{staticClass:"mt-1"},[i._v(i._s(i.__("Camera")))])]):i._e(),i._v(" "),i.google_drive_settings.enabled?e("button",{staticClass:"btn btn-file-upload",on:{click:i.show_google_drive_picker}},[e("svg",{attrs:{width:"30",height:"30"}},[e("image",{attrs:{href:"/assets/frappe/icons/social/google_drive.svg",width:"30",height:"30"}})]),i._v(" "),e("div",{staticClass:"mt-1"},[i._v(i._s(i.__("Google Drive")))])]):i._e()]),i._v(" "),e("div",{staticClass:"text-muted text-medium"},[i._v(`
				`+i._s(i.upload_notes)+`
			`)])])]),i._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:i.files.length&&!i.show_file_browser&&!i.show_web_link,expression:"files.length && !show_file_browser && !show_web_link"}],staticClass:"file-preview-area"},[i.show_image_cropper?i._e():e("div",{staticClass:"file-preview-container"},i._l(i.files,function(r,n){return e("FilePreview",{key:r.name,attrs:{file:r},on:{remove:function(a){return i.remove_file(r)},toggle_private:function(a){r.private=!r.private},toggle_optimize:function(a){r.optimize=!r.optimize},toggle_image_cropper:function(a){return i.toggle_image_cropper(n)}}})}),1),i._v(" "),i.show_upload_button&&i.currently_uploading===-1?e("div",{staticClass:"flex align-center"},[e("button",{staticClass:"btn btn-primary btn-sm margin-right",on:{click:i.upload_files}},[i.files.length===1?e("span",[i._v(`
					`+i._s(i.__("Upload file"))+`
				`)]):e("span",[i._v(`
					`+i._s(i.__("Upload {0} files",[i.files.length]))+`
				`)])]),i._v(" "),e("div",{staticClass:"text-muted text-medium"},[i._v(`
				`+i._s(i.__("Click on the lock icon to toggle public/private"))+`
			`)])]):i._e()]),i._v(" "),i.show_image_cropper&&i.wrapper_ready?e("ImageCropper",{attrs:{file:i.files[i.crop_image_with_index],fixed_aspect_ratio:i.restrictions.crop_image_aspect_ratio},on:{toggle_image_cropper:function(r){return i.toggle_image_cropper(-1)},upload_after_crop:function(r){i.trigger_upload=!0}}}):i._e(),i._v(" "),i.show_file_browser&&!i.disable_file_browser?e("FileBrowser",{ref:"file_browser",on:{"hide-browser":function(r){i.show_file_browser=!1}}}):i._e(),i._v(" "),i.show_web_link?e("WebLink",{ref:"web_link",on:{"hide-web-link":function(r){i.show_web_link=!1}}}):i._e()],1)},S0=[];Nd._withStripped=!0;var T0=function(i){!i||i("data-v-ae1e69a6_0",{source:`
.file-upload-area {
	min-height: 16rem;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px dashed var(--dark-border-color);
	border-radius: var(--border-radius);
	cursor: pointer;
	background-color: var(--bg-color);
}
.btn-file-upload {
	background-color: transparent;
	border: none;
	box-shadow: none;
	font-size: var(--text-xs);
}
`,map:{version:3,sources:["frappe/public/js/frappe/file_uploader/FileUploader.vue"],names:[],mappings:";AAulBA;CACA,iBAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,2CAAA;CACA,mCAAA;CACA,eAAA;CACA,iCAAA;AACA;AAEA;CACA,6BAAA;CACA,YAAA;CACA,gBAAA;CACA,yBAAA;AACA",file:"FileUploader.vue",sourcesContent:[`<template>
	<div class="file-uploader"
		@dragover.prevent="dragover"
		@dragleave.prevent="dragleave"
		@drop.prevent="dropfiles"
	>
		<div
			class="file-upload-area"
			v-show="files.length === 0 && !show_file_browser && !show_web_link"
		>
			<div v-if="!is_dragging">
				<div class="text-center">
					{{ __('Drag and drop files here or upload from') }}
				</div>
				<div class="mt-2 text-center">
					<button class="btn btn-file-upload" @click="browse_files">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="url(#paint0_linear)"/>
							<path d="M13.5 22V19" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M16.5 22V19" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M10.5 22H19.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M7.5 16H22.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M21 8H9C8.17157 8 7.5 8.67157 7.5 9.5V17.5C7.5 18.3284 8.17157 19 9 19H21C21.8284 19 22.5 18.3284 22.5 17.5V9.5C22.5 8.67157 21.8284 8 21 8Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<defs>
							<linearGradient id="paint0_linear" x1="0" y1="0" x2="0" y2="30" gradientUnits="userSpaceOnUse">
							<stop stop-color="#2C9AF1"/>
							<stop offset="1" stop-color="#2490EF"/>
							</linearGradient>
							</defs>
						</svg>
						<div class="mt-1">{{ __('My Device') }}</div>
					</button>
					<input
						type="file"
						class="hidden"
						ref="file_input"
						@change="on_file_input"
						:multiple="allow_multiple"
						:accept="(restrictions.allowed_file_types || []).join(', ')"
					>
					<button class="btn btn-file-upload" v-if="!disable_file_browser" @click="show_file_browser = true">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="#48BB74"/>
							<path d="M13.0245 11.5H8C7.72386 11.5 7.5 11.7239 7.5 12V20C7.5 21.1046 8.39543 22 9.5 22H20.5C21.6046 22 22.5 21.1046 22.5 20V14.5C22.5 14.2239 22.2761 14 22 14H15.2169C15.0492 14 14.8926 13.9159 14.8 13.776L13.4414 11.724C13.3488 11.5841 13.1922 11.5 13.0245 11.5Z" stroke="white" stroke-miterlimit="10" stroke-linecap="square"/>
							<path d="M8.87939 9.5V8.5C8.87939 8.22386 9.10325 8 9.37939 8H20.6208C20.8969 8 21.1208 8.22386 21.1208 8.5V12" stroke="white" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
						<div class="mt-1">{{ __('Library') }}</div>
					</button>
					<button class="btn btn-file-upload" v-if="allow_web_link" @click="show_web_link = true">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="#ECAC4B"/>
							<path d="M12.0469 17.9543L17.9558 12.0454" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M13.8184 11.4547L15.7943 9.47873C16.4212 8.85205 17.2714 8.5 18.1578 8.5C19.0443 8.5 19.8945 8.85205 20.5214 9.47873V9.47873C21.1481 10.1057 21.5001 10.9558 21.5001 11.8423C21.5001 12.7287 21.1481 13.5789 20.5214 14.2058L18.5455 16.1818" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
							<path d="M11.4547 13.8184L9.47873 15.7943C8.85205 16.4212 8.5 17.2714 8.5 18.1578C8.5 19.0443 8.85205 19.8945 9.47873 20.5214V20.5214C10.1057 21.1481 10.9558 21.5001 11.8423 21.5001C12.7287 21.5001 13.5789 21.1481 14.2058 20.5214L16.1818 18.5455" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
						<div class="mt-1">{{ __('Link') }}</div>
					</button>
					<button v-if="allow_take_photo" class="btn btn-file-upload" @click="capture_image">
						<svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="15" cy="15" r="15" fill="#CE315B"/>
							<path d="M11.5 10.5H9.5C8.67157 10.5 8 11.1716 8 12V20C8 20.8284 8.67157 21.5 9.5 21.5H20.5C21.3284 21.5 22 20.8284 22 20V12C22 11.1716 21.3284 10.5 20.5 10.5H18.5L17.3 8.9C17.1111 8.64819 16.8148 8.5 16.5 8.5H13.5C13.1852 8.5 12.8889 8.64819 12.7 8.9L11.5 10.5Z" stroke="white" stroke-linejoin="round"/>
							<circle cx="15" cy="16" r="2.5" stroke="white"/>
						</svg>
						<div class="mt-1">{{ __('Camera') }}</div>
					</button>
					<button v-if="google_drive_settings.enabled" class="btn btn-file-upload" @click="show_google_drive_picker">
						<svg width="30" height="30">
							<image href="/assets/frappe/icons/social/google_drive.svg" width="30" height="30"/>
						</svg>
						<div class="mt-1">{{ __('Google Drive') }}</div>
					</button>
				</div>
				<div class="text-muted text-medium">
					{{ upload_notes }}
				</div>
			</div>
			<div v-else>
				{{ __('Drop files here') }}
			</div>
		</div>
		<div class="file-preview-area" v-show="files.length && !show_file_browser && !show_web_link">
			<div class="file-preview-container" v-if="!show_image_cropper">
				<FilePreview
					v-for="(file, i) in files"
					:key="file.name"
					:file="file"
					@remove="remove_file(file)"
					@toggle_private="file.private = !file.private"
					@toggle_optimize="file.optimize = !file.optimize"
					@toggle_image_cropper="toggle_image_cropper(i)"
				/>
			</div>
			<div class="flex align-center" v-if="show_upload_button && currently_uploading === -1">
				<button
					class="btn btn-primary btn-sm margin-right"
					@click="upload_files"
				>
					<span v-if="files.length === 1">
						{{ __('Upload file') }}
					</span>
					<span v-else>
						{{ __('Upload {0} files', [files.length]) }}
					</span>
				</button>
				<div class="text-muted text-medium">
					{{ __('Click on the lock icon to toggle public/private') }}
				</div>
			</div>
		</div>
		<ImageCropper
			v-if="show_image_cropper && wrapper_ready"
			:file="files[crop_image_with_index]"
			:fixed_aspect_ratio="restrictions.crop_image_aspect_ratio"
			@toggle_image_cropper="toggle_image_cropper(-1)"
			@upload_after_crop="trigger_upload=true"
		/>
		<FileBrowser
			ref="file_browser"
			v-if="show_file_browser && !disable_file_browser"
			@hide-browser="show_file_browser = false"
		/>
		<WebLink
			ref="web_link"
			v-if="show_web_link"
			@hide-web-link="show_web_link = false"
		/>
	</div>
</template>

<script>
import FilePreview from './FilePreview.vue';
import FileBrowser from './FileBrowser.vue';
import WebLink from './WebLink.vue';
import GoogleDrivePicker from '../../integrations/google_drive_picker';
import ImageCropper from './ImageCropper.vue';

export default {
	name: 'FileUploader',
	props: {
		show_upload_button: {
			default: true
		},
		disable_file_browser: {
			default: false
		},
		allow_multiple: {
			default: true
		},
		as_dataurl: {
			default: false
		},
		doctype: {
			default: null
		},
		docname: {
			default: null
		},
		fieldname: {
			default: null
		},
		folder: {
			default: 'Home'
		},
		method: {
			default: null
		},
		on_success: {
			default: null
		},
		make_attachments_public: {
			default: null,
		},
		restrictions: {
			default: () => ({
				max_file_size: null, // 2048 -> 2KB
				max_number_of_files: null,
				allowed_file_types: [], // ['image/*', 'video/*', '.jpg', '.gif', '.pdf'],
				crop_image_aspect_ratio: null // 1, 16 / 9, 4 / 3, NaN (free)
			})
		},
		attach_doc_image: {
			default: false
		},
		upload_notes: {
			default: null // "Images or video, upto 2MB"
		}
	},
	components: {
		FilePreview,
		FileBrowser,
		WebLink,
		ImageCropper
	},
	data() {
		return {
			files: [],
			is_dragging: false,
			currently_uploading: -1,
			show_file_browser: false,
			show_web_link: false,
			show_image_cropper: false,
			crop_image_with_index: -1,
			trigger_upload: false,
			close_dialog: false,
			hide_dialog_footer: false,
			allow_take_photo: false,
			allow_web_link: true,
			google_drive_settings: {
				enabled: false
			},
			wrapper_ready: false
		}
	},
	created() {
		this.allow_take_photo = window.navigator.mediaDevices;
		if (frappe.user_id !== "Guest") {
			frappe.call({
				// method only available after login
				method: "frappe.integrations.doctype.google_settings.google_settings.get_file_picker_settings",
				callback: (resp) => {
					if (!resp.exc) {
						this.google_drive_settings = resp.message;
					}
				}
			});
		}
		if (this.restrictions.max_file_size == null) {
			frappe.call('frappe.core.api.file.get_max_file_size')
				.then(res => {
					this.restrictions.max_file_size = Number(res.message);
				});
		}
		if (this.restrictions.max_number_of_files == null && this.doctype) {
			this.restrictions.max_number_of_files = frappe.get_meta(this.doctype)?.max_attachments;
		}
	},
	watch: {
		files(newvalue, oldvalue) {
			if (!this.allow_multiple && newvalue.length > 1) {
				this.files = [newvalue[newvalue.length - 1]];
			}
		}
	},
	computed: {
		upload_complete() {
			return this.files.length > 0
				&& this.files.every(
					file => file.total !== 0 && file.progress === file.total);
		}
	},
	methods: {
		dragover() {
			this.is_dragging = true;
		},
		dragleave() {
			this.is_dragging = false;
		},
		dropfiles(e) {
			this.is_dragging = false;
			this.add_files(e.dataTransfer.files);
		},
		browse_files() {
			this.$refs.file_input.click();
		},
		on_file_input(e) {
			this.add_files(this.$refs.file_input.files);
		},
		remove_file(file) {
			this.files = this.files.filter(f => f !== file);
		},
		toggle_image_cropper(index) {
			this.crop_image_with_index = this.show_image_cropper ? -1 : index;
			this.hide_dialog_footer = !this.show_image_cropper;
			this.show_image_cropper = !this.show_image_cropper;
		},
		toggle_all_private() {
			let flag;
			let private_values = this.files.filter(file => file.private);
			if (private_values.length < this.files.length) {
				// there are some private and some public
				// set all to private
				flag = true;
			} else {
				// all are private, set all to public
				flag = false;
			}
			this.files = this.files.map(file => {
				file.private = flag;
				return file;
			});
		},
		show_max_files_number_warning(file) {
			console.warn(
				\`File skipped because it exceeds the allowed specified limit of \${max_number_of_files} uploads\`,
				file,
			);
			if (this.doctype) {
				MSG = __('File "{0}" was skipped because only {1} uploads are allowed for DocType "{2}"', [file.name, max_number_of_files, this.doctype])
			} else {
				MSG = __('File "{0}" was skipped because only {1} uploads are allowed', [file.name, max_number_of_files])
			}
			frappe.show_alert({
				message: MSG,
				indicator: "orange",
			});
		},
		add_files(file_array) {
			let files = Array.from(file_array)
				.filter(this.check_restrictions)
				.map(file => {
					let is_image = file.type.startsWith('image');
					let size_kb = file.size / 1024;
					return {
						file_obj: file,
						cropper_file: file,
						crop_box_data: null,
						optimize: size_kb > 200 && is_image && !file.type.includes('svg'),
						name: file.name,
						doc: null,
						progress: 0,
						total: 0,
						failed: false,
						request_succeeded: false,
						error_message: null,
						uploading: false,
						private: !this.make_attachments_public,
					};
				});

			// pop extra files as per FileUploader.restrictions.max_number_of_files
			max_number_of_files = this.restrictions.max_number_of_files;
			if (max_number_of_files && files.length > max_number_of_files) {
				files.slice(max_number_of_files).forEach(file => {
					this.show_max_files_number_warning(file, this.doctype);
				});

				files = files.slice(0, max_number_of_files);
			}

			this.files = this.files.concat(files);
			// if only one file is allowed and crop_image_aspect_ratio is set, open cropper immediately
			if (this.files.length === 1 && !this.allow_multiple && this.restrictions.crop_image_aspect_ratio != null) {
				if (!this.files[0].file_obj.type.includes('svg')) {
					this.toggle_image_cropper(0);
				}
			}
		},
		check_restrictions(file) {
			let { max_file_size, allowed_file_types = [] } = this.restrictions;

			let is_correct_type = true;
			let valid_file_size = true;

			if (allowed_file_types && allowed_file_types.length) {
				is_correct_type = allowed_file_types.some((type) => {
					// is this is a mime-type
					if (type.includes('/')) {
						if (!file.type) return false;
						return file.type.match(type);
					}

					// otherwise this is likely an extension
					if (type[0] === '.') {
						return file.name.endsWith(type);
					}
					return false;
				});
			}

			if (max_file_size && file.size != null) {
				valid_file_size = file.size < max_file_size;
			}

			if (!is_correct_type) {
				console.warn('File skipped because of invalid file type', file);
				frappe.show_alert({
					message: __('File "{0}" was skipped because of invalid file type', [file.name]),
					indicator: 'orange'
				});
			}
			if (!valid_file_size) {
				console.warn('File skipped because of invalid file size', file.size, file);
				frappe.show_alert({
					message: __('File "{0}" was skipped because size exceeds {1} MB', [file.name, max_file_size / (1024 * 1024)]),
					indicator: 'orange'
				});
			}

			return is_correct_type && valid_file_size;
		},
		upload_files() {
			if (this.show_file_browser) {
				return this.upload_via_file_browser();
			}
			if (this.show_web_link) {
				return this.upload_via_web_link();
			}
			if (this.as_dataurl) {
				return this.return_as_dataurl();
			}
			return frappe.run_serially(
				this.files.map(
					(file, i) =>
						() => this.upload_file(file, i)
				)
			);
		},
		upload_via_file_browser() {
			let selected_file = this.$refs.file_browser.selected_node;
			if (!selected_file.value) {
				frappe.msgprint(__('Click on a file to select it.'));
				this.close_dialog = true;
				return Promise.reject();
			}
			this.close_dialog = true;
			return this.upload_file({
				file_url: selected_file.file_url
			});
		},
		upload_via_web_link() {
			let file_url = this.$refs.web_link.url;
			if (!file_url) {
				frappe.msgprint(__('Invalid URL'));
				this.close_dialog = true;
				return Promise.reject();
			}
			file_url = decodeURI(file_url)
			this.close_dialog = true;
			return this.upload_file({
				file_url
			});
		},
		return_as_dataurl() {
			let promises = this.files.map(file =>
				frappe.dom.file_to_base64(file.file_obj)
					.then(dataurl => {
						file.dataurl = dataurl;
						this.on_success && this.on_success(file);
					})
			);
			this.close_dialog = true;
			return Promise.all(promises);
		},
		upload_file(file, i) {
			this.currently_uploading = i;

			return new Promise((resolve, reject) => {
				let xhr = new XMLHttpRequest();
				xhr.upload.addEventListener('loadstart', (e) => {
					file.uploading = true;
				})
				xhr.upload.addEventListener('progress', (e) => {
					if (e.lengthComputable) {
						file.progress = e.loaded;
						file.total = e.total;
					}
				})
				xhr.upload.addEventListener('load', (e) => {
					file.uploading = false;
					resolve();
				})
				xhr.addEventListener('error', (e) => {
					file.failed = true;
					reject();
				})
				xhr.onreadystatechange = () => {
					if (xhr.readyState == XMLHttpRequest.DONE) {
						if (xhr.status === 200) {
							file.request_succeeded = true;
							let r = null;
							let file_doc = null;
							try {
								r = JSON.parse(xhr.responseText);
								if (r.message.doctype === 'File') {
									file_doc = r.message;
								}
							} catch(e) {
								r = xhr.responseText;
							}

							file.doc = file_doc;

							if (this.on_success) {
								this.on_success(file_doc, r);
							}

							if (i == this.files.length - 1 && this.files.every(file => file.request_succeeded)) {
								this.close_dialog = true;
							}

						} else if (xhr.status === 403) {
							file.failed = true;
							let response = JSON.parse(xhr.responseText);
							file.error_message = \`Not permitted. \${response._error_message || ''}\`;

						} else if (xhr.status === 413) {
							file.failed = true;
							file.error_message = 'Size exceeds the maximum allowed file size.';

						} else {
							file.failed = true;
							file.error_message = xhr.status === 0 ? 'XMLHttpRequest Error' : \`\${xhr.status} : \${xhr.statusText}\`;

							let error = null;
							try {
								error = JSON.parse(xhr.responseText);
							} catch(e) {
								// pass
							}
							frappe.request.cleanup({}, error);
						}
					}
				}
				xhr.open('POST', '/api/method/upload_file', true);
				xhr.setRequestHeader('Accept', 'application/json');
				xhr.setRequestHeader('X-Frappe-CSRF-Token', frappe.csrf_token);

				let form_data = new FormData();
				if (file.file_obj) {
					form_data.append('file', file.file_obj, file.name);
				}
				form_data.append('is_private', +file.private);
				form_data.append('folder', this.folder);

				if (file.file_url) {
					form_data.append('file_url', file.file_url);
				}

				if (file.file_name) {
					form_data.append('file_name', file.file_name);
				}

				if (this.doctype && this.docname) {
					form_data.append('doctype', this.doctype);
					form_data.append('docname', this.docname);
				}

				if (this.fieldname) {
					form_data.append('fieldname', this.fieldname);
				}

				if (this.method) {
					form_data.append('method', this.method);
				}

				if (file.optimize) {
					form_data.append('optimize', true);
				}

				if (this.attach_doc_image) {
					form_data.append('max_width', 200);
					form_data.append('max_height', 200);
				}

				xhr.send(form_data);
			});
		},
		capture_image() {
			const capture = new frappe.ui.Capture({
				animate: false,
				error: true
			});
			capture.show();
			capture.submit(data_urls => {
				data_urls.forEach(data_url => {
					let filename = \`capture_\${frappe.datetime.now_datetime().replaceAll(/[: -]/g, '_')}.png\`;
					this.url_to_file(data_url, filename, 'image/png').then((file) =>
						this.add_files([file])
					);
				});
			});
		},
		show_google_drive_picker() {
			this.close_dialog = true;
			let google_drive = new GoogleDrivePicker({
				pickerCallback: data => this.google_drive_callback(data),
				...this.google_drive_settings
			});
			google_drive.loadPicker();
		},
		google_drive_callback(data) {
			if (data.action == google.picker.Action.PICKED) {
				this.upload_file({
					file_url: data.docs[0].url,
					file_name: data.docs[0].name
				});
			} else if (data.action == google.picker.Action.CANCEL) {
				cur_frm.attachments.new_attachment()
			}
		},
		url_to_file(url, filename, mime_type) {
			return fetch(url)
					.then(res => res.arrayBuffer())
					.then(buffer => new File([buffer], filename, { type: mime_type }));
		},
	}
}
<\/script>
<style>
.file-upload-area {
	min-height: 16rem;
	display: flex;
	align-items: center;
	justify-content: center;
	border: 1px dashed var(--dark-border-color);
	border-radius: var(--border-radius);
	cursor: pointer;
	background-color: var(--bg-color);
}

.btn-file-upload {
	background-color: transparent;
	border: none;
	box-shadow: none;
	font-size: var(--text-xs);
}
</style>
`]},media:void 0})},E0=void 0,A0=void 0,$0=!1;function O0(i,t,e,r,n,a,s,o,l,u){let c=(typeof e=="function"?e.options:e)||{};c.__file="frappe/public/js/frappe/file_uploader/FileUploader.vue",c.render||(c.render=i.render,c.staticRenderFns=i.staticRenderFns,c._compiled=!0,n&&(c.functional=!0)),c._scopeId=r;{let h;if(t&&(h=s?function(p){t.call(this,u(p,this.$root.$options.shadowRoot))}:function(p){t.call(this,o(p))}),h!==void 0)if(c.functional){let p=c.render;c.render=function(b,v){return h.call(v),p(b,v)}}else{let p=c.beforeCreate;c.beforeCreate=p?[].concat(p,h):[h]}}return c}function Fa(){let i=Fa.styles||(Fa.styles={}),t=typeof navigator!="undefined"&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,n){if(document.querySelector('style[data-vue-ssr-id~="'+r+'"]'))return;let a=t?n.media||"default":r,s=i[a]||(i[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(r)){let o=n.source,l=s.ids.length;if(s.ids.push(r),t&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){let u=document.head||document.getElementsByTagName("head")[0],c=s.element=document.createElement("style");c.type="text/css",n.media&&c.setAttribute("media",n.media),t&&(c.setAttribute("data-group",a),c.setAttribute("data-next-index","0")),u.appendChild(c)}if(t&&(l=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",l+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join(`
`);else{let u=document.createTextNode(o),c=s.element.childNodes;c[l]&&s.element.removeChild(c[l]),c.length?s.element.insertBefore(u,c[l]):s.element.appendChild(u)}}}}var R0=O0({render:Nd,staticRenderFns:S0},T0,C0,E0,$0,A0,!1,Fa,void 0,void 0),Pd=R0;var un=class{constructor({wrapper:t,method:e,on_success:r,doctype:n,docname:a,fieldname:s,files:o,folder:l,restrictions:u={},upload_notes:c,allow_multiple:h,as_dataurl:p,disable_file_browser:g,dialog_title:b,attach_doc_image:v,frm:k,make_attachments_public:C}={}){k&&k.attachments.max_reached(!0),t?this.wrapper=t.get?t.get(0):t:this.make_dialog(b),this.$fileuploader=new Vue({el:this.wrapper,render:O=>O(Pd,{props:{show_upload_button:!Boolean(this.dialog),doctype:n,docname:a,fieldname:s,method:e,folder:l,on_success:r,restrictions:u,upload_notes:c,allow_multiple:h,as_dataurl:p,disable_file_browser:g,attach_doc_image:v,make_attachments_public:C}})}),this.uploader=this.$fileuploader.$children[0],this.dialog||(this.uploader.wrapper_ready=!0),this.uploader.$watch("files",O=>{let d=O.every(_=>_.private);this.dialog&&this.dialog.set_secondary_action_label(d?__("Set all public"):__("Set all private"))},{deep:!0}),this.uploader.$watch("trigger_upload",O=>{O&&this.upload_files()}),this.uploader.$watch("close_dialog",O=>{O&&this.dialog&&this.dialog.hide()}),this.uploader.$watch("hide_dialog_footer",O=>{O?(this.dialog&&this.dialog.footer.addClass("hide"),this.dialog.$wrapper.data("bs.modal")._config.backdrop="static"):(this.dialog&&this.dialog.footer.removeClass("hide"),this.dialog.$wrapper.data("bs.modal")._config.backdrop=!0)}),o&&o.length&&this.uploader.add_files(o)}upload_files(){return this.dialog&&this.dialog.get_primary_btn().prop("disabled",!0),this.dialog&&this.dialog.get_secondary_btn().prop("disabled",!0),this.uploader.upload_files()}make_dialog(t){this.dialog=new frappe.ui.Dialog({title:t||__("Upload"),primary_action_label:__("Upload"),primary_action:()=>this.upload_files(),secondary_action_label:__("Set all private"),secondary_action:()=>{this.uploader.toggle_all_private()},on_page_show:()=>{this.uploader.wrapper_ready=!0}}),this.wrapper=this.dialog.body,this.dialog.show(),this.dialog.$wrapper.on("hidden.bs.modal",function(){$(this).data("bs.modal",null),$(this).remove()})}};frappe.provide("frappe.ui");frappe.ui.FileUploader=un;frappe.provide("frappe.ui");frappe.ui.Tree=class{constructor({parent:i,label:t,root_value:e,icon_set:r,toolbar:n,expandable:a,with_skeleton:s=1,args:o,method:l,get_label:u,on_render:c,on_click:h}){$.extend(this,arguments[0]),e==null&&(this.root_value=t),this.setup_treenode_class(),this.nodes={},this.wrapper=$('<div class="tree">').appendTo(this.parent),s&&this.wrapper.addClass("with-skeleton"),r||(this.icon_set={open:frappe.utils.icon("folder-open","md"),closed:frappe.utils.icon("folder-normal","md"),leaf:frappe.utils.icon("primitive-dot","xs")}),this.setup_root_node()}get_nodes(i,t){var e=Object.assign({},this.args);return e.parent=i,e.is_root=t,new Promise(r=>{frappe.call({method:this.method,args:e,callback:n=>{this.on_get_node&&this.on_get_node(n.message),r(n.message)}})})}get_all_nodes(i,t,e){var r=Object.assign({},this.args);return r.label=e||i,r.parent=i,r.is_root=t,r.tree_method=this.method,new Promise(n=>{frappe.call({method:"frappe.desk.treeview.get_all_nodes",args:r,callback:a=>{this.on_get_node&&this.on_get_node(a.message,!0),n(a.message)}})})}setup_treenode_class(){let i=this;this.TreeNode=class{constructor({parent:t,label:e,parent_label:r,expandable:n,is_root:a,data:s}){$.extend(this,arguments[0]),this.loaded=0,this.expanded=0,this.parent_label&&(this.parent_node=i.nodes[this.parent_label]),i.nodes[this.label]=this,i.make_node_element(this),i.on_render&&i.on_render(this)}}}setup_root_node(){this.root_node=new this.TreeNode({parent:this.wrapper,label:this.label,parent_label:null,expandable:!0,is_root:!0,data:{value:this.root_value}}),this.expand_node(this.root_node,!1)}refresh(){this.selected_node.parent_node&&this.load_children(this.selected_node.parent_node,!0)}make_node_element(i){i.$tree_link=$('<span class="tree-link">').attr("data-label",i.label).data("node",i).appendTo(i.parent),i.$ul=$('<ul class="tree-children">').hide().appendTo(i.parent),this.make_icon_and_label(i),this.toolbar&&(i.$toolbar=this.get_toolbar(i).insertAfter(i.$tree_link))}add_node(i,t){var e=$('<li class="tree-node">');return new this.TreeNode({parent:e.appendTo(i.$ul),parent_label:i.label,label:t.value,title:t.title,expandable:t.expandable,data:t})}reload_node(i){return this.load_children(i)}toggle(){this.get_selected_node().toggle()}get_selected_node(){return this.selected_node}set_selected_node(i){this.selected_node=i}load_children(i,t=!1){let e=i.data.value,r=i.is_root;return t?frappe.run_serially([()=>this.get_all_nodes(e,r,i.label),n=>this.render_children_of_all_nodes(n),()=>this.set_selected_node(i)]):frappe.run_serially([()=>this.get_nodes(e,r),n=>this.render_node_children(i,n),()=>this.set_selected_node(i)])}render_children_of_all_nodes(i){i.map(t=>this.render_node_children(this.nodes[t.parent],t.data))}render_node_children(i,t){i.$ul.empty(),t&&$.each(t,(e,r)=>{var n=this.add_node(i,r);n.$tree_link.data("node-data",r).data("node",n)}),i.expanded=!1,i.loaded=!0,this.expand_node(i)}on_node_click(i){this.expand_node(i),frappe.dom.activate(this.wrapper,i.$tree_link,"tree-link"),i.$toolbar&&this.show_toolbar(i)}expand_node(i,t=!0){this.set_selected_node(i),t&&this.on_click&&this.on_click(i),i.expandable&&this.toggle_node(i),this.select_link(i),i.expanded=!i.expanded,i.parent.toggleClass("opened",i.expanded)}toggle_node(i){if(i.expandable&&this.get_nodes&&!i.loaded)return this.load_children(i);i.$ul&&(i.$ul.children().length&&i.$ul.toggle(!i.expanded),this.icon_set&&(i.expanded?i.$tree_link.find(".icon").parent().addClass("node-parent").html(this.icon_set.closed):i.$tree_link.find(".icon").parent().html(this.icon_set.open)))}select_link(i){this.wrapper.find(".selected").removeClass("selected"),i.$tree_link.toggleClass("selected")}show_toolbar(i){this.cur_toolbar&&$(this.cur_toolbar).hide(),this.cur_toolbar=i.$toolbar,i.$toolbar.show()}get_node_label(i){return this.get_label?this.get_label(i):i.title&&i.title!=i.label?__(i.title)+` <span class='text-muted'>(${i.label})</span>`:__(i.title||i.label)}make_icon_and_label(i){let t="";this.icon_set&&(i.expandable?t=`<span class="node-parent">${this.icon_set.closed}</span>`:t=`<span>${this.icon_set.leaf}</span>`),$(t).appendTo(i.$tree_link),$(`<a class="tree-label"> ${this.get_node_label(i)}</a>`).appendTo(i.$tree_link),i.$tree_link.on("click",()=>{setTimeout(()=>{this.on_node_click(i)},100)}),i.$tree_link.hover(function(){$(this).parent().addClass("hover-active")},function(){$(this).parent().removeClass("hover-active")})}get_toolbar(i){let t=$('<span class="tree-node-toolbar btn-group"></span>').hide();return Object.keys(this.toolbar).map(e=>{let r=this.toolbar[e];if(!!r.label&&!(r.condition&&!r.condition(i))){var n=r.get_label?r.get_label():r.label,a=$("<button class='btn btn-default btn-xs'></button>").html(n).addClass("tree-toolbar-button "+(r.btnClass||"")).appendTo(t);a.on("click",()=>{r.click(i)})}}),t}};frappe.provide("frappe.pages");frappe.provide("frappe.views");window.cur_page=null;frappe.views.Container=class{constructor(){this.container=$("#body").get(0),this.page=null,this.pagewidth=$(this.container).width(),this.pagemargin=50;var t=this;$(document).on("page-change",function(){var e=frappe.get_route_str();$("body").attr("data-route",e),$("body").attr("data-sidebar",t.has_sidebar()?1:0)}),$(document).bind("rename",function(e,r,n,a){frappe.breadcrumbs.rename(r,n,a)})}add_page(t){var e=$('<div class="content page-container"></div>').attr("id","page-"+t).attr("data-page-route",t).hide().appendTo(this.container).get(0);return e.label=t,frappe.pages[t]=e,e}change_to(t){if(cur_page=this,t.tagName)var e=t;else var e=frappe.pages[t];if(!e){console.log(__("Page not found")+": "+t);return}return window.cur_dialog&&cur_dialog.display&&!cur_dialog.keep_open&&(cur_dialog.minimizable?cur_dialog.is_minimized||cur_dialog.toggle_minimize():cur_dialog.hide()),this.page&&this.page!=e&&($(this.page).hide(),$(this.page).trigger("hide")),(!this.page||this.page!=e)&&(this.page=e,$(this.page).show()),$(document).trigger("page-change"),this.page._route=frappe.router.get_sub_path(),$(this.page).trigger("show"),!this.page.disable_scroll_to_top&&frappe.utils.scroll_to(0),frappe.breadcrumbs.update(),this.page}has_sidebar(){var t=0,e=frappe.get_route_str();if(t=frappe.ui.pages[e]&&!frappe.ui.pages[e].single_column,!t){var r=e.split("/").slice(0,2).join("/");t=$(`.page-container[data-page-route="${r}"] .layout-side-section`).length?1:0}return t}};frappe.breadcrumbs={all:{},preferred:{File:"",Dashboard:"Customization","Dashboard Chart":"Customization","Dashboard Chart Source":"Customization"},module_map:{Core:"Settings",Email:"Settings",Custom:"Settings",Workflow:"Settings",Printing:"Settings",Setup:"Settings","Event Streaming":"Tools",Automation:"Tools"},set_doctype_module(i,t){localStorage["preferred_breadcrumbs:"+i]=t},get_doctype_module(i){return localStorage["preferred_breadcrumbs:"+i]},add(i,t,e){let r;typeof i=="object"?r=i:r={module:i,doctype:t,type:e},this.all[frappe.breadcrumbs.current_page()]=r,this.update()},current_page(){return frappe.get_route_str()},update(){var i=this.all[frappe.breadcrumbs.current_page()];if(this.clear(),!i)return this.toggle(!1);if(i.type==="Custom")this.set_custom_breadcrumbs(i);else{this.set_workspace_breadcrumb(i);let t=frappe.get_route()[0];t=t?t.toLowerCase():null,i.doctype&&["print","form"].includes(t)?(this.set_list_breadcrumb(i),this.set_form_breadcrumb(i,t)):i.doctype&&t==="list"?this.set_list_breadcrumb(i):i.doctype&&t=="dashboard-view"&&(this.set_list_breadcrumb(i),this.set_dashboard_breadcrumb(i))}this.toggle(!0)},set_custom_breadcrumbs(i){let t=`<li><a href="${i.route}">${i.label}</a></li>`;this.$breadcrumbs.append(t)},set_workspace_breadcrumb(i){i.workspace||this.set_workspace(i),i.workspace&&!i.module_info.blocked&&frappe.visible_modules.includes(i.module_info.module)&&$(`<li><a href="/app/${frappe.router.slug(i.workspace)}">${__(i.workspace)}</a></li>`).appendTo(this.$breadcrumbs)},set_workspace(i){this.setup_modules();var t=this.get_doctype_module(i.doctype);t?i.module=t:this.preferred[i.doctype]!==void 0&&(i.module=this.preferred[i.doctype]),i.module&&(this.module_map[i.module]&&(i.module=this.module_map[i.module]),i.module_info=frappe.get_module(i.module),i.module_info&&frappe.boot.module_page_map[i.module]&&(i.workspace=frappe.boot.module_page_map[i.module]))},set_list_breadcrumb(i){let t=i.doctype,e=frappe.get_doc("DocType",t);if(!(t==="User"&&!frappe.user.has_role("System Manager")||(e==null?void 0:e.issingle))){let r,n=frappe.router.slug(frappe.router.doctype_layout||t);if(e!=null&&e.is_tree){let a=frappe.model.user_settings[t].last_view||"Tree";r=`${n}/view/${a}`}else r=n;$(`<li><a href="/app/${r}">${__(t)}</a></li>`).appendTo(this.$breadcrumbs)}},set_form_breadcrumb(i,t){let e=i.doctype,r=frappe.get_route().slice(2).join("/"),n=`/app/${frappe.router.slug(e)}/${r}`;if($(`<li><a href="${n}">${__(r)}</a></li>`).appendTo(this.$breadcrumbs),t==="form"){let a=this.$breadcrumbs.find("li").last();a.addClass("disabled"),a.css("cursor","copy"),a.click(s=>{s.stopImmediatePropagation(),frappe.utils.copy_to_clipboard(a.text())})}},set_dashboard_breadcrumb(i){let t=i.doctype,e=frappe.get_route()[1],r=`/app/${frappe.router.slug(t)}/${e}`;$(`<li><a href="${r}">${__(e)}</a></li>`).appendTo(this.$breadcrumbs)},setup_modules(){frappe.visible_modules||(frappe.visible_modules=$.map(frappe.boot.allowed_workspaces,i=>i.module))},rename(i,t,e){var r=["Form",i,t].join("/"),n=["Form",i,e].join("/");this.all[n]=this.all[r],delete frappe.breadcrumbs.all[r],this.update()},clear(){this.$breadcrumbs=$("#navbar-breadcrumbs").empty()},toggle(i){i?$("body").addClass("no-breadcrumbs"):$("body").removeClass("no-breadcrumbs")}};frappe.provide("frappe.pages");frappe.provide("frappe.views");frappe.views.Factory=class{constructor(t){$.extend(this,t)}show(){this.route=frappe.get_route(),this.page_name=frappe.get_route_str(),!(this.before_show&&this.before_show()===!1)&&(frappe.pages[this.page_name]?(frappe.container.change_to(this.page_name),this.on_show&&this.on_show()):this.route[1]?this.make(this.route):frappe.show_not_found(this.route))}make_page(t,e){return frappe.make_page(t,e)}};frappe.make_page=function(i,t){t||(t=frappe.get_route_str());let e=frappe.container.add_page(t);return frappe.ui.make_app_page({parent:e,single_column:!i}),frappe.container.change_to(t),e};frappe.provide("frappe.views.pageview");frappe.provide("frappe.standard_pages");frappe.views.pageview={with_page:function(i,t){if(frappe.standard_pages[i]){frappe.pages[i]||frappe.standard_pages[i](),t();return}if(locals.Page&&locals.Page[i]&&locals.Page[i].script||i==window.page_name)t();else if(localStorage["_page:"+i]&&frappe.boot.developer_mode!=1)frappe.model.sync(JSON.parse(localStorage["_page:"+i])),t();else if(i)return frappe.call({method:"frappe.desk.desk_page.getpage",args:{name:i},callback:function(e){e.docs._dynamic_page||(localStorage["_page:"+i]=JSON.stringify(e.docs)),t()},freeze:!0})},show:function(i){i||(i=frappe.boot?frappe.boot.home_page:window.page_name),frappe.model.with_doctype("Page",function(){frappe.views.pageview.with_page(i,function(t){t&&t.exc?t["403"]||frappe.show_not_found(i):frappe.pages[i]||new frappe.views.Page(i),frappe.container.change_to(i)})})}};frappe.views.Page=class{constructor(t){this.name=t;var e=this;if(t==window.page_name)this.wrapper=document.getElementById("page-"+t),this.wrapper.label=document.title||window.page_name,this.wrapper.page_name=window.page_name,frappe.pages[window.page_name]=this.wrapper;else{if(this.pagedoc=locals.Page[this.name],!this.pagedoc){frappe.show_not_found(t);return}this.wrapper=frappe.container.add_page(this.name),this.wrapper.page_name=this.pagedoc.name,this.pagedoc.content&&(this.wrapper.innerHTML=this.pagedoc.content),frappe.dom.eval(this.pagedoc.__script||this.pagedoc.script||""),frappe.dom.set_style(this.pagedoc.style||""),frappe.breadcrumbs.add(this.pagedoc.module||null)}this.trigger_page_event("on_page_load"),$(this.wrapper).on("show",function(){window.cur_frm=null,e.trigger_page_event("on_page_show"),e.trigger_page_event("refresh")})}trigger_page_event(t){var e=this;e.wrapper[t]&&e.wrapper[t](e.wrapper)}};frappe.show_not_found=function(i){frappe.show_message_page({page_name:i,message:__("Sorry! I could not find what you were looking for."),img:"/assets/frappe/images/ui/bubble-tea-sorry.svg"})};frappe.show_not_permitted=function(i){frappe.show_message_page({page_name:i,message:__("Sorry! You are not permitted to view this page."),img:"/assets/frappe/images/ui/bubble-tea-sorry.svg"})};frappe.show_message_page=function(i){i.page_name||(i.page_name=frappe.get_route_str()),i.icon?i.img=repl('<span class="%(icon)s message-page-icon"></span> ',i):i.img&&(i.img=repl('<img src="%(img)s" class="message-page-image">',i));var t=frappe.pages[i.page_name]||frappe.container.add_page(i.page_name);$(t).html(repl('<div class="page message-page">			<div class="text-center message-page-content">				%(img)s				<p class="lead">%(message)s</p>				<a class="btn btn-default btn-sm btn-home" href="/app">%(home)s</a>			</div>		</div>',{img:i.img||"",message:i.message||"",home:__("Home")})),frappe.container.change_to(i.page_name)};var WA=Ut(Dd());frappe.provide("frappe.search");frappe.ui.Notifications=class{constructor(){this.tabs={},this.notification_settings=frappe.boot.notification_settings,this.make()}make(){this.dropdown=$(".navbar").find(".dropdown-notifications").removeClass("hidden"),this.dropdown_list=this.dropdown.find(".notifications-list"),this.header_items=this.dropdown_list.find(".header-items"),this.header_actions=this.dropdown_list.find(".header-actions"),this.body=this.dropdown_list.find(".notification-list-body"),this.panel_events=this.dropdown_list.find(".panel-events"),this.panel_notifications=this.dropdown_list.find(".panel-notifications"),this.user=frappe.session.user,this.setup_headers(),this.setup_dropdown_events()}setup_headers(){$(`<span class="notification-settings pull-right" data-action="go_to_settings">
			${frappe.utils.icon("setting-gear")}
		</span>`).on("click",r=>{r.stopImmediatePropagation(),this.dropdown.dropdown("hide"),frappe.set_route("Form","Notification Settings",frappe.session.user)}).appendTo(this.header_actions).attr("title",__("Notification Settings")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),$(`<span class="mark-all-read pull-right" data-action="mark_all_as_read">
			${frappe.utils.icon("mark-as-read")}
		</span>`).on("click",r=>this.mark_all_as_read(r)).appendTo(this.header_actions).attr("title",__("Mark all as read")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.categories=[{label:__("Notifications"),id:"notifications",view:jd,el:this.panel_notifications},{label:__("Today's Events"),id:"todays_events",view:zd,el:this.panel_events}];let t=r=>`<li class="notifications-category ${r.id=="notifications"?"active":""}"
					id="${r.id}"
					data-toggle="collapse"
				>${r.label}</li>`,e=$('<ul class="notification-item-tabs nav nav-tabs" role="tablist"></ul>');this.categories=this.categories.map(r=>(r.$tab=$(t(r)),r.$tab.on("click",n=>{n.stopImmediatePropagation(),this.switch_tab(r)}),e.append(r.$tab),r)),e.appendTo(this.header_items),this.categories.forEach(r=>{this.make_tab_view(r)}),this.switch_tab(this.categories[0])}switch_tab(t){this.categories.forEach(e=>{e.$tab.removeClass("active")}),t.$tab.addClass("active"),Object.keys(this.tabs).forEach(e=>this.tabs[e].hide()),this.tabs[t.id].show()}make_tab_view(t){let e=new t.view(t.el,this.dropdown,this.notification_settings);this.tabs[t.id]=e}mark_all_as_read(t){t.stopImmediatePropagation(),this.dropdown_list.find(".unread").removeClass("unread"),frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_all_as_read")}setup_dropdown_events(){this.dropdown.on("hide.bs.dropdown",t=>{let e=$(t.currentTarget).data("closable");return $(t.currentTarget).data("closable",!0),e}),this.dropdown.on("click",t=>{$(t.currentTarget).data("closable",!0)})}};frappe.ui.notifications={get_notification_config(){return frappe.xcall("frappe.desk.notifications.get_notification_info").then(i=>(frappe.ui.notifications.config=i,i))},show_open_count_list(i){frappe.ui.notifications.config?this.route_to_list_with_filters(i):this.get_notification_config().then(()=>{this.route_to_list_with_filters(i)})},route_to_list_with_filters(i){let t=frappe.ui.notifications.config.conditions[i];t&&$.isPlainObject(t)&&(frappe.route_options||(frappe.route_options={}),$.extend(frappe.route_options,t)),frappe.set_route("List",i)}};var Ha=class{constructor(t,e,r){this.wrapper=t,this.parent=e,this.settings=r,this.max_length=20,this.container=$("<div></div>").appendTo(this.wrapper),this.make()}show(){this.container.show()}hide(){this.container.hide()}},jd=class extends Ha{make(){this.notifications_icon=this.parent.find(".notifications-icon"),this.notifications_icon.attr("title",__("Notifications")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.setup_notification_listeners(),this.get_notifications_list(this.max_length).then(t=>{!t.message||(this.dropdown_items=t.message.notification_logs,frappe.update_user_info(t.message.user_info),this.render_notifications_dropdown(),this.settings.seen==0&&this.dropdown_items.length>0&&this.toggle_notification_icon(!1))})}update_dropdown(){this.get_notifications_list(1).then(t=>{if(!t.message)return;let e=t.message.notification_logs[0];frappe.update_user_info(t.message.user_info),this.dropdown_items.unshift(e),this.dropdown_items.length>this.max_length&&(this.container.find(".recent-notification").last().remove(),this.dropdown_items.pop()),this.insert_into_dropdown()})}change_activity_status(){this.container.find(".activity-status")&&this.container.find(".activity-status").replaceWith(`<a class="recent-item text-center text-muted"
					href="/app/List/Notification Log">
					<div class="full-log-btn">${__("View Full Log")}</div>
				</a>`)}mark_as_read(t,e){frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_as_read",{docname:t}).then(()=>{e.removeClass("unread")})}insert_into_dropdown(){let t=this.dropdown_items[0],e=this.get_dropdown_item_html(t);$(e).prependTo(this.container),this.change_activity_status()}get_dropdown_item_html(t){let e=this.get_item_link(t),r=t.read?"":"unread",n=t.subject,a=n.match(/<b class="subject-title">(.*?)<\/b>/);n=a?n.replace(a[1],frappe.ellipsis(strip_html(a[1]),100)):n;let s=frappe.datetime.comment_when(t.creation),o=`<div class="message">
			<div>${n}</div>
			<div class="notification-timestamp text-muted">
				${s}
			</div>
		</div>`,l=t.from_user,u=frappe.avatar(l,"avatar-medium user-avatar"),c=$(`<a class="recent-item notification-item ${r}"
				href="${e}"
				data-name="${t.name}"
			>
				<div class="notification-body">
					${u}
					${o}
				</div>
				<div class="mark-as-read" title="${__("Mark as Read")}">
				</div>
			</a>`);if(!t.read){let h=c.find(".mark-as-read");h.tooltip({delay:{show:600,hide:100},trigger:"hover"}),h.on("click",p=>{p.preventDefault(),p.stopImmediatePropagation(),this.mark_as_read(t.name,c)})}return c.on("click",()=>{!t.read&&this.mark_as_read(t.name,c),this.notifications_icon.trigger("click")}),c}render_notifications_dropdown(){this.settings&&!this.settings.enabled?this.container.html(`<li class="recent-item notification-item">
				<span class="text-muted">
					${__("Notifications Disabled")}
				</span></li>`):this.dropdown_items.length?(this.container.empty(),this.dropdown_items.forEach(t=>{this.container.append(this.get_dropdown_item_html(t))}),this.container.append(`<a class="list-footer"
					href="/app/List/Notification Log">
						<div class="full-log-btn">${__("See all Activity")}</div>
					</a>`)):this.container.append($(`<div class="notification-null-state">
					<div class="text-center">
						<img src="/assets/frappe/images/ui-states/notification-empty-state.svg" alt="Generic Empty State" class="null-state">
						<div class="title">${__("No New notifications")}</div>
						<div class="subtitle">
							${__("Looks like you haven\u2019t received any notifications.")}
					</div></div></div>`))}get_notifications_list(t){return frappe.call("frappe.desk.doctype.notification_log.notification_log.get_notification_logs",{limit:t})}get_item_link(t){let e=t.document_type?t.document_type:"Notification Log",r=t.document_name?t.document_name:t.name;return frappe.utils.get_form_link(e,r)}toggle_notification_icon(t){this.notifications_icon.find(".notifications-seen").toggle(t),this.notifications_icon.find(".notifications-unseen").toggle(!t)}toggle_seen(t){frappe.call("frappe.desk.doctype.notification_settings.notification_settings.set_seen_value",{value:cint(t),user:frappe.session.user})}setup_notification_listeners(){frappe.realtime.on("notification",()=>{this.toggle_notification_icon(!1),this.update_dropdown()}),frappe.realtime.on("indicator_hide",()=>{this.toggle_notification_icon(!0)}),this.parent.on("show.bs.dropdown",()=>{this.toggle_seen(!0),this.notifications_icon.find(".notifications-unseen").is(":visible")&&(this.toggle_notification_icon(!0),frappe.call("frappe.desk.doctype.notification_log.notification_log.trigger_indicator_hide"))})}},zd=class extends Ha{make(){let t=frappe.datetime.get_today();frappe.xcall("frappe.desk.doctype.event.event.get_events",{start:t,end:t}).then(e=>{this.render_events_html(e)})}render_events_html(t){let e="";if(t.length){let r=n=>{let a=__("All Day");if(!n.all_day){let l=frappe.datetime.get_time(n.starts_on),u=frappe.datetime.get_day_diff(n.ends_on,n.starts_on),c=frappe.datetime.get_time(n.ends_on);u>1&&(c=__("Rest of the day")),a=`${l} - ${c}`}let s="";n.particpants&&(s=frappe.avatar_group(n.particpants,3));let o="";return n.location&&(o=`, ${n.location}`),`<a class="recent-item event" href="/app/event/${n.name}">
					<div class="event-border" style="border-color: ${n.color}"></div>
					<div class="event-item">
						<div class="event-subject">${n.subject}</div>
						<div class="event-time">${a}${o}</div>
						${s}
					</div>
				</a>`};e=t.map(r).join("")}else e=`
				<div class="notification-null-state">
					<div class="text-center">
					<img src="/assets/frappe/images/ui-states/event-empty-state.svg" alt="Generic Empty State" class="null-state">
					<div class="title">${__("No Upcoming Events")}</div>
					<div class="subtitle">
						${__("There are no upcoming events for you.")}
				</div></div></div>
			`;this.container.html(e)}};frappe.provide("frappe.search");frappe.search.SearchDialog=class{constructor(i){$.extend(this,i),this.make()}make(){this.search_dialog=new frappe.ui.Dialog({minimizable:!0,size:"large"}),this.set_header(),this.$wrapper=$(this.search_dialog.$wrapper).addClass("search-dialog"),this.$body=$(this.search_dialog.body),this.$input=this.$wrapper.find(".search-input"),this.setup()}set_header(){this.search_dialog.header.addClass("search-header").find(".title-section").html(`<div class="input-group text-muted">
					<input type="text" class="form-control search-input">
				</div>
				<span class="search-icon">
					${frappe.utils.icon("search")}
				</span>`)}setup(){this.modal_state=0,this.current_keyword="",this.more_count=20,this.full_lists={},this.nav_lists={},this.init_search_objects(),this.bind_input(),this.bind_events()}init_search_objects(){this.searches={global_search:{input_placeholder:__("Search"),empty_state_text:__("Search for anything"),no_results_status:()=>__("No Results found"),get_results:(i,t)=>{let e=0,r=1e3,n=frappe.search.utils.get_nav_results(i);frappe.search.utils.get_global_results(i,e,r).then(a=>{n=n.concat(a),t(n,i)},a=>{console.error(a)})}},tags:{input_placeholder:__("Search"),empty_state_text:__("Search for anything"),no_results_status:i=>"<div>"+__("No documents found tagged with {0}",[i])+"</div>",get_results:(i,t)=>{var e=frappe.search.utils.get_nav_results(i);frappe.tags.utils.get_tag_results(i).then(r=>{e=e.concat(r),t(e,i)},r=>{console.error(r)})}}}}update(i){this.$wrapper.find(".loading-state").addClass("hide"),this.$body.append(i),this.$body.find(".search-results").length>1?(this.$body.find(".search-results").first().addClass("hide"),i.removeClass("hide"),this.$body.find(".search-results").first().remove()):i.removeClass("hide")}put_placeholder(i){var t=$(`<div class="row search-results hide">
			<div class="empty-state">
				<div class="text-center">
					<img src="/assets/frappe/images/ui-states/search-empty-state.svg"
						alt="Generic Empty State"
						class="null-state"
					>
					<div class="empty-state-text">${i}</div>
				</div>
			</div>
		</div>`);this.update(t)}bind_input(){this.$input.on("input",i=>{let t=$(i.currentTarget);clearTimeout(t.data("timeout")),t.data("timeout",setTimeout(()=>{if(this.$input.val()===this.current_keyword)return;let e=this.$input.val();e.length>1?this.get_results(e):(this.current_keyword="",this.put_placeholder(this.search.empty_state_text))},300))})}bind_events(){this.$body.on("click",".list-link",i=>{let t=$(i.currentTarget);this.$body.find(".search-sidebar").find(".list-link").removeClass("active selected"),t.addClass("active selected");let e=t.attr("data-category");this.$body.find(".results-area").empty().html(this.full_lists[e]),this.$body.find(".module-section-link").first().focus()}),this.$body.on("click",".section-more",i=>{let e=$(i.currentTarget).attr("data-category");this.$body.find(".search-sidebar").find('*[data-category="'+e+'"]').trigger("click")}),this.$body.on("click",".all-results-link",()=>{this.$body.find(".search-sidebar").find('*[data-category="All Results"]').trigger("click")}),this.$body.on("click",".list-more",i=>{let t=$(i.currentTarget),e=t.attr("data-category"),r=t.attr("data-search");var n=this.$body.find(".result").length;if(r==="Global")frappe.search.utils.get_global_results(this.current_keyword,n,this.more_count,e).then(a=>{a.length&&this.add_more_results(a)},a=>{console.error(a)});else{let a=this.nav_lists[e].slice(0,this.more_count);this.nav_lists[e].splice(0,this.more_count),this.add_more_results([{title:e,results:a}])}}),this.$body.on("click",".switch-to-global-search",()=>{this.search=this.searches.global_search,this.$input.attr("placeholder",this.search.input_placeholder),this.put_placeholder(this.search.empty_state_text),this.get_results(this.current_keyword)})}init_search(i,t){this.search=this.searches[t],this.$input.attr("placeholder",this.search.input_placeholder),this.put_placeholder(this.search.empty_state_text),this.get_results(i),this.search_dialog.show(),this.$input.val(i),setTimeout(()=>this.$input.select(),500)}get_results(i){this.current_keyword=i,this.$body.find(".empty-state").length>0?this.put_placeholder(__("Searching ...")):this.$wrapper.find(".loading-state").removeClass("hide"),this.current_keyword.charAt(0)==="#"?this.search=this.searches.tags:this.search=this.searches.global_search,this.search.get_results(i,this.parse_results.bind(this))}parse_results(i,t){i=i.filter(function(e){return e.results.length>0}),i.length>0?this.render_data(i):this.put_placeholder(this.search.no_results_status(t))}render_data(i){let t=$(frappe.render_template("search")).addClass("hide"),e=t.find(".search-sidebar").empty(),r='<li class="search-sidebar-item standard-sidebar-item list-link" data-category="{0}"><a><span class="ellipsis">{1}</span></a></li>';this.modal_state=0,this.full_lists={"All Results":$('<div class="results-summary"></div>')},this.nav_lists={},i.forEach(n=>{e.append($(__(r,[n.title,__(n.title)]))),this.add_section_to_summary(n.title,n.results),this.full_lists[n.title]=this.render_full_list(n.title,n.results,n.fetch_type)}),i.length>1&&e.prepend($(__(r,["All Results",__("All Results")]))),this.update(t.clone()),this.$body.find(".list-link").first().trigger("click")}render_full_list(i,t,e){let r=20,n=$(`<div class="results-summary">
			<div class="result-section full-list ${i}-section col-sm-12">
				<div class="result-title"> ${__(i)}</div>
				<div class="result-body">
				</div>
			</div>
		</div>`);return t.slice(0,r).forEach(a=>{n.find(".result-body").append(this.render_result(i,a))}),t.length>0&&(e==="Nav"&&(this.nav_lists[i]=t),t.length>r&&$(`<a class="list-more" data-search="${e}"
					data-category="${i}" data-count="${r}">
						${__("More")}
				</a>`).appendTo(n.find(".result-body"))),n}add_section_to_summary(i,t){let e=4,r="",n=s=>this.render_result(i,s);t.length>e&&(r=`<div>
				<a class="section-more" data-category="${i}">${__("More")}</a>
			</div>`),$(`<div class="col-sm-12 result-section" data-type="${i}">
			<div class="result-title">${__(i)}</div>
			<div class="result-body">
				${r}
			</div>
		</div>`).appendTo(this.full_lists["All Results"]).find(".result-body").prepend(t.slice(0,e).map(n))}get_link(i){let t="";return i.route?t=`href="/app/${i.route.join("/")}"`:i.data_path&&(t=`data-path=${i.data_path}"`),t}render_result(i,t){let e="";if(t.image!==void 0){let o=frappe.get_avatar("avatar-medium",t.label,t.image);e=`<a ${this.get_link(t)}>
				<div class="result-image">
					${o}
				</div>
			</a>`}let r=`<a ${this.get_link(t)} class="result-section-link">${t.label}</a>`,a=`<div class="result-text">
			${t.description?`<b>${r}</b><div class="description"> ${t.description} </div>`:r}
		</div>`,s=$(`<div class="result ${i}-result">
			${e}
			${a}
			${t.subtypes||""}
		</div>`);return t.description||this.handle_result_click(t,s),s}handle_result_click(i,t){i.route_options&&(frappe.route_options=i.route_options),t.on("click",()=>{if(i.onclick)i.onclick(i.match);else{var e=window.location.hash;frappe.set_route(i.route),window.location.hash==e&&frappe.router.route()}})}add_more_results(i){let t=$('<div class="more-results last"></div>');if(i[0].results&&i[0].results.forEach(e=>{t.append(this.render_result(i[0].title,e))}),this.$body.find(".list-more").before(t),i[0].results.length<this.more_count){this.$body.find(".list-more").hide();let e=this.$body.find(".result").length,r=$('<div class="results-status">'+e+" results found</div>");this.$body.find(".more-results:last").append(r)}this.$body.find(".more-results.last").slideDown(200,function(){})}};frappe.provide("frappe.tags");frappe.tags.utils={get_tags:function(i){i=i.slice(1);let t=[];for(let e in frappe.tags.tags){let r=frappe.tags.tags[e],n=frappe.search.utils.fuzzy_search(i,r);n&&t.push({type:"Tag",label:__("#{0}",[frappe.search.utils.bolden_match_part(__(r),i)]),value:__("#{0}",[__(r)]),index:1+n,match:r,onclick(){frappe.searchdialog.search.init_search("#".concat(r),"tags")}})}return t},fetch_tags(){frappe.call({method:"frappe.desk.doctype.tag.tag.get_tags_list_for_awesomebar",callback:function(i){i&&i.message&&(frappe.tags.tags=$.extend([],i.message))}})},get_tag_results:function(i){function t(e){var r=[],n,a;function s(l){return r.find(function(u){return u.title===l})}function o(l){var u=110,c=null;if(l.length>u)c=l.slice(0,u)+"...";else{var h=l.length;c=l.slice(0,h)+"..."}return c}return e.forEach(function(l){var u="";l.content&&(u=o(l.content)),n={label:l.name,value:l.name,description:u,route:["Form",l.doctype,l.name]},a=s(l.doctype),a?a.results.push(n):(a={title:l.doctype,results:[n],fetch_type:"Global"},r.push(a))}),r}return new Promise(function(e){frappe.call({method:"frappe.desk.doctype.tag.tag.get_documents_for_tag",args:{tag:i},callback:function(r){r.message?e(t(r.message)):e([])}})})}};frappe.templates.search=`<div class="search-results flex">
	<div class="col-md-3 col-sm-3 hidden-xs layout-side-section">
		<ul class="overlay-sidebar list-unstyled search-sidebar"></ul>
	</div>
	<div class="col-md-9 col-sm-9 layout-main-section results-area">

	</div>
</div>
`;function qa(i,t){return Fd(i,t,0,0,null,[],256,0,0,10)}function Fd(i,t,e,r,n,a,s,o,l,u){let c=0;if(++l>=u)return[!1,c];if(e===i.length||r===t.length)return[!1,c];let h=!1,p=[],g=0,b=!0;for(;e<i.length&&r<t.length;){if(i[e].toLowerCase()===t[r].toLowerCase()){if(o>=s)return[!1,c];b&&n&&(a=[...n],b=!1);let k=[],[C,O]=Fd(i,t,e,r+1,a,k,s,o,l,u);C&&((!h||O>g)&&(p=[...k],g=O),h=!0),a[o++]=r,++e}++r}let v=e===i.length;if(v){c=100;let k=-5*a[0];k=k<-15?-15:k,c+=k;let C=t.length-o;c+=-1*C;for(let O=0;O<o;O++){let d=a[O];if(O>0){let _=a[O-1];d==_+1&&(c+=25)}if(d>0){let _=t[d-1],m=t[d];_!==_.toUpperCase()&&m!==m.toLowerCase()&&(c+=30),(_=="_"||_==" ")&&(c+=30)}else c+=15}return h&&(!v||g>c)?(a=[...p],c=g,[!0,c]):v?[!0,c]:[!1,c]}return[!1,c]}frappe.provide("frappe.search");frappe.search.utils={setup_recent:function(){this.recent=JSON.parse(frappe.boot.user.recent||"[]")||[]},get_recent_pages:function(i){i===null&&(i="");var t=this,e=[],r=[];function n(a,s,o){a.forEach(function(l,u){var c=$.isArray(l)?l[0]:l;if(c=__(c||"").toLowerCase().replace(/-/g," "),s===c||c.indexOf(s)!==-1){var h=o(l);h&&($.isPlainObject(h)&&(h=[h]),h.forEach(function(p){p.match=l,p.recent=!0}),r=h.concat(r))}})}return t.recent.forEach(function(a,s){e.push([a[1],["Form",a[0],a[1]]])}),e=e.reverse(),frappe.route_history.forEach(function(a,s){a[0]==="Form"?e.push([a[2],a]):["List","Tree","Workspaces","query-report"].includes(a[0])||a[2]==="Report"?a[1]&&e.push([a[1],a]):a[0]&&e.push([frappe.route_titles[a.join("/")]||a[0],a])}),n(e,i,function(a){var s={route:a[1]};if(a[1][0]==="Form")a[1].length>2&&a[1][1]!==a[1][2]?(s.label=__(a[1][1])+" "+a[1][2].bold(),s.value=__(a[1][1])+" "+a[1][2]):(s.label=__(a[1][1]).bold(),s.value=__(a[1][1]));else if(["List","Tree","Workspaces","query-report"].includes(a[1][0])&&a[1].length>1){var o=a[1][0],l=o;o==="Workspaces"?l="Workspace":(o==="query-report"||a[1][2]==="Report")&&(l="Report"),s.label=__(`{0} ${l}`,[__(a[1][1]).bold()]),s.value=__(`{0} ${l}`,[__(a[1][1])])}else a[0]?(s.label=a[0].bold(),s.value=a[0]):console.log("Illegal match",a);return s.index=80,s}),r},get_frequent_links(){let i=[];return frappe.boot.frequently_visited_links.forEach(t=>{let e=frappe.utils.get_route_label(t.route);i.push({route:t.route,label:e,value:e,index:t.count})}),i.length?i:this.get_recent_pages("")},get_search_in_list:function(i){var t=this,e=[];if(in_list(i.split(" "),"in")&&i.slice(-2)!=="in"){var r=i.split(" in ");frappe.boot.user.can_read.forEach(function(n){if(frappe.boot.user.can_search.includes(n)){var a=t.fuzzy_search(r[1],n);a&&e.push({type:"In List",label:__("Find {0} in {1}",[__(r[0]),t.bolden_match_part(__(n),r[1])]),value:__("Find {0} in {1}",[__(r[0]),__(n)]),route_options:{name:["like","%"+r[0]+"%"]},index:1+a,route:["List",n]})}})}return e},get_creatables:function(i){var t=this,e=[],r=i.split(" ")[0];return r.toLowerCase()===__("new")&&frappe.boot.user.can_create.forEach(function(n){var a=t.fuzzy_search(i.substr(4),n);a&&e.push({type:"New",label:__("New {0}",[t.bolden_match_part(__(n),i.substr(4))]),value:__("New {0}",[__(n)]),index:1+a,match:n,onclick:function(){frappe.new_doc(n,!0)}})}),e},get_doctypes:function(i){var t=this,e=[],r,n,a=function(s,o,l){let u=s==="List"&&n.endsWith("List"),c=t.bolden_match_part(__(n),i);if(u)var h=c;else h=__(`{0} ${u?"":s}`,[c]);return{type:s,label:h,value:__(`{0} ${s}`,[n]),index:r+l,match:n,route:o}};return frappe.boot.user.can_read.forEach(function(s){if(r=t.fuzzy_search(i,s),r){if(n=s,in_list(frappe.boot.single_types,s))e.push(a("",["Form",s,s],.05));else if(frappe.boot.user.can_search.includes(s)){if(in_list(frappe.boot.user.can_create,s)){var o=s;e.push({type:"New",label:__("New {0}",[t.bolden_match_part(__(s),i)]),value:__("New {0}",[__(s)]),index:r+.015,match:s,onclick:function(){frappe.new_doc(o,!0)}})}e.push(a("List",["List",s],.05)),frappe.model.can_get_report(s)&&e.push(a("Report",["List",s,"Report"],.04))}}}),e},get_reports:function(i){var t=this,e=[],r;return Object.keys(frappe.boot.user.all_reports).forEach(function(n){var a=t.fuzzy_search(i,n);if(a>0){var s=frappe.boot.user.all_reports[n];s.report_type=="Report Builder"?r=["List",s.ref_doctype,"Report",n]:r=["query-report",n],e.push({type:"Report",label:__("Report {0}",[t.bolden_match_part(__(n),i)]),value:__("Report {0}",[__(n)]),index:a,route:r})}}),e},get_pages:function(i){var t=this,e=[];this.pages={},$.each(frappe.boot.page_info,function(n,a){t.pages[a.title]=a,a.name=n}),Object.keys(this.pages).forEach(function(n){if(!(n=="Hub"||n=="hub")){var a=t.fuzzy_search(i,n);if(a){var s=t.pages[n];e.push({type:"Page",label:__("Open {0}",[t.bolden_match_part(__(n),i)]),value:__("Open {0}",[__(n)]),match:n,index:a,route:[s.route||s.name]})}}});var r="Calendar";return __("calendar").indexOf(i.toLowerCase())===0&&e.push({type:"Calendar",value:__("Open {0}",[__(r)]),index:t.fuzzy_search(i,"Calendar"),match:r,route:["List","Event",r]}),r="Hub",__("hub").indexOf(i.toLowerCase())===0&&e.push({type:"Hub",value:__("Open {0}",[__(r)]),index:t.fuzzy_search(i,"Hub"),match:r,route:[r,"Item"]}),__("email inbox").indexOf(i.toLowerCase())===0&&e.push({type:"Inbox",value:__("Open {0}",[__("Email Inbox")]),index:t.fuzzy_search(i,"email inbox"),match:r,route:["List","Communication","Inbox"]}),e},get_workspaces:function(i){var t=this,e=[];return frappe.boot.allowed_workspaces.forEach(function(r){var n=t.fuzzy_search(i,r.name);if(n>0){var a={type:"Workspace",label:__("Open {0}",[t.bolden_match_part(__(r.name),i)]),value:__("Open {0}",[__(r.name)]),index:n,route:[frappe.router.slug(r.name)]};e.push(a)}}),e},get_dashboards:function(i){var t=this,e=[];return frappe.boot.dashboards.forEach(function(r){var n=t.fuzzy_search(i,r.name);if(n>0){var a={type:"Dashboard",label:__("{0} Dashboard",[t.bolden_match_part(__(r.name),i)]),value:__("{0} Dashboard",[__(r.name)]),index:n,route:["dashboard-view",r.name]};e.push(a)}}),e},get_global_results:function(i,t,e,r=""){var n=this;function a(s){var o=[],l,u;function c(p){return o.find(function(g){return g.title===p})}function h(p,g){for(var b=p.split(" ||| "),v=300,k=120,C=[],O=0,d="",_=0;_<b.length;_++){var m=b[_];if(m.toLowerCase().indexOf(i)!==-1){if(m.indexOf(" &&& ")!==-1)var y=m.indexOf(" &&& "),x=m.slice(y+5);else var y=m.indexOf(" : "),x=m.slice(y+3);if(x.length>k){var S="",w=x.indexOf(i);S+=w<k/2?x.slice(0,w):"..."+x.slice(w-k/2,w),S+=x.slice(w,w+k/2),S+=w+k/2<x.length?"...":"",x=S}var E=m.slice(0,y),L=v-O;if(O+=E.length+x.length+2,O<v)d='<span class="field-name text-muted">'+n.bolden_match_part(E,i)+": </span> "+n.bolden_match_part(x,i),C.indexOf(d)===-1&&g!==x&&C.push(d);else{E.length<L?(L-=E.length,d='<span class="field-name text-muted">'+n.bolden_match_part(E,i)+": </span> ",x=x.slice(0,L),x=x.slice(0,x.lastIndexOf(" "))+" ...",d+=n.bolden_match_part(x,i),C.push(d)):C.push("...");break}}}return C.join(", ")}return s.forEach(function(p){l={label:p.name,value:p.name,description:h(p.content,p.name),route:["Form",p.doctype,p.name]},(p.image||p.image===null)&&(l.image=p.image),u=c(p.doctype),u?u.results.push(l):(u={title:p.doctype,results:[l],fetch_type:"Global"},o.push(u))}),o}return new Promise(function(s,o){frappe.call({method:"frappe.utils.global_search.search",args:{text:i,start:t,limit:e,doctype:r},callback:function(l){l.message?s(a(l.message)):s([])}})})},get_nav_results:function(i){function t(s){var o=[],l=[];return s.forEach(function(u){if(u.route){u.route[0]==="List"&&u.route[2]&&u.route.splice(2);var c=u.route.join("/");if(o.indexOf(c)===-1)o.push(c),l.push(u);else{var h=o.indexOf(c);l[h].index>u.index&&(l[h]=u)}}else l.push(u)}),l.sort(function(u,c){return c.index-u.index})}var e=[],r=[],n=t(this.get_doctypes(i));n.forEach(function(s){s.type===""?r.push(s):e.push(s)});var a=i.split(" in ")[0];return[{title:__("Recents"),fetch_type:"Nav",results:t(this.get_recent_pages(i))},{title:__("Create a new ..."),fetch_type:"Nav",results:t(this.get_creatables(i))},{title:__("Lists"),fetch_type:"Nav",results:e},{title:__("Reports"),fetch_type:"Nav",results:t(this.get_reports(i))},{title:__("Administration"),fetch_type:"Nav",results:t(this.get_pages(i))},{title:__("Workspace"),fetch_type:"Nav",results:t(this.get_workspaces(i))},{title:__("Dashboard"),fetch_type:"Nav",results:t(this.get_dashboards(i))},{title:__("Setup"),fetch_type:"Nav",results:r},{title:__("Find '{0}' in ...",[a]),fetch_type:"Nav",results:t(this.get_search_in_list(i))}]},fuzzy_search:function(i,t){i=i||"";var e=__(t||""),r=qa(i,e);return r[1]},bolden_match_part:function(i,t){if(qa(t,i)[0]===!1)return i;if(i.indexOf(t)==0){var e=i.split(t)[1];return"<mark>"+t+"</mark>"+e}var r="",n=i,a=i.length;i=i.toLowerCase(),t=t.toLowerCase();e:for(var s=0,o=0;s<t.length;s++){for(var l=t.charCodeAt(s);o<a;){if(i.charCodeAt(o)===l){var u=n.charAt(o);u===u.toLowerCase()?r+="<mark>"+t.charAt(s)+"</mark>":r+="<mark>"+t.charAt(s).toUpperCase()+"</mark>",o++;continue e}r+=n.charAt(o),o++}return n}return r+=n.slice(o),r},get_executables(i){let t=[];return this.searchable_functions.forEach(e=>{let r=e.label.toLowerCase(),n=i.toLowerCase();(n===r||r.indexOf(n)===0)&&t.push({type:"Executable",value:this.bolden_match_part(__(e.label),n),index:this.fuzzy_search(n,r),match:e.label,onclick:()=>e.action.apply(this,e.args)})}),t},make_function_searchable(i,t=null,e=null){if(typeof i!="function")throw new Error("First argument should be a function");this.searchable_functions.push({label:t||i.name,action:i,args:e})},searchable_functions:[]};frappe.provide("frappe.ui.misc");frappe.ui.misc.about=function(){if(!frappe.ui.misc.about_dialog){var i=new frappe.ui.Dialog({title:__("Frappe Framework")});$(i.body).html(repl("<div>		<p>"+__("Open Source Applications for the Web")+"</p>  		<p><i class='fa fa-globe fa-fw'></i>			Website: <a href='https://frappeframework.com' target='_blank'>https://frappeframework.com</a></p>		<p><i class='fa fa-github fa-fw'></i>			Source: <a href='https://github.com/frappe' target='_blank'>https://github.com/frappe</a></p>		<p><i class='fa fa-linkedin fa-fw'></i>			Linkedin: <a href='https://linkedin.com/company/frappe-tech' target='_blank'>https://linkedin.com/company/frappe-tech</a></p>		<p><i class='fa fa-facebook fa-fw'></i>			Facebook: <a href='https://facebook.com/erpnext' target='_blank'>https://facebook.com/erpnext</a></p>		<p><i class='fa fa-twitter fa-fw'></i>			Twitter: <a href='https://twitter.com/erpnext' target='_blank'>https://twitter.com/erpnext</a></p>		<hr>		<h4>Installed Apps</h4>		<div id='about-app-versions'>Loading versions...</div>		<hr>		<p class='text-muted'>&copy; Frappe Technologies Pvt. Ltd. and contributors </p> 		</div>",frappe.app)),frappe.ui.misc.about_dialog=i,frappe.ui.misc.about_dialog.on_page_show=function(){frappe.versions?t(frappe.versions):frappe.call({method:"frappe.utils.change_log.get_versions",callback:function(e){t(e.message)}})};var t=function(e){var r=$("#about-app-versions").empty();$.each(Object.keys(e).sort(),function(n,a){var s=e[a];if(s.branch)var o=$.format("<p><b>{0}:</b> v{1} ({2})<br></p>",[s.title,s.branch_version||s.version,s.branch]);else var o=$.format("<p><b>{0}:</b> v{1}<br></p>",[s.title,s.version]);$(o).appendTo(r)}),frappe.versions=e}}frappe.ui.misc.about_dialog.show()};frappe.templates.navbar=`<header class="navbar navbar-expand sticky-top" role="navigation">
	<div class="container">
		<a class="navbar-brand navbar-home" href="/app">
			<img class="app-logo" style="width: {{ navbar_settings.logo_width || 24 }}px" src="{{ frappe.boot.app_logo_url }}">
		</a>
		<ul class="nav navbar-nav d-none d-sm-flex" id="navbar-breadcrumbs"></ul>
		<div class="collapse navbar-collapse justify-content-end">
			<form class="form-inline fill-width justify-content-end" role="search" onsubmit="return false;">
				{% if (frappe.boot.read_only) { %}
					<span class="indicator-pill yellow no-indicator-dot" title="{%= __("Your site is getting upgraded.") %}">
						{%= __("Read Only Mode") %}
					</span>
				{% } %}
				<div class="input-group search-bar text-muted hidden">
					<input
						id="navbar-search"
						type="text"
						class="form-control"
						placeholder="{%= __("Search or type a command (Ctrl + G)") %}"
						aria-haspopup="true"
					>
					<span class="search-icon">
						<svg class="icon icon-sm"><use href="#icon-search"></use></svg>
					</span>
				</div>
			</form>
			<ul class="navbar-nav">
				<li class="nav-item dropdown dropdown-notifications dropdown-mobile hidden">
					<a
						class="nav-link notifications-icon text-muted"
						data-toggle="dropdown"
						aria-haspopup="true"
						aria-expanded="true"
						href="#"
						onclick="return false;">
						<span class="notifications-seen">
							<svg class="icon icon-md"><use href="#icon-notification"></use></svg>
						</span>
						<span class="notifications-unseen">
							<svg class="icon icon-md"><use href="#icon-notification-with-indicator"></use></svg>
						</span>
					</a>
					<div class="dropdown-menu notifications-list dropdown-menu-right" role="menu">
						<div class="notification-list-header">
							<div class="header-items"></div>
							<div class="header-actions"></div>
						</div>
						<div class="notification-list-body">
							<div class="panel-notifications"></div>
							<div class="panel-events"></div>
						</div>
					</div>
				</li>
				<li class="nav-item dropdown dropdown-message dropdown-mobile hidden">
					<a
						class="nav-link notifications-icon text-muted"
						data-toggle="dropdown"
						aria-haspopup="true"
						aria-expanded="true"
						href="#"
						onclick="return false;">
						<span>
							<svg class="icon icon-md"><use href="#icon-small-message"></use></svg>
						</span>
					</a>
				</li>
				<li class="vertical-bar d-none d-sm-block"></li>
				<li class="nav-item dropdown dropdown-help dropdown-mobile d-none d-lg-block">
					<a class="nav-link" data-toggle="dropdown" href="#" onclick="return false;">
						{{ __("Help") }}
						<span>
							<svg class="icon icon-xs"><use href="#icon-small-down"></use></svg>
						</span>
					</a>
					<div class="dropdown-menu dropdown-menu-right" id="toolbar-help" role="menu">
						<div id="help-links"></div>
						<div class="dropdown-divider documentation-links"></div>
						{% for item in navbar_settings.help_dropdown %}
							{% if (!item.hidden) { %}
								{% if (item.route) { %}
									<a class="dropdown-item" href="{{ item.route }}">
										{%= __(item.item_label) %}
									</a>
								{% } else if (item.action) { %}
									<a class="dropdown-item" onclick="return {{ item.action }}">
										{%= __(item.item_label) %}
									</a>
								{% } else { %}
									<div class="dropdown-divider"></div>
								{% } %}
							{% } %}
						{% endfor %}
					</div>
				</li>
				<li class="nav-item dropdown dropdown-navbar-user dropdown-mobile">
					<a class="nav-link" data-toggle="dropdown" href="#" onclick="return false;">
						{{ avatar }}
					</a>
					<div class="dropdown-menu dropdown-menu-right" id="toolbar-user" role="menu">
						{% for item in navbar_settings.settings_dropdown %}
							{% if (!item.hidden) { %}
								{% if (item.route) { %}
									<a class="dropdown-item" href="{{ item.route }}">
										{%= __(item.item_label) %}
									</a>
								{% } else if (item.action) { %}
									<a class="dropdown-item" onclick="return {{ item.action }}">
										{%= __(item.item_label) %}
									</a>
								{% } else { %}
									<div class="dropdown-divider"></div>
								{% } %}
							{% } %}
						{% endfor %}
					</div>
				</li>
			</ul>
		</div>
	</div>
</header>
`;frappe.provide("frappe.ui.toolbar");frappe.provide("frappe.search");frappe.ui.toolbar.Toolbar=class{constructor(){$("header").replaceWith(frappe.render_template("navbar",{avatar:frappe.avatar(frappe.session.user,"avatar-medium"),navbar_settings:frappe.boot.navbar_settings})),$(".dropdown-toggle").dropdown(),this.setup_awesomebar(),this.setup_notifications(),this.setup_help(),this.make()}make(){this.bind_events(),$(document).trigger("toolbar_setup")}bind_events(){$(document).on("page-change",function(){$("header .navbar .custom-menu").remove()}),$("#search-modal").on("shown.bs.modal",function(){var i=$(this);setTimeout(function(){i.find("#modal-search").focus()},300)}),$(".navbar-toggle-full-width").click(()=>{frappe.ui.toolbar.toggle_full_width()})}setup_help(){if(!frappe.boot.desk_settings.notifications){$(".navbar .vertical-bar").removeClass("d-sm-block"),$(".dropdown-help").removeClass("d-lg-block");return}frappe.provide("frappe.help"),frappe.help.show_results=t,this.search=new frappe.search.SearchDialog,frappe.provide("frappe.searchdialog"),frappe.searchdialog.search=this.search,$(".dropdown-help .dropdown-toggle").on("click",function(){$(".dropdown-help input").focus()}),$(".dropdown-help .dropdown-menu").on("click","input, button",function(e){e.stopPropagation()}),$("#input-help").on("keydown",function(e){e.which==13&&$(this).val("")}),$(document).on("page-change",function(){var e=$(".dropdown-help #help-links");e.html("");for(var r=frappe.get_route_str(),n=r.split("/"),a=[],s=0;s<n.length;s++){var o=r.split("/",s+1),l=o.join("/"),u=frappe.help.help_links[l]||[];a=$.merge(a,u)}a.length===0?e.next().hide():e.next().show();for(var s=0;s<a.length;s++){var c=a[s],h=c.url;$("<a>",{href:h,class:"dropdown-item",text:__(c.label),target:"_blank"}).appendTo(e)}$(".dropdown-help .dropdown-menu").on("click","a",t)});var i=frappe.get_modal("","");i.addClass("help-modal"),$(document).on("click",".help-modal a",t);function t(e){var r=e.target.href;r.indexOf("blob")>0&&window.open(r,"_blank");var n=$(e.target).attr("data-path");n&&e.preventDefault()}}setup_awesomebar(){frappe.boot.desk_settings.search_bar&&(new frappe.search.AwesomeBar().setup("#navbar-search"),frappe.search.utils.make_function_searchable(function(){frappe.set_route("List","Client Script")},__("Custom Script List")))}setup_notifications(){frappe.boot.desk_settings.notifications&&frappe.session.user!=="Guest"&&(this.notifications=new frappe.ui.Notifications)}};$.extend(frappe.ui.toolbar,{add_dropdown_button:function(i,t,e,r){var n=frappe.ui.toolbar.get_menu(i);return n.find("li:not(.custom-menu)").length&&!n.find(".divider").length&&frappe.ui.toolbar.add_menu_divider(n),$('<li class="custom-menu"><a><i class="fa-fw '+r+'"></i> '+t+"</a></li>").insertBefore(n.find(".divider")).find("a").click(function(){e.apply(this)})},get_menu:function(i){return $("#navbar-"+i.toLowerCase())},add_menu_divider:function(i){i=typeof i=="string"?frappe.ui.toolbar.get_menu(i):i,$('<li class="divider custom-menu"></li>').prependTo(i)},add_icon_link(i,t,e,r){let n=$(".navbar-right").get(0),a=$(`<li class="${r}">
			<a class="btn" href="${i}" title="${frappe.utils.to_title_case(r,!0)}" aria-haspopup="true" aria-expanded="true">
				<div>
					<i class="octicon ${t}"></i>
				</div>
			</a>
		</li>`).get(0);n.insertBefore(a,n.children[e])},toggle_full_width(){let i=JSON.parse(localStorage.container_fullwidth||"false");i=!i,localStorage.container_fullwidth=i,frappe.ui.toolbar.set_fullwidth_if_enabled(),$(document.body).trigger("toggleFullWidth")},set_fullwidth_if_enabled(){let i=JSON.parse(localStorage.container_fullwidth||"false");$(document.body).toggleClass("full-width",i)},show_shortcuts(i){return i.preventDefault(),frappe.ui.keys.show_keyboard_shortcut_dialog(),!1}});frappe.ui.toolbar.clear_cache=frappe.utils.throttle(function(){frappe.assets.clear_local_storage(),frappe.xcall("frappe.sessions.clear").then(i=>{frappe.show_alert({message:i,indicator:"info"}),location.reload(!0)})},1e4);frappe.ui.toolbar.show_about=function(){try{frappe.ui.misc.about()}catch(i){console.log(i)}return!1};frappe.ui.toolbar.route_to_user=function(){frappe.set_route("Form","User",frappe.session.user)};frappe.ui.toolbar.view_website=function(){let i=window.open();i.opener=null,i.location="/index"};frappe.ui.toolbar.setup_session_defaults=function(){let i=[];frappe.call({method:"frappe.core.doctype.session_default_settings.session_default_settings.get_session_default_values",callback:function(t){i=JSON.parse(t.message);let e=frappe.perm.get_perm("Session Default Settings");(in_list(frappe.user_roles,"System Manager")||e[0].read==1)&&(i[i.length]={fieldname:"settings",fieldtype:"Button",label:__("Settings"),click:()=>{frappe.set_route("Form","Session Default Settings","Session Default Settings")}}),frappe.prompt(i,function(r){i.forEach(function(n){r[n.fieldname]||(r[n.fieldname]="")}),frappe.call({method:"frappe.core.doctype.session_default_settings.session_default_settings.set_session_default_values",args:{default_values:r},callback:function(n){n.message=="success"?(frappe.show_alert({message:__("Session Defaults Saved"),indicator:"green"}),frappe.ui.toolbar.clear_cache()):frappe.show_alert({message:__("An error occurred while setting Session Defaults"),indicator:"red"})}})},__("Session Defaults"),__("Save"))}})};$(document).on("startup",async()=>{if(!frappe.boot.setup_complete||!frappe.user.has_role("System Manager"))return;let i=frappe.boot.subscription_expiry;if(i){let t=frappe.datetime.get_day_diff(cstr(i),frappe.datetime.get_today())-1,e=__(`Your subscription will end in ${cstr(t).bold()} ${t>1?"days":"day"}. After that your site will be suspended.`),r=$(`
		<div
			class="position-fixed top-100 start-20 translate-middle shadow sm:rounded-lg py-2"
			style="left: 10%; bottom:20px; width:80%; margin: auto; text-align: center; border-radius: 10px; background-color: rgb(240 249 255); z-index: 1"
		>
			<div
				style="display: flex; align-items: center; justify-content: space-between; text-align: center;"
				class="text-muted"
			>
					<p style="float: left; margin: auto; font-size: 17px">${e}</p>
					<div style="display: flex; align-items: center; justify-content: space-between">
					<button
						type="button"
						class="button-renew px-4 py-2 border border-transparent text-white hover:bg-indigo-700 focus:outline-none focus:ring-offset-2 focus:ring-indigo-500"
						style="background-color: #0089FF; border-radius: 5px; margin-right: 10px; height: fit-content;"
					>
					Subscribe
					</button>
					<a
						type="button"
						class="dismiss-upgrade text-muted" data-dismiss="modal" aria-hidden="true" style="font-size:30px; margin-bottom: 5px; margin-right: 10px"
					>
					\xD7
					</a>
				</div>
			</div>
		</div>
		`);$("footer").append(r),r.find(".dismiss-upgrade").on("click",()=>{r.remove()}),r.find(".button-renew").on("click",()=>{Hd()})}});function Hd(){frappe.call({method:"frappe.utils.subscription.remote_login",callback:i=>{i.message!==!1?window.open(i.message,"_blank"):frappe.msgprint({title:__("Message"),indicator:"orange",message:__("No active subscriptions found.")})}})}$.extend(frappe.ui.toolbar,{redirectToUrl(){Hd()}});var dn=Ut(Wa());frappe.last_edited_communication={};var Ud="<div>---</div>";frappe.views.CommunicationComposer=class{constructor(i){$.extend(this,i),this.doc||(this.doc=this.frm&&this.frm.doc||{}),this.make()}make(){let i=this;this.dialog=new frappe.ui.Dialog({title:this.title||this.subject||__("New Email"),no_submit_on_enter:!0,fields:this.get_fields(),primary_action_label:__("Send"),primary_action(){i.send_action()},secondary_action_label:__("Discard"),secondary_action(){i.dialog.hide(),i.clear_cache()},size:"large",minimizable:!0}),$(this.dialog.$wrapper.find(".form-section").get(0)).addClass("to_section"),this.prepare(),this.dialog.show(),this.frm&&$(document).trigger("form-typing",[this.frm])}get_fields(){let i=[{label:__("To"),fieldtype:"MultiSelect",reqd:0,fieldname:"recipients"},{fieldtype:"Button",label:frappe.utils.icon("down"),fieldname:"option_toggle_button",click:()=>{this.toggle_more_options()}},{fieldtype:"Section Break",hidden:1,fieldname:"more_options"},{label:__("CC"),fieldtype:"MultiSelect",fieldname:"cc"},{label:__("BCC"),fieldtype:"MultiSelect",fieldname:"bcc"},{label:__("Email Template"),fieldtype:"Link",options:"Email Template",fieldname:"email_template"},{fieldtype:"Section Break"},{label:__("Subject"),fieldtype:"Data",reqd:1,fieldname:"subject",length:524288},{label:__("Message"),fieldtype:"Text Editor",fieldname:"content",onchange:frappe.utils.debounce(this.save_as_draft.bind(this),300)},{fieldtype:"Button",label:__("Add Signature"),fieldname:"add_signature",hidden:1,click:async()=>{let e=this.dialog.get_value("sender")||"";this.content_set=!1,await this.set_content(e)}},{fieldtype:"Section Break"},{label:__("Send me a copy"),fieldtype:"Check",fieldname:"send_me_a_copy",default:frappe.boot.user.send_me_a_copy},{label:__("Send Read Receipt"),fieldtype:"Check",fieldname:"send_read_receipt"},{label:__("Attach Document Print"),fieldtype:"Check",fieldname:"attach_document_print"},{label:__("Select Print Format"),fieldtype:"Select",fieldname:"select_print_format"},{label:__("Select Languages"),fieldtype:"Select",fieldname:"language_sel"},{fieldtype:"Column Break"},{label:__("Select Attachments"),fieldtype:"HTML",fieldname:"select_attachments"}],t=frappe.boot.email_accounts.filter(e=>!in_list(["All Accounts","Sent","Spam","Trash"],e.email_account)&&e.enable_outgoing);return t.length&&(this.user_email_accounts=t.map(function(e){return e.email_id}),i.unshift({label:__("From"),fieldtype:"Select",reqd:1,fieldname:"sender",options:this.user_email_accounts}),this.user_email_accounts.length==1&&(this.sender=this.user_email_accounts)),i}toggle_more_options(i){i=i||this.dialog.fields_dict.more_options.df.hidden,this.dialog.set_df_property("more_options","hidden",!i);let t=frappe.utils.icon(i?"up-line":"down");this.dialog.get_field("option_toggle_button").set_label(t)}prepare(){this.setup_multiselect_queries(),this.setup_subject_and_recipients(),this.setup_print_language(),this.setup_print(),this.setup_attach(),this.setup_email(),this.setup_email_template(),this.setup_last_edited_communication(),this.setup_add_signature_button(),this.set_values()}setup_add_signature_button(){let i=this.dialog.has_field("sender");this.dialog.set_df_property("add_signature","hidden",!i)}setup_multiselect_queries(){["recipients","cc","bcc"].forEach(i=>{this.dialog.fields_dict[i].get_data=()=>{let e=this.dialog.fields_dict[i].get_value().match(/[^,\s*]*$/)[0]||"";frappe.call({method:"frappe.email.get_contact_list",args:{txt:e},callback:r=>{this.dialog.fields_dict[i].set_data(r.message)}})}})}setup_subject_and_recipients(){if(this.subject=this.subject||"",!this.forward&&!this.recipients&&this.last_email&&(this.recipients=this.last_email.sender,this.cc=this.last_email.cc,this.bcc=this.last_email.bcc),!this.forward&&!this.recipients&&(this.recipients=this.frm&&this.frm.timeline.get_recipient()),!this.subject&&this.frm){let i=this.frm.timeline.get_last_email();i&&(this.subject=i.subject,this.recipients||(this.recipients=i.sender),strip(this.subject.toLowerCase().split(":")[0])!="re"&&(this.subject=__("Re: {0}",[this.subject]))),this.subject||(this.subject=this.frm.doc.name,this.frm.meta.subject_field&&this.frm.doc[this.frm.meta.subject_field]?this.subject=this.frm.doc[this.frm.meta.subject_field]:this.frm.meta.title_field&&this.frm.doc[this.frm.meta.title_field]&&(this.subject=this.frm.doc[this.frm.meta.title_field]));let t=`#${this.frm.doc.name}`;cstr(this.subject).includes(t)||(this.subject=`${this.subject} (${t})`)}this.frm&&!this.recipients&&(this.recipients=this.frm.doc[this.frm.email_field])}setup_email_template(){let i=this;this.dialog.fields_dict.email_template.df.onchange=()=>{let t=i.dialog.fields_dict.email_template.get_value();if(!t)return;function e(r){if(i.reply_added===t)return;let n=i.dialog.fields_dict.content,a=i.dialog.fields_dict.subject,s=n.get_value()||"";n.set_value(`${r.message}<br>${s}`),a.set_value(r.subject),i.reply_added=t}frappe.call({method:"frappe.email.doctype.email_template.email_template.get_email_template",args:{template_name:t,doc:i.doc,_lang:i.dialog.get_value("language_sel")},callback(r){e(r.message)}})}}setup_last_edited_communication(){this.frm?(this.doctype=this.frm.doctype,this.key=this.frm.docname):this.doctype=this.key="Inbox",this.last_email&&(this.key=this.key+":"+this.last_email.name),this.subject&&(this.key=this.key+":"+this.subject),this.dialog.on_hide=()=>{$.extend(this.get_last_edited_communication(!0),this.dialog.get_values(!0)),this.frm&&$(document).trigger("form-stopped-typing",[this.frm])}}get_last_edited_communication(i){return frappe.last_edited_communication[this.doctype]||(frappe.last_edited_communication[this.doctype]={}),(i||!frappe.last_edited_communication[this.doctype][this.key])&&(frappe.last_edited_communication[this.doctype][this.key]={}),frappe.last_edited_communication[this.doctype][this.key]}async set_values(){for(let t of["recipients","cc","bcc","sender"])await this.dialog.set_value(t,this[t]||"");let i=frappe.utils.html2text(this.subject)||"";if(await this.dialog.set_value("subject",i),await this.set_values_from_last_edited_communication(),await this.set_content(),this.frm&&!this.is_a_reply&&!this.content_set){let t=this.frm.meta.default_email_template||"";await this.dialog.set_value("email_template",t)}for(let t of["email_template","cc","bcc"])if(this.dialog.get_value(t)){this.toggle_more_options(!0);break}}async set_values_from_last_edited_communication(){if(this.message)return;let i=this.get_last_edited_communication();!i.content||(i.email_template&&(await this.dialog.fields_dict.email_template.set_model_value(i.email_template),delete i.email_template),await this.dialog.set_values(i),this.content_set=!0)}selected_format(){return this.dialog.fields_dict.select_print_format.input.value||this.frm&&this.frm.meta.default_print_format||"Standard"}get_print_format(i){return i||(i=this.selected_format()),locals["Print Format"]&&locals["Print Format"][i]?locals["Print Format"][i]:{}}setup_print_language(){let i=this.dialog.fields_dict;this.lang_code=this.doc.language||this.get_print_format().default_print_language||frappe.boot.lang;let t=this;$(i.language_sel.input).change(function(){t.lang_code=this.value}),$(i.language_sel.input).empty().add_options(frappe.get_languages()),this.lang_code&&$(i.language_sel.input).val(this.lang_code)}setup_print(){let i=this.dialog.fields_dict;if($(i.attach_document_print.input).click(function(){$(i.select_print_format.wrapper).toggle($(this).prop("checked"))}),$(i.select_print_format.wrapper).toggle(!1),this.frm){let t=frappe.meta.get_print_formats(this.frm.meta.name);$(i.select_print_format.input).empty().add_options(t).val(t[0])}else $(i.attach_document_print.wrapper).toggle(!1)}setup_attach(){let i=this.dialog.fields_dict,t=$(i.select_attachments.wrapper);this.attachments||(this.attachments=[]);let e={folder:"Home/Attachments",on_success:r=>{this.attachments.push(r),this.render_attachment_rows(r)}};this.frm&&(e={doctype:this.frm.doctype,docname:this.frm.docname,folder:"Home/Attachments",on_success:r=>{this.frm.attachments.attachment_uploaded(r),this.render_attachment_rows(r)}}),$(`
			<label class="control-label">
				${__("Select Attachments")}
			</label>
			<div class='attach-list'></div>
			<p class='add-more-attachments'>
				<button class='btn btn-xs btn-default'>
					${frappe.utils.icon("small-add","xs")}&nbsp;
					${__("Add Attachment")}
				</button>
			</p>
		`).appendTo(t.empty()),t.find(".add-more-attachments button").on("click",()=>new frappe.ui.FileUploader(e)),this.render_attachment_rows()}render_attachment_rows(i){let t=this.dialog.fields_dict.select_attachments,e=$(t.wrapper).find(".attach-list");if(i)e.append(this.get_attachment_row(i,!0));else{let r=[];this.attachments&&this.attachments.length&&(r=r.concat(this.attachments)),this.frm&&(r=r.concat(this.frm.get_files())),r.length&&$.each(r,(n,a)=>{!a.file_name||e.find(`[data-file-name="${a.name}"]`).length||(a.file_url=frappe.urllib.get_full_url(a.file_url),e.append(this.get_attachment_row(a)))})}}get_attachment_row(i,t){return $(`<p class="checkbox flex">
			<label class="ellipsis" title="${i.file_name}">
				<input
					type="checkbox"
					data-file-name="${i.name}"
					${t?"checked":""}>
				</input>
				<span class="ellipsis">${i.file_name}</span>
			</label>
			&nbsp;
			<a href="${i.file_url}" target="_blank" class="btn-linkF">
				${frappe.utils.icon("link-url")}
			</a>
		</p>`)}setup_email(){let i=this.dialog.fields_dict;this.attach_document_print&&($(i.attach_document_print.input).click(),$(i.select_print_format.wrapper).toggle(!0)),$(i.send_me_a_copy.input).on("click",()=>{let t=i.send_me_a_copy.get_value();frappe.db.set_value("User",frappe.session.user,"send_me_a_copy",t),frappe.boot.user.send_me_a_copy=t})}send_action(){let i=this,t=i.dialog.get_primary_btn(),e=this.get_values();if(!e)return;let r=$.map($(i.dialog.wrapper).find("[data-file-name]:checked"),function(n){return $(n).attr("data-file-name")});e.attach_document_print?i.send_email(t,e,r,null,e.select_print_format||""):i.send_email(t,e,r)}get_values(){let i=this.dialog.get_values();for(let t=0,e=this.dialog.fields.length;t<e;t++){let r=this.dialog.fields[t];r.is_cc_checkbox&&(i[r.fieldname]&&(i.cc=(i.cc?i.cc+", ":"")+r.fieldname,i.bcc=(i.bcc?i.bcc+", ":"")+r.fieldname),delete i[r.fieldname])}return i}save_as_draft(){if(this.dialog&&this.frm){let i=this.dialog.get_value("content");i=i.split(Ud)[0],dn.default.setItem(this.frm.doctype+this.frm.docname,i).catch(t=>{t&&(console.log(t),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}}clear_cache(){this.delete_saved_draft(),this.get_last_edited_communication(!0)}delete_saved_draft(){this.dialog&&this.frm&&dn.default.removeItem(this.frm.doctype+this.frm.docname).catch(i=>{i&&(console.log(i),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}send_email(i,t,e,r,n){let a=this;if(this.dialog.hide(),!t.recipients){frappe.msgprint(__("Enter Email Recipient(s)"));return}if(t.attach_document_print||(r=null,n=null),this.frm&&!frappe.model.can_email(this.doc.doctype,this.frm)){frappe.msgprint(__("You are not allowed to send emails related to this document"));return}return frappe.call({method:"frappe.core.doctype.communication.email.make",args:{recipients:t.recipients,cc:t.cc,bcc:t.bcc,subject:t.subject,content:t.content,doctype:a.doc.doctype,name:a.doc.name,send_email:1,print_html:r,send_me_a_copy:t.send_me_a_copy,print_format:n,sender:t.sender,sender_full_name:t.sender?frappe.user.full_name():void 0,email_template:t.email_template,attachments:e,_lang:a.lang_code,read_receipt:t.send_read_receipt,print_letterhead:a.is_print_letterhead_checked()},btn:i,callback(s){if(s.exc){if(frappe.msgprint(__("There were errors while sending email. Please try again.")),a.error)try{a.error(s)}catch(o){console.log(o)}}else if(frappe.utils.play_sound("email"),s.message.emails_not_sent_to&&frappe.msgprint(__("Email not sent to {0} (unsubscribed / disabled)",[frappe.utils.escape_html(s.message.emails_not_sent_to)])),a.clear_cache(),a.frm&&a.frm.reload_doc(),a.success)try{a.success(s)}catch(o){console.log(o)}}})}is_print_letterhead_checked(){return this.frm&&$(this.frm.wrapper).find(".form-print-wrapper").is(":visible")?$(this.frm.wrapper).find(".print-letterhead").prop("checked")?1:0:(frappe.model.get_doc(":Print Settings","Print Settings")||{with_letterhead:1}).with_letterhead?1:0}async set_content(i){if(this.content_set)return;let t=this.message||"";if(!t&&this.frm){let{doctype:e,docname:r}=this.frm;t=await dn.default.getItem(e+r)||""}t&&(this.content_set=!0),t+=await this.get_signature(i||null),this.is_a_reply&&!this.reply_set&&(t+=this.get_earlier_reply()),await this.dialog.set_value("content",t)}async get_signature(i){let t=frappe.boot.user.email_signature;if(!t){let e={add_signature:1};i?e.email_id=i:e.default_outgoing=1;let r=await frappe.db.get_list("Email Account",{filters:e,fields:["signature","email_id"],limit:1}),n=null;r.length&&(t=r[0].signature,n=r[0].email_id),!i&&n&&this.user_email_accounts&&this.user_email_accounts.includes(n)&&this.dialog.set_value("sender",n)}return t?(frappe.utils.is_html(t)||(t=t.replace(/\n/g,"<br>")),"<br>"+t):""}get_earlier_reply(){this.reply_set=!1;let i=this.last_email||this.frm&&this.frm.timeline.get_last_email(!0);if(!i)return"";let t=i.original_comment||i.content;t=this.html2text(t).replace(/\n/g,"<br>"),t.length>20*1024&&(t+="<div>"+__("Message clipped")+"</div>"+t,t=t.slice(0,20*1024));let e=frappe.datetime.global_date_format(i.communication_date||i.creation);return this.reply_set=!0,`
			<div><br></div>
			${Ud||""}
			<p>
			${__("On {0}, {1} wrote:",[e,i.sender])}
			</p>
			<blockquote>
			${t}
			</blockquote>
		`}html2text(i){return i=i.replace(/<\/div>/g,"<br></div>").replace(/<\/p>/g,"<br></p>").replace(/<br>/g,`
`),frappe.utils.html2text(i).replace(/\n{3,}/g,`

`)}};frappe.views.TranslationManager=class{constructor(t){Object.assign(this,t),this.make()}make(){this.data=[],this.dialog=new frappe.ui.Dialog({fields:this.get_fields(),title:__("Translate {0}",[this.df.label]),no_submit_on_enter:!0,primary_action_label:__("Update Translations"),primary_action:t=>this.update_translations(t).then(()=>{this.dialog.hide(),this.data=[],frappe.msgprint({title:__("Success"),message:__("Successfully updated translations"),indicator:"green"})})}),this.get_translations_data().then(t=>{this.data.push(...t||[]),this.dialog.refresh(),this.dialog.show()})}get_fields(){var t=[{label:__("Source Text"),fieldname:"source",fieldtype:"Data",read_only:1,bold:1,default:this.source_text},{label:__("Translations"),fieldname:"translation_data",fieldtype:"Table",fields:[{label:"Language",fieldname:"language",fieldtype:"Link",options:"Language",in_list_view:1,columns:3},{label:"Translation",fieldname:"translation",fieldtype:"Text",in_list_view:1,columns:7}],data:this.data,get_data:()=>this.data}];return t}get_translations_data(){return frappe.db.get_list("Translation",{fields:["name","language","translated_text as translation"],filters:{source_text:strip_html(this.source_text)}})}update_translations({source:t,translation_data:e=[]}){let r={};return e.map(n=>{r[n.language]=n.translation}),frappe.call({method:"frappe.translate.update_translations_for_source",btn:this.dialog.get_primary_btn(),args:{source:t,translation_dict:r}}).fail(()=>{frappe.msgprint({title:__("Something went wrong"),message:__("Please try again"),indicator:"red"})})}};var Yd=Ut(Wd()),Gd=Ut(Vd());frappe.standard_pages.Workspaces=function(){var i=frappe.container.add_page("Workspaces");frappe.ui.make_app_page({parent:i,name:"Workspaces",title:__("Workspace")}),frappe.workspace=new frappe.views.Workspace(i),$(i).bind("show",function(){frappe.workspace.show()})};frappe.views.Workspace=class{constructor(t){this.wrapper=$(t),this.page=t.page,this.blocks=frappe.workspace_block.blocks,this.is_read_only=!0,this.pages={},this.sorted_public_items=[],this.sorted_private_items=[],this.current_page={},this.sidebar_items={public:{},private:{}},this.sidebar_categories=["My Workspaces","Public"],this.prepare_container(),this.setup_pages(),this.register_awesomebar_shortcut()}prepare_container(){let t=$(`
			<div class="list-sidebar overlay-sidebar hidden-xs hidden-sm">
				<div class="desk-sidebar list-unstyled sidebar-menu"></div>
			</div>
		`).appendTo(this.wrapper.find(".layout-side-section"));this.sidebar=t.find(".desk-sidebar"),this.body=this.wrapper.find(".layout-main-section")}async setup_pages(t){if(!this.discard&&this.create_page_skeleton(),!this.discard&&this.create_sidebar_skeleton(),this.sidebar_pages=this.discard?this.sidebar_pages:await this.get_pages(),this.cached_pages=$.extend(!0,{},this.sidebar_pages),this.all_pages=this.sidebar_pages.pages,this.has_access=this.sidebar_pages.has_access,this.all_pages.forEach(e=>{e.is_editable=!e.public||this.has_access}),this.public_pages=this.all_pages.filter(e=>e.public),this.private_pages=this.all_pages.filter(e=>!e.public),this.all_pages){frappe.workspaces={};for(let e of this.all_pages)frappe.workspaces[frappe.router.slug(e.name)]={title:e.title};this.make_sidebar(),t&&this.show()}}get_pages(){return frappe.xcall("frappe.desk.desktop.get_workspace_sidebar_items")}sidebar_item_container(t){return $(`
			<div class="sidebar-item-container ${t.is_editable?"is-draggable":""}" item-parent="${t.parent_page}" item-name="${t.title}" item-public="${t.public||0}">
				<div class="desk-sidebar-item standard-sidebar-item ${t.selected?"selected":""}">
					<a
						href="/app/${t.public?frappe.router.slug(t.title):"private/"+frappe.router.slug(t.title)}"
						class="item-anchor ${t.is_editable?"":"block-click"}" title="${__(t.title)}"
					>
						<span class="sidebar-item-icon" item-icon=${t.icon||"folder-normal"}>${frappe.utils.icon(t.icon||"folder-normal","md")}</span>
						<span class="sidebar-item-label">${__(t.title)}<span>
					</a>
					<div class="sidebar-item-control"></div>
				</div>
				<div class="sidebar-child-item nested-container"></div>
			</div>
		`)}make_sidebar(){this.sidebar.find(".standard-sidebar-section")[0]&&this.sidebar.find(".standard-sidebar-section").remove(),this.sidebar_categories.forEach(t=>{let e=this.public_pages.filter(r=>r.parent_page==""||r.parent_page==null);t!="Public"&&(e=this.private_pages.filter(r=>r.parent_page==""||r.parent_page==null)),e=e.uniqBy(r=>r.title),this.build_sidebar_section(t,e)}),this.sidebar.find(".selected").length&&!frappe.dom.is_element_in_viewport(this.sidebar.find(".selected"))&&this.sidebar.find(".selected")[0].scrollIntoView(),this.remove_sidebar_skeleton()}build_sidebar_section(t,e){let r=$(`<div class="standard-sidebar-section nested-container" data-title="${t}"></div>`),n=$(`<div class="standard-sidebar-label">
			<span>${frappe.utils.icon("small-down","xs")}</span>
			<span class="section-title">${__(t)}<span>
		</div>`).appendTo(r);this.prepare_sidebar(e,r,this.sidebar),n.on("click",a=>{let s=$(a.target).find("span use").attr("href")==="#icon-small-down"?"#icon-right":"#icon-small-down";$(a.target).find("span use").attr("href",s),$(a.target).parent().find(".sidebar-item-container").toggleClass("hidden")}),Object.keys(e).length===0&&r.addClass("hidden")}prepare_sidebar(t,e,r){t.forEach(n=>this.append_item(n,e)),e.appendTo(r)}append_item(t,e){let r=frappe.router.slug(t.title)==frappe.router.slug(this.get_page_to_show().name)&&t.public==this.get_page_to_show().public;t.selected=r,r&&(this.current_page={name:t.title,public:t.public});let n=this.sidebar_item_container(t),a=n.find(".sidebar-item-control");this.add_sidebar_actions(t,a);let o=(t.public?this.public_pages:this.private_pages).filter(l=>l.parent_page==t.title);if(o.length>0){let l=n.find(".sidebar-child-item");l.addClass("hidden"),this.prepare_sidebar(o,l,n)}n.appendTo(e),this.sidebar_items[t.public?"public":"private"][t.title]=n,n.parent().hasClass("hidden")&&r&&n.parent().toggleClass("hidden"),this.add_drop_icon(t,a,n)}add_drop_icon(t,e,r){let n="small-down";r.find(`[item-name="${this.current_page.name}"]`).length&&(n="small-up");let a=r.find(".sidebar-child-item"),s=$(`<span class="drop-icon hidden">${frappe.utils.icon(n,"sm")}</span>`).appendTo(e);(t.public?this.public_pages:this.private_pages).some(l=>l.parent_page==t.title)&&s.removeClass("hidden"),s.on("click",()=>{let l=s.find("use").attr("href")==="#icon-small-down"?"#icon-small-up":"#icon-small-down";s.find("use").attr("href",l),a.toggleClass("hidden")})}show(){if(!this.all_pages){setTimeout(()=>this.show(),100);return}let t=this.get_page_to_show();this.page.set_title(__(t.name)),this.update_selected_sidebar(this.current_page,!1),this.update_selected_sidebar(t,!0),this.show_page(t)}update_selected_sidebar(t,e){let r=t.public?"public":"private";if(this.sidebar&&this.sidebar_items[r]&&this.sidebar_items[r][t.name]){let n=this.sidebar_items[r][t.name],s=(t.public?this.public_pages:this.private_pages).find(o=>o.title==t.name);e?(n[0].firstElementChild.classList.add("selected"),s&&(s.selected=!0),n.parent().hasClass("hidden")&&n.parent().removeClass("hidden"),this.current_page={name:t.name,public:t.public},localStorage.current_page=t.name,localStorage.is_current_page_public=t.public):(n[0].firstElementChild.classList.remove("selected"),s&&(s.selected=!1))}}get_data(t){return frappe.call("frappe.desk.desktop.get_desktop_page",{page:t}).then(e=>{if(this.page_data=e.message,this.pages[t.name]&&delete this.pages[t.name],this.pages[t.name]=e.message,!(!this.page_data||Object.keys(this.page_data).length===0)&&!(this.page_data.charts&&this.page_data.charts.items.length===0))return frappe.dashboard_utils.get_dashboard_settings().then(r=>{if(r){let n=r.chart_config?JSON.parse(r.chart_config):{};this.page_data.charts.items.map(a=>{a.chart_settings=n[a.chart_name]||{}}),this.pages[t.name]=this.page_data}})})}get_page_to_show(){let t;localStorage.current_page&&this.all_pages.filter(n=>n.title==localStorage.current_page).length!=0?t={name:localStorage.current_page,public:localStorage.is_current_page_public=="true"}:Object.keys(this.all_pages).length!==0?t={name:this.all_pages[0].title,public:!0}:t={name:"Build",public:!0};let e=(frappe.get_route()[1]=="private"?frappe.get_route()[2]:frappe.get_route()[1])||t.name,r=frappe.get_route()[1]?frappe.get_route()[1]!="private":t.public;return{name:e,public:r}}async show_page(t){if(this.body.find("#editorjs")[0]||(this.$page=$(`
				<div id="editorjs" class="desk-page page-main-content"></div>
			`).appendTo(this.body)),this.all_pages){this.create_page_skeleton();let r=(t.public?this.public_pages:this.private_pages).filter(n=>n.title==t.name)[0];this.content=r&&JSON.parse(r.content),this.add_custom_cards_in_content(),$(".item-anchor").addClass("disable-click"),this.pages&&this.pages[r.name]?this.page_data=this.pages[r.name]:await frappe.after_ajax(()=>this.get_data(r)),this.setup_actions(t),this.prepare_editorjs(),$(".item-anchor").removeClass("disable-click"),this.remove_page_skeleton()}}add_custom_cards_in_content(){let t=-1;this.content.find((e,r)=>{e.type=="card"&&(t=r)}),t!==-1&&(this.content.splice(t+1,0,{type:"card",data:{card_name:"Custom Documents",col:4}}),this.content.splice(t+2,0,{type:"card",data:{card_name:"Custom Reports",col:4}}))}prepare_editorjs(){this.editor?this.editor.isReady.then(()=>{this.editor.configuration.tools.chart.config.page_data=this.page_data,this.editor.configuration.tools.shortcut.config.page_data=this.page_data,this.editor.configuration.tools.card.config.page_data=this.page_data,this.editor.configuration.tools.onboarding.config.page_data=this.page_data,this.editor.configuration.tools.quick_list.config.page_data=this.page_data,this.editor.render({blocks:this.content||[]})}):this.initialize_editorjs(this.content)}setup_actions(t){let r=(t.public?this.public_pages:this.private_pages).filter(n=>n.title==t.name)[0];if(!this.is_read_only){this.setup_customization_buttons(r);return}this.clear_page_actions(),this.page.set_secondary_action(__("Edit"),async()=>{!this.editor||!this.editor.readOnly||(this.is_read_only=!1,await this.editor.readOnly.toggle(),this.editor.isReady.then(()=>{this.initialize_editorjs_undo(),this.setup_customization_buttons(r),this.show_sidebar_actions(),this.make_blocks_sortable()}))}),this.page.add_inner_button(__("Create Workspace"),()=>{this.initialize_new_page()})}initialize_editorjs_undo(){this.undo=new Gd.default({editor:this.editor}),this.undo.initialize({blocks:this.content||[]}),this.undo.readOnly=!1}clear_page_actions(){this.page.clear_primary_action(),this.page.clear_secondary_action(),this.page.clear_inner_toolbar()}setup_customization_buttons(t){this.clear_page_actions(),t.is_editable&&this.page.set_primary_action(__("Save"),()=>{this.clear_page_actions(),this.save_page(t).then(e=>{!e||(this.undo.readOnly=!0,this.editor.readOnly.toggle(),this.is_read_only=!0)})},null,__("Saving")),this.page.set_secondary_action(__("Discard"),async()=>{this.discard=!0,this.clear_page_actions(),await this.editor.readOnly.toggle(),this.is_read_only=!0,this.sidebar_pages=this.cached_pages,this.reload(),frappe.show_alert({message:__("Customizations Discarded"),indicator:"info"})}),t.name&&this.page.add_inner_button(__("Settings"),()=>{frappe.set_route(`workspace/${t.name}`)})}show_sidebar_actions(){this.sidebar.find(".standard-sidebar-section").addClass("show-control"),this.make_sidebar_sortable()}add_sidebar_actions(t,e,r){t.is_editable?(frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,e),!r&&this.add_settings_button(t,e)):(e.parent().click(()=>{!this.is_read_only&&frappe.show_alert({message:__("Only Workspace Manager can sort or edit this page"),indicator:"info"},5)}),frappe.utils.add_custom_button(frappe.utils.icon("duplicate","sm"),()=>this.duplicate_page(t),"duplicate-page",__("Duplicate Workspace"),null,e))}get_parent_pages(t){if(this.public_parent_pages=["",...this.public_pages.filter(e=>!e.parent_page).map(e=>e.title)],this.private_parent_pages=["",...this.private_pages.filter(e=>!e.parent_page).map(e=>e.title)],t)return t.public?this.public_parent_pages:this.private_parent_pages}edit_page(t){var e=this;let r=t,n=this.get_parent_pages(t),a=n.findIndex(o=>o==t.title);a!==-1&&n.splice(a,1);let s=new frappe.ui.Dialog({title:__("Update Details"),fields:[{label:__("Title"),fieldtype:"Data",fieldname:"title",reqd:1,default:t.title},{label:__("Parent"),fieldtype:"Select",fieldname:"parent",options:n,default:t.parent_page},{label:__("Public"),fieldtype:"Check",fieldname:"is_public",depends_on:`eval:${this.has_access}`,default:t.public,onchange:function(){s.set_df_property("parent","options",this.get_value()?e.public_parent_pages:e.private_parent_pages)}},{fieldtype:"Column Break"},{label:__("Icon"),fieldtype:"Icon",fieldname:"icon",default:t.icon}],primary_action_label:__("Update"),primary_action:o=>{let l=o.title!=r.title,u=o.is_public!=r.public;if(!((l||u)&&!this.validate_page(o,r))){if(s.hide(),frappe.call({method:"frappe.desk.doctype.workspace.workspace.update_page",args:{name:r.name,title:o.title,icon:o.icon||"",parent:o.parent||"",public:o.is_public||0},callback:function(c){if(c.message){let h=__("Workspace {0} Edited Successfully",[r.title.bold()]);frappe.show_alert({message:h,indicator:"green"})}}}),this.update_sidebar(r,o),this.make_page_selected){let h=(o.is_public?"":"private/")+frappe.router.slug(o.title);frappe.set_route(h),this.make_page_selected=!1}this.make_sidebar(),this.show_sidebar_actions()}}});s.show()}update_sidebar(t,e){let r=t.public!=(e.is_public||0),n=t.title!=e.title,a=lt({},t),o=(t.public?this.public_pages:this.private_pages).filter(l=>l.parent_page==t.title);if(this.make_page_selected=t.selected,a.title=e.title,a.icon=e.icon,a.parent_page=e.parent||"",a.public=e.is_public,n||r)if(e.is_public)a.name=e.title,a.label=e.title,a.for_user="";else{let l=frappe.session.user;a.name=`${e.title}-${l}`,a.label=`${e.title}-${l}`,a.for_user=l}this.update_cached_values(t,a),o.length&&o.forEach(l=>{l.parent_page=e.title,r&&this.update_child_sidebar(l,e)})}update_child_sidebar(t,e){let r=lt({},t);if(this.make_page_selected=t.selected,t.public=e.is_public,e.is_public)t.name=t.title,t.label=t.title,t.for_user="";else{let n=frappe.session.user;t.name=`${t.title}-${n}`,t.label=`${t.title}-${n}`,t.for_user=n}this.update_cached_values(r,t)}update_cached_values(t,e,r,n){let[a,s]=t.public?[this.public_pages,this.private_pages]:[this.private_pages,this.public_pages],o=a.findIndex(l=>l.title==t.title);r&&o++,(frappe.workspaces[frappe.router.slug(t.name)]||n)&&(!r&&delete frappe.workspaces[frappe.router.slug(t.name)],e&&(frappe.workspaces[frappe.router.slug(e.name)]={title:e.title})),(this.pages&&this.pages[t.name]||n)&&(e&&(this.pages[e.name]=this.pages[t.name]||{}),!r&&delete this.pages[t.name]),e?t.public!=(e.is_public||e.public||0)?(!r&&a.splice(o,1),s.push(e)):n?a.push(e):a.splice(o,r?0:1,e):a.splice(o,1),this.sidebar_pages.pages=[...this.public_pages,...this.private_pages],this.cached_pages=this.sidebar_pages}add_settings_button(t,e){this.dropdown_list=[{label:__("Edit"),title:__("Edit Workspace"),icon:frappe.utils.icon("edit","sm"),action:()=>this.edit_page(t)},{label:__("Duplicate"),title:__("Duplicate Workspace"),icon:frappe.utils.icon("duplicate","sm"),action:()=>this.duplicate_page(t)},{label:__("Delete"),title:__("Delete Workspace"),icon:frappe.utils.icon("delete-active","sm"),action:()=>this.delete_page(t)}];let r=$(`
			<div class="btn btn-secondary btn-xs setting-btn dropdown-btn" title="${__("Setting")}">
				${frappe.utils.icon("dot-horizontal","xs")}
			</div>
			<div class="dropdown-list hidden"></div>
		`),n=function(a,s,o,l){let u=$(`
				<div class="dropdown-item" title="${s}">
					<span class="dropdown-item-icon">${o}</span>
					<span class="dropdown-item-label">${a}</span>
				</div>
			`);return u.click(c=>{c.stopPropagation(),l&&l()}),u};r.filter(".dropdown-btn").click(a=>{a.stopPropagation(),r.filter(".dropdown-list.hidden").length&&$(".dropdown-list:not(.hidden)").addClass("hidden"),r.filter(".dropdown-list").toggleClass("hidden")}),e.append(r),this.dropdown_list.forEach(a=>{r.filter(".dropdown-list").append(n(a.label,a.title,a.icon,a.action))})}delete_page(t){frappe.confirm(__("Are you sure you want to delete page {0}?",[t.title.bold()]),()=>{frappe.call({method:"frappe.desk.doctype.workspace.workspace.delete_page",args:{page:t},callback:function(e){if(e.message){let r=e.message,n=__("Workspace {0} Deleted Successfully",[r.title.bold()]);frappe.show_alert({message:n,indicator:"green"})}}}),this.page.clear_primary_action(),this.update_cached_values(t),this.current_page.name==t.title&&this.current_page.public==t.public&&frappe.set_route("/"),this.make_sidebar(),this.show_sidebar_actions()})}duplicate_page(t){var e=this;let r=lt({},t);!this.has_access&&r.public&&(r.public=0);let n=this.get_parent_pages({public:r.public}),a=new frappe.ui.Dialog({title:__("Create Duplicate"),fields:[{label:__("Title"),fieldtype:"Data",fieldname:"title",reqd:1},{label:__("Parent"),fieldtype:"Select",fieldname:"parent",options:n,default:r.parent_page},{label:__("Public"),fieldtype:"Check",fieldname:"is_public",depends_on:`eval:${this.has_access}`,default:r.public,onchange:function(){a.set_df_property("parent","options",this.get_value()?e.public_parent_pages:e.private_parent_pages)}},{fieldtype:"Column Break"},{label:__("Icon"),fieldtype:"Icon",fieldname:"icon",default:r.icon}],primary_action_label:__("Duplicate"),primary_action:s=>{if(!this.validate_page(s))return;a.hide(),frappe.call({method:"frappe.desk.doctype.workspace.workspace.duplicate_page",args:{page_name:t.name,new_page:s},callback:function(u){if(u.message){let c=u.message,h=__("Duplicate of {0} named as {1} is created successfully",[t.title.bold(),c.title.bold()]);frappe.show_alert({message:h,indicator:"green"})}}}),r.title=s.title,r.public=s.is_public||0,r.name=s.title+(r.public?"":"-"+frappe.session.user),r.label=r.name,r.icon=s.icon,r.parent_page=s.parent||"",r.for_user=r.public?"":frappe.session.user,r.is_editable=!r.public,r.selected=!0,this.update_cached_values(t,r,!0);let l=(s.is_public?"":"private/")+frappe.router.slug(s.title);frappe.set_route(l),e.make_sidebar(),e.show_sidebar_actions()}});a.show()}make_sidebar_sortable(){let t=this;$(".nested-container").each(function(){new Sortable(this,{handle:".drag-handle",draggable:".sidebar-item-container.is-draggable",group:"nested",animation:150,fallbackOnBody:!0,swapThreshold:.65,onEnd:function(e){let r=$(e.item).attr("item-public")=="1";t.prepare_sorted_sidebar(r),t.update_sorted_sidebar()}})})}prepare_sorted_sidebar(t){let e=t?this.public_pages:this.private_pages;t?this.sorted_public_items=this.sort_sidebar(this.sidebar.find(".standard-sidebar-section").last(),e):this.sorted_private_items=this.sort_sidebar(this.sidebar.find(".standard-sidebar-section").first(),e),this.sidebar_pages.pages=[...this.public_pages,...this.private_pages],this.cached_pages=this.sidebar_pages}sort_sidebar(t,e){let r=[];return Array.from(t.find(".sidebar-item-container")).forEach((n,a)=>{let s="";n.closest(".nested-container").classList.contains("sidebar-child-item")&&(s=n.parentElement.parentElement.attributes["item-name"].value),r.push({title:n.attributes["item-name"].value,parent_page:s,public:n.attributes["item-public"].value});let o=$(n).find(".sidebar-item-control .drop-icon").first();$(n).find(".sidebar-child-item > *").length!=0?o.removeClass("hidden"):o.addClass("hidden");let l=e.findIndex(c=>c.title==n.attributes["item-name"].value),u=e[l];u.parent_page=s,l!=a&&(e.splice(l,1),e.splice(a,0,u))}),r}update_sorted_sidebar(){(this.sorted_public_items||this.sorted_private_items)&&frappe.call({method:"frappe.desk.doctype.workspace.workspace.sort_pages",args:{sb_public_items:this.sorted_public_items,sb_private_items:this.sorted_private_items},callback:function(t){if(t.message){let e="Sidebar Updated Successfully";frappe.show_alert({message:__(e),indicator:"green"})}}})}make_blocks_sortable(){let t=this;this.page_sortable=Sortable.create(this.page.main.find(".codex-editor__redactor").get(0),{handle:".drag-handle",draggable:".ce-block",animation:150,onEnd:function(e){t.editor.blocks.move(e.newIndex,e.oldIndex)},setData:function(){}})}initialize_new_page(){var t=this;this.get_parent_pages();let e=new frappe.ui.Dialog({title:__("New Workspace"),fields:[{label:__("Title"),fieldtype:"Data",fieldname:"title",reqd:1},{label:__("Parent"),fieldtype:"Select",fieldname:"parent",options:this.private_parent_pages},{label:__("Public"),fieldtype:"Check",fieldname:"is_public",depends_on:`eval:${this.has_access}`,onchange:function(){e.set_df_property("parent","options",this.get_value()?t.public_parent_pages:t.private_parent_pages)}},{fieldtype:"Column Break"},{label:__("Icon"),fieldtype:"Icon",fieldname:"icon"}],primary_action_label:__("Create"),primary_action:r=>{if(!this.validate_page(r))return;e.hide(),this.initialize_editorjs_undo(),this.setup_customization_buttons({is_editable:!0});let n=r.title+(r.is_public?"":"-"+frappe.session.user),a=[{type:"header",data:{text:r.title}}],s={content:JSON.stringify(a),name:n,label:n,title:r.title,public:r.is_public||0,for_user:r.is_public?"":frappe.session.user,icon:r.icon,parent_page:r.parent||"",is_editable:!0,selected:!0};this.editor.render({blocks:a}).then(async()=>{this.editor.configuration.readOnly&&(this.is_read_only=!1,await this.editor.readOnly.toggle()),frappe.call({method:"frappe.desk.doctype.workspace.workspace.new_page",args:{new_page:s},callback:function(u){if(u.message){let c=__("Workspace {0} Created Successfully",[s.title.bold()]);frappe.show_alert({message:c,indicator:"green"})}}}),this.update_cached_values(s,s,!0,!0);let l=(s.public?"":"private/")+frappe.router.slug(s.title);frappe.set_route(l),this.make_sidebar(),this.show_sidebar_actions()})}});e.show()}validate_page(t,e){let r="",[n,a]=t.is_public?[this.private_pages,this.public_pages]:[this.public_pages,this.private_pages],s=this.sidebar_categories[t.is_public];a&&a.filter(l=>l.title==t.title)[0]&&(r=__("Page with title {0} already exist.",[t.title.bold()])),frappe.router.doctype_route_exist(frappe.router.slug(t.title))&&(r=__("Doctype with same route already exist. Please choose different title."));let o=e&&n.filter(l=>l.parent_page==e.title);return o&&o.every(l=>a&&a.find(u=>u.title==l.title)?(r=__("One of the child page with name {0} already exist in {1} Section. Please update the name of the child page first before moving",[l.title.bold(),s.bold()]),cur_dialog.hide(),!1):!0),r?(frappe.throw(__(r)),!1):!0}add_page_to_sidebar(t){let e=$(".standard-sidebar-section"),r=lt({},t);r.selected=!0,r.is_editable=!0;let n=this.sidebar_item_container(r);this.add_sidebar_actions(r,n.find(".sidebar-item-control"),!0),n.find(".sidebar-item-control .drag-handle").css("margin-right","8px");let a=r.is_public?e[1]:e[0];if(!r.parent)!r.is_public&&e.first().removeClass("hidden"),n.appendTo(a);else{let o=$(a).find(`[item-name="${r.parent}"]`),l=o.find(".sidebar-child-item"),u=o.find(".drop-icon");l[0]||(l=$('<div class="sidebar-child-item hidden nested-container"></div>').appendTo(o),u.toggleClass("hidden")),n.appendTo(l),l.removeClass("hidden"),o.find(".drop-icon.hidden").removeClass("hidden"),o.find(".drop-icon use").attr("href","#icon-small-up")}let s=r.is_public?"public":"private";this.sidebar_items&&this.sidebar_items[s]&&!this.sidebar_items[s][r.title]&&(this.sidebar_items[s][r.title]=n)}initialize_editorjs(t){this.tools={header:{class:this.blocks.header,inlineToolbar:["HeaderSize","bold","italic","link"],config:{default_size:4}},paragraph:{class:this.blocks.paragraph,inlineToolbar:["HeaderSize","bold","italic","link"],config:{placeholder:__("Choose a block or continue typing")}},chart:{class:this.blocks.chart,config:{page_data:this.page_data||[]}},card:{class:this.blocks.card,config:{page_data:this.page_data||[]}},shortcut:{class:this.blocks.shortcut,config:{page_data:this.page_data||[]}},onboarding:{class:this.blocks.onboarding,config:{page_data:this.page_data||[]}},quick_list:{class:this.blocks.quick_list,config:{page_data:this.page_data||[]}},spacer:this.blocks.spacer,HeaderSize:frappe.workspace_block.tunes.header_size},this.editor=new Yd.default({data:{blocks:t||[]},tools:this.tools,autofocus:!1,readOnly:!0,logLevel:"ERROR"})}save_page(t){let e=this;return this.current_page={name:t.title,public:t.public},this.editor.save().then(r=>{let n={};r.blocks.forEach(s=>{s.data.new&&(n[s.type]||(n[s.type]=[]),n[s.type].push(s.data.new),delete s.data.new)});let a=r.blocks.filter(s=>s.type!="card"||s.data.card_name!=="Custom Documents"&&s.data.card_name!=="Custom Reports");return t.content==JSON.stringify(a)&&Object.keys(n).length===0?(this.setup_customization_buttons(t),frappe.show_alert({message:__("No changes made on the page"),indicator:"warning"}),!1):(this.create_page_skeleton(),t.content=JSON.stringify(a),frappe.call({method:"frappe.desk.doctype.workspace.workspace.save_page",args:{title:t.title,public:t.public||0,new_widgets:n,blocks:JSON.stringify(a)},callback:function(s){s.message&&(e.discard=!0,e.update_cached_values(t,t),e.reload(),frappe.show_alert({message:__("Page Saved Successfully"),indicator:"green"}))}}),!0)}).catch(r=>{})}reload(){this.sorted_public_items=[],this.sorted_private_items=[],this.setup_pages(!0),this.discard=!1,this.undo.readOnly=!0}create_page_skeleton(){$(".layout-main-section").find(".workspace-skeleton").length||($(".layout-main-section").prepend(frappe.render_template("workspace_loading_skeleton")),$(".layout-main-section").find(".codex-editor").addClass("hidden"))}remove_page_skeleton(){$(".layout-main-section").find(".codex-editor").removeClass("hidden"),$(".layout-main-section").find(".workspace-skeleton").remove()}create_sidebar_skeleton(){$(".list-sidebar").find(".workspace-sidebar-skeleton").length||($(".list-sidebar").prepend(frappe.render_template("workspace_sidebar_loading_skeleton")),$(".desk-sidebar").addClass("hidden"))}remove_sidebar_skeleton(){$(".desk-sidebar").removeClass("hidden"),$(".list-sidebar").find(".workspace-sidebar-skeleton").remove()}register_awesomebar_shortcut(){"abcdefghijklmnopqrstuvwxyz".split("").forEach(t=>{let e={action:r=>($("#navbar-search").focus(),!1),page:this.page};frappe.ui.keys.add_shortcut(lt({shortcut:t},e)),frappe.ui.keys.add_shortcut(lt({shortcut:`shift+${t}`},e))})}};var wi=class{constructor(t){Object.assign(this,t),this.editing=Boolean(this.values&&Object.keys(this.values).length)}make(){this.make_dialog(),this.setup_dialog_events(),this.dialog.show(),window.cur_dialog=this.dialog,this.editing&&this.set_default_values()}make_dialog(){this.dialog=new frappe.ui.Dialog({title:this.get_title(),fields:this.get_fields(),primary_action:t=>{t=this.process_data(t),!this.editing&&!t.name&&(t.name=`${this.type}-${this.label}-${frappe.utils.get_random(20)}`),this.dialog.hide(),this.primary_action(t)},primary_action_label:this.primary_action_label||__("Add")})}get_title(){let t=this.editing?"Edit":"Add",e=t=t+" "+frappe.model.unscrub(this.type);return __(e)}get_fields(){}set_default_values(){return this.dialog.set_values(this.values)}process_data(t){return t}setup_dialog_events(){}hide_field(t){this.dialog.set_df_property(t,"hidden",!0)}show_field(t){this.dialog.set_df_property(t,"hidden",!1)}setup_filter(t){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group);let e=this.dialog.get_field("filter_area_loading").$wrapper;$(`<span class="text-muted">${__("Loading Filters...")}</span>`).appendTo(e),this.filters=[],this.generate_filter_from_json(),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:t,on_change:()=>{}}),frappe.model.with_doctype(t,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.hide_field("filter_area_loading"),this.show_field("filter_area")})}},Xd=class extends wi{constructor(t){super(t)}get_fields(){return[{fieldtype:"Link",fieldname:"chart_name",label:"Chart Name",options:"Dashboard Chart",reqd:1},{fieldtype:"Data",fieldname:"label",label:"Label"}]}process_data(t){return t.label=t.label?t.label:t.chart_name,t}},Kd=class extends wi{constructor(t){super(t)}get_fields(){return[{fieldtype:"Link",fieldname:"document_type",label:"DocType",options:"DocType",reqd:1,onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.document_type&&this.setup_filter(this.document_type)},get_query:()=>({filters:{issingle:0,istable:0}})},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Section Break",fieldname:"filter_section",label:__("Add Filters"),depends_on:"eval: doc.document_type"},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area"}]}generate_filter_from_json(){this.values&&this.values.quick_list_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.quick_list_filter,this.values.document_type))}process_data(t){if(this.filter_group){let e=this.filter_group.get_filters();t.quick_list_filter=frappe.utils.get_filter_as_json(e)}return t.label=t.label?t.label:t.document_type,t}},Jd=class extends wi{constructor(t){super(t)}get_fields(){return[{fieldtype:"Link",fieldname:"onboarding_name",label:"Onboarding Name",options:"Module Onboarding",reqd:1}]}},Zd=class extends wi{constructor(t){super(t)}get_fields(){let t=this;return[{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldname:"links",fieldtype:"Table",label:__("Card Links"),editable_grid:1,data:t.values?JSON.parse(t.values.links):[],get_data:()=>t.values?JSON.parse(t.values.links):[],fields:[{fieldname:"label",fieldtype:"Data",in_list_view:1,label:"Label"},{fieldname:"icon",fieldtype:"Icon",label:"Icon"},{fieldname:"link_type",fieldtype:"Select",in_list_view:1,label:"Link Type",reqd:1,options:["DocType","Page","Report"]},{fieldname:"link_to",fieldtype:"Dynamic Link",in_list_view:1,label:"Link To",reqd:1,get_options:e=>e.doc.link_type},{fieldname:"column_break_7",fieldtype:"Column Break"},{fieldname:"dependencies",fieldtype:"Data",label:"Dependencies"},{fieldname:"only_for",fieldtype:"Link",label:"Only for",options:"Country"},{default:"0",fieldname:"onboard",fieldtype:"Check",label:"Onboard"},{default:"0",fieldname:"is_query_report",fieldtype:"Check",label:"Is Query Report"}]}]}process_data(t){let e="";return t.links?t.links.map((r,n)=>{let a=n+1;r.link_type||(e=__("Following fields have missing values")+": <br><br><ul>",e+=`<li>${__("Link Type in Row")} ${a}</li>`),r.link_to||(e+=`<li>${__("Link To in Row")} ${a}</li>`),r.label=r.label?r.label:r.link_to}):e=__("You must add atleast one link."),e&&(e+="</ul>",frappe.throw({message:__(e),title:__("Missing Values Required"),indicator:"orange"})),t.label=t.label?t.label:t.chart_name,t}},Qd=class extends wi{constructor(t){super(t)}hide_filters(){this.hide_field("count_section_break"),this.hide_field("filters_section_break")}show_filters(){this.show_field("count_section_break"),this.show_field("filters_section_break")}get_fields(){return[{fieldtype:"Select",fieldname:"type",label:"Type",reqd:1,options:`DocType
Report
Page
Dashboard`,onchange:()=>{this.dialog.get_value("type")=="DocType"?this.dialog.fields_dict.link_to.get_query=()=>({query:"frappe.core.report.permitted_documents_for_user.permitted_documents_for_user.query_doctypes",filters:{user:frappe.session.user}}):this.dialog.fields_dict.link_to.get_query=null}},{fieldtype:"Data",fieldname:"label",label:"Label"},{fieldtype:"Column Break",fieldname:"column_break_4"},{fieldtype:"Dynamic Link",fieldname:"link_to",label:"Link To",reqd:1,options:"type",onchange:()=>{if(this.dialog.get_value("type")=="DocType"){let t=this.dialog.get_value("link_to");frappe.model.with_doctype(t,()=>{let e=frappe.get_meta(t);t&&frappe.boot.single_types.includes(t)?this.hide_filters():t&&(this.setup_filter(t),this.show_filters());let r=["List","Report Builder","Dashboard","New"];e.is_tree==="Tree"&&r.push("Tree"),frappe.boot.calendars.includes(t)&&r.push("Calendar"),this.dialog.set_df_property("doc_view","options",r.join(`
`))})}else this.hide_filters()}},{fieldtype:"Select",fieldname:"doc_view",label:"DocType View",options:`List
Report Builder
Dashboard
Tree
New
Calendar
Kanban`,description:__("Which view of the associated DocType should this shortcut take you to?"),default:"List",depends_on:t=>{if(this.dialog){let e=this.dialog.get_value("link_to"),r=frappe.boot.single_types.includes(e);return t.type=="DocType"&&!r}return!1}},{fieldtype:"Section Break",fieldname:"filters_section_break",label:__("Count Filter"),hidden:1},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"count_section_break",label:__("Count Customizations"),hidden:1},{fieldtype:"Select",fieldname:"color",label:__("Color"),options:["Grey","Green","Red","Orange","Pink","Yellow","Blue","Cyan"],default:"Grey",input_class:"color-select",onchange:()=>{let t=this.dialog.fields_dict.color.value.toLowerCase(),e=this.dialog.fields_dict.color.$input;e.parent().find(".color-box").get(0)||$('<div class="color-box"></div>').insertBefore(e.get(0)),e.parent().find(".color-box").get(0).style.backgroundColor=`var(--text-on-${t})`}},{fieldtype:"Column Break",fieldname:"column_break_3"},{fieldtype:"Data",fieldname:"format",label:__("Format"),description:__("For Example: {} Open")}]}set_default_values(){super.set_default_values().then(()=>{this.dialog.fields_dict.link_to.df.onchange()})}generate_filter_from_json(){this.values&&this.values.stats_filter&&(this.filters=frappe.utils.get_filter_from_json(this.values.stats_filter,this.values.link_to))}process_data(t){if(this.dialog.get_value("type")=="DocType"&&this.filter_group){let e=this.filter_group.get_filters();t.stats_filter=frappe.utils.get_filter_as_json(e)}return t.label=t.label?t.label:frappe.model.unscrub(t.link_to),t}},ef=class extends wi{constructor(t){super(t)}get_fields(){let t;return t=[{fieldtype:"Select",label:__("Choose Existing Card or create New Card"),fieldname:"new_or_existing",options:["New Card","Existing Card"]},{fieldtype:"Link",fieldname:"card",label:__("Number Cards"),options:"Number Card",get_query:()=>({query:"frappe.desk.doctype.number_card.number_card.get_cards_for_user",filters:{document_type:this.document_type}}),depends_on:'eval: doc.new_or_existing == "Existing Card"'},{fieldtype:"Section Break",fieldname:"sb_1",depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Label"),fieldname:"label",fieldtype:"Data",mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Doctype"),fieldname:"document_type",fieldtype:"Link",options:"DocType",onchange:()=>{this.document_type=this.dialog.get_value("document_type"),this.set_aggregate_function_fields(this.dialog.get_values()),this.setup_filter(this.document_type)},hidden:1},{label:__("Color"),fieldname:"color",fieldtype:"Color"},{fieldtype:"Column Break",fieldname:"cb_1"},{label:__("Function"),fieldname:"function",fieldtype:"Select",options:["Count","Sum","Average","Minimum","Maximum"],mandatory_depends_on:'eval: doc.new_or_existing == "New Card"'},{label:__("Function Based On"),fieldname:"aggregate_function_based_on",fieldtype:"Select",depends_on:"eval: doc.function !== 'Count'",mandatory_depends_on:'eval: doc.function !== "Count" && doc.new_or_existing == "New Card"'},{fieldtype:"Section Break",fieldname:"sb_1",label:__("Add Filters"),depends_on:'eval: doc.new_or_existing == "New Card"'},{fieldtype:"HTML",fieldname:"filter_area_loading"},{fieldtype:"HTML",fieldname:"filter_area",hidden:1},{fieldtype:"Section Break",fieldname:"sb_1"}],t}setup_dialog_events(){this.document_type||(this.default_values&&this.default_values.doctype?(this.document_type=this.default_values.doctype,this.setup_filter(this.default_values.doctype),this.set_aggregate_function_fields()):this.show_field("document_type"))}set_aggregate_function_fields(){let t=[];this.document_type&&frappe.get_meta(this.document_type)&&frappe.get_meta(this.document_type).fields.map(e=>{if(frappe.model.numeric_fieldtypes.includes(e.fieldtype)){if(e.fieldtype=="Currency"&&(!e.options||e.options!=="Company:company:default_currency"))return;t.push({label:e.label,value:e.fieldname})}}),this.dialog.set_df_property("aggregate_function_based_on","options",t)}process_data(t){return t.new_or_existing=="Existing Card"&&(t.name=t.card),t.stats_filter=this.filter_group&&JSON.stringify(this.filter_group.get_filters()),t.document_type=this.document_type,t}};function gi(i){return{chart:Xd,shortcut:Qd,number_card:ef,links:Zd,onboarding:Jd,quick_list:Kd}[i]||wi}var Bt=class{constructor(t){Object.assign(this,t)}make(t,e,r=t){let n=this.config.page_data[t+"s"].items.find(a=>frappe.utils.unescape_html(a.label)==frappe.utils.unescape_html(__(e)));return n?(this.wrapper.innerHTML="",n.in_customize_mode=!this.readOnly,this.block_widget=new frappe.widget.SingleWidgetGroup({container:this.wrapper,type:r,class_name:t=="chart"?"widget-charts":"",options:this.options,widgets:n,api:this.api,block:this.block}),this.wrapper.setAttribute(t+"_name",e),this.readOnly||this.block_widget.customize(),!0):!1}rendered(t){t&&(this.wrapper=t),!this.readOnly&&this.resizer();let e=this.wrapper.closest(".ce-block");this.set_col_class(e,this.get_col())}resizer(){this.wrapper.className=this.wrapper.className+" resizable";var t=document.createElement("div");t.className="resizer",this.wrapper.parentElement.appendChild(t),t.addEventListener("mousedown",a,!1);let e=this;var r,n;function a(u){r=u.clientX,n=this.parentElement.offsetWidth,document.documentElement.addEventListener("mousemove",s,!1),document.documentElement.addEventListener("mouseup",l,!1)}function s(u){$(this).css("cursor","col-resize"),$(".widget").css("pointer-events","none"),$(e.wrapper.parentElement).find(".resizer").css("border-right","3px solid var(--gray-400)"),o(),n+u.clientX-r-n>60?(r=u.clientX,e.increase_width()):n+u.clientX-r-n<-60&&(r=u.clientX,e.decrease_width())}function o(){document.selection?document.selection.empty():window.getSelection().removeAllRanges()}function l(){$(this).css("cursor","default"),$(".widget").css("pointer-events","auto"),$(e.wrapper.parentElement).find(".resizer").css("border-right","0px solid transparent"),document.documentElement.removeEventListener("mousemove",s,!1),document.documentElement.removeEventListener("mouseup",l,!1)}}new(t,e=t){let r=this,n=gi(e),a=t+"_name";this.dialog=new n({label:this.label,type:e,primary_action:s=>{s.in_customize_mode=1,this.block_widget=frappe.widget.make_widget(Ht(lt({},s),{widget_type:e,container:this.wrapper,options:Ht(lt({},this.options),{on_delete:()=>this.api.blocks.delete(),on_edit:()=>this.on_edit(this.block_widget)})})),this.block_widget.customize(this.options),this.wrapper.setAttribute(a,this.block_widget.label),$(this.wrapper).find(".widget").addClass(`${e} edit-mode`),this.new_block_widget=this.block_widget.get_config(),this.add_settings_button()}}),!this.readOnly&&this.data&&!this.data[a]&&(this.dialog.make(),this.dialog.dialog.get_close_btn().click(()=>{r.wrapper.closest(".ce-block").remove()}))}on_edit(t){let e=t.edit_dialog.type+"_name";t.edit_dialog.type=="links"&&(e="card_name");let r=t.get_config();this.block_widget.widgets=r,this.wrapper.setAttribute(e,r.label),this.new_block_widget=t.get_config()}add_new_block_button(){let t=$(`
			<div class="new-block-button">${frappe.utils.icon("add-round","lg")}</div>
		`);t.appendTo(this.wrapper),t.click(e=>{e.stopPropagation();let r=this.api.blocks.getCurrentBlockIndex()+1;this.api.blocks.insert("paragraph",{},{},r),this.api.caret.setToBlock(r)})}add_settings_button(){let t=this;this.dropdown_list=[{label:"Delete",title:"Delete Block",icon:frappe.utils.icon("delete-active","sm"),action:()=>this.api.blocks.delete()},{label:"Expand",title:"Expand Block",icon:frappe.utils.icon("expand-alt","sm"),action:()=>this.increase_width()},{label:"Shrink",title:"Shrink Block",icon:frappe.utils.icon("shrink","sm"),action:()=>this.decrease_width()},{label:"Move Up",title:"Move Up",icon:frappe.utils.icon("up-arrow","sm"),action:()=>this.move_block("up")},{label:"Move Down",title:"Move Down",icon:frappe.utils.icon("down-arrow","sm"),action:()=>this.move_block("down")}];let e=$(this.wrapper).find(".widget-control"),r=$(`
			<div class="dropdown-btn">
				<button class="btn btn-secondary btn-xs setting-btn" title="${__("Setting")}">
					${frappe.utils.icon("dot-horizontal","xs")}
				</button>
				<div class="dropdown-list hidden"></div>
			</div>
		`),n=function(a,s,o,l){let u=$(`
				<div class="dropdown-item" title="${__(s)}">
					<span class="dropdown-item-icon">${o}</span>
					<span class="dropdown-item-label">${__(a)}</span>
				</div>
			`);return u.click(c=>{c.stopPropagation(),l&&l()}),u};r.click(a=>{a.stopPropagation(),r.find(".dropdown-list").toggleClass("hidden")}),e.prepend(r),this.dropdown_list.forEach(a=>{(a.label=="Expand"||a.label=="Shrink")&&t.options&&!t.options.allow_resize||r.find(".dropdown-list").append(n(a.label,a.title,a.icon,a.action))})}get_col(){let t=this.col||12,e="col-xs-12",r=this.wrapper.closest(".ce-block"),n=new RegExp(/\bcol-.+?\b/,"g");if(r&&r.className.match(n)){r.classList.forEach(function(s){s.match(n)&&(e=s)});let a=e.split("-");t=parseInt(a[2])}return t}decrease_width(){this.update_width("decrease")}increase_width(){this.update_width("increase")}update_width(t){let e=this.options&&this.options.min_width||3,r=this.api.blocks.getCurrentBlockIndex();if(r<0)return;let n=this.api.blocks.getBlockByIndex(r);if(!n)return;let a=n.holder,s="col-xs-12",o=new RegExp(/\bcol-.+?\b/,"g");if(a.className.match(o)){a.classList.forEach(h=>{h.match(o)&&(s=h)});let l=s.split("-"),u=parseInt(l[2]),c=!0;t=="increase"?(c=u<=11,u=u+1):t=="decrease"&&(c=u>e,u=u-1),c&&this.set_col_class(a,u)}}set_col_class(t,e){let r=$.grep(t.classList,function(a){return a.indexOf("col-")!==0});t.classList="",r.forEach(a=>{t.classList.add(a)});let n="col-xs-12";e<=12&&e>=7?n="col-xs-"+e:e==6||e==5?(t.classList.add("col-xs-12"),n="col-sm-"+e):e==4?(t.classList.add("col-xs-12"),t.classList.add("col-sm-6"),n="col-md-"+e):e==3&&(t.classList.add("col-xs-12"),t.classList.add("col-sm-6"),t.classList.add("col-md-4"),n="col-lg-"+e),t.classList.add(n)}move_block(t){let e=this.api.blocks.getCurrentBlockIndex(),r=e+(t=="down"?1:-1);this.api.blocks.move(r,e)}};var hn=class extends Bt{constructor({data:t,config:e,api:r,readOnly:n}){super({config:e,api:r,readOnly:n});this._settings=this.config,this._data=this.normalizeData(t),this._element=this.getTag(),this.data=t,this.col=this.data.col?this.data.col:"12"}normalizeData(t){let e={};return typeof t!="object"&&(t={}),e.text=t.text||"",e.col=parseInt(t.col)||12,e}render(){if(this.wrapper=document.createElement("div"),!this.readOnly){let t=$('<div class="widget-head"></div>'),e=$('<div class="widget-control"></div>');return t[0].appendChild(this._element),e.appendTo(t),t.appendTo(this.wrapper),this.wrapper.classList.add("widget","header","edit-mode"),this.add_settings_button(),this.add_new_block_button(),frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,e),this.wrapper}return this._element}merge(t){let e={text:this.data.text+t.text};this.data=e}validate(t){return t.text.trim()!==""}save(){return this.wrapper=this._element,{text:this.wrapper.innerHTML.replace(/&nbsp;/gi,""),col:this.get_col()}}rendered(){super.rendered(this._element)}static get sanitize(){return{level:!1,text:{br:!0,b:!0,i:!0,a:!0,span:!0}}}static get isReadOnlySupported(){return!0}get data(){return this._data.text=this._element.innerHTML,this._data}set data(t){if(this._data=this.normalizeData(t),t.text!==void 0){let e=this._data.text||"",r=/<[a-z][\s\S]*>/i.test(e);this._element.innerHTML=r?e:`<span class="h${this._settings.default_size}">${e}</span>`}!this.readOnly&&this.wrapper&&this.wrapper.classList.add("widget","header")}getTag(){let t=document.createElement("DIV"),e=this._data.text||"&nbsp";return t.innerHTML=`<span class="h${this._settings.default_size}"><b>${e}</b></span>`,t.classList.add("ce-header"),this.readOnly||(t.contentEditable=!0),t.dataset.placeholder=this.api.i18n.t(this._settings.placeholder||""),t}static get toolbox(){return{title:"Heading",icon:frappe.utils.icon("header","sm")}}};var Wi=class extends Bt{static get DEFAULT_PLACEHOLDER(){return""}constructor({data:t,config:e,api:r,readOnly:n}){super({config:e,api:r,readOnly:n});this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.readOnly||(this.onKeyUp=this.onKeyUp.bind(this)),this._placeholder=this.config.placeholder?this.config.placeholder:Wi.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),this._preserveBlank=this.config.preserveBlank!==void 0?this.config.preserveBlank:!1,this.data=t,this.col=this.data.col?this.data.col:"12"}onKeyUp(t){if(!this.wrapper||(this.show_hide_block_list(!0),t.code!=="Backspace"&&t.code!=="Delete"))return;let{textContent:e}=this._element;e===""&&(this.show_hide_block_list(),this._element.innerHTML="")}show_hide_block_list(t){let r=($(this.wrapper).hasClass("ce-paragraph")?$(this.wrapper.parentElement):$(this.wrapper)).find(".block-list-container.dropdown-list");r.removeClass("hidden"),t&&r.addClass("hidden")}drawView(){let t=document.createElement("DIV");return t.classList.add(this._CSS.wrapper,this._CSS.block,"widget"),t.contentEditable=!1,this.readOnly||(t.contentEditable=!0,t.addEventListener("focus",()=>{let{textContent:e}=this._element;e===""&&this.show_hide_block_list()}),t.addEventListener("blur",()=>{!this.over_block_list_item&&this.show_hide_block_list(!0)}),t.dataset.placeholder=this.api.i18n.t(this._placeholder),t.addEventListener("keyup",this.onKeyUp)),t}open_block_list(){let t=__("Templates"),e=$(`
			<div class="block-list-container dropdown-list">
				<div class="dropdown-title">${t.toUpperCase()}</div>
			</div>
		`),r=frappe.workspace_block.blocks;Object.keys(r).forEach(n=>{let a=$(`
				<div class="block-list-item dropdown-item">
					<span class="dropdown-item-icon">${r[n].toolbox.icon}</span>
					<span class="dropdown-item-label">${__(r[n].toolbox.title)}</span>
				</div>
			`);a.click(s=>{s.stopPropagation();let o=this.api.blocks.getCurrentBlockIndex();this.api.blocks.delete(),this.api.blocks.insert(n,{},{},o),this.api.caret.setToBlock(o)}),a.mouseenter(()=>{this.over_block_list_item=!0}).mouseleave(()=>{this.over_block_list_item=!1}),e.append(a)}),e.addClass("hidden"),e.appendTo(this.wrapper)}render(){if(this.wrapper=document.createElement("div"),!this.readOnly){let t=$('<div class="widget-control paragraph-control"></div>');return this.wrapper.appendChild(this._element),this._element.classList.remove("widget"),t.appendTo(this.wrapper),this.wrapper.classList.add("widget","paragraph","edit-mode"),this.open_block_list(),this.add_new_block_button(),this.add_settings_button(),frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,t),this.wrapper}return this._element}merge(t){let e={text:this.data.text+t.text};this.data=e}validate(t){return!(t.text.trim()===""&&!this._preserveBlank)}save(){return this.wrapper=this._element,{text:this.wrapper.innerHTML,col:this.get_col()}}rendered(){super.rendered(this._element)}onPaste(t){let e={text:t.detail.data.innerHTML};this.data=e}static get sanitize(){return{text:{br:!0,b:!0,i:!0,a:!0,span:!0}}}static get isReadOnlySupported(){return!0}get data(){let t=this._element.innerHTML;return this._data.text=t,this._data}set data(t){this._data=t||{},this._element.innerHTML=__(this._data.text)||""}static get pasteConfig(){return{tags:["P"]}}static get toolbox(){return{title:"Text",icon:frappe.utils.icon("text","sm")}}};var _n=class extends Bt{static get toolbox(){return{title:"Card",icon:frappe.utils.icon("card","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:r,readOnly:n,block:a}){super({data:t,api:e,config:r,readOnly:n,block:a});this.sections={},this.col=this.data.col?this.data.col:"4",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0}}render(){if(this.wrapper=document.createElement("div"),this.new("card","links"),!(this.data&&this.data.card_name&&!this.make("card",this.data.card_name,"links")))return this.readOnly||($(this.wrapper).find(".widget").addClass("links edit-mode"),this.add_settings_button(),this.add_new_block_button()),this.wrapper}validate(t){return!!t.card_name}save(){return{card_name:this.wrapper.getAttribute("card_name"),col:this.get_col(),new:this.new_block_widget}}};var mn=class extends Bt{static get toolbox(){return{title:"Chart",icon:frappe.utils.icon("chart","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:r,readOnly:n,block:a}){super({data:t,api:e,config:r,readOnly:n,block:a});this.col=this.data.col?this.data.col:"12",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0,min_width:6,max_widget_count:2}}render(){if(this.wrapper=document.createElement("div"),this.new("chart"),!(this.data&&this.data.chart_name&&!this.make("chart",this.data.chart_name)))return this.readOnly||($(this.wrapper).find(".widget").addClass("chart edit-mode"),this.add_settings_button(),this.add_new_block_button()),this.wrapper}validate(t){return!!t.chart_name}save(){return{chart_name:this.wrapper.getAttribute("chart_name"),col:this.get_col(),new:this.new_block_widget}}};var gn=class extends Bt{static get toolbox(){return{title:"Shortcut",icon:frappe.utils.icon("shortcut","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:r,readOnly:n,block:a}){super({data:t,api:e,config:r,readOnly:n,block:a});this.col=this.data.col?this.data.col:"3",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0}}rendered(){super.rendered(),this.remove_last_divider(),$(window).resize(()=>{this.remove_last_divider()})}remove_last_divider(){let t=this.wrapper.closest(".ce-block"),e=$(".layout-main-section")[0].offsetWidth,r=t.offsetLeft+t.offsetWidth;e-r<=110?$(t).find(".divider").addClass("hidden"):$(t).find(".divider").removeClass("hidden")}render(){if(this.wrapper=document.createElement("div"),this.new("shortcut"),!(this.data&&this.data.shortcut_name&&!this.make("shortcut",this.data.shortcut_name))){if(!this.readOnly)$(this.wrapper).find(".widget").addClass("shortcut edit-mode"),this.add_settings_button(),this.add_new_block_button();else{let t=frappe.utils.icon("arrow-up-right","xs","","stroke: grey","ml-2");$(this.wrapper).find(".widget .widget-title").append(t),$(this.wrapper).append($('<div class="divider"></div>'))}return this.wrapper}}validate(t){return!!t.shortcut_name}save(){return{shortcut_name:this.wrapper.getAttribute("shortcut_name"),col:this.get_col(),new:this.new_block_widget}}};var vn=class extends Bt{static get toolbox(){return{title:"Spacer",icon:frappe.utils.icon("spacer","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:r,readOnly:n}){super({data:t,api:e,config:r,readOnly:n});this.col=this.data.col?this.data.col:"12"}render(){if(this.wrapper=document.createElement("div"),this.wrapper.classList.add("widget","spacer"),!this.readOnly){let t=$(`
				<div class="widget-head">
					<div class="spacer-left"></div>
					<div>${__("Spacer")}</div>
					<div class="widget-control"></div>
				</div>
			`);t.appendTo(this.wrapper),this.wrapper.classList.add("edit-mode"),this.wrapper.style.minHeight=40+"px";let e=t.find(".widget-control");this.add_settings_button(),this.add_new_block_button(),frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,e)}return this.wrapper}save(){return{col:this.get_col()}}};var bn=class extends Bt{static get toolbox(){return{title:"Onboarding",icon:frappe.utils.icon("onboarding","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:r,readOnly:n,block:a}){super({data:t,api:e,config:r,readOnly:n,block:a});this.col=this.data.col?this.data.col:"12",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!1}}rendered(){let t=this.wrapper.closest(".ce-block");this.readOnly&&!$(this.wrapper).find(".onboarding-widget-box").is(":visible")&&$(t).hide(),this.set_col_class(t,this.get_col())}new(t,e=t){let r=this,n=gi(e),a=t+"_name";this.dialog=new n({label:this.label,type:e,primary_action:s=>{s.in_customize_mode=1,this.block_widget=frappe.widget.make_widget(Ht(lt({},s),{widget_type:e,container:this.wrapper,options:Ht(lt({},this.options),{on_delete:()=>this.api.blocks.delete(),on_edit:()=>this.on_edit(this.block_widget)}),new:!0})),this.block_widget.customize(this.options),this.wrapper.setAttribute(a,this.block_widget.label||this.block_widget.onboarding_name),$(this.wrapper).find(".widget").addClass(`${e} edit-mode`),this.new_block_widget=this.block_widget.get_config(),this.add_settings_button()}}),!this.readOnly&&this.data&&!this.data[a]&&(this.dialog.make(),this.dialog.dialog.get_close_btn().click(()=>{r.wrapper.closest(".ce-block").remove()}))}make(t,e){let r=this.config.page_data.onboardings.items.find(n=>n.label==__(e));return r?(this.wrapper.innerHTML="",r.in_customize_mode=!this.readOnly,this.block_widget=frappe.widget.make_widget({container:this.wrapper,widget_type:"onboarding",in_customize_mode:r.in_customize_mode,options:Ht(lt({},this.options),{on_delete:()=>this.api.blocks.delete(),on_edit:()=>this.on_edit(this.block_widget)}),label:r.label,title:r.title||__("Let's Get Started"),subtitle:r.subtitle,steps:r.items,success:r.success,docs_url:r.docs_url,user_can_dismiss:r.user_can_dismiss}),this.wrapper.setAttribute(t+"_name",e),this.readOnly||this.block_widget.customize(this.options),!0):!1}render(){if(this.wrapper=document.createElement("div"),this.new("onboarding"),!(this.data&&this.data.onboarding_name&&!this.make("onboarding",this.data.onboarding_name)))return this.readOnly||($(this.wrapper).find(".widget").addClass("onboarding edit-mode"),this.add_settings_button(),this.add_new_block_button()),$(this.wrapper).css("padding-bottom","20px"),this.wrapper}validate(t){return!!t.onboarding_name}save(){return{onboarding_name:this.wrapper.getAttribute("onboarding_name"),col:this.get_col(),new:this.new_block_widget}}};var yn=class extends Bt{static get toolbox(){return{title:"Quick List",icon:frappe.utils.icon("list","sm")}}static get isReadOnlySupported(){return!0}constructor({data:t,api:e,config:r,readOnly:n,block:a}){super({data:t,api:e,config:r,readOnly:n,block:a});this.col=this.data.col?this.data.col:"4",this.allow_customization=!this.readOnly,this.options={allow_sorting:this.allow_customization,allow_create:this.allow_customization,allow_delete:this.allow_customization,allow_hiding:!1,allow_edit:!0,allow_resize:!0,min_width:4,max_widget_count:2}}render(){if(this.wrapper=document.createElement("div"),this.new("quick_list"),!(this.data&&this.data.quick_list_name&&!this.make("quick_list",this.data.quick_list_name)))return this.readOnly||($(this.wrapper).find(".widget").addClass("quick_list edit-mode"),this.add_settings_button(),this.add_new_block_button()),this.wrapper}validate(t){return!!t.quick_list_name}save(){return{quick_list_name:this.wrapper.getAttribute("quick_list_name"),col:this.get_col(),new:this.new_block_widget}}};var wn=class{static get isInline(){return!0}get state(){return this._state}set state(t){this._state=t}get title(){return"Header Size"}constructor({api:t}){this.api=t,this.button=null,this._state=!0,this.selectedText=null,this.range=null,this.headerLevels=[]}render(){return this.button=document.createElement("button"),this.button.type="button",this.button.innerHTML=`${frappe.utils.icon("header","sm")}${frappe.utils.icon("small-down","xs")}`,this.button.classList="header-inline-tool",this.button}checkState(t){let e=this.api.selection.findParentTag("SPAN");for(let n of["h1","h2","h3","h4","h5","h6"])if(e&&e.classList.contains(n)){let a=n.match(/\d+/)[0];$(".header-inline-tool svg:first-child").replaceWith(frappe.utils.icon(`header-${a}`,"md"))}t.anchorNode}change_size(t,e){if(!t)return;let r=document.createElement("SPAN");r.classList.add(`h${e}`),r.innerText=t.toString(),this.remove_parent_tag(t,t.commonAncestorContainer,r),t.extractContents(),t.insertNode(r),this.api.inlineToolbar.close()}remove_parent_tag(t,e,r){let n=t.startContainer.data,a=r.innerText,s=e.parentElement;n!==a&&(s=e),s.innerText==a&&!s.classList.contains("ce-header")&&!s.classList.contains("ce-paragraph")&&(this.remove_parent_tag(t,e.parentElement,r),s.remove())}surround(t){this.selectedText=t.cloneContents(),this.actions.hidden=!this.actions.hidden,this.range=this.actions.hidden?null:t,this.state=!this.actions.hidden}renderActions(){this.actions=document.createElement("div"),this.actions.classList="header-level-select",this.headerLevels=new Array(6).fill().map((t,e)=>{let r=document.createElement("div");return r.classList.add(`h${e+1}`,"header-level"),r.innerText=`Header ${e+1}`,r});for(let[t,e]of this.headerLevels.entries())this.actions.appendChild(e),this.api.listeners.on(e,"click",()=>{this.change_size(this.range,t+1)});return this.actions.hidden=!0,this.actions}destroy(){for(let t of this.headerLevels)this.api.listeners.off(t,"click")}};frappe.provide("frappe.workspace_block");frappe.workspace_block.blocks={header:hn,paragraph:Wi,card:_n,chart:mn,shortcut:gn,spacer:vn,onboarding:bn,quick_list:yn};frappe.workspace_block.tunes={header_size:wn};var zt=class{constructor(t){Object.assign(this,t),this.make()}refresh(){this.set_title(),this.set_actions(),this.set_body(),this.setup_events(),this.set_footer()}get_config(){return{name:this.name,label:this.label}}customize(t){if(this.in_customize_mode=!0,this.action_area.empty(),t.allow_sorting&&frappe.utils.add_custom_button(frappe.utils.icon("drag","xs"),null,"drag-handle",__("Drag"),null,this.action_area),t.allow_hiding){this.hidden&&(this.widget.removeClass("hidden"),this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5));let e=this.hidden?"fa fa-eye":"fa fa-eye-slash",r=this.hidden?__("Show"):__("Hide");frappe.utils.add_custom_button(`<i class="${e}" aria-hidden="true"></i>`,()=>this.hide_or_show(),"show-or-hide-button",r,null,this.action_area),this.show_or_hide_button=this.action_area.find(".show-or-hide-button")}t.allow_edit&&frappe.utils.add_custom_button(frappe.utils.icon("edit","xs"),()=>this.edit(),"edit-button",__("Edit"),null,this.action_area)}make(){this.make_widget(),this.widget.appendTo(this.container)}make_widget(){this.widget=$(`<div class="widget" data-widget-name="${this.name?this.name:""}">
			<div class="widget-head">
				<div class="widget-label">
					<div class="widget-title"></div>
					<div class="widget-subtitle"></div>
				</div>
				<div class="widget-control"></div>
			</div>
			<div class="widget-body"></div>
			<div class="widget-footer"></div>
		</div>`),this.title_field=this.widget.find(".widget-title"),this.subtitle_field=this.widget.find(".widget-subtitle"),this.body=this.widget.find(".widget-body"),this.action_area=this.widget.find(".widget-control"),this.head=this.widget.find(".widget-head"),this.footer=this.widget.find(".widget-footer"),this.refresh()}set_title(t){let e=this.title||this.label||this.name,r=t?frappe.ellipsis(e,t):e;if(this.icon){let n=frappe.utils.icon(this.icon,"lg");this.title_field[0].innerHTML=`${n} <span class="ellipsis" title="${r}">${r}</span>`}else this.title_field[0].innerHTML=`<span class="ellipsis" title="${r}">${r}</span>`,t&&this.title_field[0].setAttribute("title",this.title||this.label);this.subtitle&&this.subtitle_field.html(this.subtitle)}delete(t=!0,e=!1){let r=n=>{this.widget.remove(),!e&&this.options.on_delete&&this.options.on_delete(this.name,n)};t?(this.widget.addClass("zoom-out"),setTimeout(()=>{r(!0)},300)):r(!1)}edit(){let t=gi(this.widget_type);this.edit_dialog=new t({label:this.label,type:this.widget_type,values:this.get_config(),primary_action:e=>{Object.assign(this,e),e.name=this.name,this.new=!0,this.refresh(),this.options.on_edit&&this.options.on_edit(e)},primary_action_label:__("Save")}),this.edit_dialog.make()}toggle_width(){this.width=="Full"?(this.widget.removeClass("full-width"),this.width=null,this.refresh()):(this.widget.addClass("full-width"),this.width="Full",this.refresh());let t=this.width=="Full"?__("Collapse"):__("Expand");this.resize_button.attr("title",t)}hide_or_show(){this.hidden?(this.body.css("opacity",1),this.title_field.css("opacity",1),this.footer.css("opacity",1),this.hidden=!1):(this.body.css("opacity",.5),this.title_field.css("opacity",.5),this.footer.css("opacity",.5),this.hidden=!0),this.show_or_hide_button.empty();let t=this.hidden?"fa fa-eye":"fa fa-eye-slash",e=this.hidden?__("Show"):__("Hide");$(`<i class="${t}" aria-hidden="true" title="${e}"></i>`).appendTo(this.show_or_hide_button)}setup_events(){}set_actions(){}set_body(){}set_footer(){}};frappe.provide("frappe.widget.utils");frappe.provide("frappe.dashboards");frappe.provide("frappe.dashboards.chart_sources");var kn=class extends zt{constructor(t){t.shadow=!0;super(t);this.height=this.height||240}get_config(){return{name:this.name,chart_name:this.chart_name,label:this.label,hidden:this.hidden,width:this.width}}refresh(){delete this.dashboard_chart,this.set_body(),this.make_chart()}set_chart_title(){let t=this.widget.width()<600?40:60;this.set_title(t)}set_body(){this.widget.addClass("dashboard-widget-box"),this.width=="Full"&&this.widget.addClass("full-width")}setup_container(){this.body.empty(),this.chart_doc.type=="Heatmap"&&this.setup_heatmap_container(),this.loading=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("Loading...")}</div>`),this.loading.appendTo(this.body),this.empty=$(`<div class="chart-loading-state text-muted" style="height: ${this.height}px;">${__("No Data")}</div>`),this.empty.hide().appendTo(this.body),this.chart_wrapper=$("<div></div>"),this.chart_wrapper.appendTo(this.body),this.$heatmap_legend=null,this.set_chart_title()}setup_heatmap_container(){this.widget.addClass("heatmap-chart"),this.widget.removeClass("full-width").addClass("full-width"),this.width="Full"}set_summary(){this.$summary?this.$summary.empty():(this.$summary=$('<div class="report-summary"></div>').hide(),this.head.after(this.$summary)),this.summary.forEach(t=>{frappe.utils.build_summary_item(t).appendTo(this.$summary)}),this.summary.length&&this.$summary.show()}make_chart(){this.get_settings().then(()=>{if(!this.settings){this.deleted=!0,this.widget.remove();return}this.chart_settings||(this.chart_settings={}),this.setup_container(),this.in_customize_mode||(this.action_area.empty(),this.prepare_chart_actions(),this.chart_doc.timeseries&&this.chart_doc.chart_type!=="Custom"&&this.render_time_series_filters()),frappe.run_serially([()=>this.prepare_chart_object(),()=>this.setup_filter_button(),()=>this.fetch_and_update_chart()])})}render_time_series_filters(){let t=this.get_time_series_filters();frappe.dashboard_utils.render_chart_filters(t,"chart-actions",this.action_area,0)}get_time_series_filters(){let t;return this.chart_doc.type=="Heatmap"?t=[{label:this.chart_settings.heatmap_year||this.chart_doc.heatmap_year,options:frappe.dashboard_utils.get_years_since_creation(frappe.boot.user.creation),action:e=>{this.selected_heatmap_year=e,this.save_chart_config_for_user({heatmap_year:this.selected_heatmap_year}),this.fetch_and_update_chart()}}]:t=[{label:this.chart_settings.time_interval||this.chart_doc.time_interval,options:["Yearly","Quarterly","Monthly","Weekly","Daily"],icon:"calendar",class:"time-interval-filter",action:e=>{this.selected_time_interval=e,this.save_chart_config_for_user({time_interval:this.selected_time_interval}),this.fetch_and_update_chart()}},{label:this.chart_settings.timespan||this.chart_doc.timespan,options:["Select Date Range","Last Year","Last Quarter","Last Month","Last Week"],class:"timespan-filter",action:e=>{this.selected_timespan=e,this.selected_timespan==="Select Date Range"?this.render_date_range_field():(this.selected_from_date=null,this.selected_to_date=null,this.date_field_wrapper&&(this.date_field_wrapper.hide(),this.title_field.show(),this.subtitle_field.show(),this.head.css("flex-direction","row")),this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:null,to_date:null}),this.fetch_and_update_chart())}}],t}fetch_and_update_chart(){this.args={timespan:this.selected_timespan||this.chart_settings.timespan,time_interval:this.selected_time_interval||this.chart_settings.time_interval,from_date:this.selected_from_date||this.chart_settings.from_date,to_date:this.selected_to_date||this.chart_settings.to_date,heatmap_year:this.selected_heatmap_year||this.chart_settings.heatmap_year},this.fetch(this.filters,!0,this.args).then(t=>{this.chart_doc.chart_type=="Report"&&(this.report_result=t,this.summary=t.report_summary,t=this.get_report_chart_data(t)),this.update_chart_object(),this.data=t,this.render()})}render_date_range_field(){(!this.date_field_wrapper||!this.date_field_wrapper.is(":visible"))&&(this.date_field_wrapper=$('<div class="dashboard-date-field pull-right"></div>').insertAfter(this.action_area.find(".timespan-filter")),this.width!=="Full"&&this.widget.width()<700&&(this.title_field.hide(),this.subtitle_field.hide(),this.head.css("flex-direction","row-reverse")),this.date_range_field=frappe.ui.form.make_control({df:{fieldtype:"DateRange",fieldname:"from_date",placeholder:"Date Range",input_class:"input-xs",default:[this.chart_settings.from_date,this.chart_settings.to_date],value:[this.chart_settings.from_date,this.chart_settings.to_date],reqd:1,change:()=>{let t=this.date_range_field.get_value();this.selected_from_date=t[0],this.selected_to_date=t[1],t&&t.length==2&&(this.save_chart_config_for_user({timespan:this.selected_timespan,from_date:this.selected_from_date,to_date:this.selected_to_date}),this.fetch_and_update_chart())}},parent:this.date_field_wrapper,render_input:1}),this.date_range_field.$input.focus())}get_report_chart_data(t){if(t.chart&&this.chart_doc.use_report_chart)return t.chart.data;{let e=[];this.chart_doc.y_axis.map(s=>{e.push(s.y_field)});let r={y_fields:e,x_field:this.chart_doc.x_field,chart_type:this.chart_doc.type,color:this.chart_doc.color},n=t.columns.map(s=>frappe.report_utils.prepare_field_from_column(s));return frappe.report_utils.make_chart_options(n,t,r).data}}prepare_chart_actions(){let t=[{label:__("Refresh"),action:"action-refresh",handler:()=>{delete this.dashboard_chart,this.make_chart()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Dashboard Chart",this.chart_doc.name)}},{label:__("Reset Chart"),action:"action-reset",handler:()=>{this.reset_chart(),delete this.dashboard_chart,this.make_chart()}}];this.chart_doc.document_type?t.push({label:__("{0} List",[this.chart_doc.document_type]),action:"action-list",handler:()=>{frappe.set_route("List",this.chart_doc.document_type)}}):this.chart_doc.chart_type==="Report"&&t.push({label:__("{0} Report",[this.chart_doc.report_name]),action:"action-list",handler:()=>{frappe.set_route("query-report",this.chart_doc.report_name,this.filters)}}),this.set_chart_actions(t)}setup_filter_button(){this.in_customize_mode||(this.is_document_type=this.chart_doc.chart_type!=="Report"&&this.chart_doc.chart_type!=="Custom",this.filter_button=$(`<div class="filter-chart btn btn-xs pull-right">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_button.appendTo(this.action_area),this.is_document_type?(this.filter_group&&(this.filters=this.filter_group.get_filters()),this.create_filter_group_and_add_filters()):this.filter_button.on("click",()=>{let t;frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(e=>{this.is_document_type?t=[{fieldtype:"HTML",fieldname:"filter_area"}]:e?t=e.filter(r=>r.fieldname).map(r=>(Object.assign(r,r.dashboard_config||{}),r)):t=[{fieldtype:"HTML",options:__("No Filters Set")}],this.setup_filter_dialog(t)})}))}setup_filter_dialog(t){let e=this,r=new frappe.ui.Dialog({title:__("Set Filters for {0}",[this.chart_doc.chart_name]),fields:t,primary_action:function(){let n=this.get_values();n&&(this.hide(),e.filters=n,e.save_chart_config_for_user({filters:e.filters}),e.fetch_and_update_chart())},primary_action_label:"Set"});r.show(),this.chart_doc.chart_type=="Report"&&(frappe.query_report=new frappe.views.QueryReport({filters:r.fields_list}),frappe.query_reports[this.chart_doc.report_name].onload&&frappe.query_reports[this.chart_doc.report_name].onload(frappe.query_report)),r.set_values(this.filters)}reset_chart(){this.save_chart_config_for_user(null,1),this.chart_settings={},this.filters=null,this.selected_time_interval=null,this.selected_timespan=null,this.selected_heatmap_year=null}save_chart_config_for_user(t,e=0){Object.assign(this.chart_settings,t),frappe.xcall("frappe.desk.doctype.dashboard_settings.dashboard_settings.save_chart_config",{reset:e,config:this.chart_settings,chart_name:this.chart_doc.chart_name})}create_filter_group_and_add_filters(){this.filter_group=new frappe.ui.FilterGroup({doctype:this.chart_doc.document_type,parent_doctype:this.chart_doc.parent_document_type,filter_button:this.filter_button,on_change:()=>{this.filters=this.filter_group.get_filters(),this.save_chart_config_for_user({filters:this.filters}),this.fetch_and_update_chart()}}),this.filters&&frappe.model.with_doctype(this.chart_doc.document_type,()=>{this.filter_group.add_filters_to_filter_group(this.filters)})}set_chart_actions(t){this.chart_actions=$(`<div class="chart-actions dropdown pull-right">
			<button data-toggle="dropdown"
				aria-haspopup="true"aria-expanded="false"
				class="btn btn-xs btn-secondary chart-menu"
			>
				<svg class="icon icon-sm">
					<use href="#icon-dot-horizontal">
					</use>
				</svg>
			</button>
			<ul class="dropdown-menu dropdown-menu-right">
				${t.map(e=>`<li><a class="dropdown-item" data-action="${e.action}">${e.label}</a></li>`).join("")}
			</ul>
		</div>
		`),this.chart_actions.find("a[data-action]").each((e,r)=>{let n=r.dataset.action;$(r).click(t.find(a=>a.action===n))}),this.chart_actions.appendTo(this.action_area)}fetch(t,e=!1,r){let n=this.settings.method;return this.chart_doc.chart_type=="Report"?r={report_name:this.chart_doc.report_name,filters:t,ignore_prepared_report:1}:r={chart_name:this.chart_doc.name,filters:t,refresh:e?1:0,time_interval:r&&r.time_interval?r.time_interval:null,timespan:r&&r.timespan?r.timespan:null,from_date:r&&r.from_date?r.from_date:null,to_date:r&&r.to_date?r.to_date:null,heatmap_year:r&&r.heatmap_year?r.heatmap_year:null},frappe.xcall(n,r)}async get_source_doctype(){if(this.chart_doc.document_type)return this.chart_doc.document_type;if(this.chart_doc.chart_type=="Report"&&this.chart_doc.report_name)return await frappe.db.get_value("Report",this.chart_doc.report_name,"ref_doctype").then(t=>t.message.ref_doctype)}async render(){let t=()=>{let e=this.get_chart_args();this.dashboard_chart?this.dashboard_chart.update(this.data):this.dashboard_chart=frappe.utils.make_chart(this.chart_wrapper[0],e)};!this.data||!this.data.labels||!Object.keys(this.data).length?(this.chart_wrapper.hide(),this.loading.hide(),this.$summary&&this.$summary.hide(),this.empty.show()):(this.loading.hide(),this.empty.hide(),this.chart_wrapper.show(),this.chart_doc.document_type=await this.get_source_doctype(),this.chart_doc.document_type?frappe.model.with_doctype(this.chart_doc.document_type,t):t(),this.width=="Full"&&this.summary&&this.set_summary(),this.chart_doc.type=="Heatmap"&&this.render_heatmap_legend())}get_chart_args(){var l,u;let t=this.get_chart_colors(),e,r,n={Line:"line",Bar:"bar",Percentage:"percentage",Pie:"pie",Donut:"donut",Heatmap:"heatmap"},a=["Pie","Donut"].includes(this.chart_doc.type)?6:9,s={data:this.data,type:n[this.chart_doc.type],colors:t,height:this.height,maxSlices:this.chart_doc.number_of_groups||a,axisOptions:{xIsSeries:this.chart_doc.timeseries,shortenYAxisNumbers:1}};if(this.chart_doc.document_type){let h=frappe.get_meta(this.chart_doc.document_type).fields.find(p=>p.fieldname==this.chart_doc.value_based_on);e=h==null?void 0:h.fieldtype,r=h==null?void 0:h.options}if(this.chart_doc.chart_type=="Report"&&((u=(l=this.report_result)==null?void 0:l.chart)==null?void 0:u.fieldtype)&&(e=this.report_result.chart.fieldtype,r=this.report_result.chart.options),s.tooltipOptions={formatTooltipY:c=>frappe.format(c,{fieldtype:e,options:r},{always_show_decimals:!0,inline:!0})},this.chart_doc.type=="Heatmap"){let c=parseInt(this.selected_heatmap_year||this.chart_settings.heatmap_year||this.chart_doc.heatmap_year);s.data.start=new Date(`${c}-01-01`),s.data.end=new Date(`${c+1}-01-01`)}let o=c=>{let h=JSON.parse(c);for(let p in h)typeof s[p]=="object"&&typeof h[p]=="object"?s[p]=Object.assign(s[p],h[p]):s[p]=h[p]};return this.custom_options&&o(this.custom_options),this.chart_doc.custom_options&&o(this.chart_doc.custom_options),s}get_chart_colors(){let t=[];return this.chart_doc.y_axis.length?this.chart_doc.y_axis.map(e=>{t.push(e.color)}):["Line","Bar"].includes(this.chart_doc.type)?t=[this.chart_doc.color||[]]:this.chart_doc.type=="Heatmap"&&(t=[]),t}render_heatmap_legend(){let t,e=r=>{t=JSON.parse(r).colors};this.custom_options&&e(this.custom_options),this.chart_doc.custom_options&&e(this.chart_doc.custom_options),!this.$heatmap_legend&&this.widget.width()>991&&(this.$heatmap_legend=$(`
				<div class="heatmap-legend">
					<ul class="legend-colors">
						<li style="background-color: ${t[0]||"#ebedf0"}"></li>
						<li style="background-color: ${t[1]||"#c6e48b"}"></li>
						<li style="background-color: ${t[2]||"#7bc96f"}"></li>
						<li style="background-color: ${t[3]||"#239a3b"}"></li>
						<li style="background-color: ${t[4]||"#196127"}"></li>
					</ul>
					<div class="legend-label">
						<div style="margin-bottom: 45px">${__("Less")}</div>
						<div>${__("More")}</div>
					</div>
				</div>
				`),this.body.append(this.$heatmap_legend))}update_last_synced(){if(!this.chart_doc.last_synced_on)return;let t=__("Last synced {0}",[comment_when(this.chart_doc.last_synced_on)]);this.subtitle_field.html(t)}update_chart_object(){frappe.db.get_doc("Dashboard Chart",this.chart_doc.name).then(t=>{this.chart_doc=t,this.update_last_synced()})}prepare_chart_object(){return this.chart_doc.type=="Heatmap"&&!this.chart_doc.heatmap_year&&(this.chart_doc.heatmap_year=frappe.dashboard_utils.get_year(frappe.datetime.now_date())),this.set_chart_filters()}set_chart_filters(){let t=this.chart_settings.filters||null,e=frappe.dashboard_utils.get_all_filters(this.chart_doc);return this.chart_doc.chart_type=="Report"?frappe.dashboard_utils.get_filters_for_chart_type(this.chart_doc).then(r=>{e=this.update_default_date_filters(r,e),this.filters=frappe.utils.parse_array(t)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(e)}):(this.filters=frappe.utils.parse_array(t)||frappe.utils.parse_array(this.filters)||frappe.utils.parse_array(e),Promise.resolve())}update_default_date_filters(t,e){return t&&t.map(r=>{["Date","DateRange"].includes(r.fieldtype)&&r.default&&(r.reqd||e[r.fieldname])&&(e[r.fieldname]=r.default)}),e}get_settings(){return frappe.model.with_doc("Dashboard Chart",this.chart_name).then(t=>{if(t)if(this.chart_doc=t,this.chart_doc.chart_type=="Custom"){if(frappe.dashboards.chart_sources[this.chart_doc.source])return this.settings=frappe.dashboards.chart_sources[this.chart_doc.source],Promise.resolve();{let e="frappe.desk.doctype.dashboard_chart_source.dashboard_chart_source.get_config";return frappe.xcall(e,{name:this.chart_doc.source}).then(r=>{frappe.dom.eval(r),this.settings=frappe.dashboards.chart_sources[this.chart_doc.source]})}}else return this.chart_doc.chart_type=="Report"?(this.settings={method:"frappe.desk.query_report.run"},Promise.resolve()):(this.settings={method:"frappe.desk.doctype.dashboard_chart.dashboard_chart.get"},Promise.resolve())})}};frappe.provide("frappe.utils");var xn=class extends zt{constructor(t){t.shadow=!0;super(t)}get_config(){return{name:this.name,icon:this.icon,label:this.label,format:this.format,link_to:this.link_to,doc_view:this.doc_view,color:this.color,restrict_to_domain:this.restrict_to_domain,stats_filter:this.stats_filter,type:this.type}}setup_events(){this.widget.click(()=>{if(this.in_customize_mode)return;let t=frappe.utils.generate_route({route:this.route,name:this.link_to,type:this.type,is_query_report:this.is_query_report,doctype:this.ref_doctype,doc_view:this.doc_view}),e=frappe.utils.get_filter_from_json(this.stats_filter);this.type=="DocType"&&e&&(frappe.route_options=e),frappe.set_route(t)})}set_actions(){if(this.in_customize_mode)return;this.widget.addClass("shortcut-widget-box");let t=frappe.utils.get_filter_from_json(this.stats_filter);this.type=="DocType"&&t&&frappe.db.count(this.link_to,{filters:t}).then(e=>this.set_count(e))}set_count(t){let e=()=>this.format?__(this.format).replace(/{}/g,t):t;this.action_area.empty();let r=e(),n=this.color&&t?this.color.toLowerCase():"gray";$(`<div class="indicator-pill ellipsis ${n}">${r}</div>`).appendTo(this.action_area)}};frappe.provide("frappe.utils");var Cn=class extends zt{constructor(t){t.icon=t.icon||"file";super(t)}get_config(){return{name:this.name,links:JSON.stringify(this.links),link_count:this.links.length,label:this.label,hidden:this.hidden}}set_body(){this.options||(this.options={},this.options.links=this.links),this.widget.addClass("links-widget-box");let t=a=>a.dependencies&&a.incomplete_dependencies,e=a=>t(a)?"disabled-link":"",r=a=>a.open_count?"red":a.onboard?a.count?"blue":"yellow":"gray",n=a=>t(a)?`<span class="link-content ellipsis disabled-link">${a.label?a.label:a.name}</span>
					<div class="module-link-popover popover fade top in" role="tooltip" style="display: none;">
						<div class="arrow"></div>
						<h3 class="popover-title" style="display: none;"></h3>
						<div class="popover-content" style="padding: 12px;">
							<div class="small text-muted">${__("You need to create these first: ")}</div>
							<div class="small">${a.incomplete_dependencies.join(", ")}</div>
						</div>
					</div>`:a.youtube_id?`<span class="link-content help-video-link ellipsis" data-youtubeid="${a.youtube_id}">
						${a.label?a.label:a.name}</span>`:`<span class="link-content ellipsis">${a.label?a.label:a.name}</span>`;this.link_list=this.links.map(a=>{let s={name:a.link_to,type:a.link_type,doctype:a.doctype,is_query_report:a.is_query_report};a.link_type.toLowerCase()=="report"&&!a.is_query_report&&(s.doctype=a.dependencies);let o=frappe.utils.generate_route(s);return $(`<a href="${o}" class="link-item ellipsis ${a.onboard?"onboard-spotlight":""} ${e(a)}" type="${a.type}" title="${a.label?a.label:a.name}">
					<span class="indicator-pill no-margin ${r(a)}"></span>
					${n(a)}
			</a>`)}),this.in_customize_mode&&this.body.empty(),this.link_list.forEach(a=>a.appendTo(this.body))}setup_events(){this.link_list.forEach(t=>{let e=t.find(".link-content");if(t.hasClass("disabled-link")){let r=t.find(".module-link-popover");e.mouseover(()=>{this.in_customize_mode||r.show()}),e.mouseout(()=>r.hide())}else e.click(r=>{if(!this.in_customize_mode&&e.hasClass("help-video-link")){let n=r.currentTarget.dataset.youtubeid;frappe.help.show_video(n)}})})}};frappe.provide("frappe.utils");var Sn=class extends zt{async refresh(){frappe.utils.load_video_player(),this.new&&await this.get_onboarding_data(),this.set_title(),this.set_actions(),this.set_body(),this.setup_events()}get_config(){return{label:this.onboarding_name}}make_body(){this.body.empty(),this.steps_wrapper=$('<div class="onboarding-steps-wrapper"></div>').appendTo(this.body),this.step_preview=$(`<div class="onboarding-step-preview">
			<div class="onboarding-step-body"></div>
			<div class="onboarding-step-footer"></div>
		</div>`).appendTo(this.body),this.step_body=this.step_preview.find(".onboarding-step-body"),this.step_footer=this.step_preview.find(".onboarding-step-footer"),this.steps.forEach((t,e)=>{this.add_step(t,e)}),this.show_step(this.steps[0])}add_step(t,e){let r="pending";t.is_skipped&&(r="skipped"),t.is_complete&&(r="complete");let n=$(`<a class="onboarding-step ${r}">
				<div class="step-title">
					<div class="step-index step-pending">${__(e+1)}</div>
					<div class="step-index step-skipped">${frappe.utils.icon("tick","xs")}</div>
					<div class="step-index step-complete">${frappe.utils.icon("tick","xs")}</div>
					<div>${__(t.title)}</div>
				</div>
			</a>`);if(t.$step=n,!t.is_complete&&!t.is_skipped){let a=$(`<div class="step-skip">${__("Skip")}</div>`);a.appendTo(n),a.on("click",()=>{this.skip_step(t),event.stopPropagation()})}return n.on("click",()=>this.show_step(t)),n.appendTo(this.steps_wrapper),n}show_step(t){this.active_step&&this.active_step.$step.removeClass("active"),t.$step.addClass("active"),this.active_step=t;let e={"Watch Video":s=>this.show_video(s),"Create Entry":s=>{s.is_complete?frappe.set_route(`/app/List/${s.reference_document}`):s.show_full_form?this.create_entry(s):this.show_quick_entry(s)},"Show Form Tour":s=>this.show_form_tour(s),"Update Settings":s=>this.update_settings(s),"View Report":s=>this.open_report(s),"Go to Page":s=>this.go_to_page(s)},r=()=>{this.step_body.empty(),this.step_footer.empty(),n(),t.intro_video_url?$(`<button class="btn btn-primary btn-sm">${__("Watch Tutorial")}</button>`).appendTo(this.step_footer).on("click",a):$(`<button class="btn btn-primary btn-sm">${__(t.action_label||t.action)}</button>`).appendTo(this.step_footer).on("click",()=>e[t.action](t))},n=()=>{let s=t.description?frappe.markdown(t.description):`<h1>${__(t.title)}</h1>`;t.action==="Create Entry"&&(s+=`<p>
					<a href='/app/${frappe.router.slug(t.reference_document)}'>
						${__("Show {0} List",[__(t.reference_document)])}</a>
				</p>`),this.step_body.html(s)},a=()=>{this.step_body.empty(),this.step_footer.empty();let s=$(`<div class="video-player" data-plyr-provider="youtube" data-plyr-embed-id="${t.intro_video_url}"></div>`);s.appendTo(this.step_body);let o=new frappe.Plyr(s[0],{hideControls:!0,resetOnEnd:!0});$(`<button class="btn btn-primary btn-sm">${__(t.action_label||t.action)}</button>`).appendTo(this.step_footer).on("click",()=>{o.pause(),e[t.action](t)}),$(window).one("hashchange",()=>{o.pause()}),$(`<button class="btn btn-secondary ml-2 btn-sm">${__("Back")}</button>`).appendTo(this.step_footer).on("click",r)};r()}go_to_page(t){this.mark_complete(t),frappe.set_route(t.path).then(()=>{let e=t.callback_message||__("You can continue with the onboarding after exploring this page"),r=t.callback_title||__("Awesome Work"),n=frappe.msgprint({message:e,title:r,primary_action:{action:()=>{n.hide()},label:()=>__("Continue")},wide:!0})})}open_report(t){let e=frappe.utils.generate_route({name:t.reference_report,type:"report",is_query_report:t.report_type!=="Report Builder",doctype:t.report_reference_doctype}),r=frappe.get_route();frappe.set_route(e).then(()=>{let n=frappe.msgprint({message:__(t.report_description),title:__(t.reference_report),primary_action:{action:()=>{frappe.set_route(r).then(()=>{this.mark_complete(t)}),n.hide()},label:()=>__("Continue")},secondary_action:{action:()=>{n.hide(),frappe.set_route(r).then(()=>{this.mark_complete(t)})},label:__("Go Back")}});frappe.msg_dialog.custom_onhide=()=>this.mark_complete(t)})}show_form_tour(t){let e;t.is_single?e=frappe.router.slug(t.reference_document):e=`${frappe.router.slug(t.reference_document)}/new`;let r=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=n=>{let a=()=>{let o=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Onboarding complete"),primary_action:{action:()=>{frappe.set_route(r).then(()=>{this.mark_complete(t)}),o.hide()},label:()=>__("Continue")}})},s=t.form_tour;n.tour.init({tour_name:s,on_finish:a}).then(()=>n.tour.start())},frappe.set_route(e)}update_settings(t){let e=frappe.get_route();frappe.route_hooks={},frappe.route_hooks.after_load=r=>{r.scroll_to_field(t.field),r.doc.__unsaved=!0},frappe.route_hooks.after_save=r=>{let n=!1,a={},s=r.doc[t.field],o=null;s&&t.value_to_validate=="%"&&(n=!0),s==t.value_to_validate&&(n=!0),cstr(s)==cstr(t.value_to_validate)&&(n=!0),n?(a.message=__("Let's take you back to onboarding"),a.title=__("Action Complete"),a.primary_action={action:()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")},o=()=>a.primary_action.action()):(a.message=__("Looks like you didn't change the value"),a.title=__("Try Again"),a.secondary_action={action:()=>frappe.set_route(e),label:__("Go Back")},a.primary_action={action:()=>{frappe.set_route(e).then(()=>{setTimeout(()=>{this.skip_step(t)},300)})},label:__("Skip Step")},o=()=>a.secondary_action.action()),frappe.msgprint(a),frappe.msg_dialog.custom_onhide=()=>o()},frappe.set_route("Form",t.reference_document)}async create_entry(t){let e=frappe.get_route(),r=await this.get_first_document(t.reference_document);frappe.route_hooks={},frappe.route_hooks.after_load=a=>{let s=()=>{frappe.msgprint({message:__("Awesome, now try making an entry yourself"),title:__("Document Saved"),primary_action:{action:()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(t)}},o=t.form_tour;a.tour.init({tour_name:o,on_finish:s}).then(()=>a.tour.start())};let n=()=>{frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Action Complete"),primary_action:{action:()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")}}),frappe.msg_dialog.custom_onhide=()=>{this.mark_complete(t)}};t.is_submittable?(frappe.route_hooks.after_save=()=>{frappe.msgprint({message:__("Submit this document to complete this step."),title:__("Document Saved")})},frappe.route_hooks.after_submit=n):frappe.route_hooks.after_save=n,frappe.set_route("Form",t.reference_document,r)}show_quick_entry(t){let e=frappe.get_route_str();frappe.ui.form.make_quick_entry(t.reference_document,()=>{if(frappe.get_route_str()!=e){let r=frappe.msgprint({message:__("Let's take you back to onboarding"),title:__("Document Saved"),primary_action:{action:()=>{r.hide(),frappe.set_route(e).then(()=>{this.mark_complete(t)})},label:__("Continue")}});frappe.msg_dialog.custom_onhide=()=>{frappe.set_route(e).then(()=>{this.mark_complete(t)})}}else frappe.msgprint({message:__("Let us continue with the onboarding"),title:__("Document Saved")}),this.mark_complete(t)},null,null,!0)}show_video(t){frappe.help.show_video(t.video_url,t.title),this.mark_complete(t)}mark_complete(t){let e=t.$step,r=()=>{t.is_complete=!0,e.removeClass("skipped"),e.addClass("complete")};this.update_step_status(t,"is_complete",1,r)}skip_step(t){let e=t.$step,r=()=>{t.is_skipped=!0,e.removeClass("complete"),e.removeClass("pending"),e.addClass("skipped")};this.update_step_status(t,"is_skipped",1,r)}update_step_status(t,e,r,n){let a={is_complete:"complete",is_skipped:"skipped"};frappe.route_hooks={},frappe.call("frappe.desk.desktop.update_onboarding_step",{name:t.name,field:e,value:r}).then(()=>{n(),t.$step.removeClass("pending").removeClass("complete").removeClass("skipped").addClass(a[e]),this.steps.filter(o=>!(o.is_complete||o.is_skipped)).length==0&&this.show_success()})}show_success(){let t=this.success||__("You seem good to go!"),e=this.success_state_image||"/assets/frappe/images/ui-states/success-color.png",r="";this.docs_url&&(r=__('Congratulations on completing the module setup. If you want to learn more you can refer to the documentation <a target="_blank" href="{0}">here</a>.',[this.docs_url]));let n=$(`<div class="text-center onboarding-success">
					<img src="${e}" alt="Success State" class="zoom-in success-state">
					<h3>${t}</h3>
					<div class="text-muted">${r}</div>
					<button class="btn btn-primary btn-sm">${__("Continue")}</button>
			</div>
		`);n.find(".btn").on("click",()=>this.delete()),this.step_preview.empty(),n.appendTo(this.step_preview)}set_body(){this.widget.addClass("onboarding-widget-box"),this.is_dismissed()?this.widget.hide():this.make_body()}is_dismissed(){if(this.in_customize_mode)return!1;let t=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");if(Object.keys(t).includes(this.title)){let e=new Date(t[this.title]),r=new Date;return frappe.datetime.get_hour_diff(r,e)<24}return!1}set_actions(){if(this.in_customize_mode)return;this.action_area.empty();let t=$(`<div class="small" style="cursor:pointer;">${__("Dismiss",null,"Stop showing the onboarding widget.")}</div>`);t.on("click",()=>{let e=JSON.parse(localStorage.getItem("dismissed-onboarding")||"{}");e[this.title]=frappe.datetime.now_datetime(),localStorage.setItem("dismissed-onboarding",JSON.stringify(e)),this.delete(!0,!0),this.widget.closest(".ce-block").hide()}),t.appendTo(this.action_area)}get_onboarding_data(){return frappe.model.with_doc("Module Onboarding",this.onboarding_name).then(t=>{if(t){this.onboarding_doc=t,this.label=t.label,this.title=t.title||__("Let's Get Started"),this.subtitle=t.subtitle,this.success=t.success,this.docs_url=t.docs_url,this.user_can_dismiss=t.user_can_dismiss;let e="frappe.desk.doctype.onboarding_step.onboarding_step.get_onboarding_steps";return frappe.xcall(e,{ob_steps:t.steps}).then(r=>{this.steps=r})}})}async get_first_document(t){let{message:e}=await frappe.db.get_value("Form Tour",{reference_doctype:t},["first_document"]),r;return e.first_document&&await frappe.db.get_list(t,{order_by:"creation"}).then(n=>{Array.isArray(n)&&n.length&&(r=n[0].name)}),r||"new"}};var Tn=class{constructor(t){Object.assign(this,t),this.make()}customize(){}make(){this.make_widget(),this.widget.appendTo(this.container),this.setup_events()}get_title(){let t=`New ${frappe.model.unscrub(this.type)}`;return __(t)}make_widget(){let t=`new-${frappe.scrub(frappe.model.unscrub(this.type),"-")}-widget`;this.widget=$(`<div class="widget new-widget ${t}">
				+ ${this.get_title()}
			</div>`),this.body=this.widget}setup_events(){this.widget.on("click",()=>{this.custom_dialog?this.custom_dialog():this.open_dialog()})}open_dialog(){let t=gi(this.type);this.dialog=new t({label:this.label,type:this.type,values:!1,default_values:this.default_values,primary_action:this.on_create}),this.dialog.make()}delete(){this.widget.remove()}};frappe.provide("frappe.utils");var En=class extends zt{constructor(t){t.shadow=!0;super(t)}get_config(){return{name:this.name,label:this.label,color:this.color,hidden:this.hidden}}refresh(){this.set_body()}set_body(){this.widget.addClass("number-widget-box"),this.make_card()}set_title(){$(this.title_field).html(`<div class="number-label">${this.card_doc.label}</div>`)}make_card(){frappe.model.with_doc("Number Card",this.name).then(t=>{if(t)this.card_doc=t,this.render_card();else if(this.document_type)frappe.run_serially([()=>this.create_number_card(),()=>this.render_card()]);else{this.delete(!1);return}this.set_events()})}create_number_card(){return this.set_doc_args(),frappe.xcall("frappe.desk.doctype.number_card.number_card.create_number_card",{args:this.card_doc}).then(t=>{this.name=t.name,this.card_doc=t,this.widget.attr("data-widget-name",this.name)})}set_events(){$(this.body).click(()=>{this.in_customize_mode||this.card_doc.type=="Custom"||this.set_route()})}set_route(){let t=this.card_doc.type!=="Report",e=t?this.card_doc.document_type:this.card_doc.report_name,r=frappe.utils.generate_route({name:e,type:t?"doctype":"report",is_query_report:!t});if(t){let n=JSON.parse(this.card_doc.filters_json);frappe.route_options=n.reduce((a,s)=>Object.assign(a,{[`${s[0]}.${s[1]}`]:[s[2],s[3]]}),{})}frappe.set_route(r)}set_doc_args(){this.card_doc=Object.assign({},{document_type:this.document_type,label:this.label,function:this.function,aggregate_function_based_on:this.aggregate_function_based_on,color:this.color,filters_json:this.stats_filter})}get_settings(t){return this.filters=this.get_filters(),{Custom:{method:this.card_doc.method,args:{filters:this.filters},get_number:r=>this.get_number_for_custom_card(r)},Report:{method:"frappe.desk.query_report.run",args:{report_name:this.card_doc.report_name,filters:this.filters,ignore_prepared_report:1},get_number:r=>this.get_number_for_report_card(r)},"Document Type":{method:"frappe.desk.doctype.number_card.number_card.get_result",args:{doc:this.card_doc,filters:this.filters},get_number:r=>this.get_number_for_doctype_card(r)}}[t]}get_filters(){return frappe.dashboard_utils.get_all_filters(this.card_doc)}render_card(){this.prepare_actions(),this.set_title(),this.set_loading_state(),this.card_doc.type||(this.card_doc.type="Document Type"),this.settings=this.get_settings(this.card_doc.type),frappe.run_serially([()=>this.render_number(),()=>this.render_stats()])}set_loading_state(){$(this.body).html(`<div class="number-card-loading text-muted">
			${__("Loading...")}
		</div>`)}get_number(){return frappe.xcall(this.settings.method,this.settings.args).then(t=>this.settings.get_number(t))}get_number_for_custom_card(t){typeof t=="object"?(this.number=t.value,this.set_formatted_number(t)):this.formatted_number=t}get_number_for_doctype_card(t){if(this.number=t,this.card_doc.function!=="Count")return frappe.model.with_doctype(this.card_doc.document_type,()=>{let e=frappe.meta.get_docfield(this.card_doc.document_type,this.card_doc.aggregate_function_based_on);this.set_formatted_number(e)});this.formatted_number=t}get_number_for_report_card(t){let e=this.card_doc.report_field,r=t.result.reduce((a,s)=>(s[e]&&a.push(s[e]),a),[]),n=t.columns.find(a=>a.fieldname==e);this.number=frappe.report_utils.get_result_of_fn(this.card_doc.report_function,r),this.set_formatted_number(n)}set_formatted_number(t){let e=frappe.sys_defaults.country,n=frappe.utils.shorten_number(this.number,e,5).split(" "),a=n[1]||"",s=$(frappe.format(n[0],t)).text();this.formatted_number=s+" "+__(a)}render_number(){return this.get_number().then(()=>{$(this.body).html(`<div class="widget-content">
				<div class="number" style="color:${this.card_doc.color}">${this.formatted_number}</div>
				</div>`)})}render_stats(){if(this.card_doc.type!=="Document Type")return;let t="",e="";return this.get_percentage_stats().then(()=>{this.percentage_stat==0||this.percentage_stat==null?e="grey-stat":this.percentage_stat>0?(t=`<span class="indicator-pill-round green">
						${frappe.utils.icon("arrow-up-right","xs")}
					</span>`,e="green-stat"):(t=`<span class="indicator-pill-round red">
						${frappe.utils.icon("arrow-down-left","xs")}
					</span>`,e="red-stat");let n={Daily:__("since yesterday"),Weekly:__("since last week"),Monthly:__("since last month"),Yearly:__("since last year")}[this.card_doc.stats_time_interval],a=(()=>{if(this.percentage_stat==null)return NaN;let s=this.percentage_stat.split(" "),o=s[1]||"";return Math.abs(s[0])+" "+o})();isNaN(a)||$(this.body).find(".widget-content").append(`<div class="card-stats ${e}">
				<span class="percentage-stat-area">
					${t}
					<span class="percentage-stat">
						${a} %
					</span>
				</span>
				<span class="stat-period text-muted">
					${n}
				</span>
			</div>`)})}get_percentage_stats(){return frappe.xcall("frappe.desk.doctype.number_card.number_card.get_percentage_difference",{doc:this.card_doc,filters:this.filters,result:this.number}).then(t=>{t!==void 0&&(this.percentage_stat=frappe.utils.shorten_number(t))})}prepare_actions(){let t=[{label:__("Refresh"),action:"action-refresh",handler:()=>{this.render_card()}},{label:__("Edit"),action:"action-edit",handler:()=>{frappe.set_route("Form","Number Card",this.name)}}];this.set_card_actions(t)}set_card_actions(t){this.card_actions=$(`<div class="card-actions dropdown pull-right">
				<a data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
				...
				</a>
				<ul class="dropdown-menu" style="max-height: 300px; overflow-y: auto;">
					${t.map(e=>`<li class="dropdown-item">
									<a data-action="${e.action}">${e.label}</a>
								</li>`).join("")}
				</ul>
			</div>`),this.card_actions.find("a[data-action]").each((e,r)=>{let n=r.dataset.action;$(r).click(t.find(a=>a.action===n))}),this.action_area.html(this.card_actions)}};frappe.provide("frappe.utils");var An=class extends zt{constructor(t){t.shadow=!0;super(t)}get_config(){return{document_type:this.document_type,label:this.label,quick_list_filter:this.quick_list_filter}}set_actions(){this.in_customize_mode||(this.setup_add_new_button(),this.setup_refresh_list_button(),this.setup_filter_list_button())}setup_add_new_button(){this.add_new_button=$(`<div class="add-new btn btn-xs pull-right"
			title="${__("Add New")}  ${__(this.document_type)}
			">
				${frappe.utils.icon("add","sm")}
			</div>`),this.add_new_button.appendTo(this.action_area),this.add_new_button.on("click",()=>{frappe.set_route(frappe.utils.generate_route({type:"doctype",name:this.document_type,doc_view:"New"}))})}setup_refresh_list_button(){this.refresh_list=$(`<div class="refresh-list btn btn-xs pull-right" title="${__("Refresh List")}">
				${frappe.utils.icon("refresh","sm")}
			</div>`),this.refresh_list.appendTo(this.action_area),this.refresh_list.on("click",()=>{this.body.empty(),this.set_body()})}setup_filter_list_button(){this.filter_list=$(`<div class="filter-list btn btn-xs pull-right" title="${__("Add/Update Filter")}">
				${frappe.utils.icon("filter","sm")}
			</div>`),this.filter_list.appendTo(this.action_area),this.filter_list.on("click",()=>this.setup_filter_dialog())}setup_filter(t){this.filter_group&&(this.filter_group.wrapper.empty(),delete this.filter_group),this.filters=frappe.utils.get_filter_from_json(this.quick_list_filter,t),this.filter_group=new frappe.ui.FilterGroup({parent:this.dialog.get_field("filter_area").$wrapper,doctype:t,on_change:()=>{}}),frappe.model.with_doctype(t,()=>{this.filter_group.add_filters_to_filter_group(this.filters),this.dialog.set_df_property("filter_area","hidden",!1)})}setup_filter_dialog(){let t=[{fieldtype:"HTML",fieldname:"filter_area"}],e=this;this.dialog=new frappe.ui.Dialog({title:__("Set Filters for {0}",[__(this.document_type)]),fields:t,primary_action:function(){let r=e.quick_list_filter,n=e.filter_group.get_filters();e.quick_list_filter=frappe.utils.get_filter_as_json(n),this.hide(),r!=e.quick_list_filter&&(e.body.empty(),e.set_footer(),e.set_body())},primary_action_label:__("Set")}),this.dialog.show(),this.setup_filter(this.document_type)}render_loading_state(){this.body.empty(),this.loading=$(`<div class="list-loading-state text-muted">${__("Loading...")}</div>`),this.loading.appendTo(this.body)}render_no_data_state(){this.loading=$(`<div class="list-no-data-state text-muted">${__("No Data...")}</div>`),this.loading.appendTo(this.body)}setup_quick_list_item(t){let e=frappe.get_indicator(t,this.document_type),r=$(`
			<div class="quick-list-item">
				<div class="ellipsis left">
					<div class="ellipsis title"
						title="${strip_html(t[this.title_field_name])}">
						${strip_html(t[this.title_field_name])}
					</div>
					<div class="timestamp text-muted">
						${frappe.datetime.prettyDate(t.modified)}
					</div>
				</div>
			</div>
		`);return e&&$(`
				<div class="status indicator-pill ${e[1]} ellipsis">
					${__(e[0])}
				</div>
			`).appendTo(r),$(`<div class="right-arrow">${frappe.utils.icon("right","xs")}</div>`).appendTo(r),r.click(()=>{frappe.set_route(`${frappe.utils.get_form_link(this.document_type,t.name)}`)}),r}set_body(){this.widget.addClass("quick-list-widget-box"),this.render_loading_state(),frappe.model.with_doctype(this.document_type,()=>{let t=["name"];if(!this.title_field_name){let n=frappe.get_meta(this.document_type);this.title_field_name=n&&n.title_field||"name"}if(this.title_field_name&&this.title_field_name!="name"&&t.push(this.title_field_name),this.has_status_field=frappe.meta.has_field(this.document_type,"status"),this.has_status_field){t.push("status"),t.push("docstatus");let n=frappe.workflow.get_state_fieldname(this.document_type);n&&t.push(n)}t.push("modified");let e=frappe.utils.get_filter_from_json(this.quick_list_filter),r={method:"frappe.desk.reportview.get",args:{doctype:this.document_type,fields:t,filters:e,order_by:"modified desc",start:0,page_length:4}};frappe.call(r).then(n=>{if(!n.message)return;let a=n.message;if(this.body.empty(),a=Array.isArray(a)?a:frappe.utils.dict(a.keys,a.values),!a.length){this.render_no_data_state();return}this.quick_list=a.map(s=>this.setup_quick_list_item(s)),this.quick_list.forEach(s=>s.appendTo(this.body))})})}set_footer(){this.footer.empty();let t=frappe.utils.get_filter_from_json(this.quick_list_filter);t&&(frappe.route_options=t);let e=frappe.utils.generate_route({type:"doctype",name:this.document_type});this.see_all_button=$(`
			<a href="${e}"class="see-all btn btn-xs">${__("View List")}</a>
		`).appendTo(this.footer)}};frappe.provide("frappe.widget");frappe.widget.widget_factory={chart:kn,base:zt,shortcut:xn,links:Cn,onboarding:Sn,number_card:En,quick_list:An};frappe.widget.make_widget=i=>{let t=frappe.widget.widget_factory[i.widget_type];if(t)return new t(i);console.warn("Invalid Widget Name: "+i.widget_type)};var Ga=class{constructor(t){Object.assign(this,t),this.widgets_list=[],this.widgets_dict={},this.widget_order=[],this.make()}make(){this.make_container(),this.title?this.set_title():this.title_area.remove(),this.widgets&&this.make_widgets()}make_container(){let t=$(`<div class="widget-group ${this.class_name||""}">
				<div class="widget-group-head">
					<div class="widget-group-title"></div>
					<div class="widget-group-control"></div>
				</div>
				<div class="widget-group-body grid-col-${this.columns}">
				</div>
			</div>`);this.widget_area=t,this.hidden&&this.widget_area.hide(),this.title_area=t.find(".widget-group-title"),this.control_area=t.find(".widget-group-control"),this.body=t.find(".widget-group-body"),!this.widgets.length&&this.widget_area.hide(),t.appendTo(this.container)}set_title(){this.title_area[0].innerText=this.title}make_widgets(){this.body.empty(),this.widgets.forEach(t=>{this.add_widget(t)})}add_widget(t){let e=frappe.widget.make_widget(Ht(lt({},t),{widget_type:this.type,container:this.body,height:this.height||null,options:Ht(lt({},this.options),{on_delete:r=>this.on_delete(r)})}));return this.widgets_list.push(e),this.widgets_dict[t.name]=e,e}remove_widget(t){t.widget.remove(),this.widgets_list.filter(e=>{if(e.name==t.name)return!1}),delete this.widgets_dict[t.name]}customize(){this.hidden||this.widget_area.show(),this.widgets_list.forEach(t=>{t.customize(this.options)}),this.options.allow_create&&this.setup_new_widget(),this.options.allow_sorting&&this.setup_sortable()}setup_new_widget(){let t=this.options&&this.options.max_widget_count||Number.POSITIVE_INFINITY;this.widgets_list.length<t&&(this.new_widget=new Tn({container:this.body,type:this.type,custom_dialog:this.custom_dialog,default_values:this.default_values,on_create:e=>{this.new_widget.delete(),delete this.new_widget,e.in_customize_mode=1,this.add_widget(e).customize(this.options),this.widgets_list.length<t&&this.setup_new_widget()}}))}on_delete(t,e){this.widgets_list=this.widgets_list.filter(r=>t!=r.name),delete this.widgets_dict[t],this.update_widget_order(),!this.new_widget&&e&&this.setup_new_widget()}update_widget_order(){this.widget_order=[],this.body.children().each((t,e)=>{let r=e.dataset.widgetName;r&&this.widget_order.push(r)})}setup_sortable(){let t=this.body[0];this.sortable=new Sortable(t,{animation:150,handle:".drag-handle",onEnd:()=>this.update_widget_order()})}get_widget_config(){this.update_widget_order();let t={};return this.widgets_list.forEach(e=>{let r=e.get_config(),n=r.docname?r.docname:r.name;t[n]=r}),{order:this.widget_order,widgets:t}}},tf=class{constructor(t){Object.assign(this,t),this.widgets_list=[],this.widgets_dict={},this.make()}make(){this.add_widget(this.widgets)}add_widget(t){let e=frappe.widget.make_widget(Ht(lt({},t),{widget_type:this.type,container:this.container,height:this.height||null,options:Ht(lt({},this.options),{on_delete:()=>this.on_delete(),on_edit:()=>this.on_edit(e)})}));return this.widgets_list.push(e),this.widgets_dict[t.name]=e,e}on_delete(){this.api.blocks.delete()}on_edit(t){this.block.call("on_edit",t)}customize(){this.widgets_list.forEach(t=>{t.customize(this.options)})}};frappe.widget.WidgetGroup=Ga;frappe.widget.SingleWidgetGroup=tf;frappe.templates.sort_selector=`<div class="sort-selector">
	<div class="btn-group">
		<button class="btn btn-default btn-sm btn-order"
			data-value="{{ sort_order }}"
			title="{{ sort_order==="desc" ? __("descending") : __("ascending") }}">
			<span class="sort-order">
				<svg class="icon icon-sm">
					<use href="#icon-{{ sort_order==="desc" ? "sort-descending" : "sort-ascending" }}"></use>
				</svg>
			</span>
		</button>
		<button type="button" class="btn btn-default btn-sm sort-selector-button" data-toggle="dropdown">
			<span class="dropdown-text">{{ __(sort_by_label) }}</span>
			<ul class="dropdown-menu dropdown-menu-right">
				{% for value in options %}
				<li>
					<a class="dropdown-item option" data-value="{{ value.fieldname }}">
						{{ __(value.label) }}
					</a>
				</li>
				{% endfor %}
			</ul>
		</button>
	</div>
</div>
`;frappe.ui.SortSelector=class{constructor(t){$.extend(this,t),this.labels={},this.make()}make(){this.prepare_args(),this.parent.find(".sort-selector").remove(),this.wrapper=$(frappe.render_template("sort_selector",this.args)).appendTo(this.parent),this.bind_events()}bind_events(){var t=this;this.wrapper.find(".btn-order").on("click",function(){let e=$(this),r=$(this).attr("data-value")==="desc"?"asc":"desc",n=$(this).attr("data-value")==="desc"?__("ascending"):__("descending");e.attr("data-value",r),e.attr("title",n),t.sort_order=r;let a=r==="asc"?"sort-ascending":"sort-descending";e.find(".sort-order").html(frappe.utils.icon(a,"sm")),(t.onchange||t.change)(t.sort_by,t.sort_order)}),this.wrapper.find(".dropdown-menu a.option").on("click",function(){t.sort_by=$(this).attr("data-value"),t.wrapper.find(".dropdown-text").html($(this).html()),(t.onchange||t.change)(t.sort_by,t.sort_order)})}prepare_args(){var t=this;if(this.args||(this.args={}),this.args&&typeof this.args=="string"){var e=this.args;this.args={},e.includes("`.`")&&(e=e.split(".")[1]);var r=e.split(" ");if(r.length===2){var n=strip(r[0],"`");this.args.sort_by=n,this.args.sort_order=r[1]}}this.args.options&&this.args.options.forEach(function(a){t.labels[a.fieldname]=a.label}),this.setup_from_doctype(),this.args.sort_by&&!this.args.sort_by_label&&this.args.options.every(function(a){return a.fieldname===t.args.sort_by?(t.args.sort_by_label=a.label,!1):!0})}setup_from_doctype(){var t=this,e=frappe.get_meta(this.doctype);if(!!e){var{meta_sort_field:r,meta_sort_order:n}=this.get_meta_sort_field();if(this.args.sort_by||(r?(this.args.sort_by=r,this.args.sort_order=n):(this.args.sort_by="modified",this.args.sort_order="desc")),this.args.sort_by_label||(this.args.sort_by_label=this.get_label(this.args.sort_by)),!this.args.options){var a=[{fieldname:"modified"},{fieldname:"name"},{fieldname:"creation"},{fieldname:"idx"}];e.title_field&&a.splice(1,0,{fieldname:e.title_field}),r&&a.splice(1,0,{fieldname:r}),e.fields.forEach(function(s){(s.mandatory||s.bold||s.in_list_view||s.reqd)&&frappe.model.is_value_type(s.fieldtype)&&frappe.perm.has_perm(t.doctype,s.permlevel,"read")&&a.push({fieldname:s.fieldname,label:s.label})}),a.forEach(s=>{s.label||(s.label=t.get_label(s.fieldname))}),this.args.options=a.uniqBy(s=>s.fieldname)}this.sort_by=this.args.sort_by,this.sort_order=this.args.sort_order}}get_meta_sort_field(){var t=frappe.get_meta(this.doctype);if(!t)return{meta_sort_field:null,meta_sort_order:null};if(t.sort_field&&t.sort_field.includes(",")){var e=t.sort_field.split(",")[0].split(" ");return{meta_sort_field:e[0],meta_sort_order:e[1]}}else return{meta_sort_field:t.sort_field||"modified",meta_sort_order:t.sort_order?t.sort_order.toLowerCase():""}}get_label(t){return t==="idx"?__("Most Used"):this.labels[t]||frappe.meta.get_label(this.doctype,t)}get_sql_string(){return"`tab"+this.doctype+"`.`"+this.sort_by+"` "+this.sort_order}};frappe.templates.change_log=`{% for (var i=0, l=change_log.length; i < l; i++) {
    var app_info = change_log[i]; %}
	{% if (i > 0) { %} <hr> {% } %}
	<div class="text-left app-change-log">
		<h2 style="margin-top: 10px;">
            {{ app_info.title }}
			<small>{{ __("updated to {0}", [app_info.version]) }}</small>
		</h2>
		<div class="app-change-log-body">
		{% for (var x=0, y=app_info.change_log.length; x < y; x++) {
            var version_info = app_info.change_log[x];
            if(version_info) { %}
    			<p>{{ frappe.markdown(version_info[1]) }}</p>
		    {% }
        } %}
    	</div>
	</div>
{% } %}
`;frappe.templates.workspace_loading_skeleton=`<div class="workspace-skeleton">
	<div class="widget-group">
		<div class="widget-group-head skeleton-header">
			<div class="widget-group-title skeleton-card"></div>
		</div>
		<div class="widget-group-body grid-col-3">
			<div class="widget shortcut-widget-box skeleton-card"></div>
			<div class="widget shortcut-widget-box skeleton-card"></div>
			<div class="widget shortcut-widget-box skeleton-card"></div>
		</div>
	</div>
	<div class="widget-group skeleton-body">
		<div class="widget-group-head skeleton-header">
			<div class="widget-group-title skeleton-card"></div>
		</div>
		<div class="widget-group-body grid-col-3">
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
			<div class="widget links-widget-box skeleton-card"></div>
		</div>
	</div>
</div>
`;frappe.templates.workspace_sidebar_loading_skeleton=`<div class="workspace-sidebar-skeleton">
	<div class="widget-group-body">
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
	</div>
	<div class="widget-group-body">
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box child skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
		<div class="widget sidebar-box skeleton-card"></div>
	</div>
</div>`;frappe.start_app=function(){!frappe.Application||(frappe.assets.check(),frappe.provide("frappe.app"),frappe.provide("frappe.desk"),frappe.app=new frappe.Application)};$(document).ready(function(){frappe.utils.supportsES6||frappe.msgprint({indicator:"red",title:__("Browser not supported"),message:__("Some of the features might not work in your browser. Please update your browser to the latest version.")}),frappe.start_app()});frappe.Application=class{constructor(){this.startup()}startup(){if(frappe.socketio.init(),frappe.model.init(),frappe.boot.status==="failed")throw frappe.msgprint({message:frappe.boot.error,title:__("Session Start Failed"),indicator:"red"}),"boot failed";this.setup_frappe_vue(),this.load_bootinfo(),this.load_user_permissions(),this.make_nav_bar(),this.set_favicon(),this.setup_analytics(),this.set_fullwidth_if_enabled(),this.add_browser_class(),this.setup_energy_point_listeners(),this.setup_copy_doc_listener(),frappe.ui.keys.setup(),frappe.ui.keys.add_shortcut({shortcut:"shift+ctrl+g",description:__("Switch Theme"),action:()=>{frappe.theme_switcher&&frappe.theme_switcher.dialog.is_visible?frappe.theme_switcher.hide():(frappe.theme_switcher=new frappe.ui.ThemeSwitcher,frappe.theme_switcher.show())}}),frappe.ui.add_system_theme_switch_listener();let t=document.documentElement;if(new MutationObserver(()=>{frappe.ui.set_theme()}).observe(t,{attributes:!0,attributeFilter:["data-theme-mode"]}),frappe.ui.set_theme(),this.make_page_container(),this.set_route(),$(document).trigger("startup"),$(document).trigger("app_ready"),frappe.boot.messages&&frappe.msgprint(frappe.boot.messages),frappe.user_roles.includes("System Manager")&&setTimeout(()=>{this.show_change_log(),this.show_update_available()},1e3),!frappe.boot.developer_mode){let a=__("Using this console may allow attackers to impersonate you and steal your information. Do not enter or paste code that you do not understand.");console.log(`%c${a}`,"font-size: large")}if(this.show_notes(),frappe.ui.startup_setup_dialog&&!frappe.boot.setup_complete&&(frappe.ui.startup_setup_dialog.pre_show(),frappe.ui.startup_setup_dialog.show()),frappe.realtime.on("version-update",function(){var a=frappe.msgprint({message:__("The application has been updated to a new version, please refresh this page"),indicator:"green",title:__("Version Updated")});a.set_primary_action(__("Refresh"),function(){location.reload(!0)}),a.get_close_btn().toggle(!1)}),this.setup_build_events(),frappe.sys_defaults.email_user_password){var r=frappe.sys_defaults.email_user_password.split(",");for(var n in r)r[n]===frappe.user.name&&this.set_password(r[n])}this.link_preview=new frappe.ui.LinkPreview,frappe.boot.developer_mode||frappe.user.has_role("System Manager")&&setInterval(function(){frappe.call({method:"frappe.core.doctype.log_settings.log_settings.has_unseen_error_log",args:{user:frappe.session.user},callback:function(a){a.message.show_alert&&frappe.show_alert({indicator:"red",message:a.message.message})}})},6e5)}set_route(){frappe.flags.setting_original_route=!0,frappe.boot&&localStorage.getItem("session_last_route")?(frappe.set_route(localStorage.getItem("session_last_route")),localStorage.removeItem("session_last_route")):frappe.router.route(),frappe.after_ajax(()=>frappe.flags.setting_original_route=!1),frappe.router.on("change",()=>{$(".tooltip").hide()})}setup_frappe_vue(){Vue.prototype.__=window.__,Vue.prototype.frappe=window.frappe}set_password(t){var e=this;frappe.call({method:"frappe.core.doctype.user.user.get_email_awaiting",args:{user:t},callback:function(r){if(r=r.message,r){var n=0;n<r.length&&e.email_password_prompt(r,t,n)}}})}email_password_prompt(t,e,r){var n=this;let a=t[r].email_id,s=new frappe.ui.Dialog({title:__("Password missing in Email Account"),fields:[{fieldname:"password",fieldtype:"Password",label:__("Please enter the password for: <b>{0}</b>",[a],"Email Account"),reqd:1},{fieldname:"submit",fieldtype:"Button",label:__("Submit",null,"Submit password for Email Account")}]});s.get_input("submit").on("click",function(){s.hide();var o=new frappe.ui.Dialog({title:__("Checking one moment"),fields:[{fieldtype:"HTML",fieldname:"checking"}]});o.fields_dict.checking.$wrapper.html('<i class="fa fa-spinner fa-spin fa-4x"></i>'),o.show(),frappe.call({method:"frappe.email.doctype.email_account.email_account.set_email_password",args:{email_account:t[r].email_account,password:s.get_value("password")},callback:function(l){o.hide(),s.hide(),l.message?r+1<t.length&&(r=r+1,n.email_password_prompt(t,e,r)):(frappe.show_alert({message:__("Login Failed please try again"),indicator:"error"},5),n.email_password_prompt(t,e,r))}})}),s.show()}load_bootinfo(){frappe.boot?(this.setup_workspaces(),frappe.model.sync(frappe.boot.docs),this.check_metadata_cache_status(),this.set_globals(),this.sync_pages(),frappe.router.setup(),this.setup_moment(),frappe.boot.print_css&&frappe.dom.set_style(frappe.boot.print_css,"print-style"),frappe.user.name=frappe.boot.user.name,frappe.router.setup()):this.set_as_guest()}setup_workspaces(){frappe.modules={},frappe.workspaces={};for(let t of frappe.boot.allowed_workspaces||[])frappe.modules[t.module]=t,frappe.workspaces[frappe.router.slug(t.name)]=t}load_user_permissions(){frappe.defaults.update_user_permissions(),frappe.realtime.on("update_user_permissions",frappe.utils.debounce(()=>{frappe.defaults.update_user_permissions()},500))}check_metadata_cache_status(){frappe.boot.metadata_version!=localStorage.metadata_version&&(frappe.assets.clear_local_storage(),frappe.assets.init_local_storage())}set_globals(){frappe.session.user=frappe.boot.user.name,frappe.session.logged_in_user=frappe.boot.user.name,frappe.session.user_email=frappe.boot.user.email,frappe.session.user_fullname=frappe.user_info().fullname,frappe.user_defaults=frappe.boot.user.defaults,frappe.user_roles=frappe.boot.user.roles,frappe.sys_defaults=frappe.boot.sysdefaults,frappe.ui.py_date_format=frappe.boot.sysdefaults.date_format.replace("dd","%d").replace("mm","%m").replace("yyyy","%Y"),frappe.boot.user.last_selected_values={},Object.defineProperties(window,{user:{get:function(){return console.warn("Please use `frappe.session.user` instead of `user`. It will be deprecated soon."),frappe.session.user}},user_fullname:{get:function(){return console.warn("Please use `frappe.session.user_fullname` instead of `user_fullname`. It will be deprecated soon."),frappe.session.user}},user_email:{get:function(){return console.warn("Please use `frappe.session.user_email` instead of `user_email`. It will be deprecated soon."),frappe.session.user_email}},user_defaults:{get:function(){return console.warn("Please use `frappe.user_defaults` instead of `user_defaults`. It will be deprecated soon."),frappe.user_defaults}},roles:{get:function(){return console.warn("Please use `frappe.user_roles` instead of `roles`. It will be deprecated soon."),frappe.user_roles}},sys_defaults:{get:function(){return console.warn("Please use `frappe.sys_defaults` instead of `sys_defaults`. It will be deprecated soon."),frappe.user_roles}}})}sync_pages(){if(localStorage.page_info){frappe.boot.allowed_pages=[];var t=JSON.parse(localStorage.page_info);$.each(frappe.boot.page_info,function(e,r){(!t[e]||t[e].modified!=r.modified)&&delete localStorage["_page:"+e],frappe.boot.allowed_pages.push(e)})}else frappe.boot.allowed_pages=Object.keys(frappe.boot.page_info);localStorage.page_info=JSON.stringify(frappe.boot.page_info)}set_as_guest(){frappe.session.user="Guest",frappe.session.user_email="",frappe.session.user_fullname="Guest",frappe.user_defaults={},frappe.user_roles=["Guest"],frappe.sys_defaults={}}make_page_container(){$("#body").length&&($(".splash").remove(),frappe.temp_container=$("<div id='temp-container' style='display: none;'>").appendTo("body"),frappe.container=new frappe.views.Container)}make_nav_bar(){frappe.boot&&frappe.boot.home_page!=="setup-wizard"&&(frappe.frappe_toolbar=new frappe.ui.toolbar.Toolbar)}logout(){var t=this;return t.logged_out=!0,frappe.call({method:"logout",callback:function(e){e.exc||t.redirect_to_login()}})}handle_session_expired(){if(!frappe.app.session_expired_dialog){var t=new frappe.ui.Dialog({title:__("Session Expired"),keep_open:!0,fields:[{fieldtype:"Password",fieldname:"password",label:__("Please Enter Your Password to Continue")}],onhide:()=>{t.logged_in||frappe.app.redirect_to_login()}});t.set_primary_action(__("Login"),()=>{t.set_message(__("Authenticating...")),frappe.call({method:"login",args:{usr:frappe.session.user,pwd:t.get_values().password},callback:e=>{e.message==="Logged In"&&(t.logged_in=!0,$(".modal-backdrop").css({opacity:"","background-color":"#334143"})),t.hide()},statusCode:()=>{t.hide()}})}),frappe.app.session_expired_dialog=t}frappe.app.session_expired_dialog.display||(frappe.app.session_expired_dialog.show(),$(".modal-backdrop").css({opacity:1,"background-color":"#4B4C9D"}))}redirect_to_login(){window.location.href="/"}set_favicon(){var t=$('link[type="image/x-icon"]').remove().attr("href");$('<link rel="shortcut icon" href="'+t+'" type="image/x-icon">').appendTo("head"),$('<link rel="icon" href="'+t+'" type="image/x-icon">').appendTo("head")}trigger_primary_action(){$(document.activeElement).blur(),setTimeout(()=>{window.cur_dialog&&cur_dialog.display?cur_dialog.get_primary_btn().trigger("click"):cur_frm&&cur_frm.page.btn_primary.is(":visible")?cur_frm.page.btn_primary.trigger("click"):frappe.container.page.save_action&&frappe.container.page.save_action()},100)}show_change_log(){var t=this;let e=frappe.boot.change_log;if(console.log("change_log"),console.log(e),!(!Array.isArray(e)||!e.length||window.Cypress||cint(frappe.boot.sysdefaults.disable_change_log_notification))){var r=frappe.msgprint({message:frappe.render_template("change_log",{change_log:e}),title:__("Updated To A New Version \u{1F389}"),wide:!0});r.keep_open=!0,r.custom_onhide=function(){frappe.call({method:"frappe.utils.change_log.update_last_known_versions"}),t.show_notes()}}}show_update_available(){frappe.boot.sysdefaults.disable_system_update_notification||frappe.call({method:"frappe.utils.change_log.show_update_popup"})}setup_analytics(){window.mixpanel&&(window.mixpanel.identify(frappe.session.user),window.mixpanel.people.set({$first_name:frappe.boot.user.first_name,$last_name:frappe.boot.user.last_name,$created:frappe.boot.user.creation,$email:frappe.session.user}))}add_browser_class(){$("html").addClass(frappe.utils.get_browser().name.toLowerCase())}set_fullwidth_if_enabled(){frappe.ui.toolbar.set_fullwidth_if_enabled()}show_notes(){var t=this;frappe.boot.notes.length&&frappe.boot.notes.forEach(function(e){if(!e.seen||e.notify_on_every_login){var r=frappe.msgprint({message:e.content,title:e.title});r.keep_open=!0,r.custom_onhide=function(){e.seen=!0,e.notify_on_every_login||frappe.call({method:"frappe.desk.doctype.note.note.mark_as_seen",args:{note:e.name}}),t.show_notes()}}})}setup_build_events(){frappe.boot.developer_mode&&frappe.require("build_events.bundle.js")}setup_energy_point_listeners(){frappe.realtime.on("energy_point_alert",t=>{frappe.show_alert(t)})}setup_copy_doc_listener(){$("body").on("paste",t=>{try{let e=frappe.utils.get_clipboard_data(t),r=JSON.parse(e);if(r.doctype){t.preventDefault();let n=frappe.utils.sleep;frappe.dom.freeze(__("Creating {0}",[r.doctype])+"..."),n(500).then(()=>{let a=frappe.model.with_doctype(r.doctype,()=>{let s=frappe.model.copy_doc(r);s.__newname=r.name,delete r.name,s.idx=null,s.__run_link_triggers=!1,frappe.set_route("Form",s.doctype,s.name),frappe.dom.unfreeze()});a&&a.fail(frappe.dom.unfreeze)})}}catch(e){}})}setup_moment(){moment.updateLocale("en",{week:{dow:frappe.datetime.get_first_day_of_the_week_index()}}),moment.locale("en"),moment.user_utc_offset=moment().utcOffset(),frappe.boot.timezone_info&&moment.tz.add(frappe.boot.timezone_info)}};frappe.get_module=function(i,t){var e=frappe.modules[i]||t;if(!!e)return e._setup||(e.label||(e.label=i),e._label||(e._label=__(e.label)),e._setup=!0),e};frappe.provide("frappe.utils");function L0(i){return rf()[i]||""}function B0(i){return i.includes("?")?i.slice(i.indexOf("?")+1):""}function rf(i){var t={};i||(i=location.search.substring(1));for(var e=i.split("&"),r=0,n=e.length;r<n;r++){var a=e[r].split(/=(.+)/),s=a[0];if(!!s){var o=a[1];if(typeof o=="string"){o=o.replace(/\+/g,"%20");try{o=decodeURIComponent(o)}catch(l){}}s in t?(typeof t[s]=="undefined"?t[s]=[]:typeof t[s]=="string"&&(t[s]=[t[s]]),t[s].push(o)):t[s]=o}}return t}function I0(i,t=!0){let e=[];for(let r in i){let n=i[r];n===void 0||n===""||n===null||(typeof n=="object"&&(n=JSON.stringify(n)),t&&(r=encodeURIComponent(r),n=encodeURIComponent(n)),e.push(`${r}=${n}`))}return"?"+e.join("&")}Object.assign(frappe.utils,{get_url_arg:L0,get_query_string:B0,get_query_params:rf,make_query_string:I0});frappe.provide("frappe.energy_points");Object.assign(frappe.energy_points,{get_points(i){return`<span class="bold" style="color: ${i>=0?"#45A163":"#e42121"}">
			${i>0?"+":""}${i}
		</span>`},format_form_log(i){let t="<span>&nbsp;-&nbsp;</span>";return`<span>
			<!--${this.get_points(i.points)}&nbsp;-->
			<a href="/app/energy-point-log/${i.name}">${this.get_form_log_message(i)}</a>
			${i.reason?t+i.reason:""}
		</span>`},format_history_log(i){let t="<span>&nbsp;-&nbsp;</span>",e=frappe.utils.get_form_link(i.reference_doctype,i.reference_name);return`<div class="flex">
			<span class="${i.points>=0?"green":"red"} mr-2">
				${this.get_points(i.points)}
			</span>
			<a href="${e}" class="text-muted">${this.get_history_log_message(i)}</a>
			${i.reason?t+i.reason:""}
			${t+frappe.datetime.comment_when(i.creation)}
		</div>`},get_history_log_message(i){let t=frappe.user.full_name(i.owner).bold(),e=i.reference_name;return i.type==="Appreciation"?__("{0} appreciated on {1}",[t,e]):i.type==="Criticism"?__("{0} criticized on {1}",[t,e]):i.type==="Revert"?__("{0} reverted {1}",[t,i.revert_of]):__("via automatic rule {0} on {1}",[i.rule.bold(),e])},get_form_log_message(i){let t=frappe.user.full_name(i.owner).bold(),e=frappe.user.full_name(i.user).bold();return i.type==="Appreciation"?__("{0} appreciated {1}",[t,e]):i.type==="Criticism"?__("{0} criticized {1}",[t,e]):i.type==="Revert"?__("{0} reverted {1}",[t,i.revert_of]):__("gained by {0} via automatic rule {1}",[e,i.rule.bold()])}});var h$=Ut(nf());function Bn(i){return(Bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(i)}function pi(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function af(i,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,r.key,r)}}function vi(i,t,e){return t&&af(i.prototype,t),e&&af(i,e),i}function Gi(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&wf(i,t)}function Wt(i){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(i)}function wf(i,t){return(wf=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(i,t)}function M0(i,t){return!t||typeof t!="object"&&typeof t!="function"?function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i):t}function Xi(i){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var e,r=Wt(i);if(t){var n=Wt(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return M0(this,e)}}function ci(i,t,e){return(ci=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(r,n,a){var s=function(l,u){for(;!Object.prototype.hasOwnProperty.call(l,u)&&(l=Wt(l))!==null;);return l}(r,n);if(s){var o=Object.getOwnPropertyDescriptor(s,n);return o.get?o.get.call(a):o.value}})(i,t,e||i)}function Mt(i,t){return function(e){if(Array.isArray(e))return e}(i)||function(e,r){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(e)))){var n=[],a=!0,s=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(a=(l=u.next()).done)&&(n.push(l.value),!r||n.length!==r);a=!0);}catch(c){s=!0,o=c}finally{try{a||u.return==null||u.return()}finally{if(s)throw o}}return n}}(i,t)||kf(i,t)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ui(i){return function(t){if(Array.isArray(t))return Qa(t)}(i)||function(t){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(t))return Array.from(t)}(i)||kf(i)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function kf(i,t){if(i){if(typeof i=="string")return Qa(i,t);var e=Object.prototype.toString.call(i).slice(8,-1);return e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set"?Array.from(i):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Qa(i,t):void 0}}function Qa(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,r=new Array(t);e<t;e++)r[e]=i[e];return r}function ki(i,t){return typeof i=="string"?(t||document).querySelector(i):i||null}function Rn(i){var t=i.getBoundingClientRect();return{top:t.top+(document.documentElement.scrollTop||document.body.scrollTop),left:t.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function N0(i){return i.offsetParent===null}function P0(i){var t=i.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(function(i,t){t===void 0&&(t={});var e=t.insertAt;if(i&&typeof document!="undefined"){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i))}})(`:root {
  --charts-label-color: #313b44;
  --charts-axis-line-color: #f4f5f6;
  --charts-tooltip-title: var(--charts-label-color);
  --charts-tooltip-label: var(--charts-label-color);
  --charts-tooltip-value: #192734;
  --charts-tooltip-bg: #ffffff;
  --charts-stroke-width: 2px;
  --charts-dataset-circle-stroke: #ffffff;
  --charts-dataset-circle-stroke-width: var(--charts-stroke-width);
  --charts-legend-label: var(--charts-label-color);
  --charts-legend-value: var(--charts-label-color); }

.chart-container {
  position: relative;
  /* for absolutely positioned tooltip */
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif; }
  .chart-container .axis,
  .chart-container .chart-label {
    fill: var(--charts-label-color); }
    .chart-container .axis line,
    .chart-container .chart-label line {
      stroke: var(--charts-axis-line-color); }
  .chart-container .dataset-units circle {
    stroke: var(--charts-dataset-circle-stroke);
    stroke-width: var(--charts-dataset-circle-stroke-width); }
  .chart-container .dataset-units path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container .dataset-path {
    stroke-width: var(--charts-stroke-width); }
  .chart-container .path-group path {
    fill: none;
    stroke-opacity: 1;
    stroke-width: var(--charts-stroke-width); }
  .chart-container line.dashed {
    stroke-dasharray: 5, 3; }
  .chart-container .axis-line .specific-value {
    text-anchor: start; }
  .chart-container .axis-line .y-line {
    text-anchor: end; }
  .chart-container .axis-line .x-line {
    text-anchor: middle; }
  .chart-container .legend-dataset-label {
    fill: var(--charts-legend-label);
    font-weight: 600; }
  .chart-container .legend-dataset-value {
    fill: var(--charts-legend-value); }

.graph-svg-tip {
  position: absolute;
  z-index: 99999;
  padding: 10px;
  font-size: 12px;
  text-align: center;
  background: var(--charts-tooltip-bg);
  box-shadow: 0px 1px 4px rgba(17, 43, 66, 0.1), 0px 2px 6px rgba(17, 43, 66, 0.08), 0px 40px 30px -30px rgba(17, 43, 66, 0.1);
  border-radius: 6px; }
  .graph-svg-tip ul {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ol {
    padding-left: 0;
    display: flex; }
  .graph-svg-tip ul.data-point-list li {
    min-width: 90px;
    font-weight: 600; }
  .graph-svg-tip .svg-pointer {
    position: absolute;
    height: 12px;
    width: 12px;
    border-radius: 2px;
    background: var(--charts-tooltip-bg);
    transform: rotate(45deg);
    margin-top: -7px;
    margin-left: -6px; }
  .graph-svg-tip.comparison {
    text-align: left;
    padding: 0px;
    pointer-events: none; }
    .graph-svg-tip.comparison .title {
      display: block;
      padding: 16px;
      margin: 0;
      color: var(--charts-tooltip-title);
      font-weight: 600;
      line-height: 1;
      pointer-events: none;
      text-transform: uppercase; }
      .graph-svg-tip.comparison .title strong {
        color: var(--charts-tooltip-value); }
    .graph-svg-tip.comparison ul {
      margin: 0;
      white-space: nowrap;
      list-style: none; }
      .graph-svg-tip.comparison ul.tooltip-grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 5px; }
    .graph-svg-tip.comparison li {
      display: inline-block;
      display: flex;
      flex-direction: row;
      font-weight: 600;
      line-height: 1;
      padding: 5px 15px 15px 15px; }
      .graph-svg-tip.comparison li .tooltip-legend {
        height: 12px;
        width: 12px;
        margin-right: 8px;
        border-radius: 2px; }
      .graph-svg-tip.comparison li .tooltip-label {
        margin-top: 4px;
        font-size: 11px;
        line-height: 1.25;
        max-width: 150px;
        white-space: normal;
        color: var(--charts-tooltip-label); }
      .graph-svg-tip.comparison li .tooltip-value {
        color: var(--charts-tooltip-value); }
`),ki.create=function(i,t){var e=document.createElement(i);for(var r in t){var n=t[r];if(r==="inside")ki(n).appendChild(e);else if(r==="around"){var a=ki(n);a.parentNode.insertBefore(e,a),e.appendChild(a)}else r==="styles"?Bn(n)==="object"&&Object.keys(n).map(function(s){e.style[s]=n[s]}):r in e?e[r]=n:e.setAttribute(r,n)}return e};var D0={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function Ln(i){return i.titleHeight+i.margins.top+i.paddings.top}function On(i){return i.margins.left+i.paddings.left}function ss(i){return i.margins.top+i.margins.bottom+i.paddings.top+i.paddings.bottom+i.titleHeight+i.legendHeight}function es(i){return i.margins.left+i.margins.right+i.paddings.left+i.paddings.right}var wr=["pink","blue","green","grey","red","yellow","purple","teal","cyan","orange"],j0={bar:wr,line:wr,pie:wr,percentage:wr,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:wr},sf=Math.PI/180,z0=function(){function i(t){var e=t.parent,r=e===void 0?null:e,n=t.colors,a=n===void 0?[]:n;pi(this,i),this.parent=r,this.colors=a,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}return vi(i,[{key:"setup",value:function(){this.makeTooltip()}},{key:"refresh",value:function(){this.fill(),this.calcPosition()}},{key:"makeTooltip",value:function(){var t=this;this.container=ki.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:`<span class="title"></span>
				<ul class="data-point-list"></ul>
				<div class="svg-pointer"></div>`}),this.hideTip(),this.title=this.container.querySelector(".title"),this.list=this.container.querySelector(".data-point-list"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",function(){t.hideTip()})}},{key:"fill",value:function(){var t,e=this;this.index&&this.container.setAttribute("data-point-index",this.index),t=this.titleValueFirst?"<strong>".concat(this.titleValue,"</strong>").concat(this.titleName):"".concat(this.titleName,"<strong>").concat(this.titleValue,"</strong>"),this.listValues.length>4?this.list.classList.add("tooltip-grid"):this.list.classList.remove("tooltip-grid"),this.title.innerHTML=t,this.dataPointList.innerHTML="",this.listValues.map(function(r,n){var a=e.colors[n]||"black",s=r.formatted===0||r.formatted?r.formatted:r.value,o=ki.create("li",{innerHTML:'<div class="tooltip-legend" style="background: '.concat(a,`;"></div>
					<div>
						<div class="tooltip-value">`).concat(s===0||s?s:"",`</div>
						<div class="tooltip-label">`).concat(r.title?r.title:"",`</div>
					</div>`)});e.dataPointList.appendChild(o)})}},{key:"calcPosition",value:function(){var t=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-7.48,this.left=this.x-t/2;var e=this.parent.offsetWidth-t,r=this.container.querySelector(".svg-pointer");if(this.left<0)r.style.left="calc(50% - ".concat(-1*this.left,"px)"),this.left=0;else if(this.left>e){var n=this.left-e,a="calc(50% + ".concat(n,"px)");r.style.left=a,this.left=e}else r.style.left="50%"}},{key:"setValues",value:function(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;this.titleName=r.name,this.titleValue=r.value,this.listValues=n,this.x=t,this.y=e,this.titleValueFirst=r.valueFirst||0,this.index=a,this.refresh()}},{key:"hideTip",value:function(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}},{key:"showTip",value:function(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}]),i}();function xf(i){return parseFloat(i.toFixed(2))}function ts(i,t,e){var r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];e||(e=r?i[0]:i[i.length-1]);var n=new Array(Math.abs(t)).fill(e);return i=r?n.concat(i):i.concat(n)}function of(i,t){return(i+"").length*t}function Xa(i,t){return{x:Math.sin(i*sf)*t,y:Math.cos(i*sf)*t}}function Oi(i){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return!Number.isNaN(i)&&i!==void 0&&!!Number.isFinite(i)&&!(t&&i<0)}function Cf(i){return Number(Math.round(i+"e4")+"e-4")}function is(i){var t,e,r;if(i instanceof Date)return new Date(i.getTime());if(Bn(i)!=="object"||i===null)return i;for(r in t=Array.isArray(i)?[]:{},i)e=i[r],t[r]=is(e);return t}function lf(i,t){var e,r;return i<=t?(e=t-i,r=i):(e=i-t,r=t),[e,r]}function Gt(i,t){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t.length-i.length;return e>0?i=ts(i,e):t=ts(t,e),[i,t]}function F0(i,t){if(i)return i.length>t?i.slice(0,t-3)+"...":i}function H0(i){var t;if(typeof i=="number")t=i;else if(typeof i=="string"&&(t=Number(i),Number.isNaN(t)))return i;var e=Math.floor(Math.log10(Math.abs(t)));if(e<=2)return t;var r=Math.floor(e/3),n=Math.pow(10,e-3*r)*+(t/Math.pow(10,e)).toFixed(1);return Math.round(100*n)/100+["","K","M","B","T"][r]}function cf(i,t){for(var e=[],r=(Math.min(i.length,t.length),0);r<i.length;r++)e.push([i[r],t[r]]);var n=function(a,s,o,l){var u,c,h,p,g=(u=s||a,h=(c=o||a)[0]-u[0],p=c[1]-u[1],{length:Math.sqrt(Math.pow(h,2)+Math.pow(p,2)),angle:Math.atan2(p,h)}),b=g.angle+(l?Math.PI:0),v=.2*g.length;return[a[0]+Math.cos(b)*v,a[1]+Math.sin(b)*v]};return function(a,s){return a.reduce(function(o,l,u,c){return u===0?"".concat(l[0],",").concat(l[1]):"".concat(o," ").concat(s(l,u,c))},"")}(e,function(a,s,o){var l=n(o[s-1],o[s-2],a),u=n(a,o[s-1],o[s+1],!0);return"C ".concat(l[0],",").concat(l[1]," ").concat(u[0],",").concat(u[1]," ").concat(a[0],",").concat(a[1])})}function uf(i,t){return typeof i=="string"?(t||document).querySelector(i):i||null}function ut(i,t){var e=document.createElementNS("http://www.w3.org/2000/svg",i);for(var r in t){var n=t[r];if(r==="inside")uf(n).appendChild(e);else if(r==="around"){var a=uf(n);a.parentNode.insertBefore(e,a),e.appendChild(a)}else r==="styles"?Bn(n)==="object"&&Object.keys(n).map(function(s){e.style[s]=n[s]}):(r==="className"&&(r="class"),r==="innerHTML"?e.textContent=n:e.setAttribute(r,n))}return e}function q0(i,t){return ut("linearGradient",{inside:i,id:t,x1:0,x2:0,y1:0,y2:1})}function Ka(i,t,e,r){return ut("stop",{inside:i,style:"stop-color: ".concat(e),offset:t,"stop-opacity":r})}function rs(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,r={className:i,transform:t};return e&&(r.inside=e),ut("g",r)}function Vi(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"none",r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"none",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:2;return ut("path",{className:t,d:i,styles:{stroke:e,fill:r,"stroke-width":n}})}function U0(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=e.x+i.x,o=e.y+i.y,l=e.x+t.x,u=e.y+t.y;return"M".concat(e.x," ").concat(e.y,`
		L`).concat(s," ").concat(o,`
		A `).concat(r," ").concat(r," 0 ").concat(a," ").concat(n?1:0,`
		`).concat(l," ").concat(u," z")}function W0(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=e.x+i.x,o=e.y+i.y,l=e.x+t.x,u=2*e.y,c=e.y+t.y;return"M".concat(e.x," ").concat(e.y,`
		L`).concat(s," ").concat(o,`
		A `).concat(r," ").concat(r," 0 ").concat(a," ").concat(n?1:0,`
		`).concat(l," ").concat(u,` z
		L`).concat(s," ").concat(u,`
		A `).concat(r," ").concat(r," 0 ").concat(a," ").concat(n?1:0,`
		`).concat(l," ").concat(c," z")}function V0(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=e.x+i.x,o=e.y+i.y,l=e.x+t.x,u=e.y+t.y;return"M".concat(s," ").concat(o,`
		A `).concat(r," ").concat(r," 0 ").concat(a," ").concat(n?1:0,`
		`).concat(l," ").concat(u)}function Y0(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=e.x+i.x,o=e.y+i.y,l=e.x+t.x,u=2*r+o,c=e.y+i.y;return"M".concat(s," ").concat(o,`
		A `).concat(r," ").concat(r," 0 ").concat(a," ").concat(n?1:0,`
		`).concat(l," ").concat(u,`
		M`).concat(s," ").concat(u,`
		A `).concat(r," ").concat(r," 0 ").concat(a," ").concat(n?1:0,`
		`).concat(l," ").concat(c)}function df(i,t){var e=arguments.length>2&&arguments[2]!==void 0&&arguments[2],r="path-fill-gradient-"+t+"-"+(e?"lighter":"default"),n=q0(i,r),a=[1,.6,.2];return e&&(a=[.15,.05,0]),Ka(n,"0%",t,a[0]),Ka(n,"50%",t,a[1]),Ka(n,"100%",t,a[2]),r}function G0(i,t,e){var r=e/2,n=t-r;return"M".concat(i,",0 h").concat(n," q").concat(r,",0 ").concat(r,",").concat(r," q0,").concat(r," -").concat(r,",").concat(r," h-").concat(n," v").concat(e,"z")}function X0(i,t,e){var r=e/2,n=t-r;return"M".concat(i+r,",0 h").concat(n," v").concat(e," h-").concat(n," q-").concat(r,", 0 -").concat(r,",-").concat(r," q0,-").concat(r," ").concat(r,",-").concat(r,"z")}function Sf(i,t,e,r,n){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"none",s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:{},o={className:i,x:t,y:e,width:r,height:r,rx:n,fill:a};return Object.keys(s).map(function(l){o[l]=s[l]}),ut("rect",o)}function Tf(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"none",a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:null,l=arguments.length>8&&arguments[8]!==void 0&&arguments[8];o||(o=10);var u={className:"legend-dot",x:0,y:4-e,height:e,width:e,rx:r,fill:n},c=ut("text",{className:"legend-dataset-label",x:e,y:0,dx:o+"px",dy:o/3+"px","font-size":1.6*o+"px","text-anchor":"start",innerHTML:a=l?F0(a,18):a}),h=null;s&&(h=ut("text",{className:"legend-dataset-value",x:e,y:20,dx:"10px",dy:10/3+"px","font-size":"12px","text-anchor":"start",innerHTML:s}));var p=ut("g",{transform:"translate(".concat(i,", ").concat(t,")")});return p.appendChild(ut("rect",u)),p.appendChild(c),s&&h&&p.appendChild(h),p}function Sr(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},a=n.fontSize||10,s=n.dy!==void 0?n.dy:a/2,o=n.fill||"var(--charts-label-color)",l=n.textAnchor||"start";return ut("text",{className:i,x:t,y:e,dy:s+"px","font-size":a+"px",fill:o,"text-anchor":l,innerHTML:r})}function K0(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},a=ut("line",{className:"line-vertical "+n.className,x1:0,x2:0,y1:e,y2:r,styles:{stroke:n.stroke}}),s=ut("text",{x:0,y:e>r?e+4:e-4-10,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:t+""}),o=ut("g",{transform:"translate(".concat(i,", 0)")});return o.appendChild(a),o.appendChild(s),o}function ff(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};n.lineType||(n.lineType=""),n.shortenNumbers&&(t=n.numberFormatter?n.numberFormatter(t):H0(t));var a="line-horizontal "+n.className+(n.lineType==="dashed"?"dashed":""),s=ut("line",{className:a,x1:e,x2:r,y1:0,y2:0,styles:{stroke:n.stroke}}),o=ut("text",{x:e<r?e-4:e+4,y:0,dy:"3px","font-size":"10px","text-anchor":e<r?"end":"start",innerHTML:t+""}),l=ut("g",{transform:"translate(0, ".concat(i,")"),"stroke-opacity":1});return o!==0&&o!=="0"||(l.style.stroke="rgba(27, 31, 35, 0.6)"),l.appendChild(s),l.appendChild(o),l}function pf(i,t,e,r){var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,s=arguments.length>6&&arguments[6]!==void 0&&arguments[6],o=ut("circle",{style:"fill: ".concat(r,"; ").concat(s?"stroke: ".concat(r):""),"data-point-index":a,cx:i,cy:t,r:e});if((n+="")||n.length){o.setAttribute("cy",0),o.setAttribute("cx",0);var l=ut("text",{className:"data-point-value",x:0,y:0,dy:-5-e+"px","font-size":"10px","text-anchor":"middle",innerHTML:n}),u=ut("g",{"data-point-index":a,transform:"translate(".concat(i,", ").concat(t,")")});return u.appendChild(o),u.appendChild(l),u}return o}var J0={bar:function(i){var t;i.nodeName!=="rect"&&(t=i.getAttribute("transform"),i=i.childNodes[0]);var e=i.cloneNode();return e.style.fill="#000000",e.style.opacity="0.4",t&&e.setAttribute("transform",t),e},dot:function(i){var t;i.nodeName!=="circle"&&(t=i.getAttribute("transform"),i=i.childNodes[0]);var e=i.cloneNode(),r=i.getAttribute("r"),n=i.getAttribute("fill");return e.setAttribute("r",parseInt(r)+4),e.setAttribute("fill",n),e.style.opacity="0.6",t&&e.setAttribute("transform",t),e},heat_square:function(i){var t;i.nodeName!=="circle"&&(t=i.getAttribute("transform"),i=i.childNodes[0]);var e=i.cloneNode(),r=i.getAttribute("r"),n=i.getAttribute("fill");return e.setAttribute("r",parseInt(r)+4),e.setAttribute("fill",n),e.style.opacity="0.6",t&&e.setAttribute("transform",t),e}},Z0={bar:function(i,t){var e;i.nodeName!=="rect"&&(e=i.getAttribute("transform"),i=i.childNodes[0]);var r=["x","y","width","height"];Object.values(i.attributes).filter(function(n){return r.includes(n.name)&&n.specified}).map(function(n){t.setAttribute(n.name,n.nodeValue)}),e&&t.setAttribute("transform",e)},dot:function(i,t){var e;i.nodeName!=="circle"&&(e=i.getAttribute("transform"),i=i.childNodes[0]);var r=["cx","cy"];Object.values(i.attributes).filter(function(n){return r.includes(n.name)&&n.specified}).map(function(n){t.setAttribute(n.name,n.nodeValue)}),e&&t.setAttribute("transform",e)},heat_square:function(i,t){var e;i.nodeName!=="circle"&&(e=i.getAttribute("transform"),i=i.childNodes[0]);var r=["cx","cy"];Object.values(i.attributes).filter(function(n){return r.includes(n.name)&&n.specified}).map(function(n){t.setAttribute(n.name,n.nodeValue)}),e&&t.setAttribute("transform",e)}},Q0={pink:"#F683AE",blue:"#318AD8",green:"#48BB74",grey:"#A6B1B9",red:"#F56B6B",yellow:"#FACF7A",purple:"#44427B",teal:"#5FD8C4",cyan:"#15CCEF",orange:"#F8814F","light-pink":"#FED7E5","light-blue":"#BFDDF7","light-green":"#48BB74","light-grey":"#F4F5F6","light-red":"#F6DFDF","light-yellow":"#FEE9BF","light-purple":"#E8E8F7","light-teal":"#D3FDF6","light-cyan":"#DDF8FD","light-orange":"#FECDB8"};function xr(i,t,e,r){var n=typeof t=="string"?t:t.join(", ");return[i,{transform:e.join(", ")},r,"easein","translate",{transform:n}]}function hf(i,t,e){return xr(i,[0,e],[0,t],350)}function _f(i,t){return[i,{d:t},350,"easein"]}var ek={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function tk(i,t,e){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"linear",n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:void 0,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=i.cloneNode(!0),o=i.cloneNode(!0);for(var l in t){var u=void 0;u=l==="transform"?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");var c=a[l]||i.getAttribute(l),h=t[l],p={attributeName:l,from:c,to:h,begin:"0s",dur:e/1e3+"s",values:c+";"+h,keySplines:ek[r],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var g in n&&(p.type=n),p)u.setAttribute(g,p[g]);s.appendChild(u),n?o.setAttribute(l,"translate(".concat(h,")")):o.setAttribute(l,h)}return[s,o]}function ns(i,t){i.style.transform=t,i.style.webkitTransform=t,i.style.msTransform=t,i.style.mozTransform=t,i.style.oTransform=t}function ik(i,t){var e=[],r=[];t.map(function(a){var s,o,l=a[0],u=l.parentNode;a[0]=l;var c=Mt(tk.apply(void 0,ui(a)),2);s=c[0],o=c[1],e.push(o),r.push([s,u]),u.replaceChild(s,l)});var n=i.cloneNode(!0);return r.map(function(a,s){a[1].replaceChild(e[s],a[0]),t[s][0]=e[s]}),n}function rk(i,t,e){if(e.length!==0){var r=ik(t,e);t.parentNode==i&&(i.removeChild(t),i.appendChild(r)),setTimeout(function(){r.parentNode==i&&(i.removeChild(r),i.appendChild(t))},250)}}var os=function(){function i(t,e){if(pi(this,i),e=is(e),this.parent=typeof t=="string"?document.querySelector(t):t,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=e,this.title=e.title||"",this.type=e.type||"",this.realData=this.prepareData(e.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(e.colors,this.type),this.config={showTooltip:1,showLegend:e.showLegend!==void 0?e.showLegend:1,isNavigable:e.isNavigable||0,animate:e.animate!==void 0?e.animate:1,disableEntryAnimation:e.disableEntryAnimation||0,truncateLegends:e.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(D0));var r=this.measures;this.setMeasures(e),this.title.length||(r.titleHeight=0),this.config.showLegend||(r.legendHeight=0),this.argHeight=e.height||r.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(e)}return vi(i,[{key:"prepareData",value:function(t){return t}},{key:"prepareFirstData",value:function(t){return t}},{key:"validateColors",value:function(t,e){var r=[];return(t=(t||[]).concat(j0[e])).forEach(function(n){var a=function(s){return/rgb[a]{0,1}\([\d, ]+\)/gim.test(s)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(s).map(function(o,l){return l!==0?Number(o).toString(16):"#"}).reduce(function(o,l){return"".concat(o).concat(l)}):Q0[s]||s}(n);(function(s){return/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(s)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(s)})(a)?r.push(a):console.warn('"'+n+'" is not a valid color.')}),r}},{key:"setMeasures",value:function(){}},{key:"configure",value:function(){var t=this,e=this.argHeight;this.baseHeight=e,this.height=e-ss(this.measures),this.boundDrawFn=function(){return t.draw(!0)},ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}},{key:"destroy",value:function(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}},{key:"setup",value:function(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}},{key:"makeContainer",value:function(){this.parent.innerHTML="";var t={inside:this.parent,className:"chart-container"};this.independentWidth&&(t.styles={width:this.independentWidth+"px"}),this.container=ki.create("div",t)}},{key:"makeTooltip",value:function(){this.tip=new z0({parent:this.container,colors:this.colors}),this.bindTooltip()}},{key:"bindTooltip",value:function(){}},{key:"draw",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],r=arguments.length>1&&arguments[1]!==void 0&&arguments[1];e&&N0(this.parent)||(this.updateWidth(),this.calc(e),this.makeChartArea(),this.setupComponents(),this.components.forEach(function(n){return n.setup(t.drawArea)}),this.render(this.components,!1),r&&(this.data=this.realData,setTimeout(function(){t.update(t.data,!0)},this.initTimeout)),this.config.showLegend&&this.renderLegend(),this.setupNavigation(r))}},{key:"calc",value:function(){}},{key:"updateWidth",value:function(){var t,e,r;this.baseWidth=(t=this.parent,e=window.getComputedStyle(t),r=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight),t.clientWidth-r),this.width=this.baseWidth-es(this.measures)}},{key:"makeChartArea",value:function(){this.svg&&this.container.removeChild(this.svg);var t,e,r,n,a=this.measures;this.svg=(t=this.container,e="frappe-chart chart",r=this.baseWidth,n=this.baseHeight,ut("svg",{className:e,inside:t,width:r,height:n})),this.svgDefs=ut("defs",{inside:this.svg}),this.title.length&&(this.titleEL=Sr("title",a.margins.left,a.margins.top,this.title,{fontSize:a.titleFontSize,fill:"#666666",dy:a.titleFontSize}));var s=Ln(a);this.drawArea=rs(this.type+"-chart chart-draw-area","translate(".concat(On(a),", ").concat(s,")")),this.config.showLegend&&(s+=this.height+a.paddings.bottom,this.legendArea=rs("chart-legend","translate(".concat(On(a),", ").concat(s,")"))),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(On(a),Ln(a))}},{key:"updateTipOffset",value:function(t,e){this.tip.offset={x:t,y:e}}},{key:"setupComponents",value:function(){this.components=new Map}},{key:"update",value:function(t){var e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];t||console.error("No data to update."),e||(t=is(t));var r=e?!this.config.disableEntryAnimation:this.config.animate;this.data=this.prepareData(t),this.calc(),this.render(this.components,r)}},{key:"render",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.components,r=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.config.isNavigable&&this.overlays.map(function(a){return a.parentNode.removeChild(a)});var n=[];e.forEach(function(a){n=n.concat(a.update(r))}),n.length>0?(rk(this.container,this.svg,n),setTimeout(function(){e.forEach(function(a){return a.make()}),t.updateNav()},400)):(e.forEach(function(a){return a.make()}),this.updateNav())}},{key:"updateNav",value:function(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}},{key:"renderLegend",value:function(t){var e=this;this.legendArea.textContent="";var r=0,n=0;t.map(function(a,s){var o=Math.floor(e.width/150);r>o&&(r=0,n+=e.config.legendRowHeight);var l=150*r,u=e.makeLegend(a,s,l,n);e.legendArea.appendChild(u),r++})}},{key:"makeLegend",value:function(){}},{key:"setupNavigation",value:function(){var t=this,e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.config.isNavigable&&e&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",function(r){P0(t.container)&&(r=r||window.event,t.keyActions[r.keyCode]&&t.keyActions[r.keyCode]())}))}},{key:"makeOverlay",value:function(){}},{key:"updateOverlay",value:function(){}},{key:"bindOverlay",value:function(){}},{key:"bindUnits",value:function(){}},{key:"onLeftArrow",value:function(){}},{key:"onRightArrow",value:function(){}},{key:"onUpArrow",value:function(){}},{key:"onDownArrow",value:function(){}},{key:"onEnterKey",value:function(){}},{key:"addDataPoint",value:function(){}},{key:"removeDataPoint",value:function(){}},{key:"getDataPoint",value:function(){}},{key:"setCurrentDataPoint",value:function(){}},{key:"updateDataset",value:function(){}},{key:"export",value:function(){var t=function(e){var r=e.cloneNode(!0);r.classList.add("chart-container"),r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");var n=ki.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});r.insertBefore(n,r.firstChild);var a=ki.create("div");return a.appendChild(r),a.innerHTML}(this.svg);(function(e,r){var n=document.createElement("a");n.style="display: none";var a=new Blob(r,{type:"image/svg+xml; charset=utf-8"}),s=window.URL.createObjectURL(a);n.href=s,n.download=e,document.body.appendChild(n),n.click(),setTimeout(function(){document.body.removeChild(n),window.URL.revokeObjectURL(s)},300)})(this.title||"Chart",[t])}}]),i}(),Ef=function(i){Gi(e,os);var t=Xi(e);function e(r,n){return pi(this,e),t.call(this,r,n)}return vi(e,[{key:"configure",value:function(r){ci(Wt(e.prototype),"configure",this).call(this,r),this.config.formatTooltipY=(r.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=r.maxSlices||20,this.config.maxLegendPoints=r.maxLegendPoints||20,this.config.legendRowHeight=60}},{key:"calc",value:function(){var r=this,n=this.state,a=this.config.maxSlices;n.sliceTotals=[];var s=this.data.labels.map(function(c,h){var p=0;return r.data.datasets.map(function(g){p+=g.values[h]}),[p,c]}).filter(function(c){return c[0]>=0}),o=s;if(s.length>a){s.sort(function(c,h){return h[0]-c[0]}),o=s.slice(0,a-1);var l=s.slice(a-1),u=0;l.map(function(c){u+=c[0]}),o.push([u,"Rest"]),this.colors[a-1]="grey"}n.labels=[],o.map(function(c){n.sliceTotals.push(Cf(c[0])),n.labels.push(c[1])}),n.grandTotal=n.sliceTotals.reduce(function(c,h){return c+h},0),this.center={x:this.width/2,y:this.height/2}}},{key:"renderLegend",value:function(){var r=this.state;this.legendArea.textContent="",this.legendTotals=r.sliceTotals.slice(0,this.config.maxLegendPoints),ci(Wt(e.prototype),"renderLegend",this).call(this,this.legendTotals)}},{key:"makeLegend",value:function(r,n,a,s){var o=this.config.formatTooltipY?this.config.formatTooltipY(r):r;return Tf(a,s,12,3,this.colors[n],this.state.labels[n],o,null,this.config.truncateLegends)}}]),e}(),nk=["January","February","March","April","May","June","July","August","September","October","November","December"],ak=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function mf(i){var t=new Date(i);return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t}function Ja(i){var t=i.getDate(),e=i.getMonth()+1;return[i.getFullYear(),(e>9?"":"0")+e,(t>9?"":"0")+t].join("-")}function Ri(i){return new Date(i.getTime())}function Za(i,t){var e=$f(i);return Math.ceil(function(r,n){return(mf(n)-mf(r))/864e5}(e,t)/7)}function sk(i,t){return i.getMonth()===t.getMonth()&&i.getFullYear()===t.getFullYear()}function Af(i){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],e=nk[i];return t?e.slice(0,3):e}function gf(i,t){return new Date(t,i+1,0)}function $f(i){var t=Ri(i),e=t.getDay();return e!==0&&Yi(t,-1*e),t}function Yi(i,t){i.setDate(i.getDate()+t)}var ok=function(){function i(t){var e=t.layerClass,r=e===void 0?"":e,n=t.layerTransform,a=n===void 0?"":n,s=t.constants,o=t.getData,l=t.makeElements,u=t.animateElements;pi(this,i),this.layerTransform=a,this.constants=s,this.makeElements=l,this.getData=o,this.animateElements=u,this.store=[],this.labels=[],this.layerClass=r,this.layerClass=typeof this.layerClass=="function"?this.layerClass():this.layerClass,this.refresh()}return vi(i,[{key:"refresh",value:function(t){this.data=t||this.getData()}},{key:"setup",value:function(t){this.layer=rs(this.layerClass,this.layerTransform,t)}},{key:"make",value:function(){this.render(this.data),this.oldData=this.data}},{key:"render",value:function(t){var e=this;this.store=this.makeElements(t),this.layer.textContent="",this.store.forEach(function(r){e.layer.appendChild(r)}),this.labels.forEach(function(r){e.layer.appendChild(r)})}},{key:"update",value:function(){var t=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];this.refresh();var e=[];return t&&(e=this.animateElements(this.data)||[]),e}}]),i}(),vf={donutSlices:{layerClass:"donut-slices",makeElements:function(i){return i.sliceStrings.map(function(t,e){var r=Vi(t,"donut-path",i.colors[e],"none",i.strokeWidth);return r.style.transition="transform .3s;",r})},animateElements:function(i){return this.store.map(function(t,e){return _f(t,i.sliceStrings[e])})}},pieSlices:{layerClass:"pie-slices",makeElements:function(i){return i.sliceStrings.map(function(t,e){var r=Vi(t,"pie-path","none",i.colors[e]);return r.style.transition="transform .3s;",r})},animateElements:function(i){return this.store.map(function(t,e){return _f(t,i.sliceStrings[e])})}},percentageBars:{layerClass:"percentage-bars",makeElements:function(i){var t=this,e=i.xPositions.length;return i.xPositions.map(function(r,n){var a=n==e-1,s=n==0;return function(o,l,u,c,h,p){var g=arguments.length>6&&arguments[6]!==void 0?arguments[6]:"none";if(p){var b=G0(o,u,c);return Vi(b,"percentage-bar",null,g)}if(h){var v=X0(o,u,c);return Vi(v,"percentage-bar",null,g)}var k={className:"percentage-bar",x:o,y:l,width:u,height:c,fill:g};return ut("rect",k)}(r,0,i.widths[n],t.constants.barHeight,s,a,i.colors[n])})},animateElements:function(i){if(i)return[]}},yAxis:{layerClass:"y axis",makeElements:function(i){var t=this;return i.positions.map(function(e,r){return function(n,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Oi(n)||(n=0),o.pos||(o.pos="left"),o.offset||(o.offset=0),o.mode||(o.mode="span"),o.stroke||(o.stroke="#E2E6E9"),o.className||(o.className="");var l=-6,u=o.mode==="span"?s+6:0;return o.mode==="tick"&&o.pos==="right"&&(l=s+6,u=s),l+=o.offset,u+=o.offset,typeof a=="number"&&(a=Cf(a)),ff(n,a,l,u,{className:o.className,lineType:o.lineType,shortenNumbers:o.shortenNumbers,numberFormatter:o.numberFormatter})}(e,i.labels[r],t.constants.width,{mode:t.constants.mode,pos:t.constants.pos,shortenNumbers:t.constants.shortenNumbers,numberFormatter:t.constants.numberFormatter})})},animateElements:function(i){var t=i.positions,e=i.labels,r=this.oldData.positions,n=this.oldData.labels,a=Mt(Gt(r,t),2);r=a[0],t=a[1];var s=Mt(Gt(n,e),2);return n=s[0],e=s[1],this.render({positions:r,labels:e}),this.store.map(function(o,l){return hf(o,t[l],r[l])})}},xAxis:{layerClass:"x axis",makeElements:function(i){var t=this;return i.positions.map(function(e,r){return function(n,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Oi(n)||(n=0),o.pos||(o.pos="bottom"),o.offset||(o.offset=0),o.mode||(o.mode="span"),o.className||(o.className="");var l=s+6,u=o.mode==="span"?-6:s;return o.mode==="tick"&&o.pos==="top"&&(l=-6,u=0),K0(n,a,l,u,{className:o.className,lineType:o.lineType})}(e,i.calcLabels[r],t.constants.height,{mode:t.constants.mode,pos:t.constants.pos})})},animateElements:function(i){var t=i.positions,e=i.calcLabels,r=this.oldData.positions,n=this.oldData.calcLabels,a=Mt(Gt(r,t),2);r=a[0],t=a[1];var s=Mt(Gt(n,e),2);return n=s[0],e=s[1],this.render({positions:r,calcLabels:e}),this.store.map(function(o,l){return function(u,c,h){return xr(u,[h,0],[c,0],350)}(o,t[l],r[l])})}},yMarkers:{layerClass:"y-markers",makeElements:function(i){var t=this;return i.map(function(e){return function(r,n,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};Oi(r)||(r=0),s.labelPos||(s.labelPos="right"),s.lineType||(s.lineType="dashed");var o=s.labelPos==="left"?4:a-of(n,5)-4,l=ut("text",{className:"chart-label",x:o,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:n+""}),u=ff(r,"",0,a,{stroke:s.stroke||"#E2E6E9",className:s.className||"",lineType:s.lineType});return u.appendChild(l),u}(e.position,e.label,t.constants.width,{labelPos:e.options.labelPos,stroke:e.options.stroke,mode:"span",lineType:e.options.lineType})})},animateElements:function(i){var t=Mt(Gt(this.oldData,i),2);this.oldData=t[0];var e=(i=t[1]).map(function(s){return s.position}),r=i.map(function(s){return s.label}),n=i.map(function(s){return s.options}),a=this.oldData.map(function(s){return s.position});return this.render(a.map(function(s,o){return{position:a[o],label:r[o],options:n[o]}})),this.store.map(function(s,o){return hf(s,e[o],a[o])})}},yRegions:{layerClass:"y-regions",makeElements:function(i){var t=this;return i.map(function(e){return function(r,n,a,s){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},l=r-n,u=ut("rect",{className:"bar mini",styles:{fill:o.fill||"rgba(228, 234, 239, 0.49)",stroke:o.stroke||"#E2E6E9","stroke-dasharray":"".concat(a,", ").concat(l)},x:0,y:0,width:a,height:l});o.labelPos||(o.labelPos="right");var c=o.labelPos==="left"?4:a-of(s+"",4.5)-4,h=ut("text",{className:"chart-label",x:c,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:s+""}),p=ut("g",{transform:"translate(0, ".concat(n,")")});return p.appendChild(u),p.appendChild(h),p}(e.startPos,e.endPos,t.constants.width,e.label,{labelPos:e.options.labelPos,stroke:e.options.stroke,fill:e.options.fill})})},animateElements:function(i){var t=Mt(Gt(this.oldData,i),2);this.oldData=t[0];var e=(i=t[1]).map(function(u){return u.endPos}),r=i.map(function(u){return u.label}),n=i.map(function(u){return u.startPos}),a=i.map(function(u){return u.options}),s=this.oldData.map(function(u){return u.endPos}),o=this.oldData.map(function(u){return u.startPos});this.render(s.map(function(u,c){return{startPos:o[c],endPos:s[c],label:r[c],options:a[c]}}));var l=[];return this.store.map(function(u,c){l=l.concat(function(h,p,g,b){var v=p-g,k=h.childNodes[0],C=k.getAttribute("width");return[[k,{height:v,"stroke-dasharray":"".concat(C,", ").concat(v)},350,"easein"],xr(h,[0,b],[0,g],350)]}(u,n[c],e[c],s[c]))}),l}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements:function(i){var t=this,e=this.constants,r=e.index,n=e.colWidth,a=e.rowHeight,s=e.squareSize,o=e.radius,l=e.xTranslate,u=l,c=0;return this.serializedSubDomains=[],i.cols.map(function(h,p){p===1&&t.labels.push(Sr("domain-name",u,-12,Af(r,!0).toUpperCase(),{fontSize:9})),h.map(function(g,b){if(g.fill){var v={"data-date":g.yyyyMmDd,"data-value":g.dataValue,"data-day":b},k=Sf("day",u,c,s,o,g.fill,v);t.serializedSubDomains.push(k)}c+=a}),c=0,u+=n}),this.serializedSubDomains},animateElements:function(i){if(i)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements:function(i){var t=this.constants;return this.unitType="bar",this.units=i.yPositions.map(function(e,r){return function(n,a,s,o){var l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"",u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:0,c=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0,h=arguments.length>7&&arguments[7]!==void 0?arguments[7]:{},p=lf(a,h.zeroLine),g=Mt(p,2),b=g[0],v=g[1];v-=c,b===0&&(b=h.minHeight,v-=h.minHeight),Oi(n)||(n=0),Oi(v)||(v=0),Oi(b,!0)||(b=0),Oi(s,!0)||(s=0);var k=ut("rect",{className:"bar mini",style:"fill: ".concat(o),"data-point-index":u,x:n,y:v,width:s,height:b});if((l+="")||l.length){k.setAttribute("y",0),k.setAttribute("x",0);var C=ut("text",{className:"data-point-value",x:s/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:l}),O=ut("g",{"data-point-index":u,transform:"translate(".concat(n,", ").concat(v,")")});return O.appendChild(k),O.appendChild(C),O}return k}(i.xPositions[r],e,i.barWidth,t.color,i.labels[r],r,i.offsets[r],{zeroLine:i.zeroLine,barsWidth:i.barsWidth,minHeight:t.minHeight})}),this.units},animateElements:function(i){var t=i.xPositions,e=i.yPositions,r=i.offsets,n=i.labels,a=this.oldData.xPositions,s=this.oldData.yPositions,o=this.oldData.offsets,l=this.oldData.labels,u=Mt(Gt(a,t),2);a=u[0],t=u[1];var c=Mt(Gt(s,e),2);s=c[0],e=c[1];var h=Mt(Gt(o,r),2);o=h[0],r=h[1];var p=Mt(Gt(l,n),2);l=p[0],n=p[1],this.render({xPositions:a,yPositions:s,offsets:o,labels:n,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});var g=[];return this.store.map(function(b,v){g=g.concat(function(k,C,O,d){var _=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},y=lf(O,m.zeroLine),x=Mt(y,2),S=x[0],w=x[1];if(w-=_,k.nodeName!=="rect"){var E=k.childNodes[0],L=[E,{width:d,height:S},350,"easein"],I=k.getAttribute("transform").split("(")[1].slice(0,-1),A=xr(k,I,[C,w],350);return[L,A]}return[[k,{width:d,height:S,x:C,y:w},350,"easein"]]}(b,t[v],e[v],i.barWidth,r[v],{zeroLine:i.zeroLine}))}),g}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements:function(i){var t=this.constants;if(this.unitType="dot",this.paths={},t.hideLine||(this.paths=function(n,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},u=a.map(function(k,C){return n[C]+","+k}),c=u.join("L");o.spline&&(c=cf(n,a));var h=Vi("M"+c,"line-graph-path",s);if(o.heatline){var p=df(l.svgDefs,s);h.style.stroke="url(#".concat(p,")")}var g={path:h};if(o.regionFill){var b=df(l.svgDefs,s,!0),v="M"+"".concat(n[0],",").concat(l.zeroLine,"L")+c+"L".concat(n.slice(-1)[0],",").concat(l.zeroLine);g.region=Vi(v,"region-fill","none","url(#".concat(b,")"))}return g}(i.xPositions,i.yPositions,t.color,{heatline:t.heatline,regionFill:t.regionFill,spline:t.spline},{svgDefs:t.svgDefs,zeroLine:i.zeroLine})),this.units=[],t.showDots&&(this.units=i.yPositions.map(function(n,a){return pf(i.xPositions[a],n,i.radius,t.color,t.valuesOverPoints?i.values[a]:"",a,t.hideDotBorder)})),t.trailingDot&&!t.showDots){var e=i.yPositions.length-1,r=pf(i.xPositions[e],i.yPositions[e],i.radius,t.color,t.valuesOverPoints?i.values[e]:"",e,t.hideDotBorder);this.units.push(r)}return Object.values(this.paths).concat(this.units)},animateElements:function(i){var t=i.xPositions,e=i.yPositions,r=i.values,n=this.oldData.xPositions,a=this.oldData.yPositions,s=this.oldData.values,o=Mt(Gt(n,t),2);n=o[0],t=o[1];var l=Mt(Gt(a,e),2);a=l[0],e=l[1];var u=Mt(Gt(s,r),2);s=u[0],r=u[1],this.render({xPositions:n,yPositions:a,values:r,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});var c=[];return Object.keys(this.paths).length&&(c=c.concat(function(h,p,g,b,v){var k=[],C=g.map(function(y,x){return p[x]+","+y}).join("L");v&&(C=cf(p,g));var O=[h.path,{d:"M"+C},350,"easein"];if(k.push(O),h.region){var d="".concat(p[0],",").concat(b,"L"),_="L".concat(p.slice(-1)[0],", ").concat(b),m=[h.region,{d:"M"+d+C+_},350,"easein"];k.push(m)}return k}(this.paths,t,e,i.zeroLine,this.constants.spline))),this.units.length&&this.units.map(function(h,p){c=c.concat(function(g,b,v){if(g.nodeName!=="circle"){var k=g.getAttribute("transform").split("(")[1].slice(0,-1);return[xr(g,k,[b,v],350)]}return[[g,{cx:b,cy:v},350,"easein"]]}(h,t[p],e[p]))}),c}}};function Tr(i,t,e){var r=Object.keys(vf).filter(function(a){return i.includes(a)}),n=vf[r[0]];return Object.assign(n,{constants:t,getData:e}),new ok(n)}var lk=function(i){Gi(e,Ef);var t=Xi(e);function e(r,n){var a;return pi(this,e),(a=t.call(this,r,n)).type="percentage",a.setup(),a}return vi(e,[{key:"setMeasures",value:function(r){var n=this.measures;this.barOptions=r.barOptions||{};var a=this.barOptions;a.height=a.height||16,n.paddings.right=30,n.paddings.top=60,n.paddings.bottom=0,n.legendHeight=80,n.baseHeight=8*a.height+ss(n)}},{key:"setupComponents",value:function(){var r=this.state,n=[["percentageBars",{barHeight:this.barOptions.height},function(){return{xPositions:r.xPositions,widths:r.widths,colors:this.colors}}.bind(this)]];this.components=new Map(n.map(function(a){var s=Tr.apply(void 0,ui(a));return[a[0],s]}))}},{key:"calc",value:function(){var r=this;ci(Wt(e.prototype),"calc",this).call(this);var n=this.state;n.xPositions=[],n.widths=[];var a=0;n.sliceTotals.map(function(s){var o=r.width*s/n.grandTotal;n.widths.push(o),n.xPositions.push(a),a+=o})}},{key:"makeDataByIndex",value:function(){}},{key:"bindTooltip",value:function(){var r=this,n=this.state;this.container.addEventListener("mousemove",function(a){var s=r.components.get("percentageBars").store,o=a.target;if(s.includes(o)){var l=s.indexOf(o),u=Rn(r.container),c=Rn(o),h=o.getAttribute("width")||o.getBoundingClientRect().width,p=c.left-u.left+parseInt(h)/2,g=c.top-u.top,b=(r.formattedLabels&&r.formattedLabels.length>0?r.formattedLabels[l]:r.state.labels[l])+": ",v=n.sliceTotals[l]/n.grandTotal;r.tip.setValues(p,g,{name:b,value:(100*v).toFixed(1)+"%"}),r.tip.showTip()}})}}]),e}(),bf=function(i){Gi(e,Ef);var t=Xi(e);function e(r,n){var a;return pi(this,e),(a=t.call(this,r,n)).initTimeout=0,a.init=1,a.setup(),a}return vi(e,[{key:"configure",value:function(r){ci(Wt(e.prototype),"configure",this).call(this,r),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=r.hoverRadio||.1,this.config.startAngle=r.startAngle||0,this.type="pie",this.sliceName="pieSlices",this.arcFunc=U0,this.shapeFunc=W0,this.clockWise=r.clockWise||!1}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x:this.center.y}},{key:"calc",value:function(){var r=this;ci(Wt(e.prototype),"calc",this).call(this);var n=this.state;this.radius=this.getRadius();var a=this.radius,s=this.clockWise,o=n.slicesProperties||[];n.sliceStrings=[],n.slicesProperties=[];var l=180-this.config.startAngle;n.sliceTotals.map(function(u,c){var h,p,g=l,b=u/n.grandTotal*360,v=b>180?1:0,k=s?-b:b,C=l+=k,O=Xa(g,a),d=Xa(C,a),_=r.init&&o[c];r.init?(h=_?_.startPosition:O,p=_?_.endPosition:O):(h=O,p=d);var m=b===360?r.shapeFunc(h,p,r.center,r.radius,s,v):r.arcFunc(h,p,r.center,r.radius,s,v);n.sliceStrings.push(m),n.slicesProperties.push({startPosition:O,endPosition:d,value:u,total:n.grandTotal,startAngle:g,endAngle:C,angle:k})}),this.init=0}},{key:"setupComponents",value:function(){var r=this.state,n=[["pieSlices",{},function(){return{sliceStrings:r.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(n.map(function(a){var s=Tr.apply(void 0,ui(a));return[a[0],s]}))}},{key:"calTranslateByAngle",value:function(r){var n=this.radius,a=this.hoverRadio,s=Xa(r.startAngle+r.angle/2,n);return"translate3d(".concat(s.x*a,"px,").concat(s.y*a,"px,0)")}},{key:"hoverSlice",value:function(r,n,a,s){if(r){var o=this.colors[n];if(a){ns(r,this.calTranslateByAngle(this.state.slicesProperties[n]));var l=Rn(this.svg),u=s.pageX-l.left+10,c=s.pageY-l.top-10,h=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[n]:this.state.labels[n])+": ",p=(100*this.state.sliceTotals[n]/this.state.grandTotal).toFixed(1);this.tip.setValues(u,c,{name:h,value:p+"%"}),this.tip.showTip()}else this.resetHover(r,o)}}},{key:"resetHover",value:function(r,n){ns(r,"translate3d(0,0,0)"),this.tip.hideTip(),r.style.fill=n}},{key:"bindTooltip",value:function(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}},{key:"mouseMove",value:function(r){var n=r.target,a=this.components.get(this.sliceName).store,s=this.curActiveSliceIndex,o=this.curActiveSlice;if(a.includes(n)){var l=a.indexOf(n);this.hoverSlice(o,s,!1),this.curActiveSlice=n,this.curActiveSliceIndex=l,this.hoverSlice(n,l,!0,r)}else this.mouseLeave()}},{key:"mouseLeave",value:function(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}]),e}();function Cr(i){if(i===0)return[0,0];if(isNaN(i))return{mantissa:-6755399441055744,exponent:972};var t=i>0?1:-1;if(!isFinite(i))return{mantissa:4503599627370496*t,exponent:972};i=Math.abs(i);var e=Math.floor(Math.log10(i));return[t*(i/Math.pow(10,e)),e]}function ck(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=Math.ceil(i),r=Math.floor(t),n=e-r,a=n,s=1;n>5&&(n%2!=0&&(n=++e-r),a=n/2,s=2),n<=2&&(s=n/(a=4)),n===0&&(a=5,s=1);for(var o=[],l=0;l<=a;l++)o.push(r+s*l);return o}function kr(i){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,e=Cr(i),r=Mt(e,2),n=r[0],a=r[1],s=t?t/Math.pow(10,a):0,o=ck(n=n.toFixed(6),s);return o=o.map(function(l){return l*Math.pow(10,a)})}function uk(i){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=Math.max.apply(Math,ui(i)),n=Math.min.apply(Math,ui(i));e.max!==void 0&&(r=r>e.max?r:e.max),e.min!==void 0&&(n=n<e.min?n:e.min);var a=[];function s(h,p){for(var g=kr(h),b=g[1]-g[0],v=0,k=1;v<p;k++)v+=b,g.unshift(-1*v);return g}if(r>=0&&n>=0)Cr(r)[1],a=t?kr(r,n):kr(r);else if(r>0&&n<0){var o=Math.abs(n);if(r>=o)Cr(r)[1],a=s(r,o);else{Cr(o)[1];var l=s(o,r);a=l.reverse().map(function(h){return-1*h})}}else if(r<=0&&n<=0){var u=Math.abs(n),c=Math.abs(r);Cr(u)[1],a=(a=t?kr(u,c):kr(u)).reverse().map(function(h){return-1*h})}return a}function dk(i){var t,e=Of(i);return i.indexOf(0)>=0?t=i.indexOf(0):i[0]>0?t=-1*i[0]/e:t=-1*i[i.length-1]/e+(i.length-1),t}function Of(i){return i[1]-i[0]}function fk(i){return i[i.length-1]-i[0]}function $n(i,t){return xf(t.zeroLine-i*t.scaleMultiplier)}var pk=function(i){Gi(e,os);var t=Xi(e);function e(r,n){var a;pi(this,e),(a=t.call(this,r,n)).type="heatmap",a.countLabel=n.countLabel||"";var s=["Sunday","Monday"],o=s.includes(n.startSubDomain)?n.startSubDomain:"Sunday";return a.startSubDomainIndex=s.indexOf(o),a.setup(),a}return vi(e,[{key:"setMeasures",value:function(r){var n=this.measures;this.discreteDomains=r.discreteDomains===0?0:1,n.paddings.top=36,n.paddings.bottom=0,n.legendHeight=24,n.baseHeight=84+ss(n);var a=this.data,s=this.discreteDomains?12:0;this.independentWidth=12*(Za(a.start,a.end)+s)+es(n)}},{key:"updateWidth",value:function(){var r=this.discreteDomains?12:0,n=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=12*(n+r)+es(this.measures)}},{key:"prepareData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;if(r.start&&r.end&&r.start>r.end)throw new Error("Start date cannot be greater than end date.");if(r.start||(r.start=new Date,r.start.setFullYear(r.start.getFullYear()-1)),r.end||(r.end=new Date),r.dataPoints=r.dataPoints||{},parseInt(Object.keys(r.dataPoints)[0])>1e5){var n={};Object.keys(r.dataPoints).forEach(function(a){var s=new Date(1e3*a);n[Ja(s)]=r.dataPoints[a]}),r.dataPoints=n}return r}},{key:"calc",value:function(){var r=this.state;r.start=Ri(this.data.start),r.end=Ri(this.data.end),r.firstWeekStart=Ri(r.start),r.noOfWeeks=Za(r.start,r.end),r.distribution=function(n,a){for(var s=Math.max.apply(Math,ui(n)),o=1/(a-1),l=[],u=0;u<a;u++){var c=s*(o*u);l.push(c)}return l}(Object.values(this.data.dataPoints),5),r.domainConfigs=this.getDomains()}},{key:"setupComponents",value:function(){var r=this,n=this.state,a=this.discreteDomains?0:1,s=n.domainConfigs.map(function(l,u){return["heatDomain",{index:l.index,colWidth:12,rowHeight:12,squareSize:10,radius:r.rawChartArgs.radius||0,xTranslate:12*n.domainConfigs.filter(function(c,h){return h<u}).map(function(c){return c.cols.length-a}).reduce(function(c,h){return c+h},0)},function(){return n.domainConfigs[u]}.bind(r)]});this.components=new Map(s.map(function(l,u){var c=Tr.apply(void 0,ui(l));return[l[0]+"-"+u,c]}));var o=0;ak.forEach(function(l,u){if([1,3,5].includes(u)){var c=Sr("subdomain-name",-6,o,l,{fontSize:10,dy:8,textAnchor:"end"});r.drawArea.appendChild(c)}o+=12})}},{key:"update",value:function(r){r||console.error("No data to update."),this.data=this.prepareData(r),this.draw(),this.bindTooltip()}},{key:"bindTooltip",value:function(){var r=this;this.container.addEventListener("mousemove",function(n){r.components.forEach(function(a){var s=a.store,o=n.target;if(s.includes(o)){var l=o.getAttribute("data-value"),u=o.getAttribute("data-date").split("-"),c=Af(parseInt(u[1])-1,!0),h=r.container.getBoundingClientRect(),p=o.getBoundingClientRect(),g=parseInt(n.target.getAttribute("width")),b=p.left-h.left+g/2,v=p.top-h.top,k=l+" "+r.countLabel,C=" on "+c+" "+u[0]+", "+u[2];r.tip.setValues(b,v,{name:C,value:k,valueFirst:1},[]),r.tip.showTip()}})})}},{key:"renderLegend",value:function(){var r=this;this.legendArea.textContent="";var n=0,a=this.rawChartArgs.radius||0,s=Sr("subdomain-name",n,12,"Less",{fontSize:11,dy:9});n=30,this.legendArea.appendChild(s),this.colors.slice(0,5).map(function(l,u){var c=Sf("heatmap-legend-unit",n+15*u,12,10,a,l);r.legendArea.appendChild(c)});var o=Sr("subdomain-name",n+75+3,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(o)}},{key:"getDomains",value:function(){for(var r=this.state,n=[r.start.getMonth(),r.start.getFullYear()],a=n[0],s=n[1],o=[r.end.getMonth(),r.end.getFullYear()],l=o[0]-a+1+12*(o[1]-s),u=[],c=Ri(r.start),h=0;h<l;h++){var p=r.end;if(!sk(c,r.end)){var g=[c.getMonth(),c.getFullYear()];p=gf(g[0],g[1])}u.push(this.getDomainConfig(c,p)),Yi(p,1),c=p}return u}},{key:"getDomainConfig",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",a=[r.getMonth(),r.getFullYear()],s=a[0],o=a[1],l=$f(r),u={index:s,cols:[]};Yi(n=Ri(n)||gf(s,o),1);for(var c,h=Za(l,n),p=[],g=0;g<h;g++)c=this.getCol(l,s),p.push(c),Yi(l=new Date(c[6].yyyyMmDd),1);return c[6].dataValue!==void 0&&(Yi(l,1),p.push(this.getCol(l,s,!0))),u.cols=p,u}},{key:"getCol",value:function(r,n){for(var a=arguments.length>2&&arguments[2]!==void 0&&arguments[2],s=this.state,o=Ri(r),l=[],u=0;u<7;u++,Yi(o,1)){var c={},h=o>=s.start&&o<=s.end;a||o.getMonth()!==n||!h?c.yyyyMmDd=Ja(o):c=this.getSubDomainConfig(o),l.push(c)}return l}},{key:"getSubDomainConfig",value:function(r){var n,a,s=Ja(r),o=this.data.dataPoints[s];return{yyyyMmDd:s,dataValue:o||0,fill:this.colors[n=o,a=this.state.distribution,a.filter(function(l){return l<n}).length]}}}]),e}();function hk(i,t){i.labels=i.labels||[];var e=i.labels.length,r=i.datasets,n=new Array(e).fill(0);return r||(r=[{values:n}]),r.map(function(a){if(a.values){var s=a.values;s=(s=s.map(function(o){return isNaN(o)?0:o})).length>e?s.slice(0,e):ts(s,e-s.length,0),a.values=s}else a.values=n;a.chartType||(a.chartType=t)}),i.yRegions&&i.yRegions.map(function(a){if(a.end<a.start){var s=[a.end,a.start];a.start=s[0],a.end=s[1]}}),i}function _k(i){var t=i.labels.length,e=new Array(t).fill(0),r={labels:i.labels.slice(0,-1),datasets:i.datasets.map(function(n){return{name:"",values:e.slice(0,-1),chartType:n.chartType}})};return i.yMarkers&&(r.yMarkers=[{value:0,label:""}]),i.yRegions&&(r.yRegions=[{start:0,end:0,label:""}]),r}var as=function(i){Gi(e,os);var t=Xi(e);function e(r,n){var a;return pi(this,e),(a=t.call(this,r,n)).barOptions=n.barOptions||{},a.lineOptions=n.lineOptions||{},a.type=n.type||"line",a.init=1,a.setup(),a}return vi(e,[{key:"setMeasures",value:function(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}},{key:"configure",value:function(r){ci(Wt(e.prototype),"configure",this).call(this,r),r.axisOptions=r.axisOptions||{},r.tooltipOptions=r.tooltipOptions||{},this.config.xAxisMode=r.axisOptions.xAxisMode||"span",this.config.yAxisMode=r.axisOptions.yAxisMode||"span",this.config.xIsSeries=r.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=r.axisOptions.shortenYAxisNumbers||0,this.config.numberFormatter=r.axisOptions.numberFormatter,this.config.yAxisRange=r.axisOptions.yAxisRange||{},this.config.formatTooltipX=r.tooltipOptions.formatTooltipX,this.config.formatTooltipY=r.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=r.valuesOverPoints,this.config.legendRowHeight=30}},{key:"prepareData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return hk(r,this.type)}},{key:"prepareFirstData",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.data;return _k(r)}},{key:"calc",value:function(){var r=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.calcXPositions(),r||this.calcYAxisParameters(this.getAllYValues(),this.type==="line"),this.makeDataByIndex()}},{key:"calcXPositions",value:function(){var r=this.state,n=this.data.labels;r.datasetLength=n.length,r.unitWidth=this.width/r.datasetLength,r.xOffset=r.unitWidth/2,r.xAxis={labels:n,positions:n.map(function(a,s){return xf(r.xOffset+s*r.unitWidth)})}}},{key:"calcYAxisParameters",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"false",a=uk(r,n,this.config.yAxisRange),s=this.height/fk(a),o=Of(a)*s,l=this.height-dk(a)*o;this.state.yAxis={labels:a,positions:a.map(function(u){return l-u*s}),scaleMultiplier:s,zeroLine:l},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}},{key:"calcDatasetPoints",value:function(){var r=this.state,n=function(a){return a.map(function(s){return $n(s,r.yAxis)})};r.datasets=this.data.datasets.map(function(a,s){var o=a.values,l=a.cumulativeYs||[];return{name:a.name&&a.name.replace(/<|>|&/g,function(u){return u=="&"?"&amp;":u=="<"?"&lt;":"&gt;"}),index:s,chartType:a.chartType,values:o,yPositions:n(o),cumulativeYs:l,cumulativeYPos:n(l)}})}},{key:"calcYExtremes",value:function(){var r=this.state;this.barOptions.stacked?r.yExtremes=r.datasets[r.datasets.length-1].cumulativeYPos:(r.yExtremes=new Array(r.datasetLength).fill(9999),r.datasets.map(function(n){n.yPositions.map(function(a,s){a<r.yExtremes[s]&&(r.yExtremes[s]=a)})}))}},{key:"calcYRegions",value:function(){var r=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(function(n){return n.position=$n(n.value,r.yAxis),n.options||(n.options={}),n})),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(function(n){return n.startPos=$n(n.start,r.yAxis),n.endPos=$n(n.end,r.yAxis),n.options||(n.options={}),n}))}},{key:"getAllYValues",value:function(){var r,n=this,a="values";if(this.barOptions.stacked){a="cumulativeYs";var s=new Array(this.state.datasetLength).fill(0);this.data.datasets.map(function(l,u){var c=n.data.datasets[u].values;l[a]=s=s.map(function(h,p){return h+c[p]})})}var o=this.data.datasets.map(function(l){return l[a]});return this.data.yMarkers&&o.push(this.data.yMarkers.map(function(l){return l.value})),this.data.yRegions&&this.data.yRegions.map(function(l){o.push([l.end,l.start])}),(r=[]).concat.apply(r,ui(o))}},{key:"setupComponents",value:function(){var r=this,n=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers,numberFormatter:this.config.numberFormatter},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){var h=this.state;return h.xAxis.calcLabels=function(p){var g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],b=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],v=p/g.length*.6;v<=0&&(v=1);var k,C=v/7;if(b){var O=Math.max.apply(Math,ui(g.map(function(_){return _.length})));k=Math.ceil(O/C)}var d=g.map(function(_,m){return(_+="").length>C&&(b?m%k!=0?m!==g.length-1&&(_=""):m>g.length-k/2&&(_=""):_=C-3>0?_.slice(0,C-3)+" ...":_.slice(0,C)+".."),_});return d}(this.width,h.xAxis.labels,this.config.xIsSeries),h.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],a=this.state.datasets.filter(function(h){return h.chartType==="bar"}),s=this.state.datasets.filter(function(h){return h.chartType==="line"}),o=a.map(function(h){var p=h.index;return["barGraph-"+h.index,{index:p,color:r.colors[p],stacked:r.barOptions.stacked,valuesOverPoints:r.config.valuesOverPoints,minHeight:0*r.height},function(){var g=this.state,b=g.datasets[p],v=this.barOptions.stacked,k=this.barOptions.spaceRatio||.5,C=g.unitWidth*(1-k),O=C/(v?1:a.length),d=g.xAxis.positions.map(function(y){return y-C/2});v||(d=d.map(function(y){return y+O*p}));var _=new Array(g.datasetLength).fill("");this.config.valuesOverPoints&&(_=v&&b.index===g.datasets.length-1?b.cumulativeYs:b.values);var m=new Array(g.datasetLength).fill(0);return v&&(m=b.yPositions.map(function(y,x){return y-b.cumulativeYPos[x]})),{xPositions:d,yPositions:b.yPositions,offsets:m,labels:_,zeroLine:g.yAxis.zeroLine,barsWidth:C,barWidth:O}}.bind(r)]}),l=s.map(function(h){var p=h.index;return["lineGraph-"+h.index,{index:p,color:r.colors[p],svgDefs:r.svgDefs,heatline:r.lineOptions.heatline,regionFill:r.lineOptions.regionFill,spline:r.lineOptions.spline,showDots:r.lineOptions.showDots,trailingDot:r.lineOptions.trailingDot,hideDotBorder:r.lineOptions.hideDotBorder,hideLine:r.lineOptions.hideLine,valuesOverPoints:r.config.valuesOverPoints},function(){var g=this.state,b=g.datasets[p],v=g.yAxis.positions[0]<g.yAxis.zeroLine?g.yAxis.positions[0]:g.yAxis.zeroLine;return{xPositions:g.xAxis.positions,yPositions:b.yPositions,values:b.values,zeroLine:v,radius:this.lineOptions.dotSize||4}}.bind(r)]}),u=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];n=n.concat(o,l,u);var c=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(n.filter(function(h){return!c.includes(h[0])||r.state[h[0]]}).map(function(h){var p=Tr.apply(void 0,ui(h));return(h[0].includes("lineGraph")||h[0].includes("barGraph"))&&r.dataUnitComponents.push(p),[h[0],p]}))}},{key:"makeDataByIndex",value:function(){var r=this;this.dataByIndex={};var n=this.state,a=this.config.formatTooltipX,s=this.config.formatTooltipY;n.xAxis.labels.map(function(o,l){var u=r.state.datasets.map(function(c,h){var p=c.values[l];return{title:c.name,value:p,yPos:c.yPositions[l],color:r.colors[h],formatted:s?s(p):p}});r.dataByIndex[l]={label:o,formattedLabel:a?a(o):o,xPos:n.xAxis.positions[l],values:u,yExtreme:n.yExtremes[l]}})}},{key:"bindTooltip",value:function(){var r=this;this.container.addEventListener("mousemove",function(n){var a=r.measures,s=Rn(r.container),o=n.pageX-s.left-On(a),l=n.pageY-s.top;l<r.height+Ln(a)&&l>Ln(a)?r.mapTooltipXPosition(o):r.tip.hideTip()})}},{key:"mapTooltipXPosition",value:function(r){var n=this.state;if(n.yExtremes){var a=function(o,l){var u=arguments.length>2&&arguments[2]!==void 0&&arguments[2],c=l.reduce(function(h,p){return Math.abs(p-o)<Math.abs(h-o)?p:h},[]);return u?l.indexOf(c):c}(r,n.xAxis.positions,!0);if(a>=0){var s=this.dataByIndex[a];this.tip.setValues(s.xPos+this.tip.offset.x,s.yExtreme+this.tip.offset.y,{name:s.formattedLabel,value:""},s.values,a),this.tip.showTip()}}}},{key:"renderLegend",value:function(){var r=this.data;r.datasets.length>1&&ci(Wt(e.prototype),"renderLegend",this).call(this,r.datasets)}},{key:"makeLegend",value:function(r,n,a,s){return Tf(a,s+5,12,3,this.colors[n],r.name,null,8.75,this.config.truncateLegends)}},{key:"makeOverlay",value:function(){var r=this;this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(function(n){var a=n.overlay;a.parentNode.removeChild(a)}),this.overlayGuides=this.dataUnitComponents.map(function(n){return{type:n.unitType,overlay:void 0,units:n.units}}),this.state.currentIndex===void 0&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(function(n){var a=n.units[r.state.currentIndex];n.overlay=J0[n.type](a),r.drawArea.appendChild(n.overlay)}))}},{key:"updateOverlayGuides",value:function(){this.overlayGuides&&this.overlayGuides.forEach(function(r){var n=r.overlay;n.parentNode.removeChild(n)})}},{key:"bindOverlay",value:function(){var r=this;this.parent.addEventListener("data-select",function(){r.updateOverlay()})}},{key:"bindUnits",value:function(){var r=this;this.dataUnitComponents.map(function(n){n.units.map(function(a){a.addEventListener("click",function(){var s=a.getAttribute("data-point-index");r.setCurrentDataPoint(s)})})}),this.tip.container.addEventListener("click",function(){var n=r.tip.container.getAttribute("data-point-index");r.setCurrentDataPoint(n)})}},{key:"updateOverlay",value:function(){var r=this;this.overlayGuides.map(function(n){var a=n.units[r.state.currentIndex];Z0[n.type](a,n.overlay)})}},{key:"onLeftArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex-1)}},{key:"onRightArrow",value:function(){this.setCurrentDataPoint(this.state.currentIndex+1)}},{key:"getDataPoint",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.currentIndex,n=this.state,a={index:r,label:n.xAxis.labels[r],values:n.datasets.map(function(s){return s.values[r]})};return a}},{key:"setCurrentDataPoint",value:function(r){var n=this.state;(r=parseInt(r))<0&&(r=0),r>=n.xAxis.labels.length&&(r=n.xAxis.labels.length-1),r!==n.currentIndex&&(n.currentIndex=r,function(a,s,o){var l=document.createEvent("HTMLEvents");for(var u in l.initEvent(s,!0,!0),o)l[u]=o[u];a.dispatchEvent(l)}(this.parent,"data-select",this.getDataPoint()))}},{key:"addDataPoint",value:function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.state.datasetLength;ci(Wt(e.prototype),"addDataPoint",this).call(this,r,n,a),this.data.labels.splice(a,0,r),this.data.datasets.map(function(s,o){s.values.splice(a,0,n[o])}),this.update(this.data)}},{key:"removeDataPoint",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.state.datasetLength-1;this.data.labels.length<=1||(ci(Wt(e.prototype),"removeDataPoint",this).call(this,r),this.data.labels.splice(r,1),this.data.datasets.map(function(n){n.values.splice(r,1)}),this.update(this.data))}},{key:"updateDataset",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.data.datasets[n].values=r,this.update(this.data)}},{key:"updateDatasets",value:function(r){this.data.datasets.map(function(n,a){r[a]&&(n.values=r[a])}),this.update(this.data)}}]),e}(),yf={bar:as,line:as,percentage:lk,heatmap:pk,pie:bf,donut:function(i){Gi(e,bf);var t=Xi(e);function e(r,n){return pi(this,e),t.call(this,r,n)}return vi(e,[{key:"configure",value:function(r){ci(Wt(e.prototype),"configure",this).call(this,r),this.type="donut",this.sliceName="donutSlices",this.arcFunc=V0,this.shapeFunc=Y0,this.strokeWidth=r.strokeWidth||30}},{key:"getRadius",value:function(){return this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2}},{key:"resetHover",value:function(r,n){ns(r,"translate3d(0,0,0)"),this.tip.hideTip(),r.style.stroke=n}},{key:"setupComponents",value:function(){var r=this.state,n=[[this.sliceName,{},function(){return{sliceStrings:r.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(n.map(function(a){var s=Tr.apply(void 0,ui(a));return[a[0],s]}))}}]),e}()},Rf=function i(t,e){return pi(this,i),function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"line",n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return r==="axis-mixed"?(a.type="line",new as(n,a)):yf[r]?new yf[r](n,a):void console.error("Undefined chart type: "+r)}(e.type,t,e)};frappe.provide("frappe.ui");frappe.Chart=Rf;frappe.ui.RealtimeChart=class extends frappe.Chart{constructor(t,e,r=8,n){super(t,n);n.data.datasets[0].values.length>r&&frappe.throw(__("Length of passed data array is greater than value of maximum allowed label points!")),this.currentSize=n.data.datasets[0].values.length,this.socketEvent=e,this.maxLabelPoints=r,this.start_updating=function(){frappe.realtime.on(this.socketEvent,a=>{this.update_chart(a.label,a.points)})},this.stop_updating=function(){frappe.realtime.off(this.socketEvent)},this.update_chart=function(a,s){this.currentSize>=this.maxLabelPoints?this.removeDataPoint(0):this.currentSize++,this.addDataPoint(a,s)}}};var ip=Ut(tp());frappe.DataTable=ip.default;var np=Ut(rp());frappe.Driver=np.default;frappe.provide("frappe.ui");frappe.ui.Scanner=class{constructor(t){this.dialog=null,this.handler=null,this.options=t,this.is_alive=!1,"multiple"in this.options||(this.options.multiple=!1),t.container&&(this.$scan_area=$(t.container),this.scan_area_id=frappe.dom.set_unique_id(this.$scan_area)),t.dialog&&(this.dialog=this.make_dialog(),this.dialog.show())}scan(){this.load_lib().then(()=>this.start_scan())}start_scan(){this.handler||(this.handler=new Html5Qrcode(this.scan_area_id)),this.handler.start({facingMode:"environment"},{fps:10,qrbox:250},(t,e)=>{if(this.options.on_scan)try{this.options.on_scan(e)}catch(r){console.error(r)}this.options.multiple||(this.stop_scan(),this.hide_dialog())},t=>{}).catch(t=>{this.is_alive=!1,this.hide_dialog(),console.error(t)}),this.is_alive=!0}stop_scan(){this.handler&&this.is_alive&&this.handler.stop().then(()=>{this.is_alive=!1,this.$scan_area.empty(),this.hide_dialog()})}make_dialog(){let t=new frappe.ui.Dialog({title:__("Scan QRCode"),fields:[{fieldtype:"HTML",fieldname:"scan_area"}],on_page_show:()=>{this.$scan_area=t.get_field("scan_area").$wrapper,this.$scan_area.addClass("barcode-scanner"),this.scan_area_id=frappe.dom.set_unique_id(this.$scan_area),this.scan()},on_hide:()=>{this.stop_scan()}});return t}hide_dialog(){this.dialog&&this.dialog.hide()}load_lib(){return frappe.require("/assets/frappe/node_modules/html5-qrcode/dist/html5-qrcode.min.js")}};frappe.provide("frappe.ui");frappe.ui.ThemeSwitcher=class{constructor(){this.setup_dialog(),this.refresh()}setup_dialog(){this.dialog=new frappe.ui.Dialog({title:__("Switch Theme")}),this.body=$('<div class="theme-grid"></div>').appendTo(this.dialog.$body),this.bind_events()}bind_events(){this.dialog.$wrapper.on("keydown",t=>{if(!this.themes)return;let e=frappe.ui.keys.get_key(t),r;if(e==="right")r=1;else if(e==="left")r=-1;else if(t.keyCode===13)this.hide();else return;let n=this.themes.findIndex(s=>s.name===this.current_theme),a=this.themes[n+r];if(!!a)return a.$html.click(),!1})}refresh(){this.current_theme=document.documentElement.getAttribute("data-theme-mode")||"light",this.fetch_themes().then(()=>{this.render()})}fetch_themes(){return new Promise(t=>{this.themes=[{name:"light",label:__("Frappe Light"),info:__("Light Theme")},{name:"dark",label:__("Timeless Night"),info:__("Dark Theme")},{name:"automatic",label:__("Automatic"),info:__("Uses system's theme to switch between light and dark mode")}],t(this.themes)})}render(){this.themes.forEach(t=>{let e=this.get_preview_html(t);e.appendTo(this.body),t.$html=e})}get_preview_html(t){let e=t.name==="automatic",r=$(`<div class="${this.current_theme==t.name?"selected":""}">
			<div data-theme=${e?"light":t.name}
				data-is-auto-theme="${e}" title="${t.info}">
				<div class="background">
					<div>
						<div class="preview-check" data-theme=${e?"dark":t.name}>
							${frappe.utils.icon("tick","xs")}
						</div>
					</div>
					<div class="navbar"></div>
					<div class="p-2">
						<div class="toolbar">
							<span class="text"></span>
							<span class="primary"></span>
						</div>
						<div class="foreground"></div>
						<div class="foreground"></div>
					</div>
				</div>
			</div>
			<div class="mt-3 text-center">
				<h5 class="theme-title">${t.label}</h5>
			</div>
		</div>`);return r.on("click",()=>{this.current_theme!==t.name&&(this.themes.forEach(n=>{n.$html.removeClass("selected")}),r.addClass("selected"),this.toggle_theme(t.name))}),r}toggle_theme(t){this.current_theme=t.toLowerCase(),document.documentElement.setAttribute("data-theme-mode",this.current_theme),frappe.show_alert(__("Theme Changed"),3),frappe.xcall("frappe.core.doctype.user.user.switch_theme",{theme:toTitle(t)})}show(){this.dialog.show()}hide(){this.dialog.hide()}};frappe.ui.add_system_theme_switch_listener=()=>{frappe.ui.dark_theme_media_query.addEventListener("change",()=>{frappe.ui.set_theme()})};frappe.ui.dark_theme_media_query=window.matchMedia("(prefers-color-scheme: dark)");frappe.ui.set_theme=i=>{let t=document.documentElement,e=t.getAttribute("data-theme-mode");i||e==="automatic"&&(i=frappe.ui.dark_theme_media_query.matches?"dark":"light");var r=[{key:"theme",data:i||e}];console.log(JSON.stringify(r)),t.setAttribute("data-theme",i||e)};frappe.provide("frappe.search");frappe.ui.Notifications=class{constructor(){this.tabs={},this.notification_settings=frappe.boot.notification_settings,this.make()}make(){this.dropdown=$(".navbar").find(".dropdown-notifications").removeClass("hidden"),this.dropdown_list=this.dropdown.find(".notifications-list"),this.header_items=this.dropdown_list.find(".header-items"),this.header_actions=this.dropdown_list.find(".header-actions"),this.body=this.dropdown_list.find(".notification-list-body"),this.panel_events=this.dropdown_list.find(".panel-events"),this.panel_notifications=this.dropdown_list.find(".panel-notifications"),this.user=frappe.session.user,this.setup_headers(),this.setup_dropdown_events()}setup_headers(){$(`<span class="notification-settings pull-right" data-action="go_to_settings">
			${frappe.utils.icon("setting-gear")}
		</span>`).on("click",r=>{r.stopImmediatePropagation(),this.dropdown.dropdown("hide"),frappe.set_route("Form","Notification Settings",frappe.session.user)}).appendTo(this.header_actions).attr("title",__("Notification Settings")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),$(`<span class="mark-all-read pull-right" data-action="mark_all_as_read">
			${frappe.utils.icon("mark-as-read")}
		</span>`).on("click",r=>this.mark_all_as_read(r)).appendTo(this.header_actions).attr("title",__("Mark all as read")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.categories=[{label:__("Notifications"),id:"notifications",view:ap,el:this.panel_notifications},{label:__("Today's Events"),id:"todays_events",view:sp,el:this.panel_events}];let t=r=>`<li class="notifications-category ${r.id=="notifications"?"active":""}"
					id="${r.id}"
					data-toggle="collapse"
				>${r.label}</li>`,e=$('<ul class="notification-item-tabs nav nav-tabs" role="tablist"></ul>');this.categories=this.categories.map(r=>(r.$tab=$(t(r)),r.$tab.on("click",n=>{n.stopImmediatePropagation(),this.switch_tab(r)}),e.append(r.$tab),r)),e.appendTo(this.header_items),this.categories.forEach(r=>{this.make_tab_view(r)}),this.switch_tab(this.categories[0])}switch_tab(t){this.categories.forEach(e=>{e.$tab.removeClass("active")}),t.$tab.addClass("active"),Object.keys(this.tabs).forEach(e=>this.tabs[e].hide()),this.tabs[t.id].show()}make_tab_view(t){let e=new t.view(t.el,this.dropdown,this.notification_settings);this.tabs[t.id]=e}mark_all_as_read(t){t.stopImmediatePropagation(),this.dropdown_list.find(".unread").removeClass("unread"),frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_all_as_read")}setup_dropdown_events(){this.dropdown.on("hide.bs.dropdown",t=>{let e=$(t.currentTarget).data("closable");return $(t.currentTarget).data("closable",!0),e}),this.dropdown.on("click",t=>{$(t.currentTarget).data("closable",!0)})}};frappe.ui.notifications={get_notification_config(){return frappe.xcall("frappe.desk.notifications.get_notification_info").then(i=>(frappe.ui.notifications.config=i,i))},show_open_count_list(i){frappe.ui.notifications.config?this.route_to_list_with_filters(i):this.get_notification_config().then(()=>{this.route_to_list_with_filters(i)})},route_to_list_with_filters(i){let t=frappe.ui.notifications.config.conditions[i];t&&$.isPlainObject(t)&&(frappe.route_options||(frappe.route_options={}),$.extend(frappe.route_options,t)),frappe.set_route("List",i)}};var _s=class{constructor(t,e,r){this.wrapper=t,this.parent=e,this.settings=r,this.max_length=20,this.container=$("<div></div>").appendTo(this.wrapper),this.make()}show(){this.container.show()}hide(){this.container.hide()}},ap=class extends _s{make(){this.notifications_icon=this.parent.find(".notifications-icon"),this.notifications_icon.attr("title",__("Notifications")).tooltip({delay:{show:600,hide:100},trigger:"hover"}),this.setup_notification_listeners(),this.get_notifications_list(this.max_length).then(t=>{!t.message||(this.dropdown_items=t.message.notification_logs,frappe.update_user_info(t.message.user_info),this.render_notifications_dropdown(),this.settings.seen==0&&this.dropdown_items.length>0&&this.toggle_notification_icon(!1))})}update_dropdown(){this.get_notifications_list(1).then(t=>{if(!t.message)return;let e=t.message.notification_logs[0];frappe.update_user_info(t.message.user_info),this.dropdown_items.unshift(e),this.dropdown_items.length>this.max_length&&(this.container.find(".recent-notification").last().remove(),this.dropdown_items.pop()),this.insert_into_dropdown()})}change_activity_status(){this.container.find(".activity-status")&&this.container.find(".activity-status").replaceWith(`<a class="recent-item text-center text-muted"
					href="/app/List/Notification Log">
					<div class="full-log-btn">${__("View Full Log")}</div>
				</a>`)}mark_as_read(t,e){frappe.call("frappe.desk.doctype.notification_log.notification_log.mark_as_read",{docname:t}).then(()=>{e.removeClass("unread")})}insert_into_dropdown(){let t=this.dropdown_items[0],e=this.get_dropdown_item_html(t);$(e).prependTo(this.container),this.change_activity_status()}get_dropdown_item_html(t){let e=this.get_item_link(t),r=t.read?"":"unread",n=t.subject,a=n.match(/<b class="subject-title">(.*?)<\/b>/);n=a?n.replace(a[1],frappe.ellipsis(strip_html(a[1]),100)):n;let s=frappe.datetime.comment_when(t.creation),o=t.chat_topic==1&&t.approved==0,l=`<div class="message">
			<div>${n}</div>
			<div class="notification-timestamp text-muted"  ${o?"style='display:flex;justify-content:space-between'":""}>
				${s}
				${o?`<div class='btn btn-primary approved-btn' data-chat-topic = '${t.email_content}' data-reciever = '${t.from_user}' data-doctype = '${t.document_type}' data-docname = '${t.document_name}'>Approved</div>`:""}
			</div>			
		</div>`,u=t.from_user,c=frappe.avatar(u,"avatar-medium user-avatar"),h=$(`<a class="recent-item notification-item ${r}"
				href="${e}"
				data-name="${t.name}"
			>
				<div class="notification-body">
					${c}
					${l}
				</div>
				<div class="mark-as-read" title="${__("Mark as Read")}">
				</div>
			</a>`);if(!t.read){let p=h.find(".mark-as-read");p.tooltip({delay:{show:600,hide:100},trigger:"hover"}),p.on("click",g=>{g.preventDefault(),g.stopImmediatePropagation(),this.mark_as_read(t.name,h)})}return h.on("click",()=>{!t.read&&this.mark_as_read(t.name,h),this.notifications_icon.trigger("click")}),o&&h.find(".approved-btn").on("click",p=>{p.preventDefault();let g=$(p.target),b=$(p.target).closest("a").data("name");$(p.target).remove(),jC(frappe.session.user,g.data("reciever"),g.data("chat-topic"),b,g.data("chat-topic"),g.data("doctype"),g.data("docname")),frappe.msgprint("Approved has been sent")}),h}render_notifications_dropdown(){this.settings&&!this.settings.enabled?this.container.html(`<li class="recent-item notification-item">
				<span class="text-muted">
					${__("Notifications Disabled")}
				</span></li>`):this.dropdown_items.length?(this.container.empty(),this.dropdown_items.forEach(t=>{this.container.append(this.get_dropdown_item_html(t))}),this.container.append(`<a class="list-footer"
					href="/app/List/Notification Log">
						<div class="full-log-btn">${__("See all Activity")}</div>
					</a>`)):this.container.append($(`<div class="notification-null-state">
					<div class="text-center">
						<img src="/assets/frappe/images/ui-states/notification-empty-state.svg" alt="Generic Empty State" class="null-state">
						<div class="title">${__("No New notifications")}</div>
						<div class="subtitle">
							${__("Looks like you haven\u2019t received any notifications.")}
					</div></div></div>`))}get_notifications_list(t){return frappe.call("frappe.desk.doctype.notification_log.notification_log.get_notification_logs",{limit:t})}get_item_link(t){let e=t.document_type?t.document_type:"Notification Log",r=t.document_name?t.document_name:t.name;return frappe.utils.get_form_link(e,r)}toggle_notification_icon(t){this.notifications_icon.find(".notifications-seen").toggle(t),this.notifications_icon.find(".notifications-unseen").toggle(!t)}toggle_seen(t){frappe.call("frappe.desk.doctype.notification_settings.notification_settings.set_seen_value",{value:cint(t),user:frappe.session.user})}setup_notification_listeners(){frappe.realtime.on("notification",()=>{this.toggle_notification_icon(!1),this.update_dropdown()}),frappe.realtime.on("indicator_hide",()=>{this.toggle_notification_icon(!0)}),this.parent.on("show.bs.dropdown",()=>{this.toggle_seen(!0),this.notifications_icon.find(".notifications-unseen").is(":visible")&&(this.toggle_notification_icon(!0),frappe.call("frappe.desk.doctype.notification_log.notification_log.trigger_indicator_hide"))})}},sp=class extends _s{make(){let t=frappe.datetime.get_today();frappe.xcall("frappe.desk.doctype.event.event.get_events",{start:t,end:t}).then(e=>{this.render_events_html(e)})}render_events_html(t){let e="";if(t.length){let r=n=>{let a=__("All Day");if(!n.all_day){let l=frappe.datetime.get_time(n.starts_on),u=frappe.datetime.get_day_diff(n.ends_on,n.starts_on),c=frappe.datetime.get_time(n.ends_on);u>1&&(c=__("Rest of the day")),a=`${l} - ${c}`}let s="";n.particpants&&(s=frappe.avatar_group(n.particpants,3));let o="";return n.location&&(o=`, ${n.location}`),`<a class="recent-item event" href="/app/event/${n.name}">
					<div class="event-border" style="border-color: ${n.color}"></div>
					<div class="event-item">
						<div class="event-subject">${n.subject}</div>
						<div class="event-time">${a}${o}</div>
						${s}
					</div>
				</a>`};e=t.map(r).join("")}else e=`
				<div class="notification-null-state">
					<div class="text-center">
					<img src="/assets/frappe/images/ui-states/event-empty-state.svg" alt="Generic Empty State" class="null-state">
					<div class="title">${__("No Upcoming Events")}</div>
					<div class="subtitle">
						${__("There are no upcoming events for you.")}
				</div></div></div>
			`;this.container.html(e)}};function jC(i,t,e,r,n,a,s){let o=frappe.call({method:"clefincode_erp.api.api_1_0_1.api.approve_access_request",args:{sender:i,reciever:t,chat_topic:e,notification_log:r,chat_topic_subject:n,reference_doctype:a,reference_docname:s}})}var Wn=Ut(Wa());frappe.last_edited_communication={};var op="<div>---</div>";frappe.views.CommunicationComposer=class{constructor(i){$.extend(this,i),this.doc||(this.doc=this.frm&&this.frm.doc||{}),this.make()}make(){let i=this;this.dialog=new frappe.ui.Dialog({title:this.title||this.subject||__("New Email"),no_submit_on_enter:!0,fields:this.get_fields(),primary_action_label:__("Send"),primary_action(){i.send_action()},secondary_action_label:__("Discard"),secondary_action(){i.dialog.hide(),i.clear_cache()},size:"large",minimizable:!0,static:!0}),$(this.dialog.$wrapper.find(".form-section").get(0)).addClass("to_section"),this.prepare(),this.dialog.show(),this.frm&&$(document).trigger("form-typing",[this.frm])}get_fields(){let i=[{label:__("To"),fieldtype:"MultiSelect",reqd:0,fieldname:"recipients"},{fieldtype:"Button",label:frappe.utils.icon("down"),fieldname:"option_toggle_button",click:()=>{this.toggle_more_options()}},{fieldtype:"Section Break",hidden:1,fieldname:"more_options"},{label:__("CC"),fieldtype:"MultiSelect",fieldname:"cc"},{label:__("BCC"),fieldtype:"MultiSelect",fieldname:"bcc"},{label:__("Email Template"),fieldtype:"Link",options:"Email Template",fieldname:"email_template"},{fieldtype:"Section Break"},{label:__("Subject"),fieldtype:"Data",reqd:1,fieldname:"subject",length:524288},{label:__("Message"),fieldtype:"Text Editor",fieldname:"content",onchange:frappe.utils.debounce(this.save_as_draft.bind(this),300)},{fieldtype:"Button",label:__("Add Signature"),fieldname:"add_signature",hidden:1,click:async()=>{let e=this.dialog.get_value("sender")||"";this.content_set=!1,await this.set_content(e)}},{fieldtype:"Section Break"},{label:__("Send me a copy"),fieldtype:"Check",fieldname:"send_me_a_copy",default:frappe.boot.user.send_me_a_copy},{label:__("Send Read Receipt"),fieldtype:"Check",fieldname:"send_read_receipt"},{label:__("Attach Document Print"),fieldtype:"Check",fieldname:"attach_document_print"},{label:__("Select Print Format"),fieldtype:"Select",fieldname:"select_print_format"},{label:__("Select Languages"),fieldtype:"Select",fieldname:"language_sel"},{fieldtype:"Column Break"},{label:__("Select Attachments"),fieldtype:"HTML",fieldname:"select_attachments"}],t=frappe.boot.email_accounts.filter(e=>!in_list(["All Accounts","Sent","Spam","Trash"],e.email_account)&&e.enable_outgoing);return t.length&&(this.user_email_accounts=t.map(function(e){return e.email_id}),i.unshift({label:__("From"),fieldtype:"Select",reqd:1,fieldname:"sender",options:this.user_email_accounts}),this.user_email_accounts.length==1&&(this.sender=this.user_email_accounts)),i}toggle_more_options(i){i=i||this.dialog.fields_dict.more_options.df.hidden,this.dialog.set_df_property("more_options","hidden",!i);let t=frappe.utils.icon(i?"up-line":"down");this.dialog.get_field("option_toggle_button").set_label(t)}prepare(){this.setup_multiselect_queries(),this.setup_subject_and_recipients(),this.setup_print_language(),this.setup_print(),this.setup_attach(),this.setup_email(),this.setup_email_template(),this.setup_last_edited_communication(),this.setup_add_signature_button(),this.set_values()}setup_add_signature_button(){let i=this.dialog.has_field("sender");this.dialog.set_df_property("add_signature","hidden",!i)}setup_multiselect_queries(){["recipients","cc","bcc"].forEach(i=>{this.dialog.fields_dict[i].get_data=()=>{let e=this.dialog.fields_dict[i].get_value().match(/[^,\s*]*$/)[0]||"";frappe.call({method:"frappe.email.get_contact_list",args:{txt:e},callback:r=>{this.dialog.fields_dict[i].set_data(r.message)}})}})}setup_subject_and_recipients(){if(this.subject=this.subject||"",!this.forward&&!this.recipients&&this.last_email&&(this.recipients=this.last_email.sender,this.cc=this.last_email.cc,this.bcc=this.last_email.bcc),!this.forward&&!this.recipients&&(this.recipients=this.frm&&this.frm.timeline.get_recipient()),!this.subject&&this.frm){let i=this.frm.timeline.get_last_email();i&&(this.subject=i.subject,this.recipients||(this.recipients=i.sender),strip(this.subject.toLowerCase().split(":")[0])!="re"&&(this.subject=__("Re: {0}",[this.subject]))),this.subject||(this.subject=this.frm.doc.name,this.frm.meta.subject_field&&this.frm.doc[this.frm.meta.subject_field]?this.subject=this.frm.doc[this.frm.meta.subject_field]:this.frm.meta.title_field&&this.frm.doc[this.frm.meta.title_field]&&(this.subject=this.frm.doc[this.frm.meta.title_field]));let t=`#${this.frm.doc.name}`;cstr(this.subject).includes(t)||(this.subject=`${this.subject} (${t})`)}this.frm&&!this.recipients&&(this.recipients=this.frm.doc[this.frm.email_field])}setup_email_template(){let i=this;this.dialog.fields_dict.email_template.df.onchange=()=>{let t=i.dialog.fields_dict.email_template.get_value();if(!t)return;function e(r){if(i.reply_added===t)return;let n=i.dialog.fields_dict.content,a=i.dialog.fields_dict.subject,s=n.get_value()||"";n.set_value(`${r.message}<br>${s}`),a.set_value(r.subject),i.reply_added=t}frappe.call({method:"frappe.email.doctype.email_template.email_template.get_email_template",args:{template_name:t,doc:i.doc,_lang:i.dialog.get_value("language_sel")},callback(r){e(r.message)}})}}setup_last_edited_communication(){this.frm?(this.doctype=this.frm.doctype,this.key=this.frm.docname):this.doctype=this.key="Inbox",this.last_email&&(this.key=this.key+":"+this.last_email.name),this.subject&&(this.key=this.key+":"+this.subject),this.dialog.on_hide=()=>{$.extend(this.get_last_edited_communication(!0),this.dialog.get_values(!0)),this.frm&&$(document).trigger("form-stopped-typing",[this.frm])}}get_last_edited_communication(i){return frappe.last_edited_communication[this.doctype]||(frappe.last_edited_communication[this.doctype]={}),(i||!frappe.last_edited_communication[this.doctype][this.key])&&(frappe.last_edited_communication[this.doctype][this.key]={}),frappe.last_edited_communication[this.doctype][this.key]}async set_values(){for(let t of["recipients","cc","bcc","sender"])await this.dialog.set_value(t,this[t]||"");let i=frappe.utils.html2text(this.subject)||"";if(await this.dialog.set_value("subject",i),await this.set_values_from_last_edited_communication(),await this.set_content(),this.frm&&!this.is_a_reply&&!this.content_set){let t=this.frm.meta.default_email_template||"";await this.dialog.set_value("email_template",t)}for(let t of["email_template","cc","bcc"])if(this.dialog.get_value(t)){this.toggle_more_options(!0);break}}async set_values_from_last_edited_communication(){if(this.message)return;let i=this.get_last_edited_communication();!i.content||(i.email_template&&(await this.dialog.fields_dict.email_template.set_model_value(i.email_template),delete i.email_template),await this.dialog.set_values(i),this.content_set=!0)}selected_format(){return this.dialog.fields_dict.select_print_format.input.value||this.frm&&this.frm.meta.default_print_format||"Standard"}get_print_format(i){return i||(i=this.selected_format()),locals["Print Format"]&&locals["Print Format"][i]?locals["Print Format"][i]:{}}setup_print_language(){let i=this.dialog.fields_dict;this.lang_code=this.doc.language||this.get_print_format().default_print_language||frappe.boot.lang;let t=this;$(i.language_sel.input).change(function(){t.lang_code=this.value}),$(i.language_sel.input).empty().add_options(frappe.get_languages()),this.lang_code&&$(i.language_sel.input).val(this.lang_code)}setup_print(){let i=this.dialog.fields_dict;if($(i.attach_document_print.input).click(function(){$(i.select_print_format.wrapper).toggle($(this).prop("checked"))}),$(i.select_print_format.wrapper).toggle(!1),this.frm){let t=frappe.meta.get_print_formats(this.frm.meta.name);$(i.select_print_format.input).empty().add_options(t).val(t[0])}else $(i.attach_document_print.wrapper).toggle(!1)}setup_attach(){let i=this.dialog.fields_dict,t=$(i.select_attachments.wrapper);this.attachments||(this.attachments=[]);let e={folder:"Home/Attachments",on_success:r=>{this.attachments.push(r),this.render_attachment_rows(r)}};this.frm&&(e={doctype:this.frm.doctype,docname:this.frm.docname,folder:"Home/Attachments",on_success:r=>{this.frm.attachments.attachment_uploaded(r),this.render_attachment_rows(r)}}),$(`
			<label class="control-label">
				${__("Select Attachments")}
			</label>
			<div class='attach-list'></div>
			<p class='add-more-attachments'>
				<button class='btn btn-xs btn-default'>
					${frappe.utils.icon("small-add","xs")}&nbsp;
					${__("Add Attachment")}
				</button>
			</p>
		`).appendTo(t.empty()),t.find(".add-more-attachments button").on("click",()=>new frappe.ui.FileUploader(e)),this.render_attachment_rows()}render_attachment_rows(i){let t=this.dialog.fields_dict.select_attachments,e=$(t.wrapper).find(".attach-list");if(i)e.append(this.get_attachment_row(i,!0));else{let r=[];this.attachments&&this.attachments.length&&(r=r.concat(this.attachments)),this.frm&&(r=r.concat(this.frm.get_files())),r.length&&$.each(r,(n,a)=>{!a.file_name||e.find(`[data-file-name="${a.name}"]`).length||(a.file_url=frappe.urllib.get_full_url(a.file_url),e.append(this.get_attachment_row(a)))})}}get_attachment_row(i,t){return $(`<p class="checkbox flex">
			<label class="ellipsis" title="${i.file_name}">
				<input
					type="checkbox"
					data-file-name="${i.name}"
					${t?"checked":""}>
				</input>
				<span class="ellipsis">${i.file_name}</span>
			</label>
			&nbsp;
			<a href="${i.file_url}" target="_blank" class="btn-linkF">
				${frappe.utils.icon("link-url")}
			</a>
		</p>`)}setup_email(){let i=this.dialog.fields_dict;this.attach_document_print&&($(i.attach_document_print.input).click(),$(i.select_print_format.wrapper).toggle(!0)),$(i.send_me_a_copy.input).on("click",()=>{let t=i.send_me_a_copy.get_value();frappe.db.set_value("User",frappe.session.user,"send_me_a_copy",t),frappe.boot.user.send_me_a_copy=t})}send_action(){let i=this,t=i.dialog.get_primary_btn(),e=this.get_values();if(!e)return;let r=$.map($(i.dialog.wrapper).find("[data-file-name]:checked"),function(n){return $(n).attr("data-file-name")});e.attach_document_print?i.send_email(t,e,r,null,e.select_print_format||""):i.send_email(t,e,r)}get_values(){let i=this.dialog.get_values();for(let t=0,e=this.dialog.fields.length;t<e;t++){let r=this.dialog.fields[t];r.is_cc_checkbox&&(i[r.fieldname]&&(i.cc=(i.cc?i.cc+", ":"")+r.fieldname,i.bcc=(i.bcc?i.bcc+", ":"")+r.fieldname),delete i[r.fieldname])}return i}save_as_draft(){if(this.dialog&&this.frm){let i=this.dialog.get_value("content");i=i.split(op)[0],Wn.default.setItem(this.frm.doctype+this.frm.docname,i).catch(t=>{t&&(console.log(t),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}}clear_cache(){this.delete_saved_draft(),this.get_last_edited_communication(!0)}delete_saved_draft(){this.dialog&&this.frm&&Wn.default.removeItem(this.frm.doctype+this.frm.docname).catch(i=>{i&&(console.log(i),console.warn("[Communication] IndexedDB is full. Cannot save message as draft"))})}send_email(i,t,e,r,n){let a=this;if(this.dialog.hide(),!t.recipients){frappe.msgprint(__("Enter Email Recipient(s)"));return}if(t.attach_document_print||(r=null,n=null),this.frm&&!frappe.model.can_email(this.doc.doctype,this.frm)){frappe.msgprint(__("You are not allowed to send emails related to this document"));return}return frappe.call({method:"frappe.core.doctype.communication.email.make",args:{recipients:t.recipients,cc:t.cc,bcc:t.bcc,subject:t.subject,content:t.content,doctype:a.doc.doctype,name:a.doc.name,send_email:1,print_html:r,send_me_a_copy:t.send_me_a_copy,print_format:n,sender:t.sender,sender_full_name:t.sender?frappe.user.full_name():void 0,email_template:t.email_template,attachments:e,_lang:a.lang_code,read_receipt:t.send_read_receipt,print_letterhead:a.is_print_letterhead_checked()},btn:i,callback(s){if(s.exc){if(frappe.msgprint(__("There were errors while sending email. Please try again.")),a.error)try{a.error(s)}catch(o){console.log(o)}}else if(frappe.utils.play_sound("email"),s.message.emails_not_sent_to&&frappe.msgprint(__("Email not sent to {0} (unsubscribed / disabled)",[frappe.utils.escape_html(s.message.emails_not_sent_to)])),a.clear_cache(),a.frm&&a.frm.reload_doc(),a.success)try{a.success(s)}catch(o){console.log(o)}}})}is_print_letterhead_checked(){return this.frm&&$(this.frm.wrapper).find(".form-print-wrapper").is(":visible")?$(this.frm.wrapper).find(".print-letterhead").prop("checked")?1:0:(frappe.model.get_doc(":Print Settings","Print Settings")||{with_letterhead:1}).with_letterhead?1:0}async set_content(i){if(this.content_set)return;let t=this.message||"";if(!t&&this.frm){let{doctype:e,docname:r}=this.frm;t=await Wn.default.getItem(e+r)||""}t&&(this.content_set=!0),t+=await this.get_signature(i||null),this.is_a_reply&&!this.reply_set&&(t+=this.get_earlier_reply()),await this.dialog.set_value("content",t)}async get_signature(i){let t=frappe.boot.user.email_signature;if(!t){let e={add_signature:1};i?e.email_id=i:e.default_outgoing=1;let r=await frappe.db.get_list("Email Account",{filters:e,fields:["signature","email_id"],limit:1}),n=null;r.length&&(t=r[0].signature,n=r[0].email_id),!i&&n&&this.user_email_accounts&&this.user_email_accounts.includes(n)&&this.dialog.set_value("sender",n)}return t?(frappe.utils.is_html(t)||(t=t.replace(/\n/g,"<br>")),"<br>"+t):""}get_earlier_reply(){this.reply_set=!1;let i=this.last_email||this.frm&&this.frm.timeline.get_last_email(!0);if(!i)return"";let t=i.original_comment||i.content;t=this.html2text(t).replace(/\n/g,"<br>"),t.length>20*1024&&(t+="<div>"+__("Message clipped")+"</div>"+t,t=t.slice(0,20*1024));let e=frappe.datetime.global_date_format(i.communication_date||i.creation);return this.reply_set=!0,`
			<div><br></div>
			${op||""}
			<p>
			${__("On {0}, {1} wrote:",[e,i.sender])}
			</p>
			<blockquote>
			${t}
			</blockquote>
		`}html2text(i){return i=i.replace(/<\/div>/g,"<br></div>").replace(/<\/p>/g,"<br></p>").replace(/<br>/g,`
`),frappe.utils.html2text(i).replace(/\n{3,}/g,`

`)}};})();
/*!
    localForage -- Offline Storage, Improved
    Version 1.9.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*! For license information please see editor.js.LICENSE.txt */
/*! showdown v 2.1.0 - 21-04-2022 */
/**!
 * Sortable
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
//# sourceMappingURL=desk.bundle.M4W4U5JW.js.map
